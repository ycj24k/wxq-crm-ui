(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9696],{57126:function(Ce,L,e){"use strict";var m=e(71194),E=e(50146),q=e(78697),x=e(85893);L.Z=function(T){var b=T.CardVisible,g=T.setCardVisible,W=T.setGrouptment,$=T.ment;return(0,x.jsx)(E.Z,{visible:b,onCancel:function(){return g()},onOk:function(){g(),$()},children:(0,x.jsx)(q.Z,{type:"modal",setParentIdTree:function(d){W(d)},setCardVisible:function(){return g()}})})}},78697:function(Ce,L,e){"use strict";var m=e(32157),E=e(5816),q=e(86582),x=e(39428),T=e(3182),b=e(11849),g=e(2824),W=e(47673),$=e(4107),I=e(30202),d=e(67294),p=e(63863),G=e(85893),oe=$.Z.Search,ee=[];L.Z=function(R){var v=R.setParentIdTree,te=R.setParentIdFalg,re=R.callbackRef,ce=R.type,ne=(0,d.useState)([]),ae=(0,g.Z)(ne,2),K=ae[0],F=ae[1],se=(0,d.useState)([]),B=(0,g.Z)(se,2),y=B[0],fe=B[1],me=(0,d.useState)(""),Q=(0,g.Z)(me,2),M=Q[0],t=Q[1],pe=(0,d.useState)(!0),ue=(0,g.Z)(pe,2),D=ue[0],S=ue[1];(0,d.useEffect)(function(){Y()},[]);var k=function(a){return a.forEach(function(n,u){n.children=[],n.title=n.name,a.forEach(function(o,C){n.id==Math.abs(o.parentId)&&u!=C&&n.children.push(o)}),n.children.length==0&&delete n.children}),a},P=function h(a,n){return a.forEach(function(u,o){u.key=o+"-"+n,u.children&&h(u.children,u.key)}),a},H=function h(a){return a.filter(function(n){return n.isDel>=0}).map(function(n){return n.children&&n.children.length?(0,b.Z)((0,b.Z)({},n),{},{children:h(n.children)}):n})},Y=function(){var h=(0,T.Z)((0,x.Z)().mark(function a(){var n,u,o,C,j;return(0,x.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,p.Z.get("/sms/share/getDepartment",{_isGetAll:!0});case 2:n=_.sent,u=[],o=n.data.reverse(),o=H(o),o.forEach(function(O){u.push({title:O.name,key:O.id})}),C=k(o),j=P(C,0),F(j);case 10:case"end":return _.stop()}},a)}));return function(){return h.apply(this,arguments)}}(),A=function(a){fe(a),S(!1)},U=function(a){var n=a.target.value;t(n),S(!0)},z=function h(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[];return a.forEach(function(u){var o,C=(o=u.title)===null||o===void 0?void 0:o.indexOf(M);if(u.children&&M.length>0){var j;(j=n).push.apply(j,(0,q.Z)(h(u.children)))}C>-1&&M.length>0&&n.push({title:u.title,id:u.id,key:u.key}),M.length==0&&(n=[],n.push(u))}),n};return(0,G.jsxs)(I.ZP,{title:"\u90E8\u95E8\u5217\u8868",colSpan:"25%",style:{width:ce=="modal"?"100%":"25%"},children:[(0,G.jsx)(oe,{style:{marginBottom:30},placeholder:"Search",onChange:function(a){return U(a)}}),K.length>0&&(0,G.jsx)(E.Z,{showIcon:!0,defaultExpandAll:!0,onExpand:function(a){return A(a)},autoExpandParent:D,defaultCheckedKeys:ee,onSelect:function(a,n){v({id:n.node.id,name:n.node.title}),te&&te(!1),re&&re()},treeData:z(K)})]})}},44162:function(Ce,L,e){"use strict";e.r(L),e.d(L,{default:function(){return ue}});var m=e(39428),E=e(3182),q=e(34792),x=e(48086),T=e(57663),b=e(71577),g=e(66456),W=e(15885),$=e(32059),I=e(11849),d=e(2824),p=e(67294),G=e(40110),oe=e(90631),ee=e(51042),R=e(63863),v=e(37490),te=e(15258),re=e(71906),ce=e(7903),ne=e(57126),ae=e(22),K=e(54493),F=e(952),se=e(37476),B=e(64317),y=e(5966),fe=e(8214),me=e(45510),Q=e(90672),M=e(21010),t=e(85893),pe=function(D){var S,k=(0,M.tT)("@@initialState"),P=k.initialState,H=P==null||(S=P.currentUser)===null||S===void 0?void 0:S.userid,Y=D.modalVisible,A=D.setModalVisible,U=D.callbackRef,z=D.renderData,h=D.type,a=(0,p.useState)("\u5B66\u5458\u59D3\u540D"),n=(0,d.Z)(a,2),u=n[0],o=n[1],C=(0,p.useState)(!1),j=(0,d.Z)(C,2),w=j[0],_=j[1],O=(0,p.useState)({name:""}),J=(0,d.Z)(O,2),N=J[0],he=J[1],V=(0,p.useRef)(),X=function(){var l;V==null||(l=V.current)===null||l===void 0||l.setFieldsValue({departmentId:N.name})},je=function(){var f=(0,E.Z)((0,m.Z)().mark(function l(r){return(0,m.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(N.id){Z.next=3;break}return x.default.error("\u8BF7\u91CD\u65B0\u9009\u62E9\u4E00\u4E0B\u90E8\u95E8"),Z.abrupt("return");case 3:return r.departmentId&&(r.departmentId=N.id),Z.abrupt("return",new Promise(function(Ze){R.Z.post2("/sms/business/bizStudent/addCirculationRepository",{departmentId:r.departmentId},[r]).then(function(le){le.status=="success"&&(x.default.success("\u64CD\u4F5C\u6210\u529F"),A(!1),U())}),Ze(!0)}));case 5:case"end":return Z.stop()}},l)}));return function(r){return f.apply(this,arguments)}}();return(0,t.jsxs)(se.Y,{title:"\u65B0\u5EFA",formRef:V,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,maskClosable:!1,onCancel:function(){A()}},onFinish:function(){var f=(0,E.Z)((0,m.Z)().mark(function l(r){return(0,m.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!(!r.QQ&&!r.weChat&&!r.mobile)){Z.next=3;break}return x.default.error("QQ\u3001\u5FAE\u4FE1\u3001\u7535\u8BDD\uFF0C\u4E09\u79CD\u8054\u7CFB\u65B9\u5F0F\u5FC5\u987B\u8981\u6DFB\u52A0\u4E00\u4E2A",5),Z.abrupt("return");case 3:return r.project&&(r.project=r.project[r.project.length-1]),r.provider=H,r.consultationTime=r.consultationTime,console.log("values",r),Z.next=9,je(r);case 9:case"end":return Z.stop()}},l)}));return function(l){return f.apply(this,arguments)}}(),visible:Y,children:[(0,t.jsxs)(F.ZP.Group,{children:[(0,t.jsx)(B.Z,{label:"\u5B66\u5458\u7C7B\u578B",name:"type",width:"xs",request:(0,E.Z)((0,m.Z)().mark(function f(){return(0,m.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",v.Z.getList("studentType"));case 1:case"end":return r.stop()}},f)})),fieldProps:{onChange:function(l){l=="1"?o("\u4F01\u4E1A\u540D\u79F0"):l=="2"?o("\u4EE3\u7406\u4EBA\u59D3\u540D"):l=="3"?o("\u4ECB\u7ECD\u4EBA\u59D3\u540D"):o("\u5B66\u5458\u59D3\u540D")}},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5B66\u5458\u7C7B\u578B"}]}),(0,t.jsx)(y.Z,{name:"name",width:"md",label:u,placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",rules:[{required:!0,pattern:new RegExp(/^\S*$/),message:"\u4E0D\u80FD\u5305\u542B\u7A7A\u683C/\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u7528\u6237\u540D"}]}),u==="\u4F01\u4E1A\u540D\u79F0"?(0,t.jsx)(y.Z,{width:"sm",name:"chargePersonName",label:"\u4F01\u4E1A\u8D1F\u8D23\u4EBA",placeholder:"\u8BF7\u8F93\u5165\u4F01\u4E1A\u8D1F\u8D23\u4EBA",rules:[{required:!0,pattern:new RegExp(/^\S*$/),message:"\u4E0D\u80FD\u5305\u542B\u7A7A\u683C/\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u540D\u5B57"}]}):null]}),(0,t.jsxs)(F.ZP.Group,{children:[u==="\u4F01\u4E1A\u540D\u79F0"||h==="\u4E2A\u4EBA\u4EE3\u7406"?"":(0,t.jsx)(B.Z,{label:"\u5B66\u5386",hidden:u==="\u4F01\u4E1A\u540D\u79F0"||h==="\u4E2A\u4EBA\u4EE3\u7406",name:"education",width:"xs",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5B66\u5386"}],request:(0,E.Z)((0,m.Z)().mark(function f(){return(0,m.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",v.Z.getList("dict_education"));case 1:case"end":return r.stop()}},f)}))}),(0,t.jsx)(y.Z,{width:"sm",name:"mobile",label:"\u8054\u7CFB\u7535\u8BDD",placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD",rules:[{pattern:new RegExp(v.Z.getRegex("mobile")),message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7"}]}),(0,t.jsx)(y.Z,{width:"md",name:"idCard",label:u==="\u4F01\u4E1A\u540D\u79F0"?"\u4F01\u4E1A\u8D1F\u8D23\u4EBA\u8EAB\u4EFD\u8BC1\u53F7":"\u8EAB\u4EFD\u8BC1\u53F7",placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1",rules:[{pattern:new RegExp(v.Z.getRegex("idCard")),message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u8EAB\u4EFD\u8BC1\u53F7"}]})]}),(0,t.jsxs)(F.ZP.Group,{children:[(0,t.jsx)(y.Z,{width:"xs",name:"weChat",label:"\u5FAE\u4FE1",placeholder:"\u8BF7\u8F93\u5165\u5FAE\u4FE1"}),(0,t.jsx)(y.Z,{width:"xs",name:"QQ",label:"QQ",placeholder:"\u8BF7\u8F93\u5165QQ"}),(0,t.jsx)(B.Z,{label:"\u6027\u522B",name:"sex",width:"xs",valueEnum:{false:"\u7537",true:"\u5973"}}),(0,t.jsx)(fe.Z,{width:"sm",name:"project",placeholder:"\u54A8\u8BE2\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:v.Z.getCascader("dict_reg_job"),showSearch:{filter:K.Z},onSearch:function(l){return console.log(l)}}}),(0,t.jsx)(B.Z,{label:"\u5BA2\u6237\u6765\u6E90",name:"source",width:200,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5BA2\u6237\u6765\u6E90"}],request:(0,E.Z)((0,m.Z)().mark(function f(){return(0,m.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",v.Z.getList("dict_source"));case 1:case"end":return r.stop()}},f)}))}),(0,t.jsx)(me.Z,{name:"consultationTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"sm",label:"\u54A8\u8BE2\u65E5\u671F",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u54A8\u8BE2\u65E5\u671F"}]})]}),(0,t.jsxs)(F.ZP.Group,{children:[(0,t.jsx)(y.Z,{name:"departmentId",label:"\u90E8\u95E8",rules:[{required:!0}]}),(0,t.jsx)(b.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,E.Z)((0,m.Z)().mark(function f(){return(0,m.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:_(!0);case 1:case"end":return r.stop()}},f)})),children:"\u9009\u62E9"})]}),(0,t.jsx)(Q.Z,{name:"address",label:"\u5730\u5740",placeholder:"\u8BF7\u8F93\u5165\u63CF\u8FF0..."}),(0,t.jsx)(Q.Z,{name:"description",label:"\u5907\u6CE8",placeholder:"\u8BF7\u8F93\u5165\u63CF\u8FF0..."}),w&&(0,t.jsx)(ne.Z,{CardVisible:w,setCardVisible:function(){return _(!1)},setGrouptment:function(l){return he(l)},ment:function(){return X()}})]})},ue=function(D){var S,k=(0,M.tT)("@@initialState"),P=k.initialState,H=D.hidden,Y=(0,p.useState)(null),A=(0,d.Z)(Y,2),U=A[0],z=A[1],h=(0,p.useState)(!1),a=(0,d.Z)(h,2),n=a[0],u=a[1],o=(0,p.useState)(!1),C=(0,d.Z)(o,2),j=C[0],w=C[1],_=(0,p.useState)(!1),O=(0,d.Z)(_,2),J=O[0],N=O[1],he=(0,p.useState)("1"),V=(0,d.Z)(he,2),X=V[0],je=V[1],f=(0,p.useState)([]),l=(0,d.Z)(f,2),r=l[0],ve=l[1],Z=(0,p.useRef)(),Ze=(0,p.useState)(!1),le=(0,d.Z)(Ze,2),Pe=le[0],Ee=le[1],Te=(0,p.useState)(!1),be=(0,d.Z)(Te,2),Se=be[0],_e=be[1],Ie=(0,p.useState)({name:""}),ge=(0,d.Z)(Ie,2),ye=ge[0],Re=ge[1],Fe=(0,p.useState)(P==null||(S=P.currentUser)===null||S===void 0?void 0:S.departmentId),De=(0,d.Z)(Fe,2),Be=De[0],Me=De[1],ie=(0,p.useRef)(),de=function(){Z.current.reload()},Ae=function(){var c;ie==null||(c=ie.current)===null||c===void 0||c.setFieldsValue({departmentId:ye.name}),Me(ye.id)},Oe=[{title:"\u59D3\u540D",dataIndex:"name",sorter:!0,fixed:"left",render:function(c,i){return(0,t.jsx)("div",{children:(0,t.jsxs)("a",{onClick:function(){z((0,I.Z)({},i)),w(!0)},children:[i.name,(0,t.jsx)(G.Z,{})]})})}},{title:"\u6027\u522B",dataIndex:"sex",valueType:"select",valueEnum:{false:"\u7537",true:"\u5973"},render:function(c,i){return(0,t.jsx)("span",{children:i.sex==null?"\u672A\u77E5":i.sex?"\u5973":"\u7537"})},sorter:!0},{title:"\u8EAB\u4EFD\u8BC1",dataIndex:"idCard",hideInTable:!0,sorter:!0},{title:"\u624B\u673A\u53F7",dataIndex:"mobile",hideInTable:!0,sorter:!0},{title:"\u5FAE\u4FE1\u53F7",dataIndex:"weChat",hideInTable:!0,sorter:!0},{title:"\u5B66\u5458\u7C7B\u578B",dataIndex:"type",valueType:"select",sorter:!0,order:9,filters:!0,filterMultiple:!1,valueEnum:v.Z.getSearch("studentType"),render:function(c,i){return(0,t.jsx)("span",{children:v.Z.getName("studentType",i.type)})}},{title:"\u9879\u76EE\u603B\u79F0",dataIndex:"parentProjects",key:"parentProjects",sorter:!0,valueType:"select",fieldProps:{options:v.Z.getList("dict_reg_job"),showSearch:{filter:K.Z},mode:"tags"},width:150,render:function(c,i){return(0,t.jsx)("span",{children:v.Z.getCascaderAllName("dict_reg_job",i.project)},"parentProjects")}},{title:"\u54A8\u8BE2\u5C97\u4F4D",dataIndex:"project-in",key:"project-in",valueType:"select",fieldProps:{showSearch:{filter:K.Z},options:v.Z.getCascader("dict_reg_job"),mode:"tags"},render:function(c,i){return(0,t.jsx)("span",{children:v.Z.getCascaderName("dict_reg_job",i.project)})}},{title:"\u54A8\u8BE2\u65F6\u95F4",key:"createTime",sorter:!0,dataIndex:"createTime",valueType:"dateRange",render:function(c,i){return(0,t.jsx)("span",{children:i.createTime})}},{title:"\u5BA2\u6237\u6765\u6E90",dataIndex:"studentSource",valueType:"select",sorter:!0,valueEnum:v.Z.getSearch("dict_source"),render:function(c,i){return(0,t.jsx)("span",{children:v.Z.getName("dict_source",i.studentSource)})}},{title:"\u5B66\u5458\u4FE1\u606F\u63D0\u4F9B\u4EBA",dataIndex:"providerName",sorter:!0},{title:"\u5F53\u524D\u6240\u5728\u90E8\u95E8",sorter:!0,dataIndex:"departmentName",search:!1,render:function(c,i){return(0,t.jsx)("span",{children:v.Z.getDepartmentName(i.departmentId).join("-")})}},{title:"\u5907\u6CE8",dataIndex:"description",ellipsis:!0,tip:"\u5907\u6CE8\u8FC7\u957F\u4F1A\u81EA\u52A8\u6536\u7F29"}],Ve=(0,$.Z)({},"circulationTime","desc");return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(re.ZP,{children:[(0,t.jsx)(ae.Z,{columns:Oe,actionRef:Z,request:{url:"/sms/business/bizStudentUser",params:{source:X,"userId-isNull":!0,circulationNum:0},sortList:Ve},search:H?!1:{defaultCollapsed:!1},rowSelection:{selections:[W.Z.SELECTION_ALL,W.Z.SELECTION_INVERT],onChange:function(c,i){ve(c)}},toolBarRender:[(0,t.jsx)("a",{download:"\u65B0\u5B66\u5458\u5BFC\u5165\u6A21\u677F",href:"./template/\u65B0\u5B66\u5458\u5BFC\u5165\u6A21\u677F.xlsx",children:"\u4E0B\u8F7D\u5BFC\u5165\u6A21\u677F"}),(0,t.jsx)(b.Z,{icon:(0,t.jsx)(oe.Z,{}),type:"primary",onClick:function(){Ee(!0)},children:"\u6279\u91CF\u5BFC\u5165"},"button"),(0,t.jsx)(b.Z,{icon:(0,t.jsx)(ee.Z,{}),type:"primary",onClick:function(){z({types:"add"}),N(!0)},children:"\u65B0\u5EFA"},"button"),(0,t.jsx)(b.Z,{icon:(0,t.jsx)(ee.Z,{}),type:"primary",onClick:function(){if(r.length==0){x.default.error("\u8BF7\u9009\u62E9\u9700\u8981\u9886\u53D6\u7684\u5B66\u5458!");return}console.log(r),R.Z.post("/sms/business/bizStudentUser/receive",{ids:r.join(","),source:X}).then(function(c){c.status=="success"&&(x.default.success("\u64CD\u4F5C\u6210\u529F"),de())})},children:"\u9886\u53D6"},"button")]}),(0,t.jsx)(se.Y,{visible:Pe,formRef:ie,modalProps:{destroyOnClose:!0,maskClosable:!1,onCancel:function(){Ee(!1)}},title:"\u9009\u62E9\u90E8\u95E8",width:800,onFinish:function(){var s=(0,E.Z)((0,m.Z)().mark(function c(i){return(0,m.Z)().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:u(!0),Ee(!1);case 2:case"end":return xe.stop()}},c)}));return function(c){return s.apply(this,arguments)}}(),children:(0,t.jsxs)(F.ZP.Group,{children:[(0,t.jsx)(y.Z,{name:"departmentId",label:"\u90E8\u95E8",rules:[{required:!0}],width:500}),(0,t.jsx)(b.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,E.Z)((0,m.Z)().mark(function s(){return(0,m.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:_e(!0);case 1:case"end":return i.stop()}},s)})),children:"\u9009\u62E9"})]})}),n&&(0,t.jsx)(te.Z,{setModalVisible:function(){return u(!1)},modalVisible:n,url:"/sms/business/bizStudent/addCirculationRepository?departmentId="+Be,type:"student",uploadtype:"student",propsData:{resourceType:X},callbackRef:function(){return de()},departmentType:!0}),j&&(0,t.jsx)(ce.Z,{setModalVisible:function(){return w(!1)},modalVisible:j,renderData:U,callbackRef:function(){return de()},mobileHide:!0}),J&&(0,t.jsx)(pe,{setModalVisible:function(){return N(!1)},modalVisible:J,renderData:U,callbackRef:function(){return de()},mobileHide:!0}),Se&&(0,t.jsx)(ne.Z,{CardVisible:Se,setCardVisible:function(){return _e(!1)},setGrouptment:function(c){return Re(c)},ment:function(){return Ae()}})]})})}}}]);
