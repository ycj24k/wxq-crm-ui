(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2650],{62650:function(de,V,e){"use strict";var H=e(20228),T=e(11382),J=e(32059),Q=e(62350),X=e(24565),U=e(57663),M=e(71577),_e=e(34792),h=e(48086),w=e(86582),r=e(11849),o=e(39428),I=e(3182),E=e(2824),a=e(67294),d=e(82061),R=e(51042),p=e(63863),s=e(35562),i=e(37490),j=e(22),N=e(57718),t=e(37476),x=e(22452),g=e(86615),B=e(90672),y=e(30381),c=e.n(y),_=e(85893);V.Z=function(k){var f=k.orderId,q=(0,a.useState)(!1),ee=(0,E.Z)(q,2),ae=ee[0],z=ee[1],le=(0,a.useState)(null),$=(0,E.Z)(le,2),ue=$[0],se=$[1],re=(0,a.useState)(!1),Y=(0,E.Z)(re,2),G=Y[0],C=Y[1],n=(0,a.useState)(!1),m=(0,E.Z)(n,2),u=m[0],b=m[1],L=(0,a.useState)(f?{orderId:f}:{}),ie=(0,E.Z)(L,2),F=ie[0],te=ie[1],ce=(0,a.useRef)(),ve="/sms/business/bizStudentUser",me=(0,a.useRef)();(0,a.useEffect)(function(){f&&te({orderId:f}),ne()},[f]);var ne=function(){ce.current.reload()},fe=function(){var D=(0,I.Z)((0,o.Z)().mark(function v(l,Z){var P;return(0,o.Z)().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,s.Z)("/sms/business/bizOrderField/download",l,Z);case 2:return P=O.sent,O.abrupt("return",P.imgUrl[0]);case 4:case"end":return O.stop()}},v)}));return function(l,Z){return D.apply(this,arguments)}}(),De=[{title:"\u59D3\u540D",dataIndex:"studentName",render:function(v,l){return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("a",{onClick:(0,I.Z)((0,o.Z)().mark(function Z(){return(0,o.Z)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:z(!0),p.Z.get(ve,{id:l.studentUserId}).then(function(O){p.Z.get("/sms/business/bizField/orderField",{orderId:l.id}).then(function(pe){var K=pe.data.content.reverse();console.log("signUp",K),K.length>0,K==null||K.forEach(function(){var je=(0,I.Z)((0,o.Z)().mark(function Ee(W){var oe;return(0,o.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!((W==null||(oe=W.value)===null||oe===void 0?void 0:oe.indexOf("."))>0)){S.next=4;break}return S.next=3,fe(W.orderFieldId,W.value);case 3:W.imgUrl=S.sent;case 4:case"end":return S.stop()}},Ee)}));return function(Ee){return je.apply(this,arguments)}}()),se((0,r.Z)((0,r.Z)({},O.data.content[0]),{},{signUp:K,record:l})),setTimeout(function(){C(!0),z(!1)},200)})});case 2:case"end":return A.stop()}},Z)})),children:l.studentName})})}},{title:"\u62A5\u8003\u5C97\u4F4D",dataIndex:"project",key:"project",sorter:!0,valueType:"cascader",fieldProps:{options:i.Z.getCascader("dict_reg_job")},render:function(v,l){return(0,_.jsx)("span",{children:l.project&&(0,w.Z)(new Set(l.project.split(","))).map(function(Z,P){return(0,_.jsxs)("span",{children:[i.Z.getCascaderName("dict_reg_job",Z)," ",(0,_.jsx)("br",{})]},"project-".concat(Z,"-").concat(P))})},"project")}},{title:"\u670D\u52A1\u5185\u5BB9",sorter:!0,dataIndex:"content"},{title:"\u670D\u52A1\u65F6\u95F4",sorter:!0,key:"showTime",dataIndex:"createTime",valueType:"dateTime",hideInSearch:!0},{title:"\u670D\u52A1\u8001\u5E08",sorter:!0,dataIndex:"userName"},{title:"\u64CD\u4F5C",hideInTable:!0,valueType:"option",key:"option",render:function(v,l,Z,P){return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(X.Z,{title:"\u662F\u5426\u786E\u5B9A\u5220\u9664\uFF1F",onConfirm:function(){p.Z.delete("/sms/business/bizService",{id:l.id}).then(function(O){O.status=="success"&&(h.default.success("\u5220\u9664\u6210\u529F"),ne())})},okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",children:(0,_.jsx)(M.Z,{size:"small",type:"primary",danger:!0,icon:(0,_.jsx)(d.Z,{}),children:"\u5220\u9664"},"delete")},l.id)})}}],he=(0,J.Z)({},"createTime","desc");return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(T.Z,{spinning:ae,children:[(0,_.jsx)(j.Z,{columns:De,scroll:{x:1200},actionRef:ce,cardBordered:!0,request:{url:"/sms/business/bizService",sortList:he,params:F},rowKey:"id",search:!f,toolBarRender:[(0,_.jsx)(M.Z,{icon:(0,_.jsx)(R.Z,{}),type:"primary",hidden:!f,onClick:function(){b(!0),setTimeout(function(){var v;(v=me.current)===null||v===void 0||v.setFieldsValue({createTime:c()()})},500)},children:"\u6DFB\u52A0\u670D\u52A1\u8BB0\u5F55"},"button-service-record")]}),G&&(0,_.jsx)(N.Z,{setModalVisible:function(){return C(!1)},modalVisible:G,renderData:ue,callbackRef:function(){return ne()}}),(0,_.jsxs)(t.Y,{visible:u,modalProps:{onCancel:function(){return b(!1)}},onFinish:function(){var D=(0,I.Z)((0,o.Z)().mark(function v(l){return(0,o.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:p.Z.postAll("/sms/business/bizOrder/editService/"+f,{createTime:l.createTime,serviceContent:l.content,serviceStatus:l.status}).then(function(A){A.status=="success"&&(h.default.success("\u64CD\u4F5C\u6210\u529F"),b(!1),ne())});case 1:case"end":return P.stop()}},v)}));return function(v){return D.apply(this,arguments)}}(),formRef:me,children:[(0,_.jsx)(x.Z,{name:"createTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"md",label:"\u670D\u52A1\u65E5\u671F",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u670D\u52A1\u65E5\u671F"}]}),(0,_.jsx)(g.Z.Group,{name:"status",label:"\u670D\u52A1\u72B6\u6001",options:[{label:"\u672A\u670D\u52A1",value:0},{label:"\u670D\u52A1\u4E2D",value:1},{label:"\u5DF2\u5B8C\u7ED3",value:2}],rules:[{required:!0}]}),(0,_.jsx)(B.Z,{label:"\u670D\u52A1\u5185\u5BB9",name:"content",rules:[{required:!0}]})]})]})})}},57718:function(de,V,e){"use strict";var H=e(57338),T=e(273),J=e(12968),Q=e(20352),X=e(57663),U=e(71577),M=e(11849),_e=e(48736),h=e(27049),w=e(98858),r=e(4914),o=e(39428),I=e(3182),E=e(2824),a=e(67294),d=e(37490),R=e(68503),p=e(41574),s=e(85893);V.Z=function(i){var j=i.modalVisible,N=i.setModalVisible,t=i.renderData,x=i.setAuditVisible,g=i.setRenderData,B=(0,a.useState)(null),y=(0,E.Z)(B,2),c=y[0],_=y[1],k=(0,a.useState)(),f=(0,E.Z)(k,2),q=f[0],ee=f[1],ae=(0,a.useState)(!1),z=(0,E.Z)(ae,2),le=z[0],$=z[1],ue=(0,a.useState)(!1),se=(0,E.Z)(ue,2),re=se[0],Y=se[1];(0,a.useEffect)(function(){var n=[],m=[];t.signUp.length>0&&t.signUp.forEach(function(u){u.valueType==0?n.push(u):m.push(u)}),_([n,m])},[]);var G=function(){var n=(0,I.Z)((0,o.Z)().mark(function m(u,b){var L;return(0,o.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return L=b.slice(b.indexOf(".")),F.next=3,(0,R.Z)("/sms/business/bizOrderField/download",u,b).then(function(te){console.log("ress",te),ee(te),L==".png"||L==".jpg"||L==".jpeg"?$(!0):Y(!0)});case 3:case"end":return F.stop()}},m)}));return function(u,b){return n.apply(this,arguments)}}(),C="\u5B66\u5458";return(0,s.jsxs)(T.Z,{onClose:function(){N()},width:1200,visible:j,destroyOnClose:!0,children:[t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.Z,{title:C+"\u57FA\u672C\u4FE1\u606F",bordered:!0,size:"small",children:[(0,s.jsx)(r.Z.Item,{label:C=="\u4F01\u4E1A"?"\u4F01\u4E1A\u540D\u79F0":C+"\u59D3\u540D",children:t.name}),(0,s.jsx)(r.Z.Item,{label:"\u7C7B\u578B",children:d.Z.getName("studentType",t.type)}),t.parentName?(0,s.jsx)(r.Z.Item,{label:"\u6240\u5C5E\u4F01\u4E1A",children:t.parentName}):(0,s.jsx)(r.Z.Item,{label:"\u4F01\u4E1A\u8D1F\u8D23\u4EBA",children:t.chargePersonName}),(0,s.jsx)(r.Z.Item,{label:"\u6027\u522B",children:t.sex==null?"\u672A\u77E5":t.sex?"\u5973":"\u7537"}),(0,s.jsx)(r.Z.Item,{label:"\u8054\u7CFB\u7535\u8BDD",children:t.mobile}),(0,s.jsx)(r.Z.Item,{label:"\u8EAB\u4EFD\u8BC1",children:t.idCard}),(0,s.jsx)(r.Z.Item,{label:"\u5FAE\u4FE1",children:t.weChat}),(0,s.jsx)(r.Z.Item,{label:"\u662F\u5426\u6B63\u5F0F\u5B66\u5458",contentStyle:{color:t.isFormal?"rgb(0,172,132)":"red"},children:t.isFormal?"\u6B63\u5F0F"+C:"\u6F5C\u5728"+C}),(0,s.jsx)(r.Z.Item,{label:"\u5BA2\u6237\u6765\u6E90",children:d.Z.getName("dict_source",t.source)}),(0,s.jsx)(r.Z.Item,{label:"\u6D41\u8F6C\u6B21\u6570",children:t.receiveNum}),(0,s.jsx)(r.Z.Item,{label:"\u8D44\u6E90\u7C7B\u578B",children:d.Z.getName("circulationType",t.resourceType)}),(0,s.jsx)(r.Z.Item,{label:"\u7528\u6237\u72B6\u6001",contentStyle:{color:t.enable===!1?"red":"rgb(0,172,132)"},children:t.enable===!1?"\u7981\u7528":"\u4F7F\u7528\u4E2D"}),(0,s.jsx)(r.Z.Item,{label:"\u54A8\u8BE2\u65F6\u95F4",children:t.createTime}),(0,s.jsx)(r.Z.Item,{label:"\u8054\u7CFB\u5730\u5740",span:2,children:t.address}),(0,s.jsx)(r.Z.Item,{label:"\u5907\u6CE8",children:t.description})]}),(0,s.jsx)(h.Z,{}),(0,s.jsxs)(r.Z,{title:"\u62A5\u540D\u4FE1\u606F",bordered:!0,size:"small",children:[(0,s.jsx)(r.Z.Item,{label:"\u62A5\u8003\u73ED\u578B",children:d.Z.getName("dict_class_type",t.record.classType)}),(0,s.jsx)(r.Z.Item,{label:"\u73ED\u578B\u5E74\u9650",children:d.Z.getName("dict_class_year",t.record.classYear)}),(0,s.jsx)(r.Z.Item,{label:"\u8003\u8BD5\u7C7B\u578B",children:d.Z.getName("dict_exam_type",t.record.examType)}),(0,s.jsx)(r.Z.Item,{label:"\u62A5\u540D\u9879\u76EE",children:d.Z.getCascaderName("dict_reg_job",t.record.project)})]}),(0,s.jsx)(h.Z,{}),(0,s.jsxs)(r.Z,{title:"\u7F34\u8D39\u4FE1\u606F",bordered:!0,size:"small",children:[(0,s.jsx)(r.Z.Item,{label:"\u8BA2\u5355\u91D1\u989D",children:t.record.receivable}),(0,s.jsx)(r.Z.Item,{label:"\u7D2F\u8BA1\u5B9E\u6536",children:t.record.charge}),(0,s.jsx)(r.Z.Item,{label:"\u7D2F\u8BA1\u4F18\u60E0",children:t.record.averageDiscount}),(0,s.jsx)(r.Z.Item,{label:"\u6B20\u8D39",children:(0,s.jsx)("span",{style:{color:"red"},children:t.record.arrears})})]}),(0,s.jsx)(h.Z,{}),(0,s.jsx)(r.Z,{title:"\u62A5\u540D\u8D44\u6599\u4FE1\u606F",bordered:!0,size:"small",children:c&&c[0].map(function(n,m){var u;return(0,s.jsx)(r.Z.Item,{label:n.name,children:(n==null||(u=n.value)===null||u===void 0?void 0:u.indexOf("."))>0?(0,s.jsx)("a",{onClick:function(){G(n.orderFieldId,n.value)},children:n.value}):n.value},"signup-0-".concat(n.name,"-").concat(m))})}),(0,s.jsx)(h.Z,{}),(0,s.jsx)(r.Z,{title:"\u8003\u8BD5\u8D44\u6599\u4FE1\u606F",bordered:!0,size:"small",children:c&&c[1].length&&c[1].map(function(n,m){var u;return(0,s.jsx)(r.Z.Item,{label:n.name,children:(n==null||(u=n.value)===null||u===void 0?void 0:u.indexOf("."))>0?(0,s.jsx)("a",{onClick:function(){G(n.orderFieldId,n.value)},children:n.value}):n.value},"signup-1-".concat(n.name,"-").concat(m))})})]}),(0,s.jsxs)("div",{style:{textAlign:"right",margin:"30px"},children:[(0,s.jsx)(U.Z,{danger:!0,type:"primary",onClick:function(){g((0,M.Z)((0,M.Z)({},t.record),{},{confirm:!1})),x(!0)},children:"\u5BA1\u6838\u4E0D\u901A\u8FC7"}),(0,s.jsx)(U.Z,{type:"primary",style:{marginLeft:"30px"},onClick:function(){g((0,M.Z)((0,M.Z)({},t.record),{},{confirm:!0})),x(!0)},children:"\u5BA1\u6838\u901A\u8FC7"})]}),(0,s.jsx)("div",{style:{display:"none"},children:(0,s.jsx)(Q.Z,{width:200,style:{display:"none"},preview:{visible:le,src:q,onVisibleChange:function(m){$(m)}}})}),re&&(0,s.jsx)(p.Z,{previewImage:q,previewVisible:re,setPreviewVisible:function(){Y(!1)}})]})}},35562:function(de,V,e){"use strict";var H=e(39428),T=e(11849),J=e(3182),Q=sessionStorage.getItem("tokenName"),X=sessionStorage.getItem("tokenValue"),U={};U[Q]=X;var M=function(){var _e=(0,J.Z)((0,H.Z)().mark(function h(w,r,o){var I,E,a,d,R,p=arguments;return(0,H.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return I=p.length>3&&p[3]!==void 0?p[3]:"look",E=o.split(","),a=[],d={pdfUrl:[],imgUrl:[]},E.forEach(function(j){a.push(new Promise(function(N){fetch(w+"?id="+r+"&fileName="+j,{method:"GET",headers:(0,T.Z)((0,T.Z)({},U),{},{"Content-Type":"application/x-www-form-urlencoded"})}).then(function(t){t.blob().then(function(x){if(I=="look"){var g;j.indexOf("pdf")>=0?g=new Blob([x],{type:"application/pdf;charset=utf-8"}):g=new Blob([x]);var B=new FileReader;B.readAsDataURL(g),B.onload=function(k){N(B.result)}}else{var y=window.URL.createObjectURL(x),c=document.createElement("a");document.body.appendChild(c);var _="\u9644\u4EF6";c.href=y,c.download=_,c.target="_blank",c.click(),c.remove()}})})}))}),i.next=7,Promise.all(a);case 7:return R=i.sent,R.forEach(function(j){j.indexOf("application/pdf")>=0?d.pdfUrl.push(j):d.imgUrl.push(j)}),i.abrupt("return",d);case 10:case"end":return i.stop()}},h)}));return function(w,r,o){return _e.apply(this,arguments)}}();V.Z=M}}]);
