(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6013],{63430:function(i,h,e){"use strict";var d=e(67294),p=e(76565),n=e(29640),j=e(79360),_=e(24770),D=e(27681),o=function(t,l){var u={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&l.indexOf(r)<0&&(u[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)l.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(u[r[a]]=t[r[a]]);return u},O=(0,d.forwardRef)(function(t,l){var u=t.chartRef,r=t.style,a=r===void 0?{height:"inherit"}:r,m=t.className,P=t.loading,E=t.loadingTemplate,s=t.errorTemplate,f=o(t,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),v=(0,n.Z)(p.by,f),c=v.chart,M=v.container;return(0,d.useEffect)(function(){(0,j.J)(u,c.current)},[c.current]),(0,d.useImperativeHandle)(l,function(){return{getChart:function(){return c.current}}}),d.createElement(_.Z,{errorTemplate:s},P&&d.createElement(D.Z,{loadingTemplate:E,theme:t.theme}),d.createElement("div",{className:m,style:a,ref:M}))});h.Z=O},96013:function(i,h,e){"use strict";e.r(h);var d=e(66456),p=e(15885),n=e(39428),j=e(3182),_=e(2824),D=e(30202),o=e(67294),O=e(63863),t=e(21010),l=e(30381),u=e.n(l),r=e(91584),a=e(96266),m=e(47833),P=e(3133),E=e(85893);h.default=function(s){var f,v,c,M,U=s.startTime,L=s.endTime,q=s.id,k=(0,o.useState)(!1),K=(0,_.Z)(k,2),Ie=K[0],ee=K[1],W=(0,t.tT)("@@initialState"),te=W.initialState,Ce=W.setInitialState,ne=te.currentUser,re=(f=t.m8.location.query)!==null&&f!==void 0&&f.userId?(v=t.m8.location.query)===null||v===void 0?void 0:v.userId:ne.userid,ae=(c=t.m8.location.query)!==null&&c!==void 0&&c.moonTime?JSON.parse((M=t.m8.location.query)===null||M===void 0?void 0:M.moonTime):[u()().format("YYYY-MM-DD"),u()(new Date).add(1,"days").format("YYYY-MM-DD")],ue=(0,o.useState)([]),N=(0,_.Z)(ue,2),F=N[0],_e=N[1],oe=(0,o.useState)([]),$=(0,_.Z)(oe,2),Re=$[0],Ze=$[1],se=(0,o.useState)([]),Y=(0,_.Z)(se,2),be=Y[0],ie=Y[1],le=(0,o.useState)([]),w=(0,_.Z)(le,2),xe=w[0],Ae=w[1],ce=(0,o.useState)([]),z=(0,_.Z)(ce,2),de=z[0],me=z[1],fe=(0,o.useState)(re),G=(0,_.Z)(fe,2),S=G[0],Se=G[1],Ee=(0,o.useState)(ae),J=(0,_.Z)(Ee,2),ve=J[0],pe=J[1],Pe=(0,o.useState)(0),H=(0,_.Z)(Pe,2),Be=H[0],he=H[1],De=(0,o.useState)([]),V=(0,_.Z)(De,2),Oe=V[0],je=V[1],Me=(0,o.useRef)(),ye=(0,o.forwardRef)(m.Z),ge=(0,o.useRef)();(0,o.useEffect)(function(){var y;Q(U,L),(y=Me.current)===null||y===void 0||y.setFieldsValue({createTime:ve})},[S,U,L]),(0,o.useEffect)(function(){O.Z.get("/sms/share/getDepartmentAndUser").then(function(y){ee({content:y.data,type:"performance"})})},[]);var Q=function(){var y=(0,j.Z)((0,n.Z)().mark(function C(g,R,I){var x,Z,B,A,X;return(0,n.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,O.Z.get("/sms/business/bizOrder/newOrder",{parentId:"-1","createTime-start":g,"createTime-end":R,_isGetAll:!0,auditType:0,userId:q});case 2:return x=T.sent.data.content,Z=(0,a.Z)(x),T.next=6,O.Z.get("/sms/business/bizOrder/totals",{array:JSON.stringify(Z.arrProject.map(function(b){return{project:b,userId:S,parentId:"-1",enable:!0,"createTime-start":g,"createTime-end":R}})),totalFields:"quantity"});case 6:return B=T.sent.data,Z.arr2.forEach(function(b,Te){b.num=B[Te].quantity}),A=0,B.forEach(function(b){A=A+b.quantity}),T.next=12,(0,P.Z)(g,R,S);case 12:X=T.sent,me(de),je(X.result),he(A),_e(Z.arr2),ie(Z.arr3);case 18:case"end":return T.stop()}},C)}));return function(g,R,I){return y.apply(this,arguments)}}(),Ue=function(){var y=(0,j.Z)((0,n.Z)().mark(function C(g){return(0,n.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.abrupt("return",new Promise(function(x){Q(g.createTime[0],g.createTime[1]),pe(g.createTime),x(!0)}));case 1:case"end":return I.stop()}},C)}));return function(g){return y.apply(this,arguments)}}();return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(D.ZP,{className:"cardsd",children:(0,E.jsx)(D.ZP,{children:(0,E.jsxs)("div",{children:[(0,E.jsx)(r.Z,{data:F}),(0,E.jsx)(ye,{ref:ge,orderContent:Oe}),(0,E.jsx)("div",{children:(0,E.jsx)(p.Z,{dataSource:F,columns:[{title:"\u9879\u76EE",key:"project",dataIndex:"project"},{title:"\u4E1A\u7EE9\u91D1\u989D",key:"amount",dataIndex:"amount"},{title:"\u4EBA\u6570",key:"num",dataIndex:"num"},{title:"\u62DB\u751F\u8001\u5E08",key:"name",dataIndex:"name"}]},"table")},"tablxe")]})})})})}},91584:function(i,h,e){"use strict";var d=e(11849),p=e(63430),n=e(30202),j=e(21010),_=e(85893);h.Z=function(D){var o=D.data,O=D.todayContent,t=O===void 0?!1:O,l=D.moon,u={appendPadding:10,angleField:"amount",colorField:"project",radius:.8,legend:{layout:"horizontal",position:"bottom"},label:{type:"outer",content:function(m){return"".concat(m.project).concat(m.amount,"\u5143")}},interactions:[{type:"pie-legend-active"},{type:"element-active"}]},r={appendPadding:10,angleField:"num",colorField:"project",radius:.8,legend:{layout:"horizontal",position:"bottom"},label:{type:"outer",labelHeight:28,content:`{name}
{percentage}`},interactions:[{type:"element-selected"},{type:"element-active"}],meta:{num:{alias:"\u4EBA\u6570"},amount:{project:"\u9879\u76EE"}}};return(0,_.jsxs)(n.ZP,{split:"vertical",className:"cards",children:[(0,_.jsx)(n.ZP,{title:"\u4E1A\u7EE9\u91D1\u989D",style:{height:"400px"},children:(0,_.jsx)(p.Z,(0,d.Z)({data:o},u))}),(0,_.jsx)(n.ZP,{title:"\u62DB\u751F\u4EBA\u6570",style:{height:"400px"},children:(0,_.jsx)(p.Z,(0,d.Z)({data:o},r))}),t&&(0,_.jsx)(n.ZP,{title:"\u4E1A\u7EE9\u6392\u540D",colSpan:"20%",children:(0,_.jsx)("ul",{className:"contentUl",style:{overflow:"auto",height:"390px"},children:t.map(function(a,m){return(0,_.jsxs)("li",{onClick:function(){j.m8.push("/business/statistics/performance?userId="+a.userId+"&moonTime="+l)},children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{children:m+1}),a.name]}),(0,_.jsxs)("div",{children:[a.amount,"\u5143"]})]},"pie-chart-".concat(m))})})})]})}},47833:function(i,h,e){"use strict";var d=e(11849),p=e(39428),n=e(3182),j=e(67294),_=e(63430),D=e(30202),o=e(85893);h.Z=function(O,t){var l=O.orderContent,u={appendPadding:10,angleField:"value",colorField:"source",radius:.8,label:{type:"inner",offset:"-8%",content:"{name}",style:{fontSize:12}},interactions:[{type:"pie-legend-active"},{type:"element-active"}]},r={appendPadding:10,angleField:"value",colorField:"sourceValue",radius:.8,label:{type:"inner",offset:"-8%",content:"{name}",style:{fontSize:12}},interactions:[{type:"pie-legend-active"},{type:"element-active"}]};(0,j.useImperativeHandle)(t,function(){return{getPieData:a}});var a=function(){var m=(0,n.Z)((0,p.Z)().mark(function P(E,s,f){return(0,p.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:case"end":return c.stop()}},P)}));return function(E,s,f){return m.apply(this,arguments)}}();return(0,o.jsx)("div",{children:(0,o.jsxs)(D.ZP,{split:"vertical",className:"cards",children:[(0,o.jsx)(D.ZP,{title:"\u8BA2\u5355\u6765\u6E90\u5360\u6BD4",style:{height:"400px"},children:(0,o.jsx)(_.Z,(0,d.Z)({data:l},u))}),(0,o.jsx)(D.ZP,{title:"\u8BA2\u5355\u6765\u6E90\u7B14\u6570",style:{height:"400px"},children:(0,o.jsx)(_.Z,(0,d.Z)({data:l},r))})]})})}},3133:function(i,h,e){"use strict";var d=e(39428),p=e(3182),n=e(37490),j=e(63863),_=function(){var O=(0,p.Z)((0,d.Z)().mark(function t(l,u,r){var a,m,P,E;return(0,d.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return a={},m={"status-isNot":0,enable:!0,parentId:-1,_isGetAll:!0,"createTime-start":l,"createTime-end":u},r&&(m.userId=r),f.next=5,j.Z.get("/sms/business/bizOrder",m);case 5:return P=f.sent.data,E=D(P),a.result=E,a.department=o(P),f.abrupt("return",a);case 10:case"end":return f.stop()}},t)}));return function(l,u,r){return O.apply(this,arguments)}}(),D=function(t){var l=t.content.reduce(function(u,r){var a=n.Z.getName("dict_source",r.source),m=u.find(function(P){return P.type===a});return m?m.value+=1:u.push({type:a,value:1}),u},[]);return l.forEach(function(u){var r=(u.value/t.content.length*100).toFixed(2);console.log("baifenbi",r),u.sourceValue="".concat(u.type).concat(u.value,"\u7B14"),u.source="".concat(u.type," ").concat(r,"%")}),l},o=function(t){var l=0,u=JSON.parse(localStorage.getItem("Department")),r=[];u==null||u.forEach(function(s){s.departmentName=="\u6C47\u5FB7\u6559\u80B2"&&(r=s.children)});var a=[],m=["\u4E2D\u5EFA\u4E8B\u4E1A\u90E8","\u5171\u8D62\u672A\u6765\u4E8B\u4E1A\u90E8","\u624D\u5B50\u4E8B\u4E1A\u90E8","\u6C47\u624D\u4E8B\u4E1A\u90E8","\u4E2D\u53F0","\u540E\u53F0"];r.forEach(function(s){m.indexOf(s.departmentName)>=0&&a.push(s)});var P=function s(f,v,c){f.forEach(function(M){if(M.userId==v.userId){c.num?c.num=c.num+v.quantity:c.num=v.quantity;return}M.children&&s(M.children,v,M)})};t.content.forEach(function(s){l=l+s.quantity,P(a,s,a)});var E=function s(f){var v=0;return f&&f.forEach(function(c){c.num&&(v=v+c.num),c.children&&(v=v+s(c.children))}),v};return a.forEach(function(s){s.num=s.num?s.num:0,s.num=E(s.children)+s.num}),{department:a,num:l}};h.Z=_},96266:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _services_util_dictionaries__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(37490),contentData=function(content){var arr2=[],arr3={amount:0,num:0},arr4=[],arrProject=[];return content.forEach(function(i){arrProject.indexOf(i.project)=="-1"&&arrProject.push(i.project);var h=i.project?i.project.split(","):[""],e={project:_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_0__.Z.getCascaderName("dict_reg_job",h[0]),amount:i.amount,num:i.quantity?i.quantity:1,name:i.userName,userId:i.userId};if(arr2.length>0){var d=arr2.filter(function(n){return n.project==e.project}),p=arr4.filter(function(n){return n.name==e.name});p.length>0?arr4.forEach(function(n){n.name==p[0].name&&(n.amount=e.amount+p[0].amount)}):arr4.push({name:i.userName,amount:i.amount,userId:i.userId}),d.length>0?arr2.forEach(function(n){n.project==d[0].project&&(n.amount=d[0].amount+e.amount,n.quantity?n.num=n.num+n.quantity:n.num=n.num+1,arr3.amount=arr3.amount+e.amount,arr3.num=arr3.num+e.num)}):(arr2.push(e),arr3.amount=arr3.amount+e.amount,arr3.num=arr3.num+e.num)}else arr2.push(e),arr3.amount=arr3.amount+e.amount,arr3.num=arr3.num+e.num,arr4.push({name:i.userName,amount:i.amount,userId:i.userId})}),arr4.sort(function(i,h){return h.amount-i.amount}),arr3.num&&(arr3.num=eval(arr3.num.toString().split("").join("+"))),{arr2,arr3,arr4,arrProject}};__webpack_exports__.Z=contentData}}]);
