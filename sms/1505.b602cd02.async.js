(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[1505],{71505:function(pe,ae,n){"use strict";n.d(ae,{Z:function(){return ce}});var ve=n(12968),z=n(20352),ge=n(62350),G=n(24565),Fe=n(57663),S=n(71577),T=n(11849),Ze=n(34792),p=n(48086),l=n(39428),b=n(3182),x=n(2824),ne=n(22),E=n(63863),v=n(67294),ye=n(43185),K=n(43027),se=n(952),ue=n(37476),D=n(5966),W=n(31199),re=n(64317),Y=n(90672),H=n(80876),J=n(37490),e=n(85893),ie=function(F){var V=F.setModalVisible,Z=F.modalVisible,N=F.callbackRef,s=F.renderData;console.log("renderData",s);var B=(0,v.useState)(!1),c=(0,x.Z)(B,2),P=c[0],A=c[1],U=(0,v.useState)(),w=(0,x.Z)(U,2),$=w[0],R=w[1],C=(0,v.useRef)();(s==null?void 0:s.type)=="eidt"&&(s==null?void 0:s.renderDataNumber)===0&&(setTimeout(function(){var r,a;C==null||(r=C.current)===null||r===void 0||r.setFieldsValue({name:s.name,code:s.code,description:s.description,account:s.account,mobile:s.mobile,accountName:s.accountName,bank:s.bank,chargeMethod:(a=s.chargeMethod)===null||a===void 0?void 0:a.split(","),codeFile:[{uid:"1",name:s.codeFile,response:{data:s.codeFile}}],sealFile:[{uid:"1",name:s.sealFile,response:{data:s.sealFile}}],cusid:s.cusid,appid:s.appid,privateKey:s.privateKey})},100),++s.renderDataNumber);var k=sessionStorage.getItem("tokenName"),L=sessionStorage.getItem("tokenValue"),I={};I[k]=L;var O=function(a){return new Promise(function(t){E.Z.post("/sms/contract/conCompany",a).then(function(f){console.log("res",f),f.status=="success"&&(p.default.success("\u64CD\u4F5C\u6210\u529F!"),V(),N(),t(!0))}).catch(function(f){t(!0)})})};return(0,e.jsxs)(ue.Y,{width:905,formRef:C,onFinish:function(){var r=(0,b.Z)((0,l.Z)().mark(function a(t){return(0,l.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return(s==null?void 0:s.type)=="eidt"&&(t.id=s.id),t.codeFile&&(t.codeFile=t.codeFile[t.codeFile.length-1].response.data),t.sealFile&&(t.sealFile=t.sealFile[t.sealFile.length-1].response.data),t.chargeMethod=t.chargeMethod.join(","),g.next=6,O(t);case 6:case"end":return g.stop()}},a)}));return function(a){return r.apply(this,arguments)}}(),modalProps:{destroyOnClose:!0,onCancel:function(){V()},maskClosable:!1},visible:Z,children:[(0,e.jsx)(D.Z,{label:"\u516C\u53F8\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u516C\u53F8\u540D\u79F0"}]}),(0,e.jsx)(D.Z,{label:"\u7EDF\u4E00\u793E\u4F1A\u4FE1\u7528\u4EE3\u7801",name:"code",rules:[{required:!0,pattern:new RegExp(J.Z.getRegex("code")),message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u793E\u4F1A\u4FE1\u7528\u4EE3\u7801"}]}),(0,e.jsx)(W.Z,{name:"mobile",label:"\u6CD5\u4EBA\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u6CD5\u4EBA\u624B\u673A\u53F7"}]}),(0,e.jsx)(re.Z,{label:"\u6536\u8D39\u65B9\u5F0F",name:"chargeMethod",width:"sm",mode:"multiple",request:(0,b.Z)((0,l.Z)().mark(function r(){return(0,l.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",J.Z.getList("dict_stu_refund_type"));case 1:case"end":return t.stop()}},r)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4ED8\u6B3E\u65B9\u5F0F"}]}),(0,e.jsx)(D.Z,{label:"\u5F00\u6237\u540D",name:"accountName",rules:[{required:!0}]}),(0,e.jsx)(D.Z,{label:"\u5F00\u6237\u884C",name:"bank",rules:[{required:!0}]}),(0,e.jsx)(D.Z,{label:"\u94F6\u884C\u8D26\u53F7",name:"account",rules:[{required:!0}]}),(0,e.jsx)(D.Z,{label:"\u94F6\u884C\u884C\u53F7",name:"bankNum"}),(0,e.jsx)(W.Z,{name:"mobile2",label:"\u7A0E\u7968\u624B\u673A\u53F7"}),(0,e.jsx)(Y.Z,{label:"\u7A0E\u7968\u5730\u5740",name:"address"}),(0,e.jsx)(Y.Z,{label:"\u6CE8\u91CA",name:"description"}),(0,e.jsxs)(se.ZP.Group,{children:[(0,e.jsx)(H.Z,{width:400,label:"\u7EDF\u4E00\u793E\u4F1A\u4FE1\u7528\u7801\u7535\u5B50\u7248",name:"codeFile",required:!0,action:"/sms/contract/conCompany/upload",fieldProps:{multiple:!1,headers:(0,T.Z)({},I),listType:"picture",defaultFileList:[],beforeUpload:function(a){if(console.log("file",a),a.type!="image/png"&&a.type!="image/jpeg")return p.default.error("\u53EA\u80FD\u4E0A\u4F20png\u3001jpg\u683C\u5F0F"),K.Z.LIST_IGNORE},onPreview:function(){var r=(0,b.Z)((0,l.Z)().mark(function t(f){return(0,l.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:R(f.thumbUrl),A(!0);case 2:case"end":return y.stop()}},t)}));function a(t){return r.apply(this,arguments)}return a}(),onChange:function(a){var t=a.file.status;t==="done"?p.default.success("".concat(a.file.name," \u4E0A\u4F20\u6210\u529F.")):t==="error"&&p.default.error("".concat(a.file.name," \u4E0A\u4F20\u5931\u8D25."))}}}),(0,e.jsx)(H.Z,{width:400,label:"\u8D22\u52A1\u5370\u7AE0",name:"sealFile",action:"/sms/contract/conCompany/upload",required:!0,fieldProps:{multiple:!1,headers:(0,T.Z)({},I),listType:"picture",defaultFileList:[],beforeUpload:function(a){if(console.log("file",a),a.type!="image/png"&&a.type!="image/jpeg")return p.default.error("\u53EA\u80FD\u4E0A\u4F20png\u3001jpg\u683C\u5F0F"),K.Z.LIST_IGNORE},onPreview:function(){var r=(0,b.Z)((0,l.Z)().mark(function t(f){return(0,l.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:R(f.thumbUrl),A(!0);case 2:case"end":return y.stop()}},t)}));function a(t){return r.apply(this,arguments)}return a}(),onChange:function(a){var t=a.file.status;t==="done"?p.default.success("".concat(a.file.name," \u4E0A\u4F20\u6210\u529F.")):t==="error"&&p.default.error("".concat(a.file.name," \u4E0A\u4F20\u5931\u8D25."))}}}),(0,e.jsx)("div",{style:{display:"none"},children:(0,e.jsx)(z.Z,{width:200,style:{display:"none"},preview:{visible:P,src:$,onVisibleChange:function(a){A(a)}}})})]})]})},le=n(51042),Q=n(35562),oe=n(41574),ce=function(F){var V=F.type,Z=V===void 0?"":V,N=F.setCompanyId,s=F.onCancel,B=F.admin,c=B===void 0?!0:B,P=(0,v.useState)(null),A=(0,x.Z)(P,2),U=A[0],w=A[1],$=(0,v.useState)(!1),R=(0,x.Z)($,2),C=R[0],k=R[1],L=(0,v.useState)(!1),I=(0,x.Z)(L,2),O=I[0],r=I[1],a=(0,v.useState)(!1),t=(0,x.Z)(a,2),f=t[0],g=t[1],y=(0,v.useState)(!1),X=(0,x.Z)(y,2),de=X[0],q=X[1],fe=(0,v.useState)(),_=(0,x.Z)(fe,2),me=_[0],ee=_[1],te=(0,v.useRef)(),M=function(){te.current.reload()},he=[{title:"\u516C\u53F8\u540D\u79F0",dataIndex:"name"},{title:"\u4FE1\u7528\u4EE3\u7801",dataIndex:"code",hideInTable:Z==="contract"||!c},{title:"\u5F00\u6237\u540D",dataIndex:"accountName",search:!1},{title:"\u5F00\u6237\u884C",dataIndex:"bank",search:!1},{title:"\u94F6\u884C\u8D26\u53F7",dataIndex:"account",search:!1},{title:"\u94F6\u884C\u884C\u53F7",dataIndex:"bankNum",search:!1},{title:"\u5907\u6CE8",dataIndex:"description",search:!1,hideInTable:!c},{title:"\u6388\u6743",dataIndex:"autoSignUrl",search:!1,hideInTable:!c,width:80,render:function(j,u){return(0,e.jsx)(e.Fragment,{children:u.autoSignUrl?(0,e.jsx)("span",{children:"\u5DF2\u6388\u6743"}):(0,e.jsx)("span",{style:{color:"red",textDecoration:"underline",cursor:"pointer"},onClick:(0,b.Z)((0,l.Z)().mark(function m(){var h;return(0,l.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,E.Z.post("/sms/contract/conCompany/getAuthOfAutoSign",{id:u.id});case 2:h=i.sent.data,q(h),g(!0);case 5:case"end":return i.stop()}},m)})),children:"\u672A\u6388\u6743"})})}},{title:"\u8BA4\u8BC1",dataIndex:"isVerify",search:!1,hideInTable:!c,width:80,render:function(j,u){return(0,e.jsx)(e.Fragment,{children:u.isVerify?(0,e.jsx)("span",{children:"\u5DF2\u8BA4\u8BC1"}):(0,e.jsx)("span",{style:{color:"red",textDecoration:"underline",cursor:"pointer"},onClick:(0,b.Z)((0,l.Z)().mark(function m(){var h;return(0,l.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,E.Z.post("/sms/contract/conCompany/verify",{id:u.id});case 2:h=i.sent.data,q(h),g(!0);case 5:case"end":return i.stop()}},m)})),children:"\u672A\u8BA4\u8BC1"})})}},{title:"\u7EDF\u4E00\u793E\u4F1A\u4FE1\u7528\u7801\u7535\u5B50\u7248",dataIndex:"codeFile",search:!1,hideInTable:Z==="contract"||!c,render:function(j,u){return(0,e.jsx)("a",{style:{display:u.codeFile?"block":"none"},onClick:(0,b.Z)((0,l.Z)().mark(function m(){return(0,l.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,Q.Z)("/sms/contract/conCompany/download",u.id,u.codeFile).then(function(i){console.log("res",i),ee(i.imgUrl[0]),r(!0)});case 2:case"end":return o.stop()}},m)})),children:"\u67E5\u770B"})}},{title:"\u8D22\u52A1\u5370\u7AE0",dataIndex:"sealFile",search:!1,hideInTable:Z==="contract"||!c,render:function(j,u){return(0,e.jsx)("a",{style:{display:u.sealFile?"block":"none"},onClick:(0,b.Z)((0,l.Z)().mark(function m(){return(0,l.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!u.sealFile){o.next=5;break}return o.next=3,(0,Q.Z)("/sms/contract/conCompany/download",u.id,u.sealFile).then(function(i){console.log("res",i),ee(i.imgUrl[0]),r(!0)});case 3:o.next=6;break;case 5:p.default.error("\u5C1A\u672A\u4E0A\u4F20\u8D22\u52A1\u5370\u7AE0\uFF01",5);case 6:case"end":return o.stop()}},m)})),children:"\u67E5\u770B"})}},{title:"\u7A0E\u7968\u62AC\u5934\u4FE1\u606F",search:!1,key:"taitou",hideInTable:c,copyable:!0,render:function(j,u){return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{children:["\u540D\u79F0\uFF1A",u.name]}),(0,e.jsxs)("div",{children:["\u7EB3\u7A0E\u4EBA\u8BC6\u522B\u53F7\uFF1A",u.code]}),(0,e.jsxs)("div",{children:["\u5730\u5740\u3001\u7535\u8BDD\uFF1A",u.address," ",u.mobile2]}),(0,e.jsxs)("div",{children:["\u5F00\u6237\u884C\u53CA\u8D26\u53F7\uFF1A",u.bank," ",u.account]})]})}},{title:"\u64CD\u4F5C",dataIndex:"options",search:!1,hideInTable:!c,render:function(j,u){return[(0,e.jsx)(S.Z,{type:"primary",size:"small",hidden:Z==="contract",style:{marginRight:"15px"},onClick:function(){w((0,T.Z)((0,T.Z)({},u),{},{type:"eidt",renderDataNumber:0})),k(!0)},children:"\u7F16\u8F91"},"eidt"),(0,e.jsx)(G.Z,{title:"\u662F\u5426\u91CD\u6784\u6CD5\u5927\u5927\u8D26\u53F7",okText:"\u91CD\u6784",cancelText:"\u53D6\u6D88",onConfirm:function(){E.Z.post("/sms/contract/conCompany/buildAccount",{id:u.id}).then(function(h){h.status=="success"&&(p.default.success("\u64CD\u4F5C\u6210\u529F!"),M())})},children:(0,e.jsx)(S.Z,{style:{marginRight:"15px"},hidden:Z==="contract",type:"primary",size:"small",danger:!0,children:"\u91CD\u6784"},"delete")},"buildAccount"),(0,e.jsx)(G.Z,{title:"\u662F\u5426\u5220\u9664",okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",onConfirm:function(){E.Z.delete("/sms/contract/conCompany",{id:u.id}).then(function(h){h.status=="success"&&(p.default.success("\u64CD\u4F5C\u6210\u529F!"),M())})},children:(0,e.jsx)(S.Z,{hidden:Z==="contract",type:"primary",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"deletes"),(0,e.jsx)(S.Z,{hidden:Z==="",type:"primary",onClick:function(){N(u),s()},children:"\u9009\u62E9"},"xuanze")]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ne.Z,{actionRef:te,columns:he,className:"Contract",request:{url:"/sms/contract/conCompany"},search:{defaultCollapsed:!0,labelWidth:150,defaultColsNumber:10},toolBarRender:[(0,e.jsx)(S.Z,{icon:(0,e.jsx)(le.Z,{}),type:"primary",hidden:!c,onClick:function(){w({type:"add",renderDataNumber:0}),k(!0)},children:"\u65B0\u5EFA"},"button")]}),C&&(0,e.jsx)(ie,{setModalVisible:function(){return k(!1)},modalVisible:C,renderData:U,callbackRef:function(){return M()}}),f&&(0,e.jsx)(oe.Z,{setPreviewVisible:function(){return g(!1)},previewVisible:f,previewImage:de,callbackRef:function(){return M()}}),(0,e.jsx)("div",{style:{display:"none"},children:(0,e.jsx)(z.Z,{width:200,style:{display:"none"},preview:{visible:O,src:me,onVisibleChange:function(j){r(j)}}})})]})}}}]);
