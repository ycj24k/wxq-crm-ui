(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4737],{42709:function(De,$,a){"use strict";var z=a(39428),G=a(3182),Y=a(2824),Z=a(22),M=a(37476),h=a(37490),L=a(67294),i=a(30202),r=a(85893);$.Z=function(c){var y=c.modalVisible,X=c.setModalVisible,J=c.submitok,j=c.type,_=c.dataSource,n=c.renderData,H=(0,L.useState)([]),U=(0,Y.Z)(H,2),B=U[0],E=U[1],x=(0,L.useState)([]),R=(0,Y.Z)(x,2),A=R[0],te=R[1];(0,L.useEffect)(function(){console.log("dataSource",_)},[]);var D=[{title:"\u4FE1\u606F\u6240\u6709\u4EBA",dataIndex:"ownerName",key:"ownerName"},{title:"\u62DB\u751F\u8001\u5E08",dataIndex:"userName",key:"userName"},{title:"\u624B\u673A\u53F7",dataIndex:"mobile",key:"mobile"},{title:"\u4E0B\u5355\u9879\u76EE",dataIndex:"project",key:"project",render:function(O,S){return(0,r.jsx)("span",{children:h.Z.getCascaderName("dict_reg_job",S.project)})}},{title:"\u4E0B\u5355\u65F6\u95F4",dataIndex:"createTime",key:"createTime"}],W=[{title:"\u4FE1\u606F\u6240\u6709\u4EBA",dataIndex:"ownerName",key:"ownerName"},{title:"\u56DE\u8BBF\u8001\u5E08",dataIndex:"userName",key:"userName"},{title:"\u624B\u673A\u53F7",dataIndex:"mobile",key:"mobile"},{title:"\u56DE\u8BBF\u9879\u76EE",dataIndex:"project",key:"project",render:function(O,S){return(0,r.jsx)("span",{children:h.Z.getCascaderName("dict_reg_job",S.project)})}},{title:"\u56DE\u8BBF\u65F6\u95F4",dataIndex:"createTime",key:"createTime"}];return(0,r.jsxs)(M.Y,{title:"\u8BA2\u5355\u3001\u56DE\u8BBF\u5217\u8868",width:1200,modalProps:{destroyOnClose:!0,maskClosable:!1,onCancel:function(){X()},okText:"\u7EE7\u7EED\u65B0\u589E",cancelText:"\u8FD4\u56DE"},visible:y,onFinish:function(){var P=(0,G.Z)((0,z.Z)().mark(function O(S){return(0,z.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:J(n,!1);case 1:case"end":return v.stop()}},O)}));return function(O){return P.apply(this,arguments)}}(),children:[j=="student"?(0,r.jsxs)("div",{children:["\u624B\u673A\u53F7:",n.mobile,"\u5B66\u5458\u5728\u7CFB\u7EDF\u91CC\u5DF2\u6709\u4E0B\u5355\u6216\u56DE\u8BBF\u8BB0\u5F55\u3002",(0,r.jsx)("br",{}),"\u5982\u679C\u6240\u5C5E\u8001\u5E08\u662F\u4F60\uFF0C\u8BF7\u524D\u5F80\u6240\u5C5E\u6F5C\u5728\u5B66\u5458\u6216\u6B63\u5F0F\u5B66\u5458\u67E5\u770B",(0,r.jsx)("br",{}),"\u5982\u679C\u6240\u5C5E\u8001\u5E08\u4E0D\u662F\u4F60\uFF0C\u8BF7\u70B9\u51FB\u53F3\u4E0B\u89D2\u8FD4\u56DE\uFF0C\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u5C06\u4FE1\u606F\u6240\u6709\u4EBA\u586B\u5199\u6B63\u786E\u540E\uFF0C\u518D\u70B9\u53F3\u4E0B\u89D2\u7EE7\u7EED\u65B0\u589E",(0,r.jsx)("br",{}),"\u4FE1\u606F\u6240\u6709\u4EBA\u586B\u5199\u89C4\u5219\uFF1A",(0,r.jsx)("br",{}),"\u82E5\u7CFB\u7EDF\u4E2D\u5DF2\u5B58\u5728\u8BE5\u5B66\u5458\uFF0C\u5E76\u4E14\u6709\u4FE1\u606F\u6240\u6709\u4EBA\uFF0C\u5219\u586B\u5199\u6B64\u4EBA\uFF0C\u5426\u5219\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u586B\u5199\u4FE1\u606F\u6240\u6709\u4EBA"]}):"",(0,r.jsx)(i.ZP,{title:"\u4E0B\u5217\u5B66\u5458\u5DF2\u6709\u8BA2\u5355",hidden:!_.order||_.order.length==0,children:(0,r.jsx)(Z.Z,{search:!1,columns:D,dataSource:_.order?_.order:[]})}),(0,r.jsx)(i.ZP,{title:"\u4E0B\u5217\u5B66\u5458\u5DF2\u5728\u8DDF\u8E2A\u56DE\u8BBF",hidden:!_.visit||_.visit.length==0,children:(0,r.jsx)(Z.Z,{search:!1,columns:W,dataSource:_.visit?_.visit:[]})})]})}},15258:function(De,$,a){"use strict";var z=a(20228),G=a(11382),Y=a(49111),Z=a(19650),M=a(39428),h=a(11849),L=a(34792),i=a(48086),r=a(3182),c=a(2824),y=a(67294),X=a(37476),J=a(80876),j=a(25607),_=a(63863),n=a(37490),H=a(21010),U=a(42709),B=a(85893);$.Z=function(E){var x,R=E.modalVisible,A=E.setModalVisible,te=E.url,D=E.type,W=E.upType,P=E.callbackRef,O=E.propsData,S=E.uploadtype,Q=E.callbackFn,v=Q===void 0?void 0:Q,re=E.departmentType,be=re===void 0?!1:re,me=(0,H.tT)("@@initialState"),q=me.initialState,Ce=q==null||(x=q.currentUser)===null||x===void 0?void 0:x.userid,ve=(0,y.useState)(!1),ne=(0,c.Z)(ve,2),pe=ne[0],le=ne[1],he=(0,y.useState)([{}]),se=(0,c.Z)(he,2),Ae=se[0],ge=se[1],Me=(0,y.useState)(!1),ie=(0,c.Z)(Me,2),_e=ie[0],de=ie[1],ye=(0,y.useState)({}),oe=(0,c.Z)(ye,2),Pe=oe[0],Oe=oe[1],Te=function(l){var f=l.getFullYear(),C=String(l.getMonth()+1).padStart(2,"0"),d=String(l.getDate()).padStart(2,"0");return"".concat(f,"-").concat(C,"-").concat(d," 00:00:00")},xe=function(){var m=(0,r.Z)((0,M.Z)().mark(function l(f){var C,d,o,T,s,b,ee,g,ue,K,Ee,ae=arguments;return(0,M.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(C=ae.length>1&&ae[1]!==void 0?ae[1]:!0,d=f[0],o=[],T=[],s=!1,b=["consultationTime","birthday","entryTime","formalTime","turnoverTime","examStartTime","examEndTime"],ee=function(V){le(!1),V.status=="success"&&(i.default.success("\u5BFC\u5165\u6210\u529F"),v&&v(V.data),A())},f.forEach(function(p,V){if(V>2&&p.length>0){var t={},I={};p.forEach(function(u,fe){var Be=[];if(fe<d.length){var e=d[fe];if((u+"3").replace(/(^\s*)|(\s*$)/g,"")!="3")if(e=="type")t[e]=n.Z.getValue("studentType",u);else if(e=="projects")Be=n.Z.getChildren("dict_reg_job",u);else if(e=="project"){if(Be.forEach(function(Fe){Fe.label==u&&(t[e]=Fe.value)}),t[e]=n.Z.getCascaderValues("dict_reg_job",u),t[e]===!1){i.default.error("\u7CFB\u7EDF\u91CC\u6CA1\u6709\u9879\u76EE".concat(u,"\u8BF7\u66F4\u6539\u540E\u5BFC\u5165"),5),s=!0;return}}else if(e=="source")t[e]=n.Z.getValue("dict_source",u);else if(e=="isPeer")u=="\u662F"?t[e]=1:t[e]=0;else if(e=="isInWhitelist")u=="\u662F"?t[e]=!0:t[e]=!1;else if(e=="isLive")u=="\u662F"?t[e]=!0:t[e]=!1;else if(e=="sex")u=="\u7537"?t[e]=!1:t[e]=!0;else if(e=="education")t[e]=n.Z.getValue("dict_education",u);else if(e=="provider"&&!u)console.log("provider",u),t[e]=u;else if(e=="providerName"){u=u.replace(/\s*/g,"");var N=n.Z.getUserId(u);if(console.log("obj",t),N.length==1)t.provider=N[0];else if(N.length==0){i.default.error("\u7CFB\u7EDF\u91CC\u6CA1\u6709\u8001\u5E08".concat(u)),s=!0;return}else if(N.length>1){i.default.error("\u7CFB\u7EDF\u91CC\u62DB\u751F\u8001\u5E08".concat(u,"\u91CD\u590D\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u4EBA\u5458")),s=!0;return}}else if(e=="ownerName"){u=u.replace(/\s*/g,"");var k=u=="\u65E0"?[-1]:n.Z.getUserId(u);if(console.log("obj",t),k.length==1)t.owner=k[0];else if(k.length==0){i.default.error("\u7CFB\u7EDF\u91CC\u6CA1\u6709\u8001\u5E08".concat(u)),s=!0;return}else if(k.length>1){i.default.error("\u7CFB\u7EDF\u91CC\u62DB\u751F\u8001\u5E08".concat(u,"\u91CD\u590D\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u4EBA\u5458")),s=!0;return}}else if(e=="resourceType")t[e]=n.Z.getValue("circulationType",u);else if(e=="content")I[e]=u;else if(e=="companyId"&&D=="studentOrder")t[e]=u;else if(e=="types"&&D=="student")I.type=n.Z.getValue("dict_c_type",u);else if(e=="intention")I[e]=n.Z.getValue("dict_intention_level",u);else if(e=="createBy"&&W=="post2"){var w=n.Z.getUserId(u);if(w.length==1)t[e]=w[0];else if(w.length==0){i.default.error("\u7CFB\u7EDF\u91CC\u6CA1\u6709\u8001\u5E08".concat(u)),s=!0;return}else if(w.length>1){i.default.error("\u7CFB\u7EDF\u91CC\u62DB\u751F\u8001\u5E08".concat(u,"\u91CD\u590D\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u4EBA\u5458")),s=!0;return}}else b.includes(e)&&(u=Te(new Date(u))),t[e]=u}}),o.push((0,h.Z)((0,h.Z)({},t),O)),JSON.stringify(I)!=="{}"&&T.push((0,h.Z)({},I))}}),g={},!s){F.next=11;break}return F.abrupt("return");case 11:if(D=="studentOrder"?g=o:T.length>0?g={array:o,array2:T}:g={array:o},ue=[],o.forEach(function(p){p.mobile&&ue.push(p.mobile),p.provider||(p.provider=Ce)}),D=="classlist"){F.next=24;break}return F.next=17,_.Z.get("/sms/business/bizStudent/findOrderByMobile",{mobileList:ue.join(","),_isGetAll:!0});case 17:if(K=F.sent.data,!((K.order.length!==0||K.visit.length!==0)&&C)){F.next=24;break}return Ee=o,Oe(Ee),ge(K),de(!0),F.abrupt("return");case 24:ce(W=="post2"?o:g);case 25:case"end":return F.stop()}},l)}));return function(f){return m.apply(this,arguments)}}(),ce=function(l){_.Z.postAll(te,l).then(function(f){le(!1),f.status=="success"&&(i.default.success("\u5BFC\u5165\u6210\u529F"),v&&v(f.data),A())})},Se={accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",name:"file",headers:{authorization:"authorization-text"},showUploadList:!1,fieldProps:{beforeUpload:function(l,f){var C=!0,d=f[0],o=new FileReader;return o.onload=function(T){var s=T.target.result;C||(s=new Uint8Array(s));var b=j.ij(s,{type:C?"binary":"array",cellDates:!0}),ee=b.Sheets[b.SheetNames[0]],g=j.P6.sheet_to_json(ee,{header:1});xe(g)},C?o.readAsBinaryString(d):o.readAsArrayBuffer(d),!1}}};return(0,B.jsx)(X.Y,{title:"\u6279\u91CF\u5BFC\u5165",autoFocusFirstInput:!0,modalProps:{onCancel:function(){A()}},onFinish:function(){var m=(0,r.Z)((0,M.Z)().mark(function l(f){return(0,M.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:A(),P();case 2:case"end":return d.stop()}},l)}));return function(l){return m.apply(this,arguments)}}(),visible:R,children:(0,B.jsxs)(G.Z,{spinning:pe,children:[(0,B.jsxs)(Z.Z,{children:[(0,B.jsx)("a",{hidden:D=="classlist",download:"\u65B0\u5B66\u5458\u5BFC\u5165\u6A21\u677F",href:"./template/\u65B0\u5B66\u5458\u5BFC\u5165\u6A21\u677F.xlsx",children:"\u4E0B\u8F7D\u5BFC\u5165\u5B66\u5458\u6A21\u677F"},"download-student-template"),(0,B.jsx)("a",{hidden:D!="classlist",download:"\u65B0\u5EFA\u73ED\u7EA7\u6A21\u677F",href:"./template/\u73ED\u7EA7\u6A21\u677F.xlsx",children:"\u4E0B\u8F7D\u65B0\u5EFA\u73ED\u7EA7\u6A21\u677F"},"download-class-template"),(0,B.jsx)("a",{hidden:D!="classlist",download:"\u6279\u91CF\u52A0\u5165\u73ED\u7EA7\u6A21\u677F",href:"./template/\u6279\u91CF\u4FEE\u6539\u73ED\u7EA7.xlsx",children:"\u4E0B\u8F7D\u6279\u91CF\u52A0\u5165\u73ED\u7EA7\u6A21\u677F"},"download-batch-class-template")]}),(0,B.jsx)("div",{style:{marginBottom:"5px"}}),(0,B.jsx)(J.Z,(0,h.Z)({},Se)),_e&&(0,B.jsx)(U.Z,{modalVisible:_e,setModalVisible:function(){return de(!1)},dataSource:Ae,renderData:Pe,type:"studentList",submitok:function(l){return ce(l)}})]})})}},17007:function(){}}]);
