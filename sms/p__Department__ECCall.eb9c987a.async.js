(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[8074],{78844:function(ve,Z,t){"use strict";var D=t(28991),u=t(81253),O=t(85893),E=t(51617),A=t(67294),f=t(66758),b=t(53048),U=["fieldProps","proFieldProps"],e="dateTimeRange",W=A.forwardRef(function(L,F){var d=L.fieldProps,B=L.proFieldProps,I=(0,u.Z)(L,U),$=(0,A.useContext)(f.Z);return(0,O.jsx)(b.Z,(0,D.Z)({ref:F,fieldProps:(0,D.Z)({getPopupContainer:$.getPopupContainer},d),valueType:e,proFieldProps:B,filedConfig:{valueType:e,lightFilterLabelFormatter:function(w){return(0,E.Z)(w,"YYYY-MM-DD HH:mm:ss")}}},I))});Z.Z=W},22:function(ve,Z,t){"use strict";var D=t(39428),u=t(11849),O=t(3182),E=t(2824),A=t(66801),f=t(63863),b=t(67294),U=t(85893);Z.Z=function(e){var W=e.columns,L=e.actionRef,F=e.formRef,d=e.cardBordered,B=d===void 0?!0:d,I=e.scroll,$=I===void 0?!1:I,R=e.request,w=e.beforeSearchSubmit,T=e.toolbar,re=T===void 0?void 0:T,N=e.pagesizes,ne=N===void 0?10:N,V=e.rowKey,se=V===void 0?"id":V,z=e.toolBarRender,Y=z===void 0?[]:z,H=e.dateFormatter,_e=H===void 0?"string":H,J=e.rowSelection,v=J===void 0?!1:J,Q=e.expandable,oe=Q===void 0?void 0:Q,X=e.tableAlertOptionRender,ie=X===void 0?void 0:X,le=e.onRow,q=e.params,ue=q===void 0?"":q,k=e.dataSource,de=k===void 0?void 0:k,ee=e.tableStyle,i=ee===void 0?void 0:ee,a=e.footer,r=a===void 0?void 0:a,s=e.onReset,_=s===void 0?void 0:s,c=e.onSubmit,C=c===void 0?void 0:c,m=e.onFn,h=m===void 0?void 0:m,g=e.getTotalElements,M=g===void 0?void 0:g,j=e.getData,y=j===void 0?void 0:j,o=e.loding,te=o===void 0?void 0:o,p=e.search,Re=p===void 0?void 0:p,Ee=e.searchData,Me=Ee===void 0?{}:Ee,Se=e.headerTitle,he=e.editable,Le=he===void 0?void 0:he,ge=e.className,pe=ge===void 0?"tables":ge,Pe=e.rowClassName,Te=Pe===void 0?void 0:Pe,De=!1;R&&(De=R.sortList);var S={_orderBy:"",_direction:""},Ce=(0,b.useState)(ne),Oe=(0,E.Z)(Ce,2),je=Oe[0],ye=Oe[1],Ze=(0,b.useState)({}),be=(0,E.Z)(Ze,2),Ie=be[0],Ae=be[1];return(0,U.jsx)(A.ZP,{columns:W,className:pe,actionRef:L,formRef:F,cardBordered:B,scroll:$,headerTitle:Se,tableStyle:i,dataSource:de,rowClassName:Te,request:function(){var ce=(0,O.Z)((0,D.Z)().mark(function me(P,ae,Be){var G,l,K;return(0,D.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return Object.keys(P).forEach(function(n){(P[n]=="null"||P[n]==null)&&(P["".concat(n,"-isNull")]=!0,delete P[n])}),Object.keys(ae).length>0?Object.keys(ae).forEach(function(n){var fe;S._orderBy=n,((fe=ae[n])===null||fe===void 0?void 0:fe.indexOf("desc"))==0?S._direction="desc":S._direction="asc"}):De?Object.keys(R.sortList).forEach(function(n){S._orderBy=n,S._direction=R.sortList[n]}):S={_orderBy:"",_direction:""},G=P,Object.keys(G).forEach(function(n){G[n]===""&&delete G[n]}),l=(0,u.Z)((0,u.Z)((0,u.Z)((0,u.Z)({},Be),R.params),G),Me),Object.keys(l).forEach(function(n){(l[n]==""||l[n]==[""]||l[n]=="-isNull")&&l[n]!==0&&l[n]!==!1&&(l["".concat(n)+"-isNull"]=!0,delete l[n]),l[n]===null&&delete l[n],l[n]=="All"&&delete l[n]}),S._orderBy!==""&&Object.assign(l,S),Ae(l),x.next=10,f.Z.get(R.url,(0,u.Z)({},l));case 10:return K=x.sent,h&&h(K.data.content),y&&y(l),te&&te(!1),M&&M(K.data.totalElements),x.abrupt("return",{data:K.data.content,success:K.success,total:K.data.totalElements});case 16:case"end":return x.stop()}},me)}));return function(me,P,ae){return ce.apply(this,arguments)}}(),rowKey:se,pagination:{pageSize:je,showSizeChanger:!0,onChange:function(me,P){ye(P)}},toolBarRender:function(){return Y},rowSelection:v,params:ue,expandable:oe,dateFormatter:_e,tableAlertOptionRender:ie,toolbar:re,onRow:le,beforeSearchSubmit:w,onReset:_,onSubmit:C,search:Re,editable:Le,footer:r,columnsState:{persistenceKey:pe,persistenceType:"localStorage"}})}},55404:function(ve,Z,t){"use strict";t.r(Z);var D=t(11849),u=t(39428),O=t(3182),E=t(2824),A=t(71906),f=t(67294),b=t(63863),U=t(37490),e=t(30202),W=t(22),L=t(952),F=t(78844),d=t(85893);Z.default=function(){var B=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=new Date,s=r.getFullYear(),_=String(r.getMonth()+1).padStart(2,"0"),c=a?String(r.getDate()+a).padStart(2,"0"):String(r.getDate()).padStart(2,"0");return s+"-"+_+"-"+c},I=(0,f.useState)([]),$=(0,E.Z)(I,2),R=$[0],w=$[1],T=(0,f.useRef)(),re=(0,f.useState)([]),N=(0,E.Z)(re,2),ne=N[0],V=N[1],se=(0,f.useState)(0),z=(0,E.Z)(se,2),Y=z[0],H=z[1],_e=(0,f.useState)([B(0),B(1)]),J=(0,E.Z)(_e,2),v=J[0],Q=J[1],oe=JSON.parse(sessionStorage.getItem("userInfo")).data.id;(0,f.useEffect)(function(){var i;T==null||(i=T.current)===null||i===void 0||i.setFieldValue("timeRange",v)},[]),(0,f.useEffect)(function(){X([U.Z.getDepartmentList(oe)])},[v,Y]);var X=function(){var i=(0,O.Z)((0,u.Z)().mark(function a(r){var s,_,c;return(0,u.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return s=[],_=[],c=function(){var h=(0,O.Z)((0,u.Z)().mark(function g(M){return(0,u.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:M.forEach(function(o){o.userId&&o.enable&&(s.push(o.userId),_.push({name:o.name,id:o.userId})),o.children&&c(o.children)});case 1:case"end":return y.stop()}},g)}));return function(M){return h.apply(this,arguments)}}(),m.next=5,c(r);case 5:w(s),ue(s,_);case 7:case"end":return m.stop()}},a)}));return function(r){return i.apply(this,arguments)}}(),ie=function(a){var r=a.map(function(s){return{userId:s,"startTime-start":v[0],"startTime-end":v[1],"timeLength-start":Y}});return r},le=function(a){var r=a.map(function(s){return{userId:s,"startTime-start":v[0],"startTime-end":v[1],"timeLength-start":1}});return r},q=function(a){var r=a.map(function(_){return{userId:_,"startTime-start":v[0],"startTime-end":v[1],"timeLength-start":Y}}),s={array:JSON.stringify(r),totalFields:"timeLength"};return s},ue=function(){var i=(0,O.Z)((0,u.Z)().mark(function a(r,s){var _,c,C,m,h,g,M,j;return(0,u.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return _=ie(r),c=q(r),C=le(r),o.next=5,b.Z.get("/sms/ec/ecCallLog/statistics",{array:JSON.stringify(_)});case 5:return m=o.sent,h=m.data,o.next=9,b.Z.get("/sms/ec/ecCallLog/statistics",{array:JSON.stringify(C)});case 9:return g=o.sent.data,o.next=12,b.Z.get("/sms/ec/ecCallLog/totals",c);case 12:M=o.sent.data,j=[],s.forEach(function(te,p){h[p]&&j.push((0,D.Z)((0,D.Z)({},te),{},{num:h[p],connect:g[p],connectRatio:(g[p]/h[p]*100).toFixed(2)+"%",timeLength:M[p].timeLength}))}),V(j);case 16:case"end":return o.stop()}},a)}));return function(r,s){return i.apply(this,arguments)}}(),k=function(a){a=Number(a);var r=Math.floor(a/3600),s=Math.floor(a%3600/60),_=Math.floor(a%3600%60),c=r>0?r+(r==1," \u65F6, "):"",C=s>0?s+(s==1," \u5206, "):"",m=_>0?_+(_==1," \u79D2"):"";return c+C+m},de={menu:{type:"tab",items:[{key:"all",label:(0,d.jsx)("span",{children:"\u5168\u90E8"})},{key:"15",label:(0,d.jsx)("span",{children:"15\u79D2\u4EE5\u4E0A"})}],onChange:function(a){a=="all"?H(0):H(15)}}},ee=[{title:"\u59D3\u540D",dataIndex:"name"},{title:"\u901A\u8BDD\u6B21\u6570",dataIndex:"num"},{title:"\u63A5\u901A\u6570\u91CF",dataIndex:"connect"},{title:"\u63A5\u901A\u7387",dataIndex:"connectRatio"},{title:"\u901A\u8BDD\u65F6\u957F",dataIndex:"timeLength",render:function(a,r){return(0,d.jsx)(d.Fragment,{children:r.timeLength?k(r.timeLength):0})}}];return(0,d.jsxs)(A.ZP,{children:[(0,d.jsx)(e.ZP,{children:(0,d.jsx)(L.ZP,{formRef:T,onFinish:function(){var i=(0,O.Z)((0,u.Z)().mark(function a(r){return(0,u.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:Q(r.timeRange);case 1:case"end":return _.stop()}},a)}));return function(a){return i.apply(this,arguments)}}(),children:(0,d.jsx)(F.Z,{fieldProps:{showTime:!1},name:"timeRange",label:"\u65F6\u95F4\u533A\u95F4"})})}),(0,d.jsx)(e.ZP,{children:(0,d.jsx)(W.Z,{search:!1,className:"ECContent",columns:ee,dataSource:ne,toolbar:de})})]})}}}]);
