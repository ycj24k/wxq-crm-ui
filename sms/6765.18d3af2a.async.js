(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6765],{6765:function(Fe,q,t){"use strict";t.r(q),t.d(q,{default:function(){return Pe}});var Se=t(49111),ue=t(19650),oe=t(66456),_=t(15885),Le=t(62350),ce=t(24565),ee=t(11849),ke=t(57663),$=t(71577),Me=t(77576),Ce=t(12028),S=t(39428),ze=t(34792),B=t(48086),N=t(3182),C=t(2824),i=t(67294),de=t(8212),je=t(82061),te=t(51042),T=t(63863),o=t(37490),ae=t(952),ne=t(37476),W=t(64317),xe=t(31199),e=t(85893),be=function(r){var k=r.modalVisible,h=r.setModalVisible,M=r.callbackRef,u=r.renderData,O=r.url,G=(0,i.useState)(u.types=="edit"?u.parentProject:""),E=(0,C.Z)(G,2),A=E[0],R=E[1];(0,i.useEffect)(function(){console.log("projects",A)},[A]);var b=(0,i.useRef)(),j=function(f,a){return a.some(function(l){return l.label.toLowerCase().indexOf(f.toLowerCase())>-1})};function U(s,f){R(s),console.log(s,f)}return u.types=="edit"&&setTimeout(function(){var s;b==null||(s=b.current)===null||s===void 0||s.setFieldsValue({project:u.parentProject,projects:[u.project],classType:u.classType+"",classYear:u.classYear+"",examType:u.examType+"",receivable:u.receivable})},100),(0,e.jsxs)(ne.Y,{title:"\u65B0\u5EFA\u8868\u5355",formRef:b,visible:k,width:800,autoFocusFirstInput:!0,modalProps:{onCancel:function(){return h()},destroyOnClose:!0},onFinish:function(){var s=(0,N.Z)((0,S.Z)().mark(function f(a){var l;return(0,S.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:l=[],a.projects.forEach(function(c){u.types=="edit"?l.push({classType:a.classType,id:u.id,classYear:a.classYear,examType:a.examType,project:c,receivable:a.receivable}):l.push({classType:a.classType,classYear:a.classYear,examType:a.examType,project:c,receivable:a.receivable})}),console.log("arr",l),T.Z.postAll("/sms/business/bizChargeStandard/saveArray",{array:l}).then(function(c){return c.status=="success"&&(B.default.success("\u64CD\u4F5C\u6210\u529F"),h(),M()),!0}).catch(function(c){return!0});case 4:case"end":return p.stop()}},f)}));return function(f){return s.apply(this,arguments)}}(),children:[(0,e.jsxs)(ae.ZP.Group,{children:[(0,e.jsx)(W.Z,{width:"md",name:"project",placeholder:"\u9009\u62E9\u62A5\u8003\u5C97\u4F4D",disabled:u.types=="edit",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:o.Z.getList("dict_reg_job"),showSearch:{filter:j},onChange:U,onSearch:function(f){return console.log(f)}}}),(0,e.jsx)(W.Z,{width:"md",name:"projects",disabled:u.types=="edit",placeholder:"\u9009\u62E9\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:o.Z.getList("dict_reg_job",A),mode:"multiple",showSearch:{filter:j}}})]}),(0,e.jsxs)(ae.ZP.Group,{children:[(0,e.jsx)(W.Z,{label:"\u62A5\u8003\u73ED\u578B",name:"classType",width:"sm",fieldProps:{showSearch:{filter:j}},request:(0,N.Z)((0,S.Z)().mark(function s(){return(0,S.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",o.Z.getList("dict_class_type"));case 1:case"end":return a.stop()}},s)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u73ED\u7EA7\u7C7B\u578B"}]}),(0,e.jsx)(W.Z,{label:"\u73ED\u578B\u5E74\u9650",name:"classYear",width:"sm",fieldProps:{showSearch:{filter:j}},request:(0,N.Z)((0,S.Z)().mark(function s(){return(0,S.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",o.Z.getList("dict_class_year"));case 1:case"end":return a.stop()}},s)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u73ED\u578B\u5E74\u9650"}]}),(0,e.jsx)(W.Z,{label:"\u8003\u8BD5\u7C7B\u578B",name:"examType",width:"sm",fieldProps:{showSearch:{filter:j}},request:(0,N.Z)((0,S.Z)().mark(function s(){return(0,S.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",o.Z.getList("dict_exam_type"));case 1:case"end":return a.stop()}},s)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8003\u8BD5\u7C7B\u578B"}]})]}),(0,e.jsx)(ae.ZP.Group,{children:(0,e.jsx)(xe.Z,{width:"md",label:"\u6536\u8D39\u6807\u51C6",name:"receivable",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u6536\u8D39\u6807\u51C6"}]})})]})},Ye=t(58996),De=t(77933),fe=t(86582),Ee=function(r){var k=r.modalVisible,h=r.setModalVisible,M=r.callbackRef,u=r.renderData,O=r.signUpType,G=(0,i.useState)(u.types=="edit"?u.parentProject:""),E=(0,C.Z)(G,2),A=E[0],R=E[1],b=(0,i.useState)([]),j=(0,C.Z)(b,2),U=j[0],s=j[1],f=(0,i.useState)([]),a=(0,C.Z)(f,2),l=a[0],x=a[1],p=(0,i.useState)([]),c=(0,C.Z)(p,2),g=c[0],P=c[1];(0,i.useEffect)(function(){T.Z.get("/sms/business/bizField",{_isGetAll:!0}).then(function(F){var y=F.data.content,D=[];y.forEach(function(w){D.push({key:w.id.toString(),title:w.name})}),s(D)}),T.Z.get("/sms/business/fieldStandard",{standardId:u.split(",")[0],_isGetAll:!0,type:O}).then(function(F){var y=[];F.data.content.length>0&&F.data.content.forEach(function(D){y.push(D.fieldId.toString())}),x(y)})},[]);var Z=function(y,D,w){x(y)},z=function(y,D){P([].concat((0,fe.Z)(y),(0,fe.Z)(D)))},m=function(y,D){},V=(0,i.useRef)(),v=function(y,D){};return(0,e.jsxs)(ne.Y,{title:"\u5173\u8054\u5B57\u6BB5",formRef:V,visible:k,width:800,autoFocusFirstInput:!0,modalProps:{onCancel:function(){return h()},destroyOnClose:!0},onFinish:function(){var F=(0,N.Z)((0,S.Z)().mark(function y(D){var w,J,Q;return(0,S.Z)().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:w=[],J=[],Q=[],l.length>0&&l.forEach(function(Y){w.push(Number(Y))}),u.split(",").forEach(function(Y){J.push({array:w}),Q.push(O)}),T.Z.post2("/sms/business/fieldStandard/updateTreeFromTree",{ids:u,types:Q.join(",")},J).then(function(Y){return Y.status=="success"&&(B.default.success("\u64CD\u4F5C\u6210\u529F"),h(),M()),!0}).catch(function(Y){return!0});case 6:case"end":return X.stop()}},y)}));return function(y){return F.apply(this,arguments)}}(),children:[(0,e.jsx)(ae.ZP.Group,{title:"\u62A5\u8003\u6240\u9700\u8D44\u6599\uFF08\u5C06\u6240\u9700\u8981\u7684\u8D44\u6599\u5B57\u6BB5\u9009\u4E2D\u653E\u5165\u53F3\u4FA7\u680F\u70B9\u51FB\u786E\u5B9A\u5373\u53EF\uFF09\uFF1A"}),(0,e.jsx)("div",{children:"\u6CE8\u610F\uFF1A\u9ED8\u8BA4\u62A5\u540D\u5B66\u5458\u4FE1\u606F\uFF1A\u5B66\u5458\u59D3\u540D\u3001\u624B\u673A\u53F7\u3001\u8EAB\u4EFD\u8BC1\u3001\u62A5\u8003\u5C97\u4F4D\u3001\u62DB\u751F\u8001\u5E08\u3001\u62DB\u751F\u8001\u5E08\u90E8\u95E8\uFF0C\u4E0D\u9700\u8981\u91CD\u590D\u6DFB\u52A0\uFF1B\u975E\u5FC5\u8981\u53EF\u4EE5\u4E0D\u7528\u52FE\u9009\u3002"}),(0,e.jsx)("div",{children:"\u6CE8\u610F\uFF1A\u5982\u679C\u9700\u8981\u6DFB\u52A0\u6CA1\u6709\u7684\u8D44\u6599\u5B57\u6BB5\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u6DFB\u52A0\u3002"}),(0,e.jsx)(De.Z,{dataSource:U,titles:["\u672A\u9009","\u5DF2\u9009"],listStyle:{width:500,height:300},targetKeys:l,selectedKeys:g,onChange:Z,onSelectChange:z,onScroll:m,render:function(y){return y.title},showSearch:!0,onSearch:v})]})},Ae=t(22),$e=t(20228),Be=t(11382),Te=t(80876),he=t(25607),Re=function(r){var k=r.modalVisible,h=r.setModalVisible,M=r.url,u=r.type,O=r.callbackRef,G=r.uploadtype,E=r.callbackFn,A=E===void 0?void 0:E,R=(0,i.useState)(!1),b=(0,C.Z)(R,2),j=b[0],U=b[1];console.log("pp",r);var s=function(l){var x=l[0],p=[],c=[];l.forEach(function(g,P){if(P>2&&g.length>0){var Z={},z="";g.forEach(function(m,V){if(V<x.length){var v=x[V];(m+"3").replace(/(^\s*)|(\s*$)/g,"")!="3"&&(v=="type"&&u=="student"?Z[v]=o.Z.getValue("studentType",m):v=="project"?Z[v]=o.Z.getProjectValue("dict_reg_job",g[V-1],m):v=="classType"?Z[v]=o.Z.getValue("dict_class_type",m):v=="classYear"?Z[v]=o.Z.getValue("dict_class_year",m):v=="examType"?Z[v]=o.Z.getValue("dict_exam_type",m):v!="parentProject"&&(Z[v]=m))}}),p.push((0,ee.Z)({},Z)),console.log("array",p)}}),T.Z.postAll(M,{array:p}).then(function(g){U(!1),g.status=="success"&&(B.default.success("\u5BFC\u5165\u6210\u529F"),A&&A(g.data),h())})},f={accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",name:"file",headers:{authorization:"authorization-text"},showUploadList:!1,fieldProps:{beforeUpload:function(l,x){var p=!0,c=x[0],g=new FileReader;return g.onload=function(P){var Z=P.target.result;p||(Z=new Uint8Array(Z));var z=he.ij(Z,{type:p?"binary":"array"}),m=z.Sheets[z.SheetNames[0]],V=he.P6.sheet_to_json(m,{header:1});s(V)},p?g.readAsBinaryString(c):g.readAsArrayBuffer(c),!1}}};return(0,e.jsx)(ne.Y,{title:"\u6279\u91CF\u5BFC\u5165",autoFocusFirstInput:!0,modalProps:{onCancel:function(){h()}},onFinish:function(){var a=(0,N.Z)((0,S.Z)().mark(function l(x){return(0,S.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:h(),O();case 2:case"end":return c.stop()}},l)}));return function(l){return a.apply(this,arguments)}}(),visible:k,children:(0,e.jsxs)(Be.Z,{spinning:j,children:[(0,e.jsx)("a",{download:"\u6536\u8D39\u6807\u51C6\u5BFC\u5165\u6A21\u677F",href:"./template/\u6536\u8D39\u6807\u51C6\u5BFC\u5165\u6A21\u677F.xlsx",children:"\u4E0B\u8F7D\u5BFC\u5165\u6A21\u677F"},"download-charge-template"),(0,e.jsx)(Te.Z,(0,ee.Z)({},f))]})})},H=t(54493),Pe=function(r){var k=r.student,h=k===void 0?!1:k,M=r.params,u=M===void 0?{_orderBy:"enable,id",_direction:"desc,desc"}:M,O=r.callbackRefP,G=r.orderId,E=r.setJobFalg,A=r.admin,R=A===void 0?!0:A,b=(0,i.useState)(null),j=(0,C.Z)(b,2),U=j[0],s=j[1],f=(0,i.useState)(!1),a=(0,C.Z)(f,2),l=a[0],x=a[1],p=(0,i.useState)(!1),c=(0,C.Z)(p,2),g=c[0],P=c[1],Z=(0,i.useState)(""),z=(0,C.Z)(Z,2),m=z[0],V=z[1],v=(0,i.useState)([]),F=(0,C.Z)(v,2),y=F[0],D=F[1],w=(0,i.useState)(!1),J=(0,C.Z)(w,2),Q=J[0],le=J[1],X=(0,i.useState)(!1),Y=(0,C.Z)(X,2),pe=Y[0],me=Y[1],Ve=(0,i.useState)(0),ve=(0,C.Z)(Ve,2),we=ve[0],ye=ve[1],ge=(0,i.useRef)(),re="/sms/business/bizChargeStandard",K=function(){ge.current.reload()};(0,i.useEffect)(function(){K()},[r]);var Ie=[{title:"\u9879\u76EE\u603B\u79F0",dataIndex:"parentProjects",key:"parentProjects",valueType:"cascader",fieldProps:{options:o.Z.getList("dict_reg_job"),showSearch:{filter:H.Z}},width:150,render:function(I,n){return(0,e.jsx)("span",{children:o.Z.getCascaderAllName("dict_reg_job",n.project)},"parentProjects")}},{title:"\u5C97\u4F4D\u540D\u79F0",dataIndex:"project",key:"project",valueType:"cascader",fieldProps:{options:o.Z.getCascader("dict_reg_job"),showSearch:{filter:H.Z}},render:function(I,n){return(0,e.jsx)(e.Fragment,{children:o.Z.getCascaderName("dict_reg_job",n.project)})}},{title:"\u62A5\u8003\u73ED\u578B",dataIndex:"classType",valueEnum:o.Z.getSearch("dict_class_type"),fieldProps:{showSearch:{filter:H.Z}},render:function(I,n){return(0,e.jsx)(e.Fragment,{children:o.Z.getName("dict_class_type",n.classType)})}},{title:"\u73ED\u578B\u5E74\u9650",dataIndex:"classYear",valueEnum:o.Z.getSearch("dict_class_year"),fieldProps:{showSearch:{filter:H.Z}},render:function(I,n){return(0,e.jsx)(e.Fragment,{children:o.Z.getName("dict_class_year",n.classYear)})}},{title:"\u8003\u8BD5\u7C7B\u578B",dataIndex:"examType",valueEnum:o.Z.getSearch("dict_exam_type"),fieldProps:{showSearch:{filter:H.Z}},render:function(I,n){return(0,e.jsx)(e.Fragment,{children:o.Z.getName("dict_exam_type",n.examType)})}},{title:"\u6536\u8D39\u6807\u51C6",dataIndex:"receivable"},{title:"\u62A5\u540D\u8D44\u6599\u5B57\u6BB5",dataIndex:"fields",ellipsis:!0,tip:"\u5907\u6CE8\u8FC7\u957F\u4F1A\u81EA\u52A8\u6536\u7F29"},{title:"\u8003\u8BD5\u8D44\u6599\u5B57\u6BB5",dataIndex:"fields2",ellipsis:!0,tip:"\u5907\u6CE8\u8FC7\u957F\u4F1A\u81EA\u52A8\u6536\u7F29"},{title:"\u7528\u6237\u72B6\u6001",dataIndex:"enable",valueEnum:{true:"\u542F\u7528",false:"\u7981\u7528"},render:function(I,n){return(0,e.jsx)(Ce.Z,{checkedChildren:"\u542F\u7528",unCheckedChildren:"\u7981\u7528",defaultChecked:n.enable,loading:Q,onChange:(0,N.Z)((0,S.Z)().mark(function Ze(){var se;return(0,S.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return le(!0),L.next=3,T.Z.post("/sms/business/bizChargeStandard",{id:n.id,enable:!n.enable});case 3:se=L.sent,se.status!="success"&&B.default.error(se.msg),le(!1),K();case 7:case"end":return L.stop()}},Ze)}))},n.id)}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",hideInTable:!R,render:function(I,n,Ze,se){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)($.Z,{type:"primary",size:"small",hidden:!h,icon:(0,e.jsx)(de.Z,{}),style:{marginRight:"10px",marginBottom:"8px"},onClick:function(){T.Z.post("/sms/business/bizOrder",{id:G,project:n.project}).then(function(L){L.status=="success"&&(B.default.success("\u64CD\u4F5C\u6210\u529F"),E(),O())})},children:"\u9009\u62E9"},"editable"),(0,e.jsx)($.Z,{type:"primary",size:"small",hidden:h,icon:(0,e.jsx)(de.Z,{}),style:{marginRight:"10px",marginBottom:"8px"},onClick:function(){s((0,ee.Z)((0,ee.Z)({},n),{},{types:"edit"})),x(!0)},children:"\u7F16\u8F91"},"editable"),(0,e.jsx)(ce.Z,{title:"\u662F\u5426\u786E\u5B9A\u5220\u9664\uFF1F",onConfirm:function(){T.Z.delete(re,{id:n.id}).then(function(L){L.status=="success"&&(B.default.success("\u5220\u9664\u6210\u529F"),K())})},okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",children:(0,e.jsx)($.Z,{hidden:h,size:"small",type:"primary",danger:!0,icon:(0,e.jsx)(je.Z,{}),children:"\u5220\u9664"},"delete")},n.id)]})}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ae.Z,{columns:Ie,className:"JobAssociation",actionRef:ge,cardBordered:!0,request:{url:re,params:u},rowKey:"id",search:{labelWidth:"auto",defaultCollapsed:!1},rowSelection:{selections:[_.Z.SELECTION_ALL,_.Z.SELECTION_INVERT],onChange:function(I,n){V(I.join(","))}},tableAlertOptionRender:function(){return(0,e.jsx)(ue.Z,{size:16,children:(0,e.jsx)(ce.Z,{title:"\u662F\u5426\u6279\u91CF\u5220\u9664\uFF1F",okText:"\u5220\u9664",onConfirm:function(){T.Z.delete("/sms/business/bizChargeStandard/deleteArray",{ids:m}).then(function(n){n.status=="success"&&(B.default.success("\u5220\u9664\u6210\u529F"),K())})},children:(0,e.jsx)("a",{hidden:h||!R,children:"\u6279\u91CF\u5220\u9664"})})})},dateFormatter:"string",headerTitle:"\u9879\u76EE\u5173\u8054",toolBarRender:h?[]:[(0,e.jsx)($.Z,{icon:(0,e.jsx)(te.Z,{}),type:"primary",hidden:!R,onClick:function(){me(!0)},children:"\u6279\u91CF\u5BFC\u5165\u6536\u8D39\u6807\u51C6"},"button"),(0,e.jsx)($.Z,{icon:(0,e.jsx)(te.Z,{}),type:"primary",hidden:!R,onClick:function(){s({type:"order",orderNumber:0}),x(!0)},children:"\u65B0\u5EFA\u6536\u8D39\u6807\u51C6"},"button"),(0,e.jsx)($.Z,{icon:(0,e.jsx)(te.Z,{}),type:"primary",onClick:function(){if(m.length<=0){B.default.error("\u8BF7\u5148\u52FE\u9009\u6536\u8D39\u6807\u51C6");return}ye(0),P(!0)},children:"\u5173\u8054\u62A5\u8003\u8D44\u6599"},"button"),(0,e.jsx)($.Z,{icon:(0,e.jsx)(te.Z,{}),type:"primary",onClick:function(){if(m.length<=0){B.default.error("\u8BF7\u5148\u52FE\u9009\u6536\u8D39\u6807\u51C6");return}ye(1),P(!0)},children:"\u5173\u8054\u8003\u8BD5\u8D44\u6599"},"button")]}),l&&(0,e.jsx)(be,{setModalVisible:function(){return x(!1)},modalVisible:l,callbackRef:function(){return K()},renderData:U,url:re}),g&&(0,e.jsx)(Ee,{setModalVisible:function(){return P(!1)},modalVisible:g,callbackRef:function(){return K()},renderData:m,signUpType:we,url:re}),pe&&(0,e.jsx)(Re,{setModalVisible:function(){return me(!1)},modalVisible:pe,url:"/sms/business/bizChargeStandard/saveArray",type:"student",callbackFn:function(){return K()}})]})}},54493:function(Fe,q){"use strict";var t=function(ue,oe){return oe.some(function(_){return _.label.toLowerCase().indexOf(ue.toLowerCase())>-1})};q.Z=t}}]);
