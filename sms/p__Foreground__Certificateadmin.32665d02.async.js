(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[3696],{6821:function(ie,Z,e){"use strict";var S=e(39428),O=e(3182),_=e(43185),x=e(43027),j=e(34792),p=e(48086),l=e(11849),m=e(2824),g=e(80876),T=e(28975),P=e(67294),v=e(61261),M=e(41574),c=e(85893);Z.Z=function(a){var X=a.width,w=a.action,o=a.name,B=a.fieldProps,A=B===void 0?{}:B,q=a.label,Y=a.rules,z=a.renderData,n=a.fileUrl,ee=(0,P.useState)(!1),t=(0,m.Z)(ee,2),N=t[0],F=t[1],te=(0,P.useState)(),L=(0,m.Z)(te,2),G=L[0],K=L[1],se=(0,P.useState)(),W=(0,m.Z)(se,2),$=W[0],k=W[1],ae=(0,P.useState)(!1),H=(0,m.Z)(ae,2),D=H[0],s=H[1],i=sessionStorage.getItem("tokenName"),V=sessionStorage.getItem("tokenValue"),d={};return d[i]=V,(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(g.Z,{width:X,action:w,name:o,label:q,fieldProps:(0,l.Z)((0,l.Z)({},A),{},{multiple:!0,listType:"picture",headers:(0,l.Z)({},d),defaultFileList:[],beforeUpload:function(h){if(h.size>4096e4)return p.default.error("\u4E0A\u6B21\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC740M"),x.Z.LIST_IGNORE},onPreview:function(){var f=(0,O.Z)((0,S.Z)().mark(function y(R){var re;return(0,S.Z)().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:console.log("file",R),R.thumbUrl?(K(R.thumbUrl),F(!0)):(re=R.name.slice(R.name.indexOf(".")),re==".pdf"?(0,v.Z)(z.id,R.name,n,k,s):(0,v.Z)(z.id,R.name,n,K,F));case 2:case"end":return J.stop()}},y)}));function h(y){return f.apply(this,arguments)}return h}(),onChange:function(h){var y=h.file.status;console.log("info",h),y==="done"?p.default.success("".concat(h.file.name," \u4E0A\u4F20\u6210\u529F.")):y==="error"&&p.default.error("".concat(h.file.name," \u4E0A\u4F20\u5931\u8D25."))}}),rules:Y}),N&&(0,c.jsx)(T.Z,{imgSrc:G,isModalVisibles:N,setisModalVisibles:function(h){return F(h)}}),(0,c.jsx)(M.Z,{previewVisible:D,setPreviewVisible:function(){return s(!1)},previewImage:$})]})}},84117:function(ie,Z,e){"use strict";var S=e(34792),O=e(48086),_=e(39428),x=e(11849),j=e(3182),p=e(2824),l=e(67294),m=e(45510),g=e(37476),T=e(952),P=e(5966),v=e(64317),M=e(90672),c=e(63863),a=e(37490),X=e(6821),w=e(21874),o=e(85893);Z.Z=function(B){var A=(0,l.useRef)(),q=B.modalVisible,Y=B.setModalVisible,z=B.callbackRef,n=B.renderData,ee=(0,l.useState)(),t=(0,p.Z)(ee,2),N=t[0],F=t[1],te=(0,l.useState)(),L=(0,p.Z)(te,2),G=L[0],K=L[1],se=(0,l.useState)(!1),W=(0,p.Z)(se,2),$=W[0],k=W[1],ae=(0,l.useRef)(null);(0,l.useEffect)(function(){n.type=="eidt"&&setTimeout((0,j.Z)((0,_.Z)().mark(function D(){var s,i;return(0,_.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:Object.keys(n).forEach(function(f){typeof n[f]=="number"&&(n[f]=n[f]+"")}),n.file&&(i=[],n.file.split(",").forEach(function(f,h){i.push({uid:h+1,name:f,response:{data:f}})}),n.file=i),A==null||(s=A.current)===null||s===void 0||s.setFieldsValue((0,x.Z)({},n));case 3:case"end":return d.stop()}},D)})),100)},[]);var H=function(s){if($&&O.default.error("\u8BF7\u586B\u5199\u6B63\u786E\u7684\u59D3\u540D/\u90E8\u95E8"),n.type=="add"&&(s.userName=N.name,s.userId=N.id,s.departmentId=G),delete s.createBy,s.file){var i=[];s.file.forEach(function(d){i.push(d.response.data)}),s.file=i.join(",")}var V="/sms/business/bizCertificate";return new Promise(function(d){c.Z.post(V,s).then(function(f){f.status=="success"&&(O.default.success("\u64CD\u4F5C\u6210\u529F"),Y(),z(),d(!0))}).catch(function(f){d(!0)})})};return(0,o.jsxs)(g.Y,{title:"\u8BC1\u4E66\u7533\u8BF7",formRef:A,width:1200,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,maskClosable:!1,onCancel:function(){Y()}},onFinish:function(){var D=(0,j.Z)((0,_.Z)().mark(function s(i){return(0,_.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return n.id&&(i.id=n.id),n.applyId&&(i.applyId=n.applyId),d.next=4,H(i);case 4:case"end":return d.stop()}},s)}));return function(s){return D.apply(this,arguments)}}(),visible:q,children:[n.type=="add"?(0,o.jsxs)(T.ZP.Group,{children:[(0,o.jsx)(w.Z,{ref:ae,userLabel:"\u62DB\u751F\u8001\u5E08",userNames:"userName",userPlaceholder:"\u8BF7\u8F93\u5165\u62DB\u751F\u8001\u5E08\u7684\u540D\u5B57",setUserNameId:function(s){return F(s)},setDepartId:function(s){return K(s)},setFalgUser:function(s){return k(s)}}),(0,o.jsx)(P.Z,{width:"sm",name:"mobile",label:"\u8054\u7CFB\u7535\u8BDD",placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD",rules:[{pattern:new RegExp(a.Z.getRegex("mobile")),message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7"}]}),(0,o.jsx)(P.Z,{width:"md",name:"idCard",label:"\u8EAB\u4EFD\u8BC1\u53F7",placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1",rules:[{pattern:new RegExp(a.Z.getRegex("idCard")),message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u8EAB\u4EFD\u8BC1\u53F7"}]})]}):(0,o.jsx)(P.Z,{readonly:!0,name:"userName",label:"\u6301\u6709\u4EBA\u59D3\u540D"}),(0,o.jsx)(v.Z,{label:"\u8BC1\u4E66\u79CD\u7C7B",name:"kind",width:"md",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8BC1\u4E66\u79CD\u7C7B"}],request:(0,j.Z)((0,_.Z)().mark(function D(){return(0,_.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",a.Z.getList("certificateKind"));case 1:case"end":return i.stop()}},D)}))}),(0,o.jsx)(X.Z,{label:"\u4E0A\u4F20\u8BC1\u4E66",name:"file",action:"/sms/business/bizCertificate/upload",renderData:n,fileUrl:"/sms/business/bizCertificate/download"}),(0,o.jsxs)(T.ZP.Group,{children:[(0,o.jsx)(M.Z,{name:"remark",label:"\u8BC1\u4E66\u5907\u6CE8",placeholder:"\u8BF7\u8F93\u5165\u8BC1\u4E66\u5907\u6CE8...",width:1e3}),(0,o.jsx)(m.Z,{name:"uploadTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"sm",label:"\u4E0A\u4EA4\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u4EA4\u65F6\u95F4"}]}),(0,o.jsx)(m.Z,{name:"returnTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"sm",label:"\u6700\u8FD1\u5F52\u8FD8\u65F6\u95F4"}),(0,o.jsx)(m.Z,{name:"takeTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"sm",label:"\u6700\u8FD1\u5916\u5E26\u65F6\u95F4"})]})]})}},63078:function(ie,Z,e){"use strict";e.r(Z),e.d(Z,{default:function(){return N}});var S=e(57663),O=e(71577),_=e(32059),x=e(49111),j=e(19650),p=e(62350),l=e(24565),m=e(34792),g=e(48086),T=e(39428),P=e(3182),v=e(11849),M=e(2824),c=e(71906),a=e(67294),X=e(22),w=e(37490),o=e(63863),B=e(28975),A=e(61261),q=e(84117),Y=e(92786),z=e(51042),n=e(79046),ee={\u6301\u6709\u4EBA:"userName",\u6301\u6709\u4EBA\u90E8\u95E8:"departmentName",\u8BC1\u4E66\u7F16\u53F7:"num",\u8BC1\u4E66\u79CD\u7C7B:"kind",\u8BC1\u4E66\u5907\u6CE8:"remark",\u4E0A\u4EA4\u65F6\u95F4:"uploadTime",\u6700\u8FD1\u5F52\u8FD8\u65F6\u95F4:"returnTime",\u6700\u8FD1\u5916\u5E26\u65F6\u95F4:"takeTime",\u6700\u540E\u66F4\u65B0\u65F6\u95F4:"updateTime"},t=e(85893),N=function(){var F=(0,a.useRef)(),te=(0,a.useState)({}),L=(0,M.Z)(te,2),G=L[0],K=L[1],se=(0,a.useState)(!1),W=(0,M.Z)(se,2),$=W[0],k=W[1],ae=(0,a.useState)({enable:!0}),H=(0,M.Z)(ae,2),D=H[0],s=H[1],i=(0,a.useState)(),V=(0,M.Z)(i,2),d=V[0],f=V[1],h=(0,a.useState)(!1),y=(0,M.Z)(h,2),R=y[0],re=y[1],ue=(0,a.useState)(!1),J=(0,M.Z)(ue,2),le=J[0],oe=J[1],me=(0,a.useState)([]),de=(0,M.Z)(me,2),Pe=de[0],ce=de[1],ne=function(){F.current.reload()},fe=function(u){var r=(0,t.jsx)("span",{});if(u){var b;r=(b=u.file)===null||b===void 0?void 0:b.split(",").map(function(C,U){return(0,t.jsx)("div",{className:"notice-files",children:(0,t.jsxs)("a",{onClick:function(){(0,A.Z)(u.id,C,"/sms/business/bizCertificate/download",f,re)},children:["\u8BC1\u4E66\u9644\u4EF6",U]})},U)})}return r},Ee=function(u){var r=sessionStorage.getItem("tokenName"),b=sessionStorage.getItem("tokenValue"),C={};C[r]=b,fetch("/sms/business/bizCertificate/export?idList="+u,{method:"GET",headers:(0,v.Z)({},C)}).then(function(U){U.blob().then(function(I){var he=window.URL.createObjectURL(I),Q=document.createElement("a");document.body.appendChild(Q);var pe="\u9644\u4EF6";Q.href=he,Q.download=pe,Q.target="_blank",Q.click(),Q.remove(),ne()})})},ve=[{title:"\u6301\u6709\u4EBA",dataIndex:"userName",key:"userName",sorter:!0,render:function(u,r){return(0,t.jsx)("span",{children:r.userId?(0,t.jsx)("a",{onClick:(0,P.Z)((0,T.Z)().mark(function b(){var C;return(0,T.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,o.Z.get("/sms/system/sysUser",{id:r.createBy});case 2:C=I.sent.data.content[0],K((0,v.Z)({},C)),oe(!0);case 5:case"end":return I.stop()}},b)})),children:r.userName}):(0,t.jsx)("span",{children:r.userName})})}},{title:"\u6301\u6709\u4EBA\u90E8\u95E8",dataIndex:"departmentName",key:"departmentName",sorter:!0,render:function(u,r){return(0,t.jsx)("span",{children:w.Z.getDepartmentName(r.departmentId).join("-")})}},{title:"\u8BC1\u4E66\u7F16\u53F7",dataIndex:"num",sorter:!0},{title:"\u8BC1\u4E66\u79CD\u7C7B",dataIndex:"kind",key:"kind",valueType:"select",sorter:!0,filters:!0,filterMultiple:!1,valueEnum:w.Z.getSearch("certificateKind"),render:function(u,r){return(0,t.jsx)("span",{children:w.Z.getName("certificateKind",r.kind)})}},{title:"\u8BC1\u4E66\u7167\u7247",key:"file",dataIndex:"file",render:function(u,r){return(0,t.jsx)("span",{children:fe(r)})}},{title:"\u8BC1\u4E66\u5907\u6CE8",dataIndex:"remark",key:"remark",sorter:!0},{title:"\u4E0A\u4EA4\u65F6\u95F4",key:"uploadTime",dataIndex:"uploadTime",valueType:"dateTime",sorter:!0,search:!1},{title:"\u6700\u8FD1\u5F52\u8FD8\u65F6\u95F4",key:"returnTime",dataIndex:"returnTime",valueType:"dateTime",sorter:!0,search:!1},{title:"\u6700\u8FD1\u5916\u5E26\u65F6\u95F4",key:"takeTime",dataIndex:"takeTime",valueType:"dateTime",sorter:!0,search:!1},{title:"\u6700\u540E\u66F4\u65B0\u65F6\u95F4",key:"updateTime",dataIndex:"updateTime",valueType:"dateTime",sorter:!0,search:!1},{title:"\u64CD\u4F5C",search:!1,width:180,render:function(u,r){return[(0,t.jsxs)(j.Z,{children:[(0,t.jsx)("a",{onClick:function(){K((0,v.Z)((0,v.Z)({},r),{},{type:"eidt",typeAdmin:!0})),k(!0)},children:"\u66F4\u65B0\u8BC1\u4E66\u72B6\u6001"}),(0,t.jsx)(l.Z,{title:"\u662F\u5426\u5E9F\u9664",okText:"\u5E9F\u9664",cancelText:"\u53D6\u6D88",onConfirm:function(C){C==null||C.stopPropagation(),o.Z.post("/sms/business/bizCertificate/disable/"+r.id).then(function(U){U.status=="success"&&(g.default.success("\u5E9F\u9664\u6210\u529F"),ne())})},children:(0,t.jsx)("a",{style:{color:"red"},children:"\u5E9F\u9664"})},"delete")]})]}}],De=(0,_.Z)({},"createTime,num","desc,desc"),_e=void 0;return _e={menu:{type:"tab",items:[{key:"all",label:(0,t.jsx)("span",{children:"\u5168\u90E8"})},{key:"false",label:(0,t.jsx)("span",{children:"\u5DF2\u5E9F\u9664"})}],onChange:function(u){u=="all"?s({enable:!0}):s({enable:!1}),ne()}}},(0,t.jsxs)(c.ZP,{children:[(0,t.jsx)(X.Z,{className:"Certificate",columns:ve,actionRef:F,toolbar:_e,request:{url:"/sms/business/bizCertificate",sortList:De,params:D},search:{defaultCollapsed:!1,labelWidth:120},toolBarRender:[(0,t.jsx)(O.Z,{icon:(0,t.jsx)(z.Z,{}),type:"primary",onClick:function(){K({type:"add"}),k(!0)},children:"\u65B0\u589E\u8BC1\u4E66"},"add-certificate-admin")],rowSelection:{onChange:function(u,r){ce(r)}},tableAlertOptionRender:function(u){var r=u.selectedRowKeys,b=u.selectedRows,C=u.onCleanSelected;return(0,t.jsxs)(j.Z,{size:24,children:[(0,t.jsx)("span",{children:(0,t.jsx)("a",{style:{marginInlineStart:8},onClick:C,children:"\u53D6\u6D88\u9009\u62E9"})}),(0,t.jsx)("a",{onClick:function(){console.log("selectedRowKeys",b),(0,n.Z)(b,ee,"\u8BC1\u4E66\u5217\u8868\u4FE1\u606F")},children:"\u5BFC\u51FA\u5217\u8868"}),(0,t.jsx)("a",{onClick:function(){var I=r.length>0?r.join(","):"";Ee(I)},children:"\u5BFC\u51FA\u8BC1\u4E66"})]})}}),$&&(0,t.jsx)(q.Z,{setModalVisible:function(){return k(!1)},modalVisible:$,callbackRef:function(){return ne()},renderData:G}),R&&(0,t.jsx)(B.Z,{imgSrc:d,isModalVisibles:R,setisModalVisibles:function(u){return re(u)}}),le&&(0,t.jsx)(Y.Z,{setModalVisible:function(){return oe(!1)},modalVisible:le,callbackRef:function(){return ne()},renderData:G})]})}},28975:function(ie,Z,e){"use strict";var S=e(12968),O=e(20352),_=e(85893);Z.Z=function(x){var j=x.isModalVisibles,p=x.imgSrc,l=x.setisModalVisibles;return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("div",{style:{display:"none"},children:(0,_.jsx)(O.Z,{width:200,style:{display:"none"},preview:{visible:j,src:p,onVisibleChange:function(g){l(g)}}})})})}},61261:function(ie,Z,e){"use strict";var S=e(39428),O=e(3182),_=e(68503),x=function(){var j=(0,O.Z)((0,S.Z)().mark(function p(l,m,g,T,P){var v;return(0,S.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(v=m.slice(m.indexOf(".")),!(v!=".png"&&v!=".jpg"&&v!=".jpeg"&&v!=".pdf")){c.next=6;break}return c.next=4,(0,_.Z)(g,l,m,m);case 4:c.next=8;break;case 6:return c.next=8,(0,_.Z)(g,l,m).then(function(a){T(a),P(!0)});case 8:case"end":return c.stop()}},p)}));return function(l,m,g,T,P){return j.apply(this,arguments)}}();Z.Z=x}}]);
