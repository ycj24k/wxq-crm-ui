(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[3441],{8214:function(Y,P,e){"use strict";var u=e(28991),c=e(81253),g=e(85893),E=e(67294),M=e(53048),R=["fieldProps","request","params","proFieldProps"],v=function(t,x){var Z=t.fieldProps,B=t.request,T=t.params,O=t.proFieldProps,r=(0,c.Z)(t,R);return(0,g.jsx)(M.Z,(0,u.Z)({valueType:"cascader",fieldProps:Z,ref:x,request:B,params:T,filedConfig:{customLightMode:!0},proFieldProps:O},r))};P.Z=E.forwardRef(v)},64317:function(Y,P,e){"use strict";var u=e(28991),c=e(81253),g=e(85893),E=e(96202),M=e(67294),R=e(66758),v=e(53048),K=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],t=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],x=M.forwardRef(function(r,C){var d=r.fieldProps,D=r.children,A=r.params,h=r.proFieldProps,f=r.mode,I=r.valueEnum,n=r.request,b=r.showSearch,m=r.options,S=(0,c.Z)(r,K),j=(0,M.useContext)(R.Z);return(0,g.jsx)(v.Z,(0,u.Z)((0,u.Z)({valueEnum:(0,E.h)(I),request:n,params:A,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,u.Z)({options:m,mode:f,showSearch:b,getPopupContainer:j.getPopupContainer},d),ref:C,proFieldProps:h},S),{},{children:D}))}),Z=M.forwardRef(function(r,C){var d=r.fieldProps,D=r.children,A=r.params,h=r.proFieldProps,f=r.mode,I=r.valueEnum,n=r.request,b=r.options,m=(0,c.Z)(r,t),S=(0,u.Z)({options:b,mode:f||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},d),j=(0,M.useContext)(R.Z);return(0,g.jsx)(v.Z,(0,u.Z)((0,u.Z)({valueEnum:(0,E.h)(I),request:n,params:A,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,u.Z)({getPopupContainer:j.getPopupContainer},S),ref:C,proFieldProps:h},m),{},{children:D}))}),B=x,T=Z,O=B;O.SearchSelect=T,O.displayName="ProFormComponent",P.Z=O},22:function(Y,P,e){"use strict";var u=e(39428),c=e(11849),g=e(3182),E=e(2824),M=e(66801),R=e(63863),v=e(67294),K=e(85893);P.Z=function(t){var x=t.columns,Z=t.actionRef,B=t.formRef,T=t.cardBordered,O=T===void 0?!0:T,r=t.scroll,C=r===void 0?!1:r,d=t.request,D=t.beforeSearchSubmit,A=t.toolbar,h=A===void 0?void 0:A,f=t.pagesizes,I=f===void 0?10:f,n=t.rowKey,b=n===void 0?"id":n,m=t.toolBarRender,S=m===void 0?[]:m,j=t.dateFormatter,L=j===void 0?"string":j,y=t.rowSelection,H=y===void 0?!1:y,$=t.expandable,ce=$===void 0?void 0:$,G=t.tableAlertOptionRender,X=G===void 0?void 0:G,q=t.onRow,k=t.params,ee=k===void 0?"":k,te=t.dataSource,me=te===void 0?void 0:te,re=t.tableStyle,ae=re===void 0?void 0:re,N=t.footer,pe=N===void 0?void 0:N,se=t.onReset,fe=se===void 0?void 0:se,ne=t.onSubmit,Ee=ne===void 0?void 0:ne,oe=t.onFn,_e=oe===void 0?void 0:oe,ie=t.getTotalElements,z=ie===void 0?void 0:ie,le=t.getData,i=le===void 0?void 0:le,a=t.loding,s=a===void 0?void 0:a,l=t.search,_=l===void 0?void 0:l,U=t.searchData,ue=U===void 0?{}:U,F=t.headerTitle,Oe=t.editable,Te=Oe===void 0?void 0:Oe,Ce=t.className,De=Ce===void 0?"tables":Ce,be=t.rowClassName,Se=be===void 0?void 0:be,ge=!1;d&&(ge=d.sortList);var w={_orderBy:"",_direction:""},je=(0,v.useState)(I),Me=(0,E.Z)(je,2),xe=Me[0],Ze=Me[1],Be=(0,v.useState)({}),Re=(0,E.Z)(Be,2),Ie=Re[0],Le=Re[1];return(0,K.jsx)(M.ZP,{columns:x,className:De,actionRef:Z,formRef:B,cardBordered:O,scroll:C,headerTitle:F,tableStyle:ae,dataSource:me,rowClassName:Se,request:function(){var ve=(0,g.Z)((0,u.Z)().mark(function he(W,de,Ae){var Q,p,J;return(0,u.Z)().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return Object.keys(W).forEach(function(o){(W[o]=="null"||W[o]==null)&&(W["".concat(o,"-isNull")]=!0,delete W[o])}),Object.keys(de).length>0?Object.keys(de).forEach(function(o){var Pe;w._orderBy=o,((Pe=de[o])===null||Pe===void 0?void 0:Pe.indexOf("desc"))==0?w._direction="desc":w._direction="asc"}):ge?Object.keys(d.sortList).forEach(function(o){w._orderBy=o,w._direction=d.sortList[o]}):w={_orderBy:"",_direction:""},Q=W,Object.keys(Q).forEach(function(o){Q[o]===""&&delete Q[o]}),p=(0,c.Z)((0,c.Z)((0,c.Z)((0,c.Z)({},Ae),d.params),Q),ue),Object.keys(p).forEach(function(o){(p[o]==""||p[o]==[""]||p[o]=="-isNull")&&p[o]!==0&&p[o]!==!1&&(p["".concat(o)+"-isNull"]=!0,delete p[o]),p[o]===null&&delete p[o],p[o]=="All"&&delete p[o]}),w._orderBy!==""&&Object.assign(p,w),Le(p),V.next=10,R.Z.get(d.url,(0,c.Z)({},p));case 10:return J=V.sent,_e&&_e(J.data.content),i&&i(p),s&&s(!1),z&&z(J.data.totalElements),V.abrupt("return",{data:J.data.content,success:J.success,total:J.data.totalElements});case 16:case"end":return V.stop()}},he)}));return function(he,W,de){return ve.apply(this,arguments)}}(),rowKey:b,pagination:{pageSize:xe,showSizeChanger:!0,onChange:function(he,W){Ze(W)}},toolBarRender:function(){return S},rowSelection:H,params:ee,expandable:ce,dateFormatter:L,tableAlertOptionRender:X,toolbar:h,onRow:q,beforeSearchSubmit:D,onReset:fe,onSubmit:Ee,search:_,editable:Te,footer:pe,columnsState:{persistenceKey:De,persistenceType:"localStorage"}})}},89101:function(Y,P,e){"use strict";e.r(P);var u=e(39428),c=e(3182),g=e(57663),E=e(71577),M=e(34792),R=e(48086),v=e(2824),K=e(30202),t=e(37476),x=e(952),Z=e(5966),B=e(8214),T=e(64317),O=e(71906),r=e(37490),C=e(54493),d=e(67294),D=e(63863),A=e(22),h=e(35562),f=e(51042),I=e(21010),n=e(85893);P.default=function(){var b=(0,d.useRef)(),m=(0,d.useRef)(),S=(0,d.useState)(!1),j=(0,v.Z)(S,2),L=j[0],y=j[1],H=(0,I.tT)("@@initialState"),$=H.initialState,ce=(0,d.useState)(0),G=(0,v.Z)(ce,2),X=G[0],q=G[1],k=(0,d.useState)([]),ee=(0,v.Z)(k,2),te=ee[0],me=ee[1],re=(0,d.useState)(!1),ae=(0,v.Z)(re,2),N=ae[0],pe=ae[1],se=function(){b.current.reload()},fe=function(a){var s;if(!a.projectId){R.default.error("\u8BF7\u9009\u62E9\u9879\u76EE");return}a.isInWhiteList===void 0&&(a.isInWhiteList=!1);var l={p:a.projectId[a.projectId.length-1]};l.t=X,l.u=$==null||(s=$.currentUser)===null||s===void 0?void 0:s.userid,N&&(l.classType=N.classType,l.examType=N.examType,l.classYear=N.classYear,l.receivable=N.receivable,l.t="3"),console.log(l),D.Z.post2("/sms/business/bizFile/createWeChatMiniQRCode",{fileName:a.fileName},l).then(function(_){_.status=="success"&&(y(!1),se())})},ne=[{title:"\u9879\u76EE\u4E8C\u7EF4\u7801",dataIndex:"name",sorter:!0},{title:"\u8BF4\u660E",dataIndex:"description",sorter:!0},{title:"\u4E0A\u4F20\u65F6\u95F4",dataIndex:"updateTime",sorter:!0,valueType:"dateRange",render:function(a,s){return(0,n.jsx)("span",{children:s.updateTime})}},{title:"\u64CD\u4F5C",render:function(a,s){return[(0,n.jsx)(E.Z,{type:"primary",style:{marginRight:"10px"},size:"small",onClick:function(){s.files.split(",").forEach(function(_,U){var ue=s.name+_.slice(_.indexOf("."));(0,h.Z)("/sms/business/bizFile/download",s.id,_,ue)})},children:"\u4E0B\u8F7D"})]}}],Ee={updateTime:"desc"},oe=[(0,n.jsx)(E.Z,{type:"primary",icon:(0,n.jsx)(f.Z,{}),onClick:function(){q(1),y(!0)},children:"\u5C0F\u7A0B\u5E8F\u5206\u4EAB\u4E8C\u7EF4\u7801"}),(0,n.jsx)(E.Z,{type:"primary",icon:(0,n.jsx)(f.Z,{}),onClick:function(){q(2),y(!0)},children:"\u8D44\u6599\u6536\u96C6\u4E8C\u7EF4\u7801"})],_e=function(){var a,s=m==null||(a=m.current)===null||a===void 0?void 0:a.getFieldsValue();if(s.JobClassExam){var l,_=JSON.parse(s.JobClassExam),U=r.Z.getCascaderName("dict_reg_job",_.project)+"/"+r.Z.getName("dict_class_type",_.classType)+"/"+r.Z.getName("dict_class_year",_.classYear)+"/"+r.Z.getName("dict_exam_type",_.examType);m==null||(l=m.current)===null||l===void 0||l.setFieldValue("fileName",U)}};function ie(i,a,s){return z.apply(this,arguments)}function z(){return z=(0,c.Z)((0,u.Z)().mark(function i(a,s,l){var _,U;return(0,u.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(a){F.next=2;break}return F.abrupt("return");case 2:return F.next=4,D.Z.get("/sms/business/bizChargeStandard?project="+a[a.length-1]+"&useNum=0&_size=999&enable=true");case 4:_=F.sent.data.content,U=le(_),console.log("arr",U),me(U);case 8:case"end":return F.stop()}},i)})),z.apply(this,arguments)}function le(i){var a=[];return i.forEach(function(s){a.push({label:r.Z.getName("dict_class_type",s.classType)+"/"+r.Z.getName("dict_exam_type",s.examType)+"/"+r.Z.getName("dict_class_year",s.classYear),value:JSON.stringify({classType:s.classType,examType:s.examType,classYear:s.classYear,receivable:s.receivable,project:s.project})})}),a}return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(O.ZP,{title:"\u4E8C\u7EF4\u7801",children:[(0,n.jsx)(K.ZP,{children:(0,n.jsx)(A.Z,{actionRef:b,columns:ne,request:{url:"/sms/business/bizFile",sortList:Ee,params:{type:1}},toolBarRender:oe})}),(0,n.jsx)(t.Y,{visible:L,formRef:m,modalProps:{destroyOnClose:!0,onCancel:function(){return y(!1)}},onFinish:function(){var i=(0,c.Z)((0,u.Z)().mark(function a(s){return(0,u.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,fe(s);case 2:case"end":return _.stop()}},a)}));return function(a){return i.apply(this,arguments)}}(),children:(0,n.jsxs)(x.ZP.Group,{children:[(0,n.jsx)(Z.Z,{name:"fileName",placeholder:"\u6587\u4EF6\u540D\u79F0",label:"\u6587\u4EF6\u540D\u79F0",rules:[{required:!0,message:"\u6587\u4EF6\u540D\u79F0"}]}),(0,n.jsx)(B.Z,{width:"sm",name:"projectId",placeholder:"\u54A8\u8BE2\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:r.Z.getCascader("dict_reg_job"),showSearch:{filter:C.Z},onSearch:function(a){return console.log(a)},onChange:function(a){return ie(a,"change")}}}),(0,n.jsx)(T.Z,{label:"\u73ED\u578B\u9009\u62E9",name:"JobClassExam",hidden:X==1,fieldProps:{options:te,showSearch:!0,onChange:function(a){},onSearch:function(a){},filterOption:function(a,s){var l,_;return((l=s.children)===null||l===void 0||(_=l.props)===null||_===void 0?void 0:_.label.indexOf(a))>=0},onSelect:function(a){_e(),pe(JSON.parse(a))}},width:"sm"})]})})]})})}},35562:function(Y,P,e){"use strict";var u=e(39428),c=e(11849),g=e(3182),E=sessionStorage.getItem("tokenName"),M=sessionStorage.getItem("tokenValue"),R={};R[E]=M;var v=function(){var K=(0,g.Z)((0,u.Z)().mark(function t(x,Z,B){var T,O,r,C,d,D=arguments;return(0,u.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return T=D.length>3&&D[3]!==void 0?D[3]:"look",O=B.split(","),r=[],C={pdfUrl:[],imgUrl:[]},O.forEach(function(f){r.push(new Promise(function(I){fetch(x+"?id="+Z+"&fileName="+f,{method:"GET",headers:(0,c.Z)((0,c.Z)({},R),{},{"Content-Type":"application/x-www-form-urlencoded"})}).then(function(n){n.blob().then(function(b){if(T=="look"){var m;f.indexOf("pdf")>=0?m=new Blob([b],{type:"application/pdf;charset=utf-8"}):m=new Blob([b]);var S=new FileReader;S.readAsDataURL(m),S.onload=function(H){I(S.result)}}else{var j=window.URL.createObjectURL(b),L=document.createElement("a");document.body.appendChild(L);var y="\u9644\u4EF6";L.href=j,L.download=y,L.target="_blank",L.click(),L.remove()}})})}))}),h.next=7,Promise.all(r);case 7:return d=h.sent,d.forEach(function(f){f.indexOf("application/pdf")>=0?C.pdfUrl.push(f):C.imgUrl.push(f)}),h.abrupt("return",C);case 10:case"end":return h.stop()}},t)}));return function(x,Z,B){return K.apply(this,arguments)}}();P.Z=v},54493:function(Y,P){"use strict";var e=function(c,g){return g.some(function(E){return E.label.toLowerCase().indexOf(c.toLowerCase())>-1})};P.Z=e}}]);
