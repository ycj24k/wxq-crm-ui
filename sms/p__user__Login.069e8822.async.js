(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9531],{63434:function(te,J,s){"use strict";var pe=s(63185),R=s(9676),M=s(28991),I=s(81253),l=s(85893),y=s(96202),B=s(67294),L=s(71436),ne=s(53048),ue=["options","fieldProps","proFieldProps","valueEnum"],v=B.forwardRef(function(h,A){var D=h.options,E=h.fieldProps,X=h.proFieldProps,q=h.valueEnum,U=(0,I.Z)(h,ue);return(0,l.jsx)(ne.Z,(0,M.Z)({ref:A,valueType:"checkbox",valueEnum:(0,y.h)(q,void 0),fieldProps:(0,M.Z)({options:D},E),lightProps:(0,M.Z)({labelFormatter:function(){return(0,l.jsx)(ne.Z,(0,M.Z)({ref:A,valueType:"checkbox",mode:"read",valueEnum:(0,y.h)(q,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,M.Z)({options:D},E),proFieldProps:X},U))}},U.lightProps),proFieldProps:X},U))}),d=B.forwardRef(function(h,A){var D=h.fieldProps,E=h.children;return(0,l.jsx)(R.Z,(0,M.Z)((0,M.Z)({ref:A},D),{},{children:E}))}),oe=(0,L.G)(d,{valuePropName:"checked"}),Q=oe;Q.Group=v,J.Z=Q},34687:function(te){te.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",icon:"icon___rzGKO"}},32384:function(){},3459:function(te,J,s){"use strict";s.r(J),s.d(J,{default:function(){return ye}});var pe=s(18106),R=s(63885),M=s(34792),I=s(48086),l=s(39428),y=s(11849),B=s(3182),L=s(2824),ne=s(17462),ue=s(76772),v=s(28991),d=s(67294),oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},Q=oe,h=s(27029),A=function(p,c){return d.createElement(h.Z,(0,v.Z)((0,v.Z)({},p),{},{ref:c,icon:Q}))},D=d.forwardRef(A),E=D,X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M744 62H280c-35.3 0-64 28.7-64 64v768c0 35.3 28.7 64 64 64h464c35.3 0 64-28.7 64-64V126c0-35.3-28.7-64-64-64zm-8 824H288V134h448v752zM472 784a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"mobile",theme:"outlined"},q=X,U=function(p,c){return d.createElement(h.Z,(0,v.Z)((0,v.Z)({},p),{},{ref:c,icon:q}))},ve=d.forwardRef(U),Pe=ve,ge=s(89366),ke=s(84305),Fe=s(88182),Ze=s(81253),e=s(85893),xe=s(57863),be=s(5894),we=s(32384),je=["logo","message","contentStyle","title","subTitle","actions","children"];function Me(g){var p,c=g.logo,_=g.message,ee=g.contentStyle,V=g.title,z=g.subTitle,O=g.actions,le=g.children,m=(0,Ze.Z)(g,je),P=(0,xe.YB)(),se=m.submitter===!1?!1:(0,v.Z)((0,v.Z)({searchConfig:{submitText:P.getMessage("loginForm.submitText","\u767B\u5F55")}},m.submitter),{},{submitButtonProps:(0,v.Z)({size:"large",style:{width:"100%"}},(p=m.submitter)===null||p===void 0?void 0:p.submitButtonProps),render:function(w,b){var W,me=b.pop();if(typeof(m==null||(W=m.submitter)===null||W===void 0?void 0:W.render)=="function"){var T,N;return m==null||(T=m.submitter)===null||T===void 0||(N=T.render)===null||N===void 0?void 0:N.call(T,w,b)}return me}}),de=(0,d.useContext)(Fe.ZP.ConfigContext),re=de.getPrefixCls("pro-form-login"),F=function(w){return"".concat(re,"-").concat(w)},k=(0,d.useMemo)(function(){return c?typeof c=="string"?(0,e.jsx)("img",{src:c}):c:null},[c]);return(0,e.jsxs)("div",{className:F("container"),children:[(0,e.jsxs)("div",{className:F("top"),children:[V||k?(0,e.jsxs)("div",{className:F("header"),children:[k?(0,e.jsx)("span",{className:F("logo"),children:k}):null,V?(0,e.jsx)("span",{className:F("title"),children:V}):null]}):null,z?(0,e.jsx)("div",{className:F("desc"),children:z}):null]}),(0,e.jsxs)("div",{className:F("main"),style:(0,v.Z)({width:328},ee),children:[(0,e.jsxs)(be.A,(0,v.Z)((0,v.Z)({isKeyPressSubmit:!0},m),{},{submitter:se,children:[_,le]})),O?(0,e.jsx)("div",{className:F("other"),children:O}):null]})]})}var x=s(5966),Be=s(63434),Ee=s(37476),t=s(21010),ie=s(63863),Se=s(34687),S=s.n(Se),Ce=function(p){var c=p.content;return(0,e.jsx)(ue.Z,{style:{marginBottom:24},message:c,type:"error",showIcon:!0})},Ie=function(){var p=(0,d.useState)({}),c=(0,L.Z)(p,2),_=c[0],ee=c[1],V=(0,d.useState)("account"),z=(0,L.Z)(V,2),O=z[0],le=z[1],m=(0,t.tT)("@@initialState"),P=m.initialState,se=m.setInitialState,de=(0,d.useState)(!1),re=(0,L.Z)(de,2),F=re[0],k=re[1],ce=(0,d.useState)(),w=(0,L.Z)(ce,2),b=w[0],W=w[1],me=(0,d.useState)(),T=(0,L.Z)(me,2),N=T[0],Le=T[1],K=(0,t.YB)();(0,d.useEffect)(function(){ie.Z.get("/sms/public/getRegex").then(function(f){W(f.data)})},[]);var Oe=function(){var f=(0,B.Z)((0,l.Z)().mark(function o(){var n,a;return(0,l.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,P==null||(n=P.fetchUserInfo)===null||n===void 0?void 0:n.call(P);case 2:if(a=i.sent,console.log("userInfo",a),!a){i.next=7;break}return i.next=7,se(function(C){return(0,y.Z)((0,y.Z)({},C),{},{currentUser:a})});case 7:return i.abrupt("return",a);case 8:case"end":return i.stop()}},o)}));return function(){return f.apply(this,arguments)}}(),Te=function(){var f=(0,B.Z)((0,l.Z)().mark(function o(n){var a,u,i,C,ae,H,Y,j,G,$,fe,Z,he;return(0,l.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(O!=="account"){r.next=36;break}return r.prev=1,r.next=4,ie.Z.get("/sms/public/login",{userName:n.username,password:n.password});case 4:if(a=r.sent,Le(a),localStorage.removeItem("tokenName"),localStorage.removeItem("tokenValue"),!(a.status=="success"||a.status=="ok")){r.next=29;break}return sessionStorage.setItem("tokenName",a.data.tokenName),sessionStorage.setItem("tokenValue",a.data.tokenValue),i=K.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),I.default.success(i),r.next=15,P==null||(u=P.fetchUserInfo)===null||u===void 0?void 0:u.call(P);case 15:if(C=r.sent,C.isReset){r.next=19;break}return k(!0),r.abrupt("return");case 19:if(!C){r.next=22;break}return r.next=22,se(function(De){return(0,y.Z)((0,y.Z)({},De),{},{currentUser:C})});case 22:if(t.m8){r.next=24;break}return r.abrupt("return");case 24:return ae=t.m8.location.query,H=ae,Y=H.redirect,t.m8.push(Y||"/"),setTimeout(function(){location.reload()},100),r.abrupt("return");case 29:ee(a),r.next=34;break;case 32:r.prev=32,r.t0=r.catch(1);case 34:r.next=64;break;case 36:return r.prev=36,r.next=39,ie.Z.post("/sms/public/login",{userName:n.username,password:n.password,mobile:n.mobile});case 39:if(j=r.sent,localStorage.removeItem("tokenName"),localStorage.removeItem("tokenValue"),!(j.status=="success"||j.status=="ok")){r.next=57;break}return sessionStorage.setItem("tokenName",j.data.tokenName),sessionStorage.setItem("tokenValue",j.data.tokenValue),sessionStorage,G=K.formatMessage({id:"pages.login.success",defaultMessage:"\u6CE8\u518C\u6210\u529F\uFF01"}),I.default.success(G),r.next=50,Oe();case 50:if(t.m8){r.next=52;break}return r.abrupt("return");case 52:return $=t.m8.location.query,fe=$,Z=fe.redirect,t.m8.push(Z||"/"),setTimeout(function(){location.reload()},100),r.abrupt("return");case 57:ee(j),r.next=64;break;case 60:r.prev=60,r.t1=r.catch(36),he=K.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),I.default.error(he);case 64:case"end":return r.stop()}},o,null,[[1,32],[36,60]])}));return function(n){return f.apply(this,arguments)}}(),Ne=_.status,Ae=_.type;return(0,e.jsx)("div",{className:S().container,children:(0,e.jsxs)("div",{className:S().content,children:[(0,e.jsxs)(Me,{logo:(0,e.jsx)("img",{alt:"logo",src:"./logo.svg"}),title:"\u6587\u661F\u68CB\u7BA1\u7406\u7CFB\u7EDF",subTitle:"\u7528\u5FC3\u670D\u52A1\u5B66\u5458",initialValues:{autoLogin:!0},onFinish:function(){var f=(0,B.Z)((0,l.Z)().mark(function o(n){return(0,l.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Te(n);case 2:case"end":return u.stop()}},o)}));return function(o){return f.apply(this,arguments)}}(),children:[(0,e.jsxs)(R.Z,{activeKey:O,onChange:le,children:[(0,e.jsx)(R.Z.TabPane,{tab:K.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},"account"),(0,e.jsx)(R.Z.TabPane,{tab:"\u65B0\u7528\u6237\u6CE8\u518C"},"mobile")]}),Ne==="error"&&Ae==="account"&&(0,e.jsx)(Ce,{content:K.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),O==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(x.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(ge.Z,{className:S().prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u8D26\u53F7...",rules:[{required:!0,message:(0,e.jsx)(t._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(x.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(E,{className:S().prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u5BC6\u7801...",rules:[{required:!0,message:(0,e.jsx)(t._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),O==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(x.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(Pe,{className:S().prefixIcon})},name:"mobile",rules:[{required:!0,message:(0,e.jsx)(t._H,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:b.mobile.value,message:(0,e.jsx)(t._H,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(x.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(ge.Z,{className:S().prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u8D26\u53F7...",rules:[{pattern:b.userName.value,message:"2-32\u4F4D\u9996\u5C3E\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,e.jsx)(x.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(E,{className:S().prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u5BC6\u7801...",rules:[{pattern:b.password.value,message:"\u5BC6\u7801\u957F\u5EA6\u4E3A8-16\u4F4D\u5B57\u6BCD\u52A0\u6570\u5B57\u7EC4\u5408"}]}),(0,e.jsx)(x.Z.Password,{name:"password1",fieldProps:{size:"large",prefix:(0,e.jsx)(E,{className:S().prefixIcon})},placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u60A8\u7684\u5BC6\u7801...",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"\u8BF7\u518D\u6B21\u8F93\u5165\u60A8\u7684\u5BC6\u7801..."},function(f){var o=f.getFieldValue;return{validator:function(a,u){return!u||o("password")===u?Promise.resolve():Promise.reject(new Error("\u4E24\u6B21\u5BC6\u7801\u8F93\u5165\u4E0D\u4E00\u81F4"))}}}]})]}),(0,e.jsx)("div",{style:{marginBottom:24},children:(0,e.jsx)(Be.Z,{noStyle:!0,name:"autoLogin",children:(0,e.jsx)(t._H,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})})})]}),(0,e.jsxs)(Ee.Y,{title:"\u4FEE\u6539\u5BC6\u7801",autoFocusFirstInput:!0,layout:"LAYOUT_TYPE_HORIZONTAL",onFinish:function(){var f=(0,B.Z)((0,l.Z)().mark(function o(n){var a;return(0,l.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:delete n.Passwords,a={},a[N.data.tokenName]=[N.data.tokenValue],console.log("userInfo",N),(0,t.WY)("/sms/user",{headers:a}).then(function(C){(0,t.WY)("/sms/user?id="+C.data.id+"&Password="+n.Password+"&oldPassword="+n.oldPassword,{method:"POST",headers:a}).then(function(){var ae=(0,B.Z)((0,l.Z)().mark(function H(Y){var j,G,$;return(0,l.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(Y.status!="success"){Z.next=11;break}if(I.default.success("\u4FEE\u6539\u6210\u529F\uFF01",5),k(!1),t.m8){Z.next=5;break}return Z.abrupt("return");case 5:j=t.m8.location.query,G=j,$=G.redirect,t.m8.push($||"/"),setTimeout(function(){location.reload()},100),Z.next=12;break;case 11:I.default.error(Y.msg);case 12:case"end":return Z.stop()}},H)}));return function(H){return ae.apply(this,arguments)}}())});case 5:case"end":return i.stop()}},o)}));return function(o){return f.apply(this,arguments)}}(),visible:F,children:[(0,e.jsx)(x.Z.Password,{label:"\u65E7\u5BC6\u7801",name:"oldPassword",width:"lg",rules:[{required:!0}]}),(0,e.jsx)(x.Z.Password,{label:"\u65B0\u5BC6\u7801",name:"Password",width:"lg",hasFeedback:!0,placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u5BC6\u7801...",rules:[{required:!0,pattern:b==null?void 0:b.password.value,message:"\u5BC6\u7801\u957F\u5EA6\u4E3A8-16\u4F4D\u5B57\u6BCD\u52A0\u6570\u5B57\u7EC4\u5408"}]}),(0,e.jsx)(x.Z.Password,{label:"\u786E\u8BA4\u65B0\u5BC6\u7801",placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u60A8\u7684\u5BC6\u7801...",dependencies:["Password"],hasFeedback:!0,name:"Passwords",width:"lg",rules:[{required:!0,message:"\u8BF7\u518D\u6B21\u8F93\u5165\u60A8\u7684\u5BC6\u7801..."},function(f){var o=f.getFieldValue;return{validator:function(a,u){return!u||o("Password")===u?Promise.resolve():Promise.reject(new Error("\u4E24\u6B21\u5BC6\u7801\u8F93\u5165\u4E0D\u4E00\u81F4"))}}}]})]})]})})},ye=Ie}}]);
