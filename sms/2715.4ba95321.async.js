(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2715],{50717:function(ce,D,e){"use strict";var j=e(13062),g=e(71230),V=e(57663),o=e(71577),I=e(39428),i=e(3182),A=e(32059),m=e(2824),L=e(5966),M=e(67294),d=e(63863),J=e(14037),ne=e(21010),X=e(85893),x=null;D.Z=(0,M.forwardRef)(function(F,f){var P,r,p=F.label,O=F.name,c=F.setUserNameId,a=F.userName,h=F.formRefs,ie=F.userNameChange,Ee=ie===void 0?!1:ie,s=(0,ne.tT)("@@initialState"),le=s.initialState,$=(0,M.useState)(),bt=(0,m.Z)($,2),pe=bt[0],Ct=bt[1],gt=(0,M.useState)(!1),et=(0,m.Z)(gt,2),ae=et[0],ut=et[1],ot=(0,M.useState)({name:le==null||(P=le.currentUser)===null||P===void 0?void 0:P.name,id:le==null||(r=le.currentUser)===null||r===void 0?void 0:r.userid}),tr=(0,m.Z)(ot,2),he=tr[0],Ft=tr[1];(0,M.useImperativeHandle)(f,function(){return{setDepartment:function(t){Ft(t)}}}),(0,M.useEffect)(function(){a&&Ft(a)},[]),(0,M.useEffect)(function(){var it;c(he),h==null||(it=h.current)===null||it===void 0||it.setFieldsValue((0,A.Z)({},O,he.name))},[he]);var gr=function(t){if(Ee)Ft({name:t,id:-1});else return};return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsxs)(g.Z,{children:[(0,X.jsx)(L.Z,{name:O,label:p,width:"sm",fieldProps:{value:he.name,onChange:function(t){gr(t.target.value)}},rules:[{required:!0}]}),(0,X.jsx)(o.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,i.Z)((0,I.Z)().mark(function it(){return(0,I.Z)().wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:if(x){Ye.next=4;break}return Ye.next=3,d.Z.get("/sms/share/getDepartmentAndUser");case 3:x=Ye.sent;case 4:Ct({content:x.data,type:"order"}),ut(!0);case 6:case"end":return Ye.stop()}},it)})),children:"\u9009\u62E9"})]}),ae&&(0,X.jsx)(J.Z,{CardVisible:ae,CardContent:pe,setCardVisible:function(){return ut(!1)},setDepartment:function(t){return Ft(t)},departments:[he]})]})})},42025:function(ce,D,e){"use strict";var j=e(39428),g=e(3182),V=e(34792),o=e(48086),I=e(11849),i=e(67294),A=e(37476),m=e(952),L=e(90672),M=e(63863),d=e(85893);D.Z=function(J){var ne=J.modalVisible,X=J.setModalVisible,x=J.callbackRef,F=J.renderData,f=J.callback;console.log("renderData",F);var P=(0,i.useRef)(),r=function(O){var c=0;if(F.type!=0&&(c=F!=null&&F.auditNum?(F==null?void 0:F.auditNum)+1:1),O.confirm=F.confirm,O.entityId=F.id,O.entityId instanceof Array){for(var a=[],h=0;h<O.entityId.length;h++)a[h]=(0,I.Z)((0,I.Z)({},O),{},{entityId:O.entityId[h]});O=a}else O=[O];return new Promise(function(ie){M.Z.postAll("/sms/business/bizAudit/audits/"+c,O).then(function(Ee){Ee.status=="success"&&(o.default.success("\u64CD\u4F5C\u6210\u529F"),X(),x(),ie(!0))}).catch(function(Ee){ie(!0)})})};return(0,d.jsx)(A.Y,{title:"\u5BA1\u6838\u610F\u89C1",formRef:P,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){X()},maskClosable:!1},onFinish:function(){var p=(0,g.Z)((0,j.Z)().mark(function O(c){return(0,j.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,r(c);case 2:case"end":return h.stop()}},O)}));return function(O){return p.apply(this,arguments)}}(),visible:ne,children:(0,d.jsx)(m.ZP.Group,{children:(0,d.jsx)(L.Z,{label:"\u5BA1\u6838\u610F\u89C1",name:"remark",width:"lg",rules:[{required:!F.confirm,message:"\u8BF7\u8F93\u5165\u672A\u901A\u8FC7\u539F\u56E0"}]})})})}},98580:function(ce,D,e){"use strict";var j=e(20228),g=e(11382),V=e(57338),o=e(273),I=e(49111),i=e(19650),A=e(71194),m=e(50146),L=e(66456),M=e(15885),d=e(32059),J=e(54029),ne=e(79166),X=e(62350),x=e(24565),F=e(34792),f=e(48086),P=e(86582),r=e(22385),p=e(94199),O=e(39428),c=e(3182),a=e(71153),h=e(60331),ie=e(11849),Ee=e(57663),s=e(71577),le=e(2824),$=e(67294),bt=e(51042),pe=e(1870),Ct=e(40110),gt=e(8212),et=e(82061),ae=e(79189),ut=e(63863),ot=e(37490),tr=e(9686),he=e(38282),Ft=e(73230),gr=e(7903),it=e(41574),t=e(42025),Ye=e(22),l=e(66573),u=e(79046),b=e(7339),n=e(91566),ht=e(54493),jr=e(37476),$e=e(31199),sr=e(80876),Y=e(181),Dt=e(76294),re=e(25607),Xt=e(47038),B=e(37423),Z=e(85893);D.Z=function(nr){var De=nr.admin,xr=nr.studentUserId,zt=xr===void 0?!1:xr,Ut=nr.studentType,Gt=Ut===void 0?"0":Ut,kt=nr.type,Kt=kt===void 0?"0":kt,Bt=nr.auditType,Ie=Bt===void 0?"":Bt,Ot=nr.chargeType,Je=Ot===void 0?"charge":Ot,jt=nr.chargeBtn,_t=nr.chargeTypes,at=nr.setChargeModal,Ht=nr.setChargeInfo,qt=nr.setModalsCharge,yr=qt===void 0?void 0:qt,Zr=nr.setChargeList,_e=nr.formParam,or=_e===void 0?{}:_e,Zt={enable:!0},Fe=or;Zt.type=Kt,Je=="refundList"?(delete Zt.type,Zt["type-in"]="1,3"):Je=="chargeList"&&(Zt["type-in"]="0,2,4,5,6",Zt["userId-isNull"]=!1,delete Zt.type);var vt=(0,$.useRef)(),Qe=(0,$.useRef)(),Be=ot.Z.getDepartmentTree(),Mt=(0,$.useState)(!1),fr=(0,le.Z)(Mt,2),Ue=fr[0],vr=fr[1],Tt=(0,$.useState)(!1),Pe=(0,le.Z)(Tt,2),ze=Pe[0],Ae=Pe[1],Rt=(0,$.useState)(!1),S=(0,le.Z)(Rt,2),Xe=S[0],we=S[1],qe=(0,$.useState)(!1),Yt=(0,le.Z)(qe,2),Te=Yt[0],N=Yt[1],y=(0,$.useState)(!1),W=(0,le.Z)(y,2),k=W[0],xe=W[1],ye=(0,$.useState)(!1),Ne=(0,le.Z)(ye,2),je=Ne[0],q=Ne[1],G=(0,$.useState)(!0),K=(0,le.Z)(G,2),Et=K[0],yt=K[1],er=(0,$.useState)(!1),Se=(0,le.Z)(er,2),Vt=Se[0],Nt=Se[1],tt=(0,$.useState)(Fe),ir=(0,le.Z)(tt,2),wt=ir[0],Or=ir[1],We=(0,$.useState)(!1),Le=(0,le.Z)(We,2),ve=Le[0],st=Le[1],ct=(0,$.useState)(!1),br=(0,le.Z)(ct,2),_r=br[0],Fr=br[1],Ir=(0,$.useState)(null),Ar=(0,le.Z)(Ir,2),Ge=Ar[0],Pr=Ar[1],wr=(0,$.useState)(),Re=(0,le.Z)(wr,2),lt=Re[0],Ze=Re[1],cr=(0,$.useState)(!1),Q=(0,le.Z)(cr,2),ee=Q[0],T=Q[1],me=(0,$.useState)(!1),U=(0,le.Z)(me,2),Me=U[0],It=U[1],be=(0,$.useState)([0,0]),z=(0,le.Z)(be,2),He=z[0],Sr=z[1],Jt=(0,$.useState)(!1),mr=(0,le.Z)(Jt,2),Er=mr[0],H=mr[1],w=(0,$.useState)(),C=(0,le.Z)(w,2),Oe=C[0],Ce=C[1],nt=(0,$.useState)({}),pr=(0,le.Z)(nt,2),Qt=pr[0],mt=pr[1],hr=(0,$.useState)(!1),Lr=(0,le.Z)(hr,2),Br=Lr[0],Vr=Lr[1],Wr="/sms/business/bizCharge",rr="/sms/business/bizStudentUser",Nr=(0,$.forwardRef)(Dt.Z),tu=De?[(0,Z.jsx)(s.Z,{icon:(0,Z.jsx)(bt.Z,{}),type:"primary",onClick:function(){Pr({type:"add"}),Ae(!0)},children:"\u65B0\u589E"},"button-charge")]:[],Tr=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;vt.current.reloadAndRest(),R&&Je=="refund"&&lr(),R&&Je=="charge"&&Xr()},lr=function(){var R=Gt!="all"?{studentType:Gt}:{};ut.Z.get("/sms/business/bizCharge/statistics",{array:JSON.stringify([(0,ie.Z)((0,ie.Z)({type:1},R),{},{"auditNum-isNull":!0,isSubmit:!0}),(0,ie.Z)((0,ie.Z)({auditNum:"1",type:1},R),{},{isSubmit:!0}),(0,ie.Z)((0,ie.Z)({auditNum:"2",type:1},R),{},{isSubmit:!0}),(0,ie.Z)((0,ie.Z)({auditNum:"3",type:1},R),{},{isSubmit:!0}),{enable:!0,type:1,isSubmit:!1}])}).then(function(v){Sr(v.data)})},Xr=function(){var R=Gt!="all"?{studentType:Gt}:{};ut.Z.get("/sms/business/bizCharge/statistics",{array:JSON.stringify([(0,ie.Z)((0,ie.Z)({type:0},R),{},{"auditType-isNull":!0})])}).then(function(v){Sr(v.data)})};(0,$.useEffect)(function(){Tr()},[Gt,Ie]),(0,$.useEffect)(function(){Je=="refund"&&Or({"auditNum-isNull":!0,enable:!0,isSubmit:!0})},[]),(0,$.useEffect)(function(){Ge!=null&&Ge.performanceAmount&&setTimeout(function(){var _;(_=Qe.current)===null||_===void 0||_.setFieldsValue({performanceAmount:Ge.performanceAmount})},100)},[Me]);var ru=function(R){if(R=="max"){var v;(v=Qe.current)===null||v===void 0||v.setFieldsValue({performanceAmount:Ge.amount})}else{var ft;(ft=Qe.current)===null||ft===void 0||ft.setFieldsValue({performanceAmount:0})}},uu=function(R){var v="";return(R=="refund"||R=="refundList")&&(v="-"),v},su=[{title:"\u7F16\u53F7",dataIndex:"num",width:100,fixed:"left",sorter:!0},{title:"\u7B2C\u4E09\u65B9\u8BA2\u5355\u7F16\u53F7",dataIndex:"num2",hideInTable:!0,hideInSearch:Je=="refundList"||Je=="refund"},{title:"\u7F34\u8D39\u7C7B\u578B",dataIndex:"type",width:100,valueType:"select",key:"type",valueEnum:ot.Z.getSearch("chargeType")},{title:"\u5BA1\u6838\u72B6\u6001",dataIndex:"confirm",width:120,sorter:!0,filters:!0,hideInTable:Kt=="1",filterMultiple:!1,valueType:"select",valueEnum:{"":{text:(0,Z.jsx)(h.Z,{color:"#f50",children:"\u672A\u5BA1\u6838"}),status:"Processing"},false:{text:(0,Z.jsx)(h.Z,{color:"#FF0000",children:"\u672A\u901A\u8FC7"}),status:"Error"},true:{text:(0,Z.jsx)(h.Z,{color:"#87d068",children:"\u5DF2\u5BA1\u6838"}),status:"Success"}},formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},render:function(R,v){return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(h.Z,{color:v.confirm===!0?"#87d068":v.confirm===!1?"#FF0000":"#f50",children:[v.confirm===!0?"\u5BA1\u6838\u901A\u8FC7":v.confirm===!1?"\u672A\u901A\u8FC7":"\u672A\u5BA1\u6838",v.confirm===!1&&v.isSubmit&&",\u5DF2\u91CD\u65B0\u63D0\u4EA4"]}),(0,Z.jsx)("br",{}),v.confirm===!1&&!v.isSubmit&&":"+v.remark]})}},{title:"\u6536\u8D39\u90E8\u95E8",dataIndex:"departmentId-in",width:100,valueType:"treeSelect",request:function(){var _=(0,c.Z)((0,O.Z)().mark(function v(){return(0,O.Z)().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Lt.abrupt("return",Be);case 1:case"end":return Lt.stop()}},v)}));function R(){return _.apply(this,arguments)}return R}(),render:function(R,v){return(0,Z.jsx)(Z.Fragment,{children:ot.Z.getDepartmentName(v.departmentId).reverse().slice(1).join("-")})}},{title:"\u5B66\u5458",dataIndex:"studentName",width:80,fixed:"left",sorter:!0,render:function(R,v){return(0,Z.jsxs)("a",{onClick:function(){ut.Z.get(rr,{id:v.studentUserId}).then(function(Lt){Pr((0,ie.Z)((0,ie.Z)({},Lt.data.content[0]),{},{admin:De})),Fr(!0)})},children:[v.studentName,v.isPeer&&(0,Z.jsx)(h.Z,{color:"#87CEEB",children:"\u540C\u884C\u4F01\u4E1A"}),!v.enable&&(0,Z.jsx)(h.Z,{color:"red",children:"\u5DF2\u5E9F\u9664"})]})}},{title:"\u662F\u5426\u662F\u540C\u884C\u4F01\u4E1A",dataIndex:"isPeer",valueType:"select",key:"isPeer",valueEnum:{false:"\u5426",true:"\u662F"},hideInTable:!0},{title:Je=="refundList"||Je=="refund"?"\u9000\u8D39\u65E5\u671F":"\u6536\u8D39\u65E5\u671F",key:"chargeTime",sorter:!0,width:120,dataIndex:"chargeTime",valueType:"dateRange",render:function(R,v){return(0,Z.jsx)("span",{children:v.chargeTime})}},{title:"\u5230\u8D26\u65E5\u671F",key:"paymentTime",sorter:!0,width:120,dataIndex:"paymentTime",valueType:"dateRange",render:function(R,v){return(0,Z.jsx)("span",{children:v.paymentTime})}},{title:(0,Z.jsxs)(Z.Fragment,{children:["\u5BA1\u6838\u8FDB\u5EA6",(0,Z.jsx)(p.Z,{placement:"top",title:"\u9000\u8D39\u5BA1\u6838\u6D41\u7A0B\uFF1A \u2460\u6559\u52A1\u8D1F\u8D23\u4EBA\u5BA1\u6838 \u2192 \u2461\u6559\u52A1\u4E3B\u7BA1\u5BA1\u6838 \u2192\u2462\u8D22\u52A1\u4E3B\u7BA1\u5BA1\u6838 \u2192\u2463\u603B\u7ECF\u529E\u5BA1\u6838",children:(0,Z.jsx)(pe.Z,{style:{marginLeft:4}})})]}),dataIndex:"auditType",hideInTable:Kt==0,filters:!0,filterMultiple:!1,valueType:"select",width:180,align:"center",valueEnum:{"-isNull":{text:"\u6559\u52A1\u4E3B\u7BA1"},"1":{text:"\u6559\u52A1\u8D1F\u8D23\u4EBA"},"2":{text:"\u8D22\u52A1"},"3":{text:"\u603B\u7ECF\u529E"}},render:function(R,v){return(0,Z.jsx)("span",{children:v.confirm===!1?(0,Z.jsx)(h.Z,{color:"#FF0000",children:v.isSubmit&&"\u5DF2\u91CD\u65B0\u63D0\u4EA4"||ot.Z.getCascaderName("auditType",v.auditType)+"\u672A\u901A\u8FC7"}):(0,Z.jsx)(h.Z,{color:v.auditNum==4?"#87d068":"#f50",children:v.auditNum==4?"\u9000\u8D39\u5B8C\u6210":ot.Z.getCascaderName("auditType",v!=null&&v.auditNum?v.auditNum+1:1)})})}},{title:"\u9879\u76EE\u603B\u79F0",dataIndex:"parentProjects",key:"parentProjects",sorter:!0,valueType:"cascader",fieldProps:{options:ot.Z.getList("dict_reg_job"),showSearch:{filter:ht.Z}},width:120,render:function(R,v){return(0,Z.jsx)("span",{children:ot.Z.getCascaderAllName("dict_reg_job",v.project)},"parentProjects")}},{title:Je=="refundList"||Je=="refund"?"\u9000\u8D39\u9879\u76EE":"\u6536\u8D39\u9879\u76EE",dataIndex:"project",width:150,key:"project",sorter:!0,valueType:"cascader",fieldProps:{options:ot.Z.getCascader("dict_reg_job"),showSearch:{filter:ht.Z}},render:function(R,v){return(0,Z.jsx)("span",{children:v.project&&(0,P.Z)(new Set(v.project.split(","))).map(function(ft,Lt){return(0,Z.jsxs)("span",{children:[ot.Z.getCascaderName("dict_reg_job",ft)," ",(0,Z.jsx)("br",{})]},"project-".concat(ft,"-").concat(Lt))})})}},{title:"\u8003\u8BD5\u7C7B\u578B",sorter:!0,width:100,dataIndex:"examType",valueEnum:ot.Z.getSearch("dict_exam_type"),render:function(R,v){return(0,Z.jsx)(Z.Fragment,{children:ot.Z.getName("dict_exam_type",v.examType)})}},{title:Je=="chargeList"?"\u6536\u8D39\u91D1\u989D":"\u9000\u8D39\u91D1\u989D",dataIndex:"amount",sorter:!0,width:100,search:!1},{title:Je=="refundList"||Je=="refund"?"\u9000\u8D39\u65B9\u5F0F":"\u6536\u8D39\u65B9\u5F0F",dataIndex:"method",width:80,valueType:"select",valueEnum:ot.Z.getSearch("dict_stu_refund_type"),render:function(R,v){return(0,Z.jsx)("span",{children:ot.Z.getCascaderName("dict_stu_refund_type",v.method)})}},{title:"\u9000\u6B3E\u7C7B\u578B",dataIndex:"refundType",width:80,valueType:"select",hideInTable:Je!="refundList"&&Je!="refund",valueEnum:ot.Z.getSearch("dict_refundType"),render:function(R,v){return(0,Z.jsx)("span",{children:ot.Z.getCascaderName("dict_refundType",v.refundType)})}},{title:"\u5907\u6CE8",dataIndex:"description",width:150},{title:"\u8D22\u52A1\u6458\u8981",width:150,dataIndex:"description2"},{title:Je=="refundList"||Je=="refund"?"\u9000\u8D39\u4EBA":"\u6536\u8D39\u4EBA",dataIndex:"userName",width:80},{title:"\u4FE1\u606F\u63D0\u4F9B\u4EBA",dataIndex:"providerName",width:80},{title:"\u4FE1\u606F\u6240\u6709\u4EBA",dataIndex:"ownerName",width:80,render:function(R,v){return(0,Z.jsxs)("div",{children:[v.ownerName,(0,Z.jsx)("span",{children:v.ownerName&&"("+v.percent*100+"%)"})]})}},{title:"\u7ECF\u529E\u4EBA",dataIndex:"agentName",hideInTable:Je!="refundList"&&Je!="refund",width:80},{title:"\u53D1\u7968\u4FE1\u606F",width:80,sorter:!0,dataIndex:"hasInvoice",render:function(R,v){return(0,Z.jsx)(Z.Fragment,{children:v.hasInvoice?(0,Z.jsx)(s.Z,{type:"primary",size:"small",icon:(0,Z.jsx)(Ct.Z,{}),onClick:function(){var ft=(0,c.Z)((0,O.Z)().mark(function Lt(ur){return(0,O.Z)().wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:Pr((0,ie.Z)((0,ie.Z)({},v),{},{types:"charges"})),Nt(!0);case 2:case"end":return dr.stop()}},Lt)}));return function(Lt){return ft.apply(this,arguments)}}(),children:"\u67E5\u770B"},"hasInvoicelook"):""})}},{title:"\u4E1A\u7EE9\u91D1\u989D",dataIndex:"performanceAmount",width:100,order:8,render:function(R,v,ft,Lt){return(0,Z.jsxs)(Z.Fragment,{children:[uu(Je),v.performanceAmount?v.performanceAmount:0,(0,Z.jsx)("a",{onClick:function(){Pr(v),It(!0)},children:"\u4FEE\u6539"})]})}},{title:"\u5DF2\u5F00\u7968\u91D1\u989D",dataIndex:"usedAmount",width:80},{title:"\u5BA1\u6838\u4EBA",dataIndex:"auditor",width:80},{title:"\u5BA1\u6838\u65F6\u95F4",key:"auditTime",sorter:!0,width:120,dataIndex:"auditTime",valueType:"dateRange",render:function(R,v){return(0,Z.jsx)("span",{children:v.auditTime})}},{title:"\u5BA1\u6838\u5EFA\u8BAE",dataIndex:"remark",width:150,search:!1,sorter:!0},{title:"\u662F\u5426\u5E9F\u9664",dataIndex:"enable",filters:!0,hideInTable:!0,sorter:!0,filterMultiple:!1,valueType:"select",valueEnum:{false:{text:"\u5DF2\u5E9F\u9664",status:"Error"},true:{text:"\u672A\u5E9F\u9664",status:"Success"}}},{title:"\u5BA1\u6838\u5458",dataIndex:"auditor",search:!1,sorter:!0},{title:"\u64CD\u4F5C",valueType:"option",key:"options",fixed:"right",hideInTable:!_t,render:function(R,v){return(0,Z.jsx)(s.Z,{type:"primary",onClick:function(){Ht(v),at(!1)},children:"\u9009\u62E9"})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",fixed:"right",width:120,hideInTable:_t,render:function(R,v,ft,Lt){return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(s.Z,{type:"primary",size:"small",icon:(0,Z.jsx)(Ct.Z,{}),style:{marginRight:"10px",marginBottom:"8px"},onClick:function(){var ur=(0,c.Z)((0,O.Z)().mark(function dt(dr){return(0,O.Z)().wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:dr.stopPropagation(),v.type!=2&&v.type!=3?(Pr({orderId:v.orderId,type:Je}),Ae(!0)):(Pr(v),xe(!0));case 2:case"end":return $r.stop()}},dt)}));return function(dt){return ur.apply(this,arguments)}}(),children:"\u67E5\u770B"},"look-charge"),(0,Z.jsx)(s.Z,{type:"primary",size:"small",hidden:!v.isSubmit||Je!="refund",icon:(0,Z.jsx)(gt.Z,{}),style:{marginRight:"10px",marginBottom:"8px"},onClick:function(){Pr((0,ie.Z)((0,ie.Z)({},v),{},{types:"eidt",orderId:v.orderId})),N(!0)},children:"\u5BA1\u6838"},"editable-charge-1"),(0,Z.jsx)(s.Z,{type:"primary",size:"small",hidden:!!v.auditNum||!v.isSubmit||v.confirm||Je=="refund"||v.type==2||v.type==3,icon:(0,Z.jsx)(gt.Z,{}),style:{marginRight:"10px",marginBottom:"8px"},onClick:function(){ut.Z.get("/sms/business/bizOrder",{id:v.orderId}).then(function(dt){var dr=dt.data.content[0];if(!dr){f.default.error("\u6743\u9650\u4E0D\u8DB3\uFF0C\u65E0\u6CD5\u63D0\u4EA4");return}var Pt=[];dr.chargeId=v.id,Pt.push((0,ie.Z)((0,ie.Z)({},dr),v)),Pr({list:Pt,type:v.type==1?"orders":v.type}),we(!0)})},children:"\u7F16\u8F91"},"editable-charge-2"),(0,Z.jsx)(s.Z,{type:"primary",size:"small",hidden:v.isSubmit||v.type==2||v.type==3,icon:(0,Z.jsx)(gt.Z,{}),style:{marginRight:"10px",marginBottom:"8px"},onClick:function(){ut.Z.get("/sms/business/bizOrder",{id:v.orderId}).then(function(dt){var dr=dt.data.content[0];if(!dr){f.default.error("\u6743\u9650\u4E0D\u8DB3\uFF0C\u65E0\u6CD5\u63D0\u4EA4");return}var Pt=[];dr.chargeId=v.id,Pt.push((0,ie.Z)((0,ie.Z)({},dr),v)),Pr({list:Pt,type:v.type==1?"orders":v.type}),we(!0)})},children:"\u91CD\u65B0\u63D0\u4EA4"},"editable-charge-3"),(0,Z.jsx)(x.Z,{title:"\u662F\u5426\u5E9F\u9664\uFF1F",onConfirm:function(){var dt=v.auditNum===null?"/sms/business/bizCharge/unAuditDisable/":"/sms/business/bizCharge/disable/";ut.Z.post(dt+v.id).then(function(dr){dr.status=="success"&&(f.default.success("\u5E9F\u9664\u6210\u529F"),Tr())})},onCancel:function(){var dt=v.auditNum===null?"/sms/business/bizCharge/unAuditDisable/":"/sms/business/bizCharge/disable/";ut.Z.post(dt+v.id).then(function(dr){dr.status=="success"&&(v.type=="0"||v.type=="1"?ut.Z.post("/sms/business/bizOrder/disable/"+v.orderId).then(function(Pt){Pt.status=="success"&&(f.default.success("\u5E9F\u9664\u6210\u529F"),Tr())}):(f.default.success("\u5E9F\u9664\u6210\u529F"),Tr()))})},okText:"\u4EC5\u5E9F\u9664\u7F34\u8D39",cancelText:"\u540C\u6B65\u5E9F\u9664\u8BA2\u5355",children:(0,Z.jsx)(s.Z,{type:"primary",size:"small",style:{marginRight:"10px",marginBottom:"8px"},hidden:wt.confirm===!1||Je!="refund",danger:!0,icon:(0,Z.jsx)(et.Z,{}),children:"\u5E9F\u9664"},"delete")},v.id),(0,Z.jsx)(s.Z,{type:"primary",size:"small",icon:(0,Z.jsx)(ae.Z,{}),style:{marginRight:"10px",marginBottom:"8px"},hidden:Je=="refund"||Je=="refundList",onClick:(0,c.Z)((0,O.Z)().mark(function ur(){return(0,O.Z)().wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:(0,l.Z)("/sms/business/bizCharge/export/",v.id,void 0,".png");case 1:case"end":return dr.stop()}},ur)})),children:"\u5BFC\u51FA\u6536\u636E\u7167\u7247"},"dapchu-charge-1"),(0,Z.jsx)(s.Z,{type:"primary",size:"small",style:{marginRight:"10px",marginBottom:"8px"},icon:(0,Z.jsx)(ae.Z,{}),hidden:Je=="refund",onClick:(0,c.Z)((0,O.Z)().mark(function ur(){return(0,O.Z)().wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:Je=="refundList"?(0,l.Z)("/sms/business/bizCharge/export/2",v.id):(0,l.Z)("/sms/business/bizCharge/export/3",v.id);case 1:case"end":return dr.stop()}},ur)})),children:"\u5BFC\u51FA\u6536\u636EWord"},"dapchu-charge-2"),De?(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(x.Z,{title:"\u662F\u5426\u786E\u5B9A\u5220\u9664\uFF1F",onConfirm:function(){ut.Z.delete(Wr,{id:v.id}).then(function(dt){dt.status=="success"&&(f.default.success("\u5220\u9664\u6210\u529F"),Tr())})},okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",children:(0,Z.jsx)(s.Z,{type:"primary",size:"small",danger:!0,icon:(0,Z.jsx)(et.Z,{}),children:"\u5220\u9664"},"delete")},v.id)}):""]})}}],eu=void 0;Gt!="all"&&(Zt.studentType=Gt),zt&&(Zt.studentUserId=zt),Kt=="1"&&Je=="refund"&&(eu={menu:{type:"tab",items:[{key:"-isNull",label:(0,Z.jsx)(ne.Z,{count:He[0],size:"small",offset:[5,6],children:(0,Z.jsx)(s.Z,{size:"small",type:"link",disabled:Et,children:"\u2460\u6559\u52A1\u4E3B\u7BA1/\u5B66\u7C4D\u5BA1\u6838"})})},{key:"1",label:(0,Z.jsx)(ne.Z,{count:He[1],size:"small",offset:[5,6],children:(0,Z.jsx)(s.Z,{size:"small",type:"link",disabled:Et,children:"\u2461\u4E8B\u4E1A\u90E8\u8D1F\u8D23\u4EBA\u5BA1\u6838"})})},{key:"2",label:(0,Z.jsx)(ne.Z,{count:He[2],size:"small",offset:[5,6],children:(0,Z.jsx)(s.Z,{size:"small",type:"link",disabled:Et,children:"\u2462\u8D22\u52A1\u5BA1\u6838"})})},{key:"3",label:(0,Z.jsx)(ne.Z,{count:He[3],size:"small",offset:[5,6],children:(0,Z.jsx)(s.Z,{size:"small",type:"link",disabled:Et,children:"\u2463\u603B\u7ECF\u529E\u5BA1\u6838"})})},{key:"4",label:(0,Z.jsx)(s.Z,{size:"small",disabled:Et,type:"link",children:"\u9000\u8D39\u5217\u8868"})},{key:"false",label:(0,Z.jsx)(ne.Z,{count:He[4],size:"small",offset:[5,6],children:(0,Z.jsx)(s.Z,{size:"small",type:"link",disabled:Et,children:"\u5BA1\u6838\u672A\u901A\u8FC7"})})},{key:"enable",label:(0,Z.jsx)(s.Z,{size:"small",type:"dashed",danger:!0,disabled:Et,children:"\u5DF2\u5E9F\u9664"})}],onChange:function(R){yt(!0),R==="false"?Or({auditNum:"All",enable:!0,isSubmit:!1}):R==="-isNull"?Or({"auditNum-isNull":!0,enable:!0,isSubmit:!0}):R==="enable"?Or({enable:!1}):R=="4"?Or({}):Or({auditNum:R,enable:!0,isSubmit:!0}),Tr(!1)}}});var au=(0,d.Z)({},"confirm,auditNum,num,updateTime","asc,asc,desc,desc");_t&&(au=(0,d.Z)({},"updateTime","desc")),Object.assign(Zt,wt);var Ke=function(R){return Object.keys(R).length===0};return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsxs)(g.Z,{spinning:ve,children:[(0,Z.jsx)(Ye.Z,{columns:su,actionRef:vt,className:"Charge",cardBordered:!0,scroll:{x:1500},request:{url:Wr,params:_t?{type:0}:Zt,sortList:au},toolbar:eu,getData:function(R){delete R.current,delete R.pageSize,mt(R)},loding:function(R){return yt(R)},search:{defaultCollapsed:!0,labelWidth:120,defaultColsNumber:10},rowSelection:{selections:[M.Z.SELECTION_ALL,M.Z.SELECTION_INVERT],onChange:function(R,v){Pr(v[0])},preserveSelectedRowKeys:!0},tableAlertOptionRender:function(R){var v=R.selectedRowKeys,ft=R.selectedRows,Lt=R.onCleanSelected;return(0,Z.jsxs)(i.Z,{size:24,children:[(0,Z.jsx)("span",{children:(0,Z.jsx)(s.Z,{type:"primary",style:{marginInlineStart:8},onClick:Lt,children:"\u53D6\u6D88\u9009\u62E9"})}),(0,Z.jsx)(s.Z,{loading:Br,type:"primary",hidden:!!yr,onClick:function(){Je=="refundList"||Je=="refund"?ut.Z.get("/sms/business/bizCharge/getListOfFinance",{idList:v.join(",")}).then(function(dt){dt.status=="success"&&(0,u.Z)(dt.data,b.Z.RefundHeader,"\u9000\u8D39\u4FE1\u606F","refund")}):(0,n.Z)(v.join(","))},children:"\u5BFC\u51FA\u6570\u636E"}),(0,Z.jsx)(x.Z,{title:"\u662F\u5426\u6279\u91CF\u4E0D\u8BA1\u7B97\u4E1A\u7EE9\uFF1F",onConfirm:function(){ut.Z.post("/sms/business/bizCharge/reports/setIsCalculation",{ids:v.join(","),isCalculation:!1}).then(function(dt){dt.status=="success"&&Tr()})},okText:"\u4E0D\u7B97",cancelText:"\u53D6\u6D88",children:(0,Z.jsx)(s.Z,{type:"primary",hidden:!!yr,children:"\u4E0D\u8BA1\u7B97\u4E1A\u7EE9"})}),(0,Z.jsx)(x.Z,{title:"\u662F\u5426\u6279\u91CF\u8BA1\u7B97\u4E1A\u7EE9\uFF1F",onConfirm:function(){ut.Z.post("/sms/business/bizCharge/reports/setIsCalculation",{ids:v.join(","),isCalculation:!0}).then(function(dt){dt.status=="success"&&Tr()})},okText:"\u7B97",cancelText:"\u53D6\u6D88",children:(0,Z.jsx)(s.Z,{type:"primary",hidden:!!yr,children:"\u8BA1\u7B97\u4E1A\u7EE9"})}),(0,Z.jsx)("a",{hidden:!yr,onClick:function(){var dt=[];yr&&ft.forEach(function(dr){dr.usedAmount>=dr.amount&&dt.push(dr.num)}),dt.length===0?(Zr(ft),yr()):m.Z.error({title:"\u4EE5\u4E0B\u7F34\u8D39\u53EF\u5F00\u7968\u91D1\u989D\u5DF2\u7528\u5B8C\uFF0C\u8BF7\u91CD\u65B0\u9009\u62E9!",content:(0,Z.jsx)("p",{children:dt.join(",")})})},children:"\u9009\u62E9\u7ED1\u5B9A\u5230\u53D1\u7968\u4FE1\u606F"})]})},toolBarRender:[(0,Z.jsx)(s.Z,{hidden:Je=="refundList"||Je=="refund",type:"primary",icon:(0,Z.jsx)(bt.Z,{}),onClick:function(){H(!0)},children:"\u5BFC\u5165\u5BF9\u516C\u8F6C\u8D26\u6D41\u6C34"}),,(0,Z.jsx)("a",{hidden:Je!="refundList"&&Je!="refund",download:"\u6C47\u5FB7\u9000\u8D39\u7533\u8BF7\u8868\u534F\u8BAE\u7248\uFF08\u672A\u4E0B\u5355\u76F4\u63A5\u9000\u6B3E\u6A21\u677F\uFF09",href:"./template/\u6C47\u5FB7\u9000\u8D39\u7533\u8BF7\u8868\u534F\u8BAE\u7248\uFF08\u672A\u4E0B\u5355\u76F4\u63A5\u9000\u6B3E\u6A21\u677F\uFF09.doc",children:"\u4E0B\u8F7D\u9000\u8D39\u7533\u8BF7\u8868\u534F\u8BAE\u7248(\u672A\u4E0B\u5355\u76F4\u63A5\u9000\u6B3E\u6A21\u677F)"}),(0,Z.jsx)("a",{hidden:Je!="refundList"&&Je!="refund",download:"\u6C47\u5FB7\u9000\u8D39\u7533\u8BF7\u4E66\u6A21\u677F\uFF08\u4E24\u4E2A--\u4F01\u4E1A\u548C\u4E2A\u4EBA\uFF09",href:"./template/\u6C47\u5FB7\u9000\u8D39\u7533\u8BF7\u4E66\u6A21\u677F\uFF08\u4E24\u4E2A--\u4F01\u4E1A\u548C\u4E2A\u4EBA\uFF09.doc",children:"\u4E0B\u8F7D\u9000\u8D39\u7533\u8BF7\u4E66\u6A21\u677F(\u4E24\u4E2A--\u4F01\u4E1A\u548C\u4E2A\u4EBA)"}),(0,Z.jsx)(s.Z,{loading:Br,onClick:(0,c.Z)((0,O.Z)().mark(function _(){return(0,O.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!Ke(Qt)){v.next=5;break}return f.default.error("\u8BF7\u9009\u62E9\u6761\u4EF6!"),v.abrupt("return");case 5:ut.Z.get("/sms/business/bizCharge/getListOfFinance2",Qt).then(function(ft){ft.status=="success"&&(Je=="refundList"||Je=="refund"?(0,u.Z)(ft.data,b.Z.PayHeader,"\u9000\u8D39\u4FE1\u606F","refund"):(0,u.Z)(ft.data,b.Z.jiaoPayHeader,"\u7F34\u8D39","charge"))}).catch(function(ft){});case 6:case"end":return v.stop()}},_)})),children:"\u6761\u4EF6\u5BFC\u51FA"})]}),_r&&(0,Z.jsx)(gr.Z,{setModalVisible:function(){return Fr(!1)},modalVisible:_r,renderData:Ge,callbackRef:function(){return Tr()},admin:De}),Te&&(0,Z.jsx)(tr.Z,{setModalVisible:function(){return N(!1)},modalVisible:Te,callbackRef:function(){return Tr()},renderData:Ge,setPreviewImage:function(R){return Ze(R)},setPreviewVisible:function(){return T(!0)},admin:De}),(0,Z.jsx)(o.Z,{title:"\u91CD\u65B0\u63D0\u4EA4",width:1200,visible:Xe,onClose:function(){return we(!1)},maskClosable:!1,footer:null,destroyOnClose:!0,children:(0,Z.jsx)(Nr,{setModalVisible:function(){return we(!1)},modalVisible:Xe,renderData:Ge,callbackRef:function(){return Tr()}})}),Ue&&(0,Z.jsx)(B.Z,{setModalVisible:function(){return vr(!1)},modalVisible:Ue,renderData:Ge,callbackRef:function(){return Tr()}}),ze&&(0,Z.jsx)(he.Z,{setModalVisible:function(){return Ae(!1)},modalVisible:ze,callbackRef:function(){return Tr()},renderData:Ge,setPreviewImage:function(R){return Ze(R)},setPreviewVisible:function(){return T(!0)},admin:De}),je&&(0,Z.jsx)(t.Z,{setModalVisible:function(){return q(!1)},modalVisible:je,callbackRef:function(){return Tr()},renderData:Ge}),(0,Z.jsx)(o.Z,{open:Vt,onClose:function(){return Nt(!1)},width:1400,children:(0,Z.jsx)(Y.Z,{param:{chargeIds:","+(Ge==null?void 0:Ge.id)+","}})}),k&&(0,Z.jsx)(Ft.Z,{setModalVisible:function(){return xe(!1)},modalVisible:k,callbackRef:function(){return Tr()},renderData:Ge}),(0,Z.jsx)(it.Z,{previewVisible:ee,setPreviewVisible:function(){return T(!1)},previewImage:lt}),(0,Z.jsxs)(jr.Y,{title:"\u4FEE\u6539\u4E1A\u7EE9",formRef:Qe,visible:Me,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){It(!1)}},onFinish:function(){var _=(0,c.Z)((0,O.Z)().mark(function R(v){return(0,O.Z)().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:ut.Z.postAll("/sms/business/bizCharge/edit",[(0,ie.Z)({id:Ge.id},v)]).then(function(ur){ur.status=="success"&&(f.default.success("\u64CD\u4F5C\u6210\u529F"),It(!1),Tr())});case 1:case"end":return Lt.stop()}},R)}));return function(R){return _.apply(this,arguments)}}(),children:[(0,Z.jsxs)("div",{children:[" ",(0,Z.jsx)("a",{onClick:function(){return ru("max")},children:"\u6700\u5927"})," ",(0,Z.jsx)("a",{onClick:function(){return ru("min")},children:"\u6700\u5C0F"}),"  "]}),(0,Z.jsx)($e.Z,{name:"performanceAmount",label:"\u4E1A\u7EE9\u91D1\u989D"})]}),(0,Z.jsxs)(m.Z,{title:"\u6279\u91CF\u5BFC\u5165",okText:"\u5BFC\u5165",onCancel:function(){H(!1)},onOk:(0,c.Z)((0,O.Z)().mark(function _(){return(0,O.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(Oe){v.next=3;break}return f.default.error("\u8BF7\u4E0A\u4F20\u6587\u4EF6"),v.abrupt("return");case 3:ut.Z.baseOptions({url:"/sms/business/bizCharge/uploadRemarkCode",data:Oe},"POST","up",!1).then(function(ft){ft.status=="success"?(f.default.success("\u5BFC\u5165\u6210\u529F"),H(!1),Tr()):m.Z.confirm({title:"\u5BFC\u5165\u5931\u8D25",content:(0,Z.jsx)("div",{style:{whiteSpace:"pre"},children:ft.msg})}),Ce(void 0)});case 4:case"end":return v.stop()}},_)})),width:800,visible:Er,children:[(0,Z.jsx)("a",{download:"\u5BFC\u5165\u5BF9\u516C\u8F6C\u8D26\u6D41\u6C34\u6A21\u677F.xlsx",href:"./template/\u5BFC\u5165\u5BF9\u516C\u8F6C\u8D26\u6D41\u6C34\u6A21\u677F.xlsx",children:"\u4E0B\u8F7D\u5BFC\u5165\u5BF9\u516C\u8F6C\u8D26\u6D41\u6C34\u6A21\u677F"}),(0,Z.jsx)(sr.Z,{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",name:"file",fieldProps:{beforeUpload:function(R,v){var ft=new FileReader;return ft.onload=function(Lt){var ur=Lt.target.result,dt=re.ij(ur,{type:"binary"}),dr=dt.Sheets[dt.SheetNames[0]],Pt=re.P6.sheet_to_json(dr,{header:1});Ce((0,Xt.gZ)(Pt))},ft.readAsArrayBuffer(R),!1}}})]})]})})}},38282:function(ce,D,e){"use strict";var j=e(71194),g=e(50146),V=e(12968),o=e(20352),I=e(39428),i=e(3182),A=e(86582),m=e(71153),L=e(60331),M=e(98858),d=e(4914),J=e(2824),ne=e(67294),X=e(71975),x=e(37490),F=e(86707),f=e(63863),P=e(66801),r=e(68503),p=e(41574),O=e(21987),c=e(35338),a=e(85893);D.Z=function(h){var ie=h.modalVisible,Ee=h.setModalVisible,s=h.renderData,le=h.setPreviewImage,$=(0,ne.useState)(s.totalPages?s.totalPages:!1),bt=(0,J.Z)($,2),pe=bt[0],Ct=bt[1],gt=(0,ne.useState)([]),et=(0,J.Z)(gt,2),ae=et[0],ut=et[1],ot=(0,ne.useState)(),tr=(0,J.Z)(ot,2),he=tr[0],Ft=tr[1],gr=(0,ne.useState)(!1),it=(0,J.Z)(gr,2),t=it[0],Ye=it[1],l=(0,ne.useState)(!1),u=(0,J.Z)(l,2),b=u[0],n=u[1],ht=(0,ne.useState)([]),jr=(0,J.Z)(ht,2),$e=jr[0],sr=jr[1],Y=(0,ne.useState)(!1),Dt=(0,J.Z)(Y,2),re=Dt[0],Xt=Dt[1],B=(0,ne.useState)(s.charge?s.charge:!1),Z=(0,J.Z)(B,2),nr=Z[0],De=Z[1],xr=(0,ne.useState)(!1),zt=(0,J.Z)(xr,2),Ut=zt[0],Gt=zt[1],kt=(0,ne.useState)(),Kt=(0,J.Z)(kt,2),Bt=Kt[0],Ie=Kt[1],Ot=(0,ne.useState)((0,F.Z)()),Je=(0,J.Z)(Ot,2),jt=Je[0],_t=Je[1],at=[(0,a.jsxs)("div",{hidden:s.type=="refund"||s.type=="refundList",children:[(0,a.jsx)(d.Z,{title:"\u7F34\u8D39\u4FE1\u606F",bordered:!0,size:"small"}),$e.map(function(_e,or){return(0,a.jsxs)(d.Z,{bordered:!0,size:"small",style:{marginBottom:"30px"},children:[(0,a.jsx)(d.Z.Item,{label:"\u7F34\u8D39\u7F16\u53F7",children:_e.num}),(0,a.jsx)(d.Z.Item,{label:"\u7B2C\u4E09\u65B9\u8BA2\u5355\u7F16\u53F7",children:_e.num2}),(0,a.jsx)(d.Z.Item,{label:"\u7F34\u8D39\u7C7B\u578B",children:x.Z.getCascaderName("chargeType",_e.type)}),(0,a.jsx)(d.Z.Item,{label:"\u6536\u8D39\u91D1\u989D",children:_e.amount}),(0,a.jsx)(d.Z.Item,{label:"\u6536\u6B3E\u65B9\u5F0F",children:x.Z.getCascaderName("dict_stu_refund_type",_e.method)}),(0,a.jsx)(d.Z.Item,{label:"\u672C\u6B21\u6298\u6263\u91D1\u989D",children:_e.discount}),(0,a.jsx)(d.Z.Item,{label:"\u672C\u6B21\u6298\u6263\u539F\u56E0",children:_e.discountRemark}),(0,a.jsx)(d.Z.Item,{label:"\u6536\u8D39\u4EBA",children:_e.userName}),(0,a.jsx)(d.Z.Item,{label:"\u7F34\u8D39\u65E5\u671F",children:_e.paymentTime}),(0,a.jsx)(d.Z.Item,{label:"\u4E0B\u6B21\u7F34\u8D39\u65F6\u95F4",children:_e.nextPaymentTime}),(0,a.jsx)(d.Z.Item,{label:"\u5BA1\u6838\u4EBA",children:_e.auditor}),(0,a.jsx)(d.Z.Item,{label:"\u5BA1\u6838\u72B6\u6001",children:_e.confirm===!0?(0,a.jsx)(L.Z,{color:"#87d068",children:"\u5BA1\u6838\u901A\u8FC7"}):_e.confirm===!1?(0,a.jsx)(L.Z,{color:"#FF0000",children:"\u5BA1\u6838\u672A\u901A\u8FC7"}):(0,a.jsx)(L.Z,{color:"#f50",children:"\u672A\u5BA1\u6838"})}),(0,a.jsx)(d.Z.Item,{label:"\u7F34\u8D39\u5907\u6CE8",span:3,children:_e.description}),(0,a.jsx)(d.Z.Item,{label:"\u8D22\u52A1\u5907\u6CE8",span:3,children:_e.description2}),(0,a.jsx)(d.Z.Item,{label:"\u5BA1\u6838\u5907\u6CE8",span:3,children:_e.remark}),(0,a.jsx)(d.Z.Item,{label:"\u9644\u4EF6",span:3,children:_e!=null&&_e.files?_e.files.split(",").map(function(Zt,Fe){return(0,a.jsxs)("div",{className:"notice-files",children:["\u9644\u4EF6\u5185\u5BB9\uFF1A"," ",(0,a.jsx)("a",{onClick:function(){yr(_e.id,Zt)},children:Zt})]},Fe)}):""}),_e.file&&(0,a.jsx)(d.Z.Item,{label:"\u4E8C\u7EF4\u7801",span:3,children:(0,a.jsxs)("div",{className:"notice-files",children:["\u4E8C\u7EF4\u7801\u56FE\u7247\uFF1A"," ",(0,a.jsx)("a",{onClick:function(){Zr(_e)},children:_e.file})]})}),_e.code&&(0,a.jsx)(d.Z.Item,{label:"\u5BF9\u516C\u8F6C\u8D26\u5907\u6CE8\u7801",span:3,children:(0,a.jsxs)("div",{className:"notice-files",children:["\u5907\u6CE8\u7801\uFF1A"," ",(0,a.jsx)(O.Z,{copyable:!0,children:_e.code})]})})]},"charge-info-".concat(or))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.Z,{title:"\u9000\u8D39\u4FE1\u606F",bordered:!0,size:"small"}),ae.map(function(_e,or){return(0,a.jsxs)(d.Z,{bordered:!0,size:"small",style:{marginBottom:"30px"},children:[(0,a.jsx)(d.Z.Item,{label:"\u9000\u8D39\u91D1\u989D",style:{width:"150px"},children:_e.amount}),(0,a.jsx)(d.Z.Item,{label:"\u9000\u6B3E\u65B9\u5F0F",children:x.Z.getCascaderName("dict_stu_refund_type",_e.method)}),(0,a.jsx)(d.Z.Item,{label:"\u6536\u8D39\u4EBA",children:_e.userName}),(0,a.jsx)(d.Z.Item,{label:"\u9000\u8D39\u9879\u76EE\u603B\u79F0",children:_e.project&&x.Z.getCascaderAllName("dict_reg_job",_e.project.split(",")[0])}),(0,a.jsx)(d.Z.Item,{label:"\u9000\u8D39\u9879\u76EE",children:_e.project&&(0,A.Z)(new Set(_e.project.split(","))).map(function(Zt,Fe){return(0,a.jsxs)("span",{children:[x.Z.getCascaderName("dict_reg_job",Zt)," ",(0,a.jsx)("br",{})]},"charge-info-project-".concat(Zt,"-").concat(Fe))})}),(0,a.jsx)(d.Z.Item,{label:"\u7533\u8BF7\u65F6\u95F4",children:_e.paymentTime}),(0,a.jsx)(d.Z.Item,{label:"\u9000\u6B3E\u5907\u6CE8",span:3,children:_e.description}),(0,a.jsx)(d.Z.Item,{label:"\u8D22\u52A1\u5907\u6CE8",span:3,children:_e.description2}),(0,a.jsx)(d.Z.Item,{label:"\u9000\u6B3E\u9886\u53D6\u4EBA",children:_e.recipientName}),(0,a.jsx)(d.Z.Item,{label:"\u9000\u6B3E\u7C7B\u578B",children:x.Z.getCascaderName("dict_refundType",_e.refundType)}),(0,a.jsx)(d.Z.Item,{label:"\u7ECF\u529E\u4EBA",children:_e.agentName}),(0,a.jsx)(d.Z.Item,{label:"\u8D26\u6237",children:_e.account}),(0,a.jsx)(d.Z.Item,{label:"\u5F00\u6237\u540D",children:_e.accountName}),(0,a.jsx)(d.Z.Item,{label:"\u5F00\u6237\u884C",children:_e.bank}),(0,a.jsx)(d.Z.Item,{label:"\u5BA1\u6838\u8FDB\u5EA6",span:3,children:(0,a.jsx)(P.ZP,{bordered:!0,columns:[{title:"\u5BA1\u6838\u6B65\u9AA4",dataIndex:"auditType",search:!1,render:function(Fe,vt){return(0,a.jsx)("span",{children:x.Z.getName("auditType",vt.auditType)})}},{title:"\u5BA1\u6838\u4EBA",dataIndex:"userName",search:!1},{title:"\u5BA1\u6838\u7ED3\u679C",dataIndex:"confirm",search:!1,render:function(Fe,vt){return(0,a.jsx)(L.Z,{color:vt.confirm?"#87d068":"#FF0000",children:vt.confirm?"\u5BA1\u6838\u901A\u8FC7":"\u5BA1\u6838\u672A\u901A\u8FC7\uFF0C\u5DF2\u9000\u56DE\u7B2C\u4E00\u6B65"})}},{title:"\u5BA1\u6838\u5EFA\u8BAE",dataIndex:"remark",ellipsis:!0,tip:"\u5EFA\u8BAE\u8FC7\u957F\u4F1A\u81EA\u52A8\u6536\u7F29"},{title:"\u5BA1\u6838\u65F6\u95F4",key:"createTime",dataIndex:"createTime",valueType:"dateRange",render:function(Fe,vt){return(0,a.jsx)("span",{children:vt.createTime})}}],headerTitle:!1,search:!1,rowKey:"id",options:!1,request:function(){var Zt=(0,i.Z)((0,I.Z)().mark(function Fe(vt,Qe,Be){var Mt;return(0,I.Z)().wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.next=2,f.Z.get("/sms/business/bizAudit",{entityId:_e.id,"auditType-in":"1,2,3,4"});case 2:return Mt=Ue.sent,Ue.abrupt("return",{data:Mt.data.content,success:Mt.success,total:Mt.data.totalElements});case 4:case"end":return Ue.stop()}},Fe)}));return function(Fe,vt,Qe){return Zt.apply(this,arguments)}}(),pagination:!1})}),(0,a.jsx)(d.Z.Item,{label:"\u9644\u4EF6",children:_e!=null&&_e.files?_e.files.split(",").map(function(Zt,Fe){return(0,a.jsxs)("div",{className:"notice-files",children:["\u9644\u4EF6\u5185\u5BB9\uFF1A"," ",(0,a.jsx)("a",{onClick:function(){yr(_e.id,Zt)},children:Zt})]},Fe)}):""})]},or)})]})];(0,ne.useEffect)(function(){Ht(),f.Z.get("/sms/business/bizOrder",{id:s.orderId}).then(function(_e){Xt(_e.data.content[0])})},[s]);var Ht=function(){var _e=(0,i.Z)((0,I.Z)().mark(function or(){var Zt,Fe,vt;return(0,I.Z)().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return Be.next=2,f.Z.get("/sms/business/bizCharge",{orderId:s.orderId,enable:!0});case 2:Zt=Be.sent,Fe=[],vt=[],Zt.data.content.forEach(function(Mt){Mt.type!=1?Fe.push(Mt):vt.push(Mt)}),sr(Fe),ut(vt),(s.type=="refund"||s.type=="refundList")&&at.splice(0,1);case 9:case"end":return Be.stop()}},or)}));return function(){return _e.apply(this,arguments)}}(),qt=(0,ne.useRef)(),yr=function(){var _e=(0,i.Z)((0,I.Z)().mark(function or(Zt,Fe){var vt;return(0,I.Z)().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return vt=Fe.slice(Fe.indexOf(".")),Be.next=3,(0,r.Z)("/sms/business/bizCharge/download",Zt,Fe).then(function(Mt){Ft(Mt),vt==".png"||vt==".jpg"||vt==".jpeg"?n(!0):Ye(!0)});case 3:case"end":return Be.stop()}},or)}));return function(Zt,Fe){return _e.apply(this,arguments)}}(),Zr=function(){var _e=(0,i.Z)((0,I.Z)().mark(function or(Zt){var Fe,vt,Qe;return(0,I.Z)().wrap(function(Mt){for(;;)switch(Mt.prev=Mt.next){case 0:Fe=sessionStorage.getItem("tokenName"),vt=sessionStorage.getItem("tokenValue"),Qe="/sms/business/bizChargeQrcode/download?id="+Zt.chargeQrcodeId+"&fileName="+Zt.file+"&"+Fe+"="+vt,Ie(Qe),Gt(!0),De(Zt);case 6:case"end":return Mt.stop()}},or)}));return function(Zt){return _e.apply(this,arguments)}}();return(0,a.jsxs)(X.a,{title:"\u7F34\u8D39\u4FE1\u606F",formRef:qt,autoFocusFirstInput:!0,drawerProps:{destroyOnClose:!0,onClose:function(){Ee()}},width:jt.innerWidth/1.5,onFinish:function(){var _e=(0,i.Z)((0,I.Z)().mark(function or(Zt){return(0,I.Z)().wrap(function(vt){for(;;)switch(vt.prev=vt.next){case 0:Ee();case 1:case"end":return vt.stop()}},or)}));return function(or){return _e.apply(this,arguments)}}(),visible:ie,children:[re&&(0,a.jsxs)(d.Z,{title:"\u8BA2\u5355\u4FE1\u606F:".concat(re.num?re.num:""),bordered:!0,size:"small",children:[(0,a.jsxs)(d.Z.Item,{label:"\u5B66\u5458/\u4F01\u4E1A",children:[(0,a.jsx)("div",{children:re.studentName}),(0,a.jsxs)("div",{children:[" ",re.isPeer&&(0,a.jsx)(L.Z,{color:"#87CEEB",children:"\u540C\u884C\u4F01\u4E1A"})]})]}),(0,a.jsx)(d.Z.Item,{label:"\u9879\u76EE\u603B\u79F0",children:x.Z.getCascaderAllName("dict_reg_job",re.project)}),(0,a.jsx)(d.Z.Item,{label:"\u62A5\u8003\u9879\u76EE",children:x.Z.getCascaderName("dict_reg_job",re.project)}),(0,a.jsx)(d.Z.Item,{label:"\u62A5\u8003\u73ED\u578B",children:x.Z.getName("dict_class_type",re.classType)}),(0,a.jsx)(d.Z.Item,{label:"\u73ED\u578B\u5E74\u9650",children:x.Z.getName("dict_class_year",re.classYear)}),(0,a.jsx)(d.Z.Item,{label:"\u8003\u8BD5\u7C7B\u578B",children:x.Z.getName("dict_exam_type",re.examType)}),(0,a.jsx)(d.Z.Item,{label:"\u8BA2\u5355\u6536\u8D39\u6807\u51C6/\u4EBA",children:re.receivable}),(0,a.jsx)(d.Z.Item,{label:"\u8BA2\u5355\u5B9E\u9645\u5E94\u6536\u91D1\u989D",children:re.actualReceivable}),(0,a.jsx)(d.Z.Item,{label:"\u8BA2\u5355\u5DF2\u6536\u91D1\u989D",children:(0,a.jsx)("span",{style:{color:"green"},children:re.charge})}),(0,a.jsx)(d.Z.Item,{label:"\u8BA2\u5355\u7D2F\u8BA1\u4F18\u60E0\u91D1\u989D",children:re.discount}),(0,a.jsx)(d.Z.Item,{label:"\u8BA2\u5355\u672A\u6536\u91D1\u989D",children:(0,a.jsx)("span",{style:{color:"red"},children:re.arrears})}),(0,a.jsx)(d.Z.Item,{label:"\u62A5\u540D\u4EBA\u6570",children:re.quantity}),(0,a.jsx)(d.Z.Item,{label:"\u4E0B\u5355\u65F6\u95F4",children:re.createTime}),(0,a.jsx)(d.Z.Item,{label:"\u662F\u5426\u5DF2\u5B8C\u7ED3",children:re.isServed===!0?(0,a.jsx)(L.Z,{color:"#87d068",children:"\u5DF2\u5B8C\u7ED3"}):(0,a.jsx)(L.Z,{color:"#FF0000",children:"\u672A\u5B8C\u7ED3"})})]}),(0,a.jsx)("div",{style:{display:"none"},children:(0,a.jsx)(o.Z,{width:200,style:{display:"none"},preview:{visible:b,src:he,onVisibleChange:function(or){n(or)}}})}),at.map(function(_e){return _e}),(0,a.jsx)("a",{id:"downloadDiv",style:{display:"none"}}),t&&(0,a.jsx)(p.Z,{previewImage:he,previewVisible:t,setPreviewVisible:function(){Ye(!1)}}),(0,a.jsx)(g.Z,{visible:Ut,title:"\u4E8C\u7EF4\u7801\u4FE1\u606F",footer:null,onCancel:function(){return Gt(!1)},children:(0,a.jsx)(c.Z,{src:Bt,order:re,charge:nr})})]})}},76294:function(ce,D,e){"use strict";var j=e(71194),g=e(50146),V=e(13062),o=e(71230),I=e(89032),i=e(15746),A=e(49111),m=e(19650),L=e(20228),M=e(11382),d=e(57663),J=e(71577),ne=e(34792),X=e(48086),x=e(39428),F=e(3182),f=e(11849),P=e(2824),r=e(67294),p=e(45510),O=e(59962),c=e(24739),a=e(63434),h=e(952),ie=e(64317),Ee=e(5966),s=e(22452),le=e(31199),$=e(90672),bt=e(30381),pe=e.n(bt),Ct=e(37490),gt=e(63863),et=e(30202),ae=e(21010),ut=e(14037),ot=e(98580),tr=e(28975),he=e(6821),Ft=e(19103),gr=e(19278),it=e(181),t=e(21874),Ye=e(42025),l=e(5909),u=e(81927),b=e(85893);D.Z=function(n,ht){var jr,$e,sr,Y=n.setModalVisible,Dt=Y===void 0?void 0:Y,re=n.callbackRef,Xt=re===void 0?void 0:re,B=n.renderData,Z=n.admin,nr=n.chargeType,De=(0,ae.tT)("@@initialState"),xr=De.initialState,zt=(0,r.useState)(!1),Ut=(0,P.Z)(zt,2),Gt=Ut[0],kt=Ut[1],Kt=(0,r.useState)(!1),Bt=(0,P.Z)(Kt,2),Ie=Bt[0],Ot=Bt[1],Je=(0,r.useState)(!1),jt=(0,P.Z)(Je,2),_t=jt[0],at=jt[1],Ht=(0,r.useState)(!1),qt=(0,P.Z)(Ht,2),yr=qt[0],Zr=qt[1],_e=(0,r.useState)(!1),or=(0,P.Z)(_e,2),Zt=or[0],Fe=or[1],vt=(0,r.useState)(),Qe=(0,P.Z)(vt,2),Be=Qe[0],Mt=Qe[1],fr=(0,r.useState)(),Ue=(0,P.Z)(fr,2),vr=Ue[0],Tt=Ue[1],Pe=(0,r.useState)(),ze=(0,P.Z)(Pe,2),Ae=ze[0],Rt=ze[1],S=(0,r.useState)(),Xe=(0,P.Z)(S,2),we=Xe[0],qe=Xe[1],Yt=(0,r.useState)(!1),Te=(0,P.Z)(Yt,2),N=Te[0],y=Te[1],W=(0,r.useState)(!1),k=(0,P.Z)(W,2),xe=k[0],ye=k[1],Ne=(0,r.useState)(!1),je=(0,P.Z)(Ne,2),q=je[0],G=je[1],K=(0,r.useState)([]),Et=(0,P.Z)(K,2),yt=Et[0],er=Et[1],Se=(0,r.useState)([]),Vt=(0,P.Z)(Se,2),Nt=Vt[0],tt=Vt[1],ir=(0,r.useState)([]),wt=(0,P.Z)(ir,2),Or=wt[0],We=wt[1],Le=(0,r.useState)([]),ve=(0,P.Z)(Le,2),st=ve[0],ct=ve[1],br=(0,r.useState)([]),_r=(0,P.Z)(br,2),Fr=_r[0],Ir=_r[1],Ar=(0,r.useState)(),Ge=(0,P.Z)(Ar,2),Pr=Ge[0],wr=Ge[1],Re=(0,r.useState)([]),lt=(0,P.Z)(Re,2),Ze=lt[0],cr=lt[1],Q=(0,r.useState)(!1),ee=(0,P.Z)(Q,2),T=ee[0],me=ee[1],U=(0,r.useState)(!1),Me=(0,P.Z)(U,2),It=Me[0],be=Me[1],z=(0,r.useState)(!1),He=(0,P.Z)(z,2),Sr=He[0],Jt=He[1],mr=(0,r.useState)({}),Er=(0,P.Z)(mr,2),H=Er[0],w=Er[1],C=(0,r.useState)(!1),Oe=(0,P.Z)(C,2),Ce=Oe[0],nt=Oe[1],pr=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D"],Qt=[!1,!1,!1,!1,!1,!1,!1,!1],mt=[!1,!1,!1,!1,!1,!1,!1,!1],hr=["\u6210\u8003","\u56FD\u5BB6\u5F00\u653E\u5927\u5B66	"],Lr=(0,r.useState)(!1),Br=(0,P.Z)(Lr,2),Vr=Br[0],Wr=Br[1],rr=(0,r.useRef)(null),Nr=(0,r.useRef)(),tu=(0,r.forwardRef)(l.Z),Tr=(0,r.useState)({name:xr==null||(jr=xr.currentUser)===null||jr===void 0?void 0:jr.name,id:xr==null||($e=xr.currentUser)===null||$e===void 0?void 0:$e.userid,departmentId:xr==null||(sr=xr.currentUser)===null||sr===void 0?void 0:sr.departmentId}),lr=(0,P.Z)(Tr,2),Xr=lr[0],ru=lr[1],uu=function(se){gt.Z.get("/sms/business/bizOrder",{id:se}).then(function(ke){for(var fe=0;fe<B.list.length;fe++){var pt=B.list[fe];if(pt.orderId==se){delete ke.data.content[0].amount,delete ke.data.content[0].description,B.list[fe]=(0,f.Z)((0,f.Z)({},pt),ke.data.content[0]),v(),console.log(B);return}}})},su=sessionStorage.getItem("tokenName"),eu=sessionStorage.getItem("tokenValue"),au={};au[su]=eu;var Ke=B.type=="orders"?"\u9000\u8D39":"\u6536\u8D39",_=B.type=="orders"?"\uFF08-\uFF09":"\uFF08+\uFF09",R=function(){var se;Pt==null||(se=Pt.current)===null||se===void 0||se.setFieldsValue({agent:Xr.name})};(0,r.useEffect)(function(){if(Ae){var St,se,ke;G(!1);var fe=Pt==null||(St=Pt.current)===null||St===void 0?void 0:St.getFieldsValue().chargeLists;fe[0].amount=Ae.reduce(function(pt,Wt){return pt+Wt.amount},0),Pt==null||(se=Pt.current)===null||se===void 0||se.setFieldsValue({chargeLogName:Ae.map(function(pt){return pt.name}).join("\u3001")+"\u7684\u6536\u6B3E\u8BB0\u5F55",paymentTime:Ae[0].paymentTime,userId:Ae[0].userId+"",method:Ae[0].method+"",chargeLists:fe}),rr==null||(ke=rr.current)===null||ke===void 0||ke.setDepartment({id:Ae[0].userId,name:Ct.Z.getDepartmentUserName(Ae[0].userId)}),wr({id:Ae[0].userId,name:Ct.Z.getDepartmentUserName(Ae[0].userId)})}},[Ae]);var v=function(){be(!0);var se=B.list,ke=function(){var fe=(0,F.Z)((0,x.Z)().mark(function pt(Wt){var ue;return(0,x.Z)().wrap(function($t){for(;;)switch($t.prev=$t.next){case 0:return $t.next=2,Lt(se);case 2:return ue=$t.sent,$t.abrupt("return",new Promise(function(Mr,At){var Kr=[];Wt.forEach(function(){var Ve=(0,F.Z)((0,x.Z)().mark(function xt(E,Cr){var Rr,ar;return(0,x.Z)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(Rr=Ct.Z.getName("dict_class_type",E.classType)+"/"+Ct.Z.getName("dict_class_year",E.classYear)+"/"+Ct.Z.getName("dict_exam_type",E.examType),B.type!="add"){oe.next=5;break}Kr.push({orderId:E.orderId,PaymentLength:0,parentProjectList:Ct.Z.getCascaderAllName("dict_reg_job",E.project),projectList:Ct.Z.getCascaderName("dict_reg_job",E.project),banxin:Rr,quantity:E.quantity,totalReceivable:E.receivable*E.quantity,receivable:E.receivable,charge:0,arrears:E.receivable*E.quantity-E.discount,source:Ct.Z.getName("dict_source",E.source),discount:E.discount,discountRemark:E.discountRemark,fFalg:"false",percent:E.percent?E.percent*100+"%":null,ownerName:E.ownerName,studentName:E.studentName,isCalculation:E.isCalculation,providerName:E.providerName}),oe.next=40;break;case 5:return ar=JSON.parse(JSON.stringify(Ze)),ar[Cr]=E,cr(ar),oe.t0=Kr,oe.t1=E.orderId,oe.next=12,ur(E.orderId,ue);case 12:oe.t2=oe.sent,oe.t3=Ct.Z.getCascaderAllName("dict_reg_job",E.project),oe.t4=Ct.Z.getCascaderName("dict_reg_job",E.project),oe.t5=Rr,oe.t6=E.chargeId,oe.t7=E.studentName,oe.t8=E.isCalculation,oe.t9=E.quantity,oe.t10=E.totalReceivable,oe.t11=E.receivable,oe.t12=E.charge,oe.t13=E.arrears,oe.t14=E.discount,oe.t15=E.discountRemark,oe.t16=Ct.Z.getName("dict_source",E.source),oe.t17=E.amount?E.amount:0,oe.t18=E.collectedAmount,oe.t19=E.performanceAmount,oe.t20=E.commissionBase,oe.t21=E.description?E.description:"",oe.t22=E.description2?E.description2:"",oe.t23=E.arrears-E.amount,oe.t24=E.percent?E.percent*100+"%":null,oe.t25=E.ownerName,oe.t26=E.providerName,oe.t27=E.percent?E.amount*E.percent:"-",oe.t28={orderId:oe.t1,PaymentLength:oe.t2,parentProjectList:oe.t3,projectList:oe.t4,banxin:oe.t5,chargeId:oe.t6,studentName:oe.t7,isCalculation:oe.t8,quantity:oe.t9,totalReceivable:oe.t10,receivable:oe.t11,charge:oe.t12,arrears:oe.t13,discount:oe.t14,discountRemark:oe.t15,source:oe.t16,amount:oe.t17,collectedAmount:oe.t18,performanceAmount:oe.t19,commissionBase:oe.t20,description:oe.t21,description2:oe.t22,surplus:oe.t23,percent:oe.t24,ownerName:oe.t25,providerName:oe.t26,percents:oe.t27},oe.t0.push.call(oe.t0,oe.t28);case 40:case"end":return oe.stop()}},xt)}));return function(xt,E){return Ve.apply(this,arguments)}}()),Mr(Kr)}));case 4:case"end":return $t.stop()}},pt)}));return function(Wt){return fe.apply(this,arguments)}}();ke(se).then(function(fe){(function(){var pt=(0,F.Z)((0,x.Z)().mark(function ue(){var te,$t,Mr,At,Kr,Ve,xt,E,Cr,Rr,ar,Dr;return(0,x.Z)().wrap(function(zr){for(;;)switch(zr.prev=zr.next){case 0:if(be(!1),We(fe),te=B.list[0],te!=null&&te.files&&typeof(te==null?void 0:te.files)=="string"&&(Mr=[],te==null||($t=te.files)===null||$t===void 0||$t.split(",").forEach(function(kr,qr){Mr.push({uid:qr+1,name:kr,response:{data:kr}})}),te.files=Mr),te.type=te.type!=null?te.type+"":te.type,te.method=te.method!=null?te.method+"":te.method,te.method!=null){zr.next=13;break}return Ve=xr==null||(At=xr.currentUser)===null||At===void 0?void 0:At.companyId,zr.next=10,gt.Z.get("/sms/share/getBank");case 10:xt=zr.sent.data,E=xt.find(function(kr){return kr.companyId==Ve}),te.method=(Kr=E.method)===null||Kr===void 0?void 0:Kr.toString();case 13:console.log("renderData.list[0]",B.list[0].num),console.log("res",fe),console.log("fiedsValue",te),te.userId?(Pt==null||(Cr=Pt.current)===null||Cr===void 0||Cr.setFieldsValue((0,f.Z)((0,f.Z)({},te),{},{chargeLists:fe})),rr==null||(Rr=rr.current)===null||Rr===void 0||Rr.setDepartment({id:(te.userId+"").split(",")[0],name:te.userName.split(",")[0]}),wr({id:(te.userId+"").split(",")[0],name:te.userName.split(",")[0],departmentId:te.departmentId})):(Pt==null||(ar=Pt.current)===null||ar===void 0||ar.setFieldsValue((0,f.Z)((0,f.Z)({},te),{},{chargeLists:fe})),rr==null||(Dr=rr.current)===null||Dr===void 0||Dr.setDepartment(Xr),wr(Xr));case 17:case"end":return zr.stop()}},ue)}));function Wt(){return pt.apply(this,arguments)}return Wt})()()})};(0,r.useEffect)(function(){Qt=Nt,mt=yt},[Nt,yt]);var ft=function(){var St=(0,F.Z)((0,x.Z)().mark(function se(ke,fe){var pt,Wt,ue,te,$t,Mr;return(0,x.Z)().wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:if(pt=JSON.parse(JSON.stringify(Fr)),!pt[fe]){Kr.next=5;break}console.log("list[index]",pt[fe]),Kr.next=9;break;case 5:return Kr.next=7,gt.Z.get("/sms/business/bizInvoice",{studentUserId:B.list[fe].studentUserId});case 7:Wt=Kr.sent.data.content[0],Wt&&($t=Pt==null||(ue=Pt.current)===null||ue===void 0?void 0:ue.getFieldValue("chargeLists"),Mr=$t[fe],delete Wt.amount,Wt.amounts=Mr.amount,Object.keys(Wt).forEach(function(Ve){typeof Wt[Ve]=="number"&&(Wt[Ve]=Wt[Ve]+"")}),$t[fe]=(0,f.Z)((0,f.Z)({},Mr),Wt),console.log("formValue",$t),Pt==null||(te=Pt.current)===null||te===void 0||te.setFieldsValue({chargeLists:$t}));case 9:case"end":return Kr.stop()}},se)}));return function(ke,fe){return St.apply(this,arguments)}}(),Lt=function(){var St=(0,F.Z)((0,x.Z)().mark(function se(ke){var fe,pt;return(0,x.Z)().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(B.type!="add"){ue.next=2;break}return ue.abrupt("return");case 2:return fe=ke.map(function(te){return{orderId:te.orderId}}),ue.next=5,gt.Z.get("/sms/business/bizCharge/statistics",{array:JSON.stringify(fe)});case 5:return pt=ue.sent.data.map(function(te,$t){return{orderId:fe[$t].orderId,PaymentLength:te}}),ue.abrupt("return",pt);case 7:case"end":return ue.stop()}},se)}));return function(ke){return St.apply(this,arguments)}}(),ur=function(){var St=(0,F.Z)((0,x.Z)().mark(function se(ke,fe){var pt;return(0,x.Z)().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(fe.length!=0){ue.next=2;break}return ue.abrupt("return");case 2:return pt=0,fe.forEach(function(te){te.orderId==ke&&(pt=te.PaymentLength)}),B.types=="eidt"&&(pt=pt-1),ue.abrupt("return",pt);case 6:case"end":return ue.stop()}},se)}));return function(ke,fe){return St.apply(this,arguments)}}(),dt=function(){var St=(0,F.Z)((0,x.Z)().mark(function se(ke){var fe,pt,Wt,ue,te,$t,Mr,At,Kr;return(0,x.Z)().wrap(function(xt){for(;;)switch(xt.prev=xt.next){case 0:Wt=Pt==null||(fe=Pt.current)===null||fe===void 0?void 0:fe.getFieldsValue().chargeLists,ue=Wt[ke],te=ue.amount,ue.surplus=Number(ue.arrears)-te,ue.fFalg=Nt[ke]?"true":"false",hr.indexOf(Ct.Z.getCascaderAllName("dict_reg_job",ue.project))>=0||te%ue.quantity!=0?ue.description="":($t="",te-ue.arrears>=0&&ue.PaymentLength==0?$t="\u5168\u6B3E":te-ue.arrears>=0&&ue.PaymentLength!=0?$t="\u5C3E\u6B3E":$t="\u7B2C"+pr[ue.PaymentLength]+"\u6B21",Mr=ue.quantity+"*",At=(te-(ue.collectedAmount||0))/ue.quantity,ue.description=$t+Mr+At),ue.percent&&(Kr=ue.percent.slice(0,ue.percent.indexOf("%")),ue.percents=Kr/100*te),ue.collectedAmount!=null&&(ue.performanceAmount=te-ue.collectedAmount,ue.commissionBase=te-ue.collectedAmount),We(Wt),Pt==null||(pt=Pt.current)===null||pt===void 0||pt.setFieldsValue({chargeLists:Wt});case 10:case"end":return xt.stop()}},se)}));return function(ke){return St.apply(this,arguments)}}(),dr=function(){var St=(0,F.Z)((0,x.Z)().mark(function se(ke,fe){var pt,Wt;return(0,x.Z)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return Wt=Pt==null||(pt=Pt.current)===null||pt===void 0?void 0:pt.getFieldsValue().chargeLists[fe],te.next=3,gt.Z.post("/sms/business/bizCharge/reports/setIsCalculation",{ids:Wt.chargeId,isCalculation:ke});case 3:case"end":return te.stop()}},se)}));return function(ke,fe){return St.apply(this,arguments)}}();(0,r.useImperativeHandle)(ht,function(){return{submitok:iu,formRefs:Pt}}),(0,r.useEffect)(function(){R()},[Xr]);var Pt=(0,r.useRef)();(0,r.useEffect)(function(){var St;Pt==null||(St=Pt.current)===null||St===void 0||St.setFieldsValue({chargeTime:pe()().format("YYYY-MM-DD HH:mm:ss")}),v(),Tt(nr)},[]);var $r=function(se,ke){return ke.some(function(fe){return fe.label.toLowerCase().indexOf(se.toLowerCase())>-1})},du=function(se){var ke,fe,pt=Pt==null||(ke=Pt.current)===null||ke===void 0?void 0:ke.getFieldValue("chargeLists"),Wt=pt[se],ue=Wt.price||0,te=Wt.quantity||0;Wt.amounts=ue*te,(fe=Pt.current)===null||fe===void 0||fe.setFieldValue("chargeLists",pt),console.log(pt)},nu=function(se){Object.keys(se).forEach(function(ke){(se[ke]==null||se[ke]=="undefined"||se[ke]==null)&&delete se[ke]})},iu=function(se){var ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"add";at(!0),Nt||delete se.fapiao;var fe="",pt=[],Wt=[];if(se.files){var ue=[];se.files.forEach(function(te){ue.push(te.response.data)}),se.files=ue.join(",")}return B.orderId?se.id=B.studentId:se.orderId=B.id,se.fapiao&&(fe=se.fapiao[0],delete se.fapiao),B.type=="orders"&&(se.agent=Xr.id,se.paymentTime=se.chargeTime,st.length>0&&(se.servedOrderIds=st.join(","))),se.userId=Pr.id,se.departmentId=Pr.departmentId,se.type==null&&(se.type=B.type=="orders"?"1":0),vr=="6"&&(se.chargeLogIds=Ae==null?void 0:Ae.map(function(te){return te.id}).join(",")),se.chargeLists.forEach(function(te){pt.push({chargeLogIds:se.chargeLogIds,chargeTime:se.chargeTime,method:se.method,userId:se.userId,departmentId:se.departmentId,type:se.type,paymentTime:se.paymentTime,id:te.chargeId,orderId:te.orderId,description:te.description,description2:te.description2,amount:te.amount,collectedAmount:te.collectedAmount,performanceAmount:te.performanceAmount,commissionBase:te.commissionBase,isSubmit:!0,files:se.files}),te.fFalg=="false"?Wt.push({}):Wt.push({account:te.account,address:te.address,chargeId:te.chargeId,amount:te.amounts,id:te.invoiceId,bank:te.bank,title:te.title,productType:te.productType,price:te.price,quantity:te.quantity,chargeAccount:te.chargeAccount,taxCode:te.taxCode,email:te.email,remark:te.remark,cautions:te.cautions,type:te.invoiceType,mobile:te.mobile})}),nu(pt),nu(se),new Promise(function(te){var $t=B.types=="eidt"?"/sms/business/bizCharge/edit":"/sms/business/bizCharge/saves",Mr=B.types=="eidt"?pt:{array:pt,array2:Wt};gt.Z.postAll($t,Mr).then(function(At){if(At.status=="success"){var Kr=function(){X.default.success("\u64CD\u4F5C\u6210\u529F"),Dt&&(at(!1),Dt(),Xt()),te(At)};if(B.types=="eidt"){var Ve=[];Wt.forEach(function(E){console.log("123",Object.keys(E)),Object.keys(E).length>0&&Ve.push(E)})}if(ke=="audit"){console.log("value.chargeLists",se.chargeLists);var xt=[];se.chargeLists.forEach(function(){var E=(0,F.Z)((0,x.Z)().mark(function Cr(Rr){var ar;return(0,x.Z)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return xt.push(gt.Z.post("/sms/business/bizAudit",{entityId:Rr.chargeId,confirm:!0,auditType:"0"})),oe.next=3,gt.Z.get("/sms/business/bizInvoice",{enable:!0,chargeIds:Rr.chargeId});case 3:ar=oe.sent.data.content,ar.length>0&&xt.push(gt.Z.post("/sms/business/bizAudit",{entityId:ar[0].id,confirm:!0,auditType:"11"}));case 5:case"end":return oe.stop()}},Cr)}));return function(Cr){return E.apply(this,arguments)}}()),Promise.all(xt).then(function(E){Kr()}).catch(function(E){at(!1)})}else Kr()}}).catch(function(At){te(!0)})})},lu=function(se){return se&&se<pe()().subtract(2,"month").endOf("month")};return(0,b.jsxs)(h.ZP,{submitter:Z==="step"?!1:{render:function(se,ke){return(0,b.jsx)(o.Z,{children:(0,b.jsx)(i.Z,{span:24,offset:17,children:(0,b.jsxs)(m.Z,{children:[ke,(0,b.jsx)(M.Z,{spinning:_t,children:(0,b.jsx)(J.Z,{htmlType:"button",type:"primary",hidden:B.types!="eidt",onClick:(0,F.Z)((0,x.Z)().mark(function fe(){var pt,Wt;return(0,x.Z)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:(pt=Pt.current)===null||pt===void 0||(Wt=pt.validateFieldsReturnFormatValue)===null||Wt===void 0||Wt.call(pt).then(function(){var $t=(0,F.Z)((0,x.Z)().mark(function Mr(At){return(0,x.Z)().wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return console.log("\u6821\u9A8C\u8868\u5355\u5E76\u8FD4\u56DE\u683C\u5F0F\u5316\u540E\u7684\u6240\u6709\u6570\u636E\uFF1A",At),Ve.next=3,iu(At,"audit");case 3:case"end":return Ve.stop()}},Mr)}));return function(Mr){return $t.apply(this,arguments)}}());case 1:case"end":return te.stop()}},fe)})),children:"\u4FEE\u6539\u5E76\u5BA1\u6838\u901A\u8FC7"},"edit-charge-new-1")}),(0,b.jsxs)(M.Z,{spinning:_t,children:[(0,b.jsx)(J.Z,{htmlType:"button",type:"dashed",hidden:B.types!="eidt",onClick:(0,F.Z)((0,x.Z)().mark(function fe(){var pt,Wt;return(0,x.Z)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:for(pt=[],Wt=0;Wt<B.list.length;Wt++)pt[Wt]=B.list[Wt].id;w({id:pt,type:0,confirm:!1}),Jt(!0);case 4:case"end":return te.stop()}},fe)})),children:"\u4E0D\u901A\u8FC7"},"edit-charge-new-2"),(0,b.jsx)(Ye.Z,{setModalVisible:function(){return Jt(!1)},modalVisible:Sr,callbackRef:function(){Xt(),Dt()},renderData:H})]})]})})})}},formRef:Pt,autoFocusFirstInput:!0,initialValues:{userId:Pr==null?void 0:Pr.id},onFinish:function(){var St=(0,F.Z)((0,x.Z)().mark(function se(ke){return(0,x.Z)().wrap(function(pt){for(;;)switch(pt.prev=pt.next){case 0:return pt.next=2,iu(ke);case 2:case"end":return pt.stop()}},se)}));return function(se){return St.apply(this,arguments)}}(),children:[(0,b.jsx)(M.Z,{spinning:It,children:(0,b.jsxs)("div",{className:"scolle",style:{overflowX:"auto",paddingBottom:"100px"},children:[(0,b.jsxs)("div",{style:{marginBottom:"15px"},children:["\u8BA2\u5355\u7F16\u53F7\uFF1A",B.list[0].num]}),(0,b.jsxs)(h.ZP.Group,{children:[B.type=="orders"?(0,b.jsx)(ie.Z,{label:"\u7F34\u8D39\u7C7B\u578B",name:"type",width:"md",request:(0,F.Z)((0,x.Z)().mark(function St(){return(0,x.Z)().wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:return ke.abrupt("return",Ct.Z.getList("chargeType"));case 1:case"end":return ke.stop()}},St)})),required:!0,disabled:!0,fieldProps:{defaultValue:B.type=="orders"?["\u8BA2\u5355\u9000\u8D39"]:["\u8BA2\u5355\u7F34\u8D39"]}}):(0,b.jsx)(ie.Z,{label:"\u7F34\u8D39\u7C7B\u578B",name:"type",width:"md",request:(0,F.Z)((0,x.Z)().mark(function St(){var se;return(0,x.Z)().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return fe.abrupt("return",(se=Ct.Z.getList("chargeType"))===null||se===void 0?void 0:se.filter(function(pt){return["0","4","5","6"].indexOf(pt.value)!=-1}));case 1:case"end":return fe.stop()}},St)})),fieldProps:{onChange:function(se){var ke;console.log("e",se),Tt(se),(ke=Pt.current)===null||ke===void 0||ke.setFieldValue("paymentTime",void 0)}},required:!0,initialValue:nr,disabled:nr!=null}),vr=="6"&&(0,b.jsx)(Ee.Z,{label:"\u6536\u6B3E\u8BB0\u5F55",name:"chargeLogName",width:"md",rules:[{required:!0}],fieldProps:{onClick:function(){return Rt(null),G(!0),!1}}}),(0,b.jsx)(ie.Z,{label:"\u4ED8\u6B3E\u65B9\u5F0F",name:"method",width:"md",disabled:vr=="6",request:(0,F.Z)((0,x.Z)().mark(function St(){return(0,x.Z)().wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:return ke.abrupt("return",Ct.Z.getList("dict_stu_refund_type"));case 1:case"end":return ke.stop()}},St)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4ED8\u6B3E\u65B9\u5F0F"}]}),(0,b.jsx)(t.Z,{ref:rr,userLabel:B.type=="orders"?"\u9000\u8D39\u4EBA":"\u6536\u8D39\u4EBA",userNames:"userId",userPlaceholder:"\u8BF7\u8F93\u5165\u62DB\u751F\u8001\u5E08\u7684\u540D\u5B57",setUserNameId:function(se){return wr(se)},disabled:vr=="6",flag:!0})]}),(0,b.jsx)(h.ZP.Group,{children:B.type=="orders"?"":(0,b.jsx)(b.Fragment,{})}),(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)(p.Z,{name:"chargeTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"md",label:"".concat(Ke,"\u65E5\u671F"),rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7F34\u8D39\u65E5\u671F"}]}),(0,b.jsx)(s.Z,{name:"paymentTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"md",hidden:B.type=="orders",label:"".concat(Ke=="\u6536\u8D39"?"\u5B9E\u9645\u5230\u8D26":Ke,"\u65E5\u671F"),disabled:["4","6"].indexOf(vr)!=-1,rules:[{required:B.type!="orders"&&["4","6"].indexOf(vr)==-1,message:"\u8BF7\u586B\u5199\u7F34\u8D39\u65E5\u671F"}]}),(0,b.jsx)(s.Z,{name:"nextPaymentTime",width:"md",label:"\u4E0B\u6B21\u7F34\u8D39\u65F6\u95F4",fieldProps:{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"},hidden:B.type=="orders",disabled:B.type=="orders"})]}),(0,b.jsx)(O.u,{name:"chargeLists",creatorButtonProps:!1,deleteIconProps:!1,copyIconProps:!1,itemRender:function(se,ke){var fe=se.listDom,pt=se.action,Wt=ke.record,ue=ke.index,te=ke.name;return(0,b.jsx)(et.ZP,{bordered:!0,style:{marginBottom:8},title:"\u8BA2\u5355\u73ED\u578B\u8BE6\u60C5\u7F34\u8D39",children:(0,b.jsxs)(c.UW,{children:[(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)(Ee.Z,{label:"\u62A5\u540D\u5B66\u5458/\u4F01\u4E1A",name:"studentName",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u9879\u76EE\u603B\u79F0",name:"parentProjectList",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u62A5\u8003\u5C97\u4F4D",name:"projectList",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u8BA2\u5355\u73ED\u578B",name:"banxin",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u73ED\u578B\u6536\u8D39\u6807\u51C6",name:"receivable",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u8BA2\u5355\u4EBA\u6570",name:"quantity",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u8BA2\u5355\u5E94\u6536\u603B\u989D",name:"totalReceivable",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u8BA2\u5355\u4F18\u60E0\u91D1\u989D",name:"discount",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u8BA2\u5355\u5DF2\u6536\u91D1\u989D",name:"charge",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u8BA2\u5355\u5F53\u524D\u6B20\u8D39",name:"arrears",readonly:!0})]}),(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)(le.Z,{label:"\u672C\u6B21".concat(Ke,"\u91D1\u989D"),name:"amount",width:"sm",fieldProps:{precision:2,onChange:function(Mr){dt(ue)}},rules:[{required:!0}]}),B.type!="orders"&&(0,b.jsx)(le.Z,{hidden:B.type=="orders",tooltip:"\u8FD4\u4EE3\u7406\u8D39\u3001\u5FEB\u9012\u8D39\u3001\u7A0E\u8D39\uFF0C\u4E0D\u5305\u542B\u5728\u6536\u8D39\u6807\u51C6\u91CC\u7684\u62A5\u540D\u8D39\u7B49",label:"\u4EE3\u6536\u6B3E\u9879",name:"collectedAmount",width:"sm",fieldProps:{onChange:function(Mr){dt(ue)}},rules:[{required:!0}]}),(0,b.jsx)(le.Z,{label:"\u4E1A\u7EE9\u91D1\u989D"+_,readonly:B.types!="eidt",name:"performanceAmount",width:"sm"}),(0,b.jsx)(le.Z,{label:"\u63D0\u6210\u57FA\u6570"+_,readonly:B.types!="eidt",name:"commissionBase",width:"sm"}),(0,b.jsx)(Ee.Z,{label:"\u8BA2\u5355\u6765\u6E90",name:"source",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u672C\u6B21\u6536\u8D39\u540E\u5269\u4F59\u5C3E\u6B3E",name:"surplus",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u8BA2\u5355\u4F18\u60E0\u539F\u56E0",name:"discountRemark",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u4FE1\u606F\u6240\u6709\u4EBA",name:"ownerName",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u4FE1\u606F\u6240\u6709\u4EBA\u5206\u6210\u6BD4\u4F8B",name:"percent",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u4FE1\u606F\u6240\u6709\u4EBA\u5206\u6210\u91D1\u989D",name:"percents",readonly:!0}),(0,b.jsx)(Ee.Z,{label:"\u4FE1\u606F\u63D0\u4F9B\u4EBA",name:"providerName",readonly:!0}),(0,b.jsx)(J.Z,{type:"primary",onClick:function(){gt.Z.get("/sms/business/bizOrder",{id:Wt.orderId}).then(function(Mr){ye(Mr.data.content[0]),console.log(Wt),y(!0)})},children:"\u7F16\u8F91\u8BA2\u5355"})]}),(0,b.jsx)($.Z,{width:1100,label:B.type!="orders"?"\u5907\u6CE8":"\u9000\u6B3E\u539F\u56E0",name:"description",rules:[{required:!0}]}),(0,b.jsx)($.Z,{hidden:B.types!="eidt",width:1100,label:"\u8D22\u52A1\u5907\u6CE8",name:"description2"}),(0,b.jsxs)("div",{hidden:B.types!="eidt",children:[(0,b.jsx)(h.ZP.Group,{title:"\u53D1\u7968\u4FE1\u606F"}),(0,b.jsx)(it.Z,{chargeId:Ze[ue]})]}),(0,b.jsxs)("div",{hidden:B.type=="orders"||B.types=="eidt",children:[(0,b.jsx)(ie.Z,{name:"fFalg",label:"\u662F\u5426\u5F00\u5177\u53D1\u7968",valueEnum:{false:"\u5426",true:"\u662F"},width:"xs",fieldProps:{onChange:function(Mr){var At=JSON.parse(JSON.stringify(Qt));console.log("renderDatass",B),Mr=="false"?(At[ue]=!1,Qt=At,tt(At)):(ft(!0,ue),At[ue]=!0,Qt=At,tt(At))},placeholder:"\u8BF7\u9009\u62E9"}}),!!Nt[ue]&&(0,b.jsxs)("div",{hidden:!Nt[ue],children:[(0,b.jsx)(h.ZP.Group,{title:"\u7A0E\u7968\u4FE1\u606F",children:(0,b.jsx)(gr.Z,{})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)(Ee.Z,{name:"title",label:"\u53D1\u7968\u62AC\u5934",width:"lg",required:!0}),(0,b.jsx)(ie.Z,{label:"\u5546\u54C1\u79CD\u7C7B",name:"productType",width:"md",initialValue:"0",required:!0,request:(0,F.Z)((0,x.Z)().mark(function $t(){return(0,x.Z)().wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.abrupt("return",Ct.Z.getList("invoiceProductType"));case 1:case"end":return At.stop()}},$t)}))})]}),(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)(ie.Z,{label:"\u4ED8\u6B3E\u65B9\u5F0F",name:"chargeAccount",rules:[{required:!0}],width:"md",request:(0,F.Z)((0,x.Z)().mark(function $t(){return(0,x.Z)().wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.abrupt("return",Ct.Z.getList("dict_stu_refund_type"));case 1:case"end":return At.stop()}},$t)}))}),(0,b.jsx)(le.Z,{name:"price",label:"\u5355\u4EF7",rules:[{required:!0}],fieldProps:{onChange:function(Mr){return du(ue)}}}),(0,b.jsx)(le.Z,{name:"quantity",label:"\u6570\u91CF",rules:[{required:!0}],fieldProps:{onChange:function(Mr){return du(ue)}}})]}),(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)(Ee.Z,{name:"taxCode",label:"\u7A0E\u53F7",width:"md",required:!0}),(0,b.jsx)(le.Z,{name:"amounts",label:"\u91D1\u989D",width:"md",required:!0,fieldProps:{precision:2}}),(0,b.jsx)(Ee.Z,{name:"email",label:"\u5B66\u5458\u90AE\u7BB1",width:"md",required:!0,fieldProps:{autoComplete:"no"}})]}),(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)($.Z,{width:1100,label:"\u53D1\u7968\u5907\u6CE8",name:"remark",fieldProps:{autoComplete:"no"}}),(0,b.jsx)($.Z,{width:1100,label:"\u6CE8\u610F\u4E8B\u9879",name:"cautions",fieldProps:{autoComplete:"no"}})]}),(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)(ie.Z,{label:"\u53D1\u7968\u79CD\u7C7B",name:"invoiceType",width:"md",fieldProps:{onChange:function(Mr){var At=JSON.parse(JSON.stringify(mt));Mr==0?(At[ue]=!1,mt=At,er(At),nt(!1)):(At[ue]=!0,mt=At,er(At),nt(!0))}},initialValue:"0",request:(0,F.Z)((0,x.Z)().mark(function $t(){return(0,x.Z)().wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.abrupt("return",Ct.Z.getList("invoiceType"));case 1:case"end":return At.stop()}},$t)}))}),(0,b.jsx)(a.Z.Group,{hidden:Ce,name:"hasAccount",layout:"vertical",label:" ",options:["\u586B\u5199\u8D26\u53F7\u4FE1\u606F"],fieldProps:{onChange:function(Mr){var At=JSON.parse(JSON.stringify(mt));Mr.length>0?(At[ue]=!0,mt=At,er(At)):(At[ue]=!1,mt=At,er(At))}}})]}),(0,b.jsxs)("div",{hidden:!yt[ue],children:[(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)(Ee.Z,{name:"bank",label:"\u5F00\u6237\u884C",width:"md",rules:[{required:!!yt[ue]}]}),(0,b.jsx)(Ee.Z,{name:"account",label:"\u8D26\u53F7",width:"md",rules:[{required:!!yt[ue]}]})]}),(0,b.jsxs)(h.ZP.Group,{children:[(0,b.jsx)(Ee.Z,{name:"mobile",label:"\u7535\u8BDD",width:"md",rules:[{required:!!yt[ue]}]}),(0,b.jsx)(Ee.Z,{name:"address",label:"\u5730\u5740",width:"md",rules:[{required:!!yt[ue]}]})]})]})]})]})]})]},"charge-new-form-".concat(ue))},"charge-new-".concat(ue))}}),(0,b.jsx)(h.ZP.Group,{children:(0,b.jsx)(he.Z,{width:1100,label:"\u4E0A\u4F20\u9644\u4EF6",name:"files",action:"/sms/business/bizCharge/upload",renderData:T||B.list[0],fileUrl:"/sms/business/bizCharge/download"})}),(0,b.jsxs)(o.Z,{hidden:B.type=="orders",style:{width:"1100px",backgroundColor:"#d9edf7",border:"1px solid #bce8f1",padding:"20px",marginBottom:"20px"},children:[(0,b.jsx)(i.Z,{span:2,style:{color:"red"},children:"\u6CE8\u610F\uFF1A"}),(0,b.jsxs)(i.Z,{span:22,children:["\uFF081\uFF09\u5982\u5BA2\u6237\u540D\u79F0\u4E0E\u5B9E\u9645\u4ED8\u6B3E\u4EBA\u4E0D\u4E00\u81F4\uFF0C\u8BF7\u5907\u6CE8\u5B9E\u9645\u4ED8\u6B3E\u4EBA\u59D3\u540D\u3002",(0,b.jsx)("br",{}),"\uFF082\uFF09\u5982\u6536\u8D39\u91D1\u989D\u4E2D\u5305\u542B\u4EE3\u7406\u8D39\uFF0C\u8BF7\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u5907\u6CE8\u6E05\u695A\u3002",(0,b.jsx)("br",{}),"\uFF083\uFF09\u5B66\u5386\u9879\u76EE\u8BF7\u6309\u4EE5\u4E0B\u793A\u4F8B\u586B\u5199\u5907\u6CE8\u680F\uFF1A",(0,b.jsx)("br",{}),"\u2460\u6210\u8003\uFF1A",(0,b.jsx)("br",{}),"A.\u672A\u4EA4\u9F50\u7B2C\u4E00\u5E74\u5B66\u8D39\uFF1A\u670D\u52A1\u8D391200+\u7B2C\u4E00\u5E74\u5B66\u8D39\u7B2C\u4E00\u6B21\u4ED8\u6B3E1000\uFF0823\u5E74 \u6E56\u5357\u5DE5\u4E1A\u5927\u5B66 \u673A\u7535\u4E00\u4F53\u5316\u679D\u672F \u9AD8\u5347\u4E13 \uFF09 \u56E0\u4E2A\u4EBA\u539F\u56E0\u62A5\u8003\u6210\u529F\uFF0C\u8003\u8BD5\u51FA\u73B00\u5206\uFF0C\u5F55\u53D6\u4E0D\u8BFB\uFF0C\u6B64\u8D39\u7528\u5747\u4E0D\u9000\uFF0C\u53EF\u5EF6\u7EED\u670D\u52A1",(0,b.jsx)("br",{}),"B.\u7B2C\u4E8C\u6B21\u4ED8\u6B3E\u5E76\u4EA4\u9F50\u7B2C\u4E00\u5E74\u5B66\u8D39\u7684\uFF1A\u7B2C\u4E00\u5E74\u5B66\u8D39\u5C3E\u6B3E1200\uFF0823\u5E74 \u6E56\u5357\u5DE5\u4E1A\u5927\u5B66 \u673A\u7535\u4E00\u4F53\u5316\u679D\u672F \u9AD8\u5347\u4E13 \uFF09",(0,b.jsx)("br",{}),"\u2461\u56FD\u5F00\u548C\u7F51\u6559\uFF1A",(0,b.jsx)("br",{}),"A.\u7B2C\u4E00\u6B21\u4ED8\u6B3E\uFF0C\u672A\u4EA4\u9F50\u7B2C\u4E00\u5E74\u5B66\u8D39\u7684\uFF1A\u7B2C\u4E00\u5E74\u5B66\u8D39\u7B2C\u4E00\u6B21\u4ED8\u6B3E2000\uFF0823\u6625 \u6B66\u6C49\u7406\u5DE5\u5927\u5B66 \u4E13\u5347\u672C \u571F\u6728\u5DE5\u7A0B\u4E13\u4E1A\uFF09",(0,b.jsx)("br",{}),"B.\u7B2C\u4E8C\u6B21\u4ED8\u6B3E\u5E76\u4EA4\u9F50\u7B2C\u4E00\u5E74\u5B66\u8D39\u7684\uFF1A\u7B2C\u4E00\u5E74\u5B66\u8D39\u5C3E\u6B3E2500\uFF0823\u6625 \u6B66\u6C49\u7406\u5DE5\u5927\u5B66 \u4E13\u5347\u672C \u571F\u6728\u5DE5\u7A0B\u4E13\u4E1A\uFF09"]})]})]})}),Ie&&(0,b.jsx)(ut.Z,{CardVisible:Ie,CardContent:we,setCardVisible:function(){return Ot(!1)},setDepartment:function(se){return ru(se)},departments:[Xr]}),Gt&&(0,b.jsx)(tr.Z,{imgSrc:Be,isModalVisibles:Gt,setisModalVisibles:function(se){return kt(se)}}),(0,b.jsx)(g.Z,{width:1200,open:yr,onCancel:function(){return Zr(!1)},onOk:function(){return Zr(!1)},children:(0,b.jsx)(ot.Z,{setChargeModal:function(){return Zr(!1)},setChargeInfo:function(se){return me(se)},type:"0",studentType:B.studentType,chargeType:"chargeList",chargeTypes:!0})}),(0,b.jsx)(g.Z,{width:1e3,open:Zt,onCancel:function(){return Fe(!1)},onOk:function(){return Fe(!1)},children:(0,b.jsx)(Ft.Z,{setChargeModals:function(){return Fe(!1)},setFromDataUp:function(se){Wr(se)}})}),(0,b.jsx)(g.Z,{title:"\u7F16\u8F91",width:1200,visible:N,onCancel:function(){return y(!1)},destroyOnClose:!0,footer:null,children:N&&(0,b.jsx)(tu,{ref:Nr,editAll:B.types=="eidt",setModalVisible:function(){return y(!1)},modalVisible:N,callbackRef:function(){return uu(xe.id)},renderData:(0,f.Z)((0,f.Z)({},xe),{},{type:"order",orderNumber:0,projectClassExamList:[]})})}),(0,b.jsx)(g.Z,{title:"\u9009\u62E9\u6536\u6B3E\u8BB0\u5F55",width:1200,visible:q,onCancel:function(){return G(!1)},footer:null,children:(0,b.jsx)(u.default,{select:Rt,type:1})})]})}},26802:function(ce,D,e){"use strict";var j=e(71194),g=e(50146),V=e(98858),o=e(4914),I=e(57663),i=e(71577),A=e(13062),m=e(71230),L=e(89032),M=e(15746),d=e(49111),J=e(19650),ne=e(34792),X=e(48086),x=e(86582),F=e(39428),f=e(3182),P=e(11849),r=e(2824),p=e(43358),O=e(34041),c=e(67294),a=e(45510),h=e(59962),ie=e(952),Ee=e(31199),s=e(64317),le=e(5966),$=e(22452),bt=e(90672),pe=e(22),Ct=e(30381),gt=e.n(Ct),et=e(37490),ae=e(63863),ut=e(30202),ot=e(21010),tr=e(14037),he=e(98580),Ft=e(28975),gr=e(50717),it=e(6821),t=e(19103),Ye=e(47038),l=e(85893);function u(ht){return new Promise(function(jr,$e){var sr=new FileReader;sr.readAsDataURL(ht),sr.onload=function(){return jr(sr.result)},sr.onerror=function(Y){return $e(Y)}})}var b=null,n=O.Z.Option;D.Z=function(ht,jr){var $e,sr,Y,Dt,re=ht.modalVisible,Xt=ht.setModalVisible,B=Xt===void 0?void 0:Xt,Z=ht.callbackRef,nr=Z===void 0?void 0:Z,De=ht.renderData,xr=ht.callback,zt=ht.admin,Ut=ht.setPreviewImage,Gt=ht.setPreviewVisible,kt="/sms/business/bizCharge/complex",Kt=(0,ot.tT)("@@initialState"),Bt=Kt.initialState,Ie=(0,c.useState)(!1),Ot=(0,r.Z)(Ie,2),Je=Ot[0],jt=Ot[1],_t=(0,c.useState)(0),at=(0,r.Z)(_t,2),Ht=at[0],qt=at[1],yr=(0,c.useState)(!1),Zr=(0,r.Z)(yr,2),_e=Zr[0],or=Zr[1],Zt=(0,c.useState)(!1),Fe=(0,r.Z)(Zt,2),vt=Fe[0],Qe=Fe[1],Be=(0,c.useState)(!1),Mt=(0,r.Z)(Be,2),fr=Mt[0],Ue=Mt[1],vr=(0,c.useState)(!1),Tt=(0,r.Z)(vr,2),Pe=Tt[0],ze=Tt[1],Ae=(0,c.useState)(!1),Rt=(0,r.Z)(Ae,2),S=Rt[0],Xe=Rt[1],we=(0,c.useState)(),qe=(0,r.Z)(we,2),Yt=qe[0],Te=qe[1],N=(0,c.useState)(),y=(0,r.Z)(N,2),W=y[0],k=y[1],xe=(0,c.useState)(!1),ye=(0,r.Z)(xe,2),Ne=ye[0],je=ye[1],q=(0,c.useState)(!1),G=(0,r.Z)(q,2),K=G[0],Et=G[1],yt=(0,c.useState)(0),er=(0,r.Z)(yt,2),Se=er[0],Vt=er[1],Nt=(0,c.useState)(0),tt=(0,r.Z)(Nt,2),ir=tt[0],wt=tt[1],Or=(0,c.useState)([]),We=(0,r.Z)(Or,2),Le=We[0],ve=We[1],st=(0,c.useState)([]),ct=(0,r.Z)(st,2),br=ct[0],_r=ct[1],Fr=(0,c.useState)(),Ir=(0,r.Z)(Fr,2),Ar=Ir[0],Ge=Ir[1],Pr=(0,c.useState)(!1),wr=(0,r.Z)(Pr,2),Re=wr[0],lt=wr[1],Ze=(0,c.useState)(!0),cr=(0,r.Z)(Ze,2),Q=cr[0],ee=cr[1],T=(0,c.useState)(""),me=(0,r.Z)(T,2),U=me[0],Me=me[1],It=(0,c.useState)([]),be=(0,r.Z)(It,2),z=be[0],He=be[1],Sr=(0,c.useState)([]),Jt=(0,r.Z)(Sr,2),mr=Jt[0],Er=Jt[1],H=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D"],w=["\u6210\u8003","\u56FD\u5BB6\u5F00\u653E\u5927\u5B66	"],C=(0,c.useState)(!1),Oe=(0,r.Z)(C,2),Ce=Oe[0],nt=Oe[1],pr=(0,c.useRef)(null),Qt=(0,c.useState)({name:Bt==null||($e=Bt.currentUser)===null||$e===void 0?void 0:$e.name,id:Bt==null||(sr=Bt.currentUser)===null||sr===void 0?void 0:sr.userid}),mt=(0,r.Z)(Qt,2),hr=mt[0],Lr=mt[1],Br=sessionStorage.getItem("tokenName"),Vr=sessionStorage.getItem("tokenValue"),Wr={};Wr[Br]=Vr;var rr=De.type=="orders"?"\u9000\u8D39":"\u6536\u8D39",Nr=function(){var _;lr==null||(_=lr.current)===null||_===void 0||_.setFieldsValue({agent:hr.name})};(0,c.useEffect)(function(){if(De.type!="orders"&&!(w.indexOf(et.Z.getCascaderAllName("dict_reg_job",De.project))>=0)&&Se!=0)if(De.studentType==0){var Ke,_="1*".concat(Se),R="";z.length==0?De.arrears-Se-ir<=0?R="\u5168\u6B3E":R="\u7B2C"+H[z.length]+"\u6B21\u4ED8\u6B3E":De.arrears-Se-ir<=0?R="\u5C3E\u6B3E":R="\u7B2C"+H[z.length]+"\u6B21\u4ED8\u6B3E",lr==null||(Ke=lr.current)===null||Ke===void 0||Ke.setFieldsValue({description:R+" "+_})}else{var v=De.quantity,ft=Se-ir,Lt="";if((0,Ye.zs)(Se,v)){var ur,dt="".concat(v," * ").concat(Se/v);z.length==0?De.arrears-Se-ir<=0?Lt="\u5168\u6B3E":Lt="\u7B2C"+H[z.length]+"\u6B21\u4ED8\u6B3E":De.arrears-Se-ir<=0?Lt="\u5C3E\u6B3E":Lt="\u7B2C"+H[z.length]+"\u6B21\u4ED8\u6B3E",lr==null||(ur=lr.current)===null||ur===void 0||ur.setFieldsValue({description:Lt+" "+dt})}else{var dr;lr==null||(dr=lr.current)===null||dr===void 0||dr.setFieldsValue({description:""})}}},[Se,ir]),(0,c.useEffect)(function(){!Re||setTimeout(function(){var Ke,_=Re,R=[],v=[];Re.files&&Re.files.split(",").forEach(function(ft,Lt){v.push({uid:Lt+1,name:ft,response:{data:ft}})}),_.invoiceTitle&&R.push({title:_.invoiceTitle,productType:_.invoiceProductType+"",taxCode:_.invoiceTaxCode,amount:_.invoiceAmount,email:_.invoiceEmail,remark:_.invoiceRemark,cautions:_.invoiceCautions,type:_.invoiceType+"",bank:_.invoiceBank,account:_.invoiceAccount,mobile:_.invoiceMobile,address:_.invoiceAddress}),Vt(_.amount),_.type=_.type+"",_.refundType=_.refundType+"",_.agent=Re.agentName,pr.current.setDepartment({id:Re.userId,name:Re.userName}),Et(!!_.invoiceTitle),je(!!_.invoiceType),delete _.description,lr==null||(Ke=lr.current)===null||Ke===void 0||Ke.setFieldsValue((0,P.Z)((0,P.Z)({},_),{},{method:Re.method.toString(),files:v,fFalg:_.invoiceTitle?"\u662F":"\u5426",fapiao:R}))},100)},[Re]);var tu=function(){var Ke=(0,f.Z)((0,F.Z)().mark(function _(R){var v,ft;return(0,F.Z)().wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return ur.next=2,ae.Z.get("/sms/contract/conCompany",{name:R});case 2:if(v=ur.sent,v.data.content.length!=0){ur.next=7;break}return ur.abrupt("return","0");case 7:if(!v.data.content[0].chargeMethod){ur.next=12;break}return ft=v.data.content[0].chargeMethod.split(",")[0],ur.abrupt("return",ft);case 12:return ur.abrupt("return","0");case 13:case"end":return ur.stop()}},_)}));return function(R){return Ke.apply(this,arguments)}}();(0,c.useEffect)(function(){if(!!Ce&&!!Ce.chargeTime){var Ke=tu(Ce.corporateName),_=Ce.chargeTime.substring(0,10),R=Ce.chargeTime.substring(0,10)+" "+Ce.chargeTime.substring(10);if(Ce.amount&&Vt(Number(Ce.amount)),R.indexOf("\u5E74")>=0){console.log("paymentTime",R);var v=/|/g;R=R.replace(v,"-").replace("\u65E5","")}setTimeout((0,f.Z)((0,F.Z)().mark(function ft(){var Lt;return(0,F.Z)().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:if(lr!=null){dt.next=4;break}dt.next=19;break;case 4:if(!((Lt=lr.current)===null||Lt===void 0)){dt.next=8;break}dt.next=19;break;case 8:return dt.t0=Lt,dt.t1=Ce.amount,dt.t2=R,dt.next=13,Ke;case 13:dt.t3=dt.sent,dt.t4=dt.t3+"",dt.t5=[],dt.t6=Ce.files,dt.t7={amount:dt.t1,paymentTime:dt.t2,method:dt.t4,discount:0,fFalg:"\u5426",fapiao:dt.t5,files:dt.t6},dt.t0.setFieldsValue.call(dt.t0,dt.t7);case 19:case"end":return dt.stop()}},ft)})),100)}},[Ce]),(0,c.useEffect)(function(){Nr()},[hr]);var Tr=[{title:"\u5B66\u5458",dataIndex:"studentName",sorter:!0},{title:"\u6240\u5C5E\u56E2\u7EC4",dataIndex:"studentParentName",sorter:!0,render:function(_,R){return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("span",{children:[" ",R.studentParentName]})})}},{title:"\u62A5\u8003\u73ED\u578B",dataIndex:"classType",sorter:!0,valueEnum:et.Z.getSearch("dict_class_type"),render:function(_,R){return(0,l.jsx)(l.Fragment,{children:et.Z.getName("dict_class_type",R.classType)})}},{title:"\u73ED\u578B\u5E74\u9650",sorter:!0,dataIndex:"classYear",valueEnum:et.Z.getSearch("dict_class_year"),render:function(_,R){return(0,l.jsx)(l.Fragment,{children:et.Z.getName("dict_class_year",R.classYear)})}},{title:"\u8003\u8BD5\u7C7B\u578B",sorter:!0,dataIndex:"examType",valueEnum:et.Z.getSearch("dict_exam_type"),render:function(_,R){return(0,l.jsx)(l.Fragment,{children:et.Z.getName("dict_exam_type",R.examType)})}},{title:"\u62A5\u8003\u5C97\u4F4D",dataIndex:"project",key:"project",sorter:!0,valueType:"cascader",fieldProps:{options:et.Z.getCascader("dict_reg_job")},render:function(_,R){return(0,l.jsx)("span",{children:R.project&&(0,x.Z)(new Set(R.project.split(","))).map(function(v,ft){return(0,l.jsxs)("span",{children:[et.Z.getCascaderName("dict_reg_job",v)," ",(0,l.jsx)("br",{})]},"charge-order-".concat(v,"-").concat(ft))})},"project")}}],lr=(0,c.useRef)();(0,c.useImperativeHandle)(jr,function(){return{submitok:eu,formRefs:lr}});var Xr={onChange:function(_,R){console.log("selectedRowKeys: ".concat(_),"selectedRows: ",R)}},ru=function(){var Ke=(0,f.Z)((0,F.Z)().mark(function _(){var R,v;return(0,F.Z)().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Lt.next=2,ae.Z.get("/sms/business/bizCharge",{orderId:De.id,enable:!0});case 2:return R=Lt.sent.data.content,Lt.next=5,ae.Z.get("/sms/business/bizOrder",{parentId:De.id,enable:!0});case 5:v=Lt.sent.data.content,He(R),Er(v);case 8:case"end":return Lt.stop()}},_)}));return function(){return Ke.apply(this,arguments)}}();(0,c.useEffect)(function(){var Ke;if(ru(),lr==null||(Ke=lr.current)===null||Ke===void 0||Ke.setFieldsValue({chargeTime:gt()().format("YYYY-MM-DD")}),De.type=="orders"){var _={};De.studentType==1?_.parentId=De.id:_.id=De.id,ae.Z.get("/sms/business/bizOrder/registration",_).then(function(R){_r(R.data.content)})}},[]),De.type=="eidt"&&setTimeout(function(){var Ke,_=De;delete _.files,lr==null||(Ke=lr.current)===null||Ke===void 0||Ke.setFieldsValue((0,P.Z)((0,P.Z)({},_),{},{method:De.method.toString()}))},100);var uu=function(_,R){return R.some(function(v){return v.label.toLowerCase().indexOf(_.toLowerCase())>-1})};function su(Ke,_){console.log(Ke,_)}var eu=function(_){K||delete _.fapiao;var R="";if(_.files){var v=[];_.files.forEach(function(ft){v.push(ft.response.data)}),_.files=v.join(",")}return De.orderId?_.id=De.studentId:_.orderId=De.id,_.fapiao&&(R=_.fapiao[0],delete _.fapiao),De.type=="orders"&&(_.agent=hr.id,_.paymentTime=_.chargeTime,Le.length>0&&(_.servedOrderIds=Le.join(","))),_.id==null&&delete _.id,_.isCalculation=!0,_.userId=Ar.id,_.type=De.type=="orders"?"1":0,new Promise(function(ft){ae.Z.post2(kt,_,R).then(function(Lt){Lt.status=="success"&&(X.default.success("\u64CD\u4F5C\u6210\u529F"),B&&(B(),nr()),ft(Lt))}).catch(function(Lt){ft(!0)})})},au=function(_){return _&&_<gt()().subtract(2,"month").endOf("month")};return(0,l.jsxs)(ie.ZP,{submitter:zt==="step"?!1:{render:function(_,R){return(0,l.jsx)(m.Z,{children:(0,l.jsx)(M.Z,{span:24,offset:21,children:(0,l.jsx)(J.Z,{children:R})})})}},formRef:lr,autoFocusFirstInput:!0,onFinish:function(){var Ke=(0,f.Z)((0,F.Z)().mark(function _(R){return(0,F.Z)().wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:if(delete R.fFalg,K||delete R.fapiao,De.type!="orders"){ft.next=8;break}if(!(De.charge-Se<0)){ft.next=6;break}return Ue(!0),ft.abrupt("return");case 6:ft.next=11;break;case 8:if(!(De.arrears-Se-ir<0)){ft.next=11;break}return Ue(!0),ft.abrupt("return");case 11:return ft.next=13,eu(R);case 13:case"end":return ft.stop()}},_)}));return function(_){return Ke.apply(this,arguments)}}(),children:[(0,l.jsxs)("div",{className:"scolle",style:{overflowX:"auto",height:"600px",paddingBottom:"100px"},children:[(0,l.jsxs)("div",{style:{textAlign:"right"},hidden:De.type=="orders",children:[(0,l.jsx)(i.Z,{type:"primary",onClick:function(){Xe(!0)},children:"\u56FE\u7247\u6A21\u677F\u586B\u5145"}),(0,l.jsx)(i.Z,{style:{marginLeft:"30px"},type:"primary",onClick:function(){ze(!0)},children:"\u9009\u62E9\u8FC7\u5F80\u7F34\u8D39\u505A\u6A21\u677F\u586B\u5145"})]}),De.type=="orders"?(0,l.jsxs)(o.Z,{title:"\u8BA2\u5355\u6536\u8D39\u4FE1\u606F",bordered:!0,style:{marginBottom:"20px"},children:[(0,l.jsx)(o.Z.Item,{style:{width:"120px"},label:"\u8BA2\u5355\u91D1\u989D",children:(0,l.jsx)("span",{children:De.totalReceivable})}),(0,l.jsx)(o.Z.Item,{style:{width:"120px"},label:"\u7D2F\u8BA1\u4F18\u60E0",children:(0,l.jsx)("span",{children:De.discount+ir})}),(0,l.jsx)(o.Z.Item,{style:{width:"120px"},label:"\u53EF\u9000\u6B3E\u91D1\u989D",children:(0,l.jsx)("span",{style:{color:"green"},children:De.charge})}),(0,l.jsx)(o.Z.Item,{style:{width:"120px"},label:"\u9000\u6B3E\u540E\u5269\u4F59",children:(0,l.jsx)("span",{style:{color:"red"},children:De.charge-Se})})]}):De.type!="eidt"?(0,l.jsxs)(o.Z,{title:"\u8BA2\u5355\u5DF2\u6536\u8D39\u4FE1\u606F",bordered:!0,style:{marginBottom:"20px"},children:[(0,l.jsx)(o.Z.Item,{style:{width:"120px"},label:"\u8BA2\u5355\u91D1\u989D",children:(0,l.jsx)("span",{children:De.totalReceivable})}),(0,l.jsx)(o.Z.Item,{style:{width:"120px"},label:"\u7D2F\u8BA1\u4F18\u60E0",children:(0,l.jsx)("span",{children:De.discount+ir})}),(0,l.jsx)(o.Z.Item,{style:{width:"120px"},label:"\u7D2F\u8BA1\u5B9E\u6536",children:(0,l.jsx)("span",{style:{color:"green"},children:De.charge+Number(Se)})}),(0,l.jsx)(o.Z.Item,{style:{width:"120px"},label:"\u5F53\u524D\u6B20\u8D39",children:(0,l.jsx)("span",{style:{color:"red"},children:De.arrears-Se-ir})})]}):"",(0,l.jsxs)(ie.ZP.Group,{children:[(0,l.jsx)(Ee.Z,{label:"\u672C\u6B21".concat(rr,"\u91D1\u989D"),name:"amount",width:"md",fieldProps:{precision:2,onChange:function(_){Vt(_)}},rules:[{required:!0}]}),(0,l.jsx)(s.Z,{label:"\u4ED8\u6B3E\u65B9\u5F0F",name:"method",width:"md",request:(0,f.Z)((0,F.Z)().mark(function Ke(){return(0,F.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",et.Z.getList("dict_stu_refund_type"));case 1:case"end":return R.stop()}},Ke)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4ED8\u6B3E\u65B9\u5F0F"}]}),(0,l.jsx)(s.Z,{label:"\u7F34\u8D39\u7C7B\u578B",name:"type",width:"md",valueEnum:{0:"\u8BA2\u5355\u7F34\u8D39",1:"\u8BA2\u5355\u9000\u8D39"},required:!0,disabled:!0,fieldProps:{defaultValue:De.type=="orders"?["\u8BA2\u5355\u9000\u8D39"]:["\u8BA2\u5355\u7F34\u8D39"]}})]}),(0,l.jsxs)(m.Z,{style:{width:"1100px",backgroundColor:"#d9edf7",border:"1px solid #bce8f1",padding:"20px",marginBottom:"20px"},hidden:De.type=="orders",children:[(0,l.jsx)(M.Z,{span:2,style:{color:"red"},children:"\u6CE8\u610F\uFF1A"}),(0,l.jsx)(M.Z,{span:22,children:"\uFF081\uFF09\u8D85\u6536\u91D1\u989D\uFF0C\u8BF7\u5728\u7B2C\u4E00\u6B21\u7F34\u8D39\u4F18\u60E0\u91D1\u989D\u91CC\u586B\u5199\u8D85\u6536\u91D1\u989D\u7684\u8D1F\u6570\u3002"})]}),(0,l.jsxs)(ie.ZP.Group,{children:[De.type=="orders"?"":(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Ee.Z,{name:"discount",label:"\u672C\u6B21\u4F18\u60E0\u91D1\u989D",disabled:De.type=="orders",hidden:De.type=="orders",min:-999999,width:"md",rules:[{required:!0}],fieldProps:{onChange:function(_){wt(_),jt(!!_)}}}),(0,l.jsx)(le.Z,{name:"discountRemark",label:"\u672C\u6B21\u4F18\u60E0\u539F\u56E0",width:"lg",fieldProps:{autoComplete:"no"},disabled:De.type=="orders",hidden:De.type=="orders",rules:[{required:Je,message:"\u8BF7\u586B\u5199\u672C\u6B21\u6298\u6263\u539F\u56E0"}]})]}),De.type=="orders"?(0,l.jsx)(gr.Z,{ref:pr,label:"\u9000\u8D39\u4EBA",name:"userId",formRefs:lr,setUserNameId:function(_){return Ge(_)},userName:{name:De==null||(Y=De.userName)===null||Y===void 0?void 0:Y.split(",")[0],id:De==null||(Dt=De.userId)===null||Dt===void 0?void 0:Dt.split(",")[0]}}):(0,l.jsx)(gr.Z,{ref:pr,label:"\u6536\u8D39\u4EBA",name:"userId",formRefs:lr,setUserNameId:function(_){return Ge(_)}})]}),(0,l.jsxs)(ie.ZP.Group,{children:[(0,l.jsx)(a.Z,{name:"chargeTime",fieldProps:{showTime:!1,disabledDate:au},width:"md",label:"".concat(rr,"\u65E5\u671F"),rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7F34\u8D39\u65E5\u671F"}]}),(0,l.jsx)($.Z,{name:"paymentTime",fieldProps:{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"},width:"md",hidden:De.type=="orders",label:"".concat(rr=="\u6536\u8D39"?"\u5B9E\u9645\u5230\u8D26":rr,"\u65E5\u671F"),rules:[{required:De.type!="orders",message:"\u8BF7\u586B\u5199\u7F34\u8D39\u65E5\u671F"}]}),(0,l.jsx)($.Z,{name:"nextPaymentTime",width:"md",label:"\u4E0B\u6B21\u7F34\u8D39\u65F6\u95F4",fieldProps:{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"},hidden:De.type=="orders",disabled:De.type=="orders"})]}),(0,l.jsxs)("div",{hidden:De.type=="orders",children:[(0,l.jsx)(s.Z,{name:"fFalg",label:"\u662F\u5426\u5F00\u5177\u53D1\u7968",valueEnum:{false:"\u5426",true:"\u662F"},width:"xs",fieldProps:{onChange:function(_){_=="false"?Et(!1):Et(!0)},placeholder:"\u8BF7\u9009\u62E9"},rules:[{required:De.type!="orders"}]}),(0,l.jsx)("div",{hidden:!K,children:(0,l.jsx)(h.u,{name:"fapiao",creatorButtonProps:!1,initialValue:[{title:""}],max:1,itemRender:function(_,R){var v=_.listDom,ft=_.action,Lt=R.record,ur=R.index,dt=R.name;return(0,l.jsxs)(ut.ZP,{title:"\u53D1\u7968\u4FE1\u606F",style:{width:"1050px",border:"1px solid #bce8f1",padding:"20px"},children:[(0,l.jsxs)(ie.ZP.Group,{children:[(0,l.jsx)(le.Z,{name:"title",label:"\u53D1\u7968\u62AC\u5934",width:"lg",required:!0}),(0,l.jsx)(s.Z,{label:"\u5546\u54C1\u79CD\u7C7B",name:"productType",width:"md",initialValue:"0",request:(0,f.Z)((0,F.Z)().mark(function dr(){return(0,F.Z)().wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return $r.abrupt("return",et.Z.getList("invoiceProductType"));case 1:case"end":return $r.stop()}},dr)}))})]}),(0,l.jsxs)(ie.ZP.Group,{children:[(0,l.jsx)(le.Z,{name:"taxCode",label:"\u7A0E\u53F7",width:"md",required:!0}),(0,l.jsx)(Ee.Z,{name:"amount",label:"\u91D1\u989D",width:"md",required:!0,fieldProps:{precision:2}}),(0,l.jsx)(le.Z,{name:"email",label:"\u5B66\u5458\u90AE\u7BB1",width:"md",required:!0})]}),(0,l.jsxs)(ie.ZP.Group,{children:[(0,l.jsx)(bt.Z,{width:1100,label:"\u53D1\u7968\u5907\u6CE8",name:"remark"}),(0,l.jsx)(bt.Z,{width:1100,label:"\u6CE8\u610F\u4E8B\u9879",name:"cautions"})]}),(0,l.jsx)(ie.ZP.Group,{children:(0,l.jsx)(s.Z,{label:"\u53D1\u7968\u79CD\u7C7B",name:"type",width:"md",fieldProps:{onChange:function(Pt){var $r=Pt!=0;je($r)}},initialValue:"0",request:(0,f.Z)((0,F.Z)().mark(function dr(){return(0,F.Z)().wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return $r.abrupt("return",et.Z.getList("invoiceType"));case 1:case"end":return $r.stop()}},dr)}))})}),(0,l.jsxs)("div",{hidden:!Ne,children:[(0,l.jsxs)(ie.ZP.Group,{children:[(0,l.jsx)(le.Z,{name:"bank",label:"\u5F00\u6237\u884C",width:"md",required:!0}),(0,l.jsx)(le.Z,{name:"account",label:"\u8D26\u53F7",width:"md",required:!0})]}),(0,l.jsxs)(ie.ZP.Group,{children:[(0,l.jsx)(le.Z,{name:"mobile",label:"\u7535\u8BDD",width:"md",required:!0}),(0,l.jsx)(le.Z,{name:"address",label:"\u5730\u5740",width:"md",required:!0})]})]})]})}})}),(0,l.jsx)(ie.ZP.Group,{title:"\u7A0E\u7968\u4FE1\u606F",children:(0,l.jsxs)(m.Z,{style:{width:"1100px",backgroundColor:"#d9edf7",border:"1px solid #bce8f1",padding:"20px",marginBottom:"20px"},children:[(0,l.jsx)(M.Z,{span:2,style:{color:"red"},children:"\u6CE8\u610F\uFF1A"}),(0,l.jsxs)(M.Z,{span:22,children:["\uFF081\uFF09\u5B66\u5386\u9879\u76EE\u4E0D\u5F00\u53D1\u7968",(0,l.jsx)("br",{}),"\uFF082\uFF09\u62DB\u751F\u8001\u5E08\u5728\u4E0B\u5355\u65F6\u586B\u5199\u53D1\u7968\u7533\u8BF7\u4FE1\u606F\u2192\u51FA\u7EB3\u5BA1\u6838\u2192\u51FA\u7EB3\u5F00\u5177\u53D1\u7968\u2192\u62DB\u751F\u8001\u5E08\u9886\u53D6\u53D1\u7968\u6216\u51FA\u7EB3\u53D1\u9001\u7535\u5B50\u53D1\u7968\u7ED9\u5B66\u5458\uFF1B",(0,l.jsx)("br",{}),"\uFF083\uFF09\u9009\u62E9\u4E0D\u5F00\u7968\u7684\u4E1A\u52A1\u6536\u6B3E\uFF0C\u540E\u671F\u4E0D\u518D\u5F00\u5177\u53D1\u7968\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4\u91CD\u590D\u7F34\u7A0E\u3002",(0,l.jsx)("br",{}),"\uFF084\uFF09\u52A1\u5FC5\u8BE2\u95EE\u5B66\u5458\u662F\u5426\u5F00\u54A8\u8BE2\u8D39\uFF0C\u53EF\u964D\u4F4E\u98CE\u9669\u3002",(0,l.jsx)("br",{}),"\uFF085\uFF09\u804C\u79F0\u8BC4\u5BA1\u53EA\u53EF\u4EE5\u5F00\u54A8\u8BE2\u8D39\u3002",(0,l.jsx)("br",{}),"\uFF086\uFF09\u5982\u679C\u5B66\u5458\u5F00\u4E13\u7968\uFF0C\u9700\u52A0\u6536\u7968\u9762\u7A0E\u7387\u7684\u7A0E\u8D39\uFF082023\u5E74\u4E3A1%\uFF09\uFF0C\u539F\u56E0\u662F\u5C0F\u89C4\u6A21\u7EB3\u7A0E\u4EBA\u5F00\u666E\u7968\u514D\u7A0E\uFF0C\u800C\u5F00\u4E13\u7968\u4E0D\u51CF\u514D\u4EFB\u4F55\u7A0E\u8D39\u3002",(0,l.jsx)("br",{}),"\uFF087\uFF09\u8BF7\u8DDF\u5B66\u5458\u786E\u5B9A\u597D\u5F00\u7968\u4FE1\u606F\uFF0C\u5982\u679C\u9519\u8BEF\u4E0D\u91CD\u5F00\uFF0C\u56E0\u4E3A\u53D1\u7968\u5F20\u6570\u6709\u9650\u3002",(0,l.jsx)("br",{}),"\uFF088\uFF09\u82E5\u5B66\u5458\u5F00\u4E2A\u4EBA\u53D1\u7968\uFF0C\u62DB\u751F\u8001\u5E08\u8BF7\u63D0\u524D\u544A\u77E5\u5B66\u5458\u4E2A\u4EBA\u53D1\u7968\u4E00\u822C\u516C\u53F8\u4E0D\u7ED9\u62A5\u9500\uFF0C\u5982\u56E0\u5F00\u5177\u4E2A\u4EBA\u53D1\u7968\u5B66\u5458\u4E0D\u80FD\u62A5\u9500\u9700\u8981\u9000\u56DE\u91CD\u5F00\uFF0C\u8D22\u52A1\u4E0D\u4E88\u5F00\u5177\u3002"]})]})})]}),(0,l.jsxs)(ie.ZP.Group,{children:[(0,l.jsx)(it.Z,{width:1100,label:"\u4E0A\u4F20\u9644\u4EF6",name:"files",action:"/sms/business/bizCharge/upload",renderData:Re||De,fileUrl:"/sms/business/bizCharge/download",rules:[{required:Ht!=1}]}),(0,l.jsx)(bt.Z,{width:1100,label:De.type!="orders"?"\u5907\u6CE8":"\u9000\u6B3E\u539F\u56E0",name:"description",rules:[{required:!0}]})]}),(0,l.jsxs)(m.Z,{hidden:De.type=="orders",style:{width:"1100px",backgroundColor:"#d9edf7",border:"1px solid #bce8f1",padding:"20px",marginBottom:"20px"},children:[(0,l.jsx)(M.Z,{span:2,style:{color:"red"},children:"\u6CE8\u610F\uFF1A"}),(0,l.jsxs)(M.Z,{span:22,children:["\uFF081\uFF09\u5982\u5BA2\u6237\u540D\u79F0\u4E0E\u5B9E\u9645\u4ED8\u6B3E\u4EBA\u4E0D\u4E00\u81F4\uFF0C\u8BF7\u5907\u6CE8\u5B9E\u9645\u4ED8\u6B3E\u4EBA\u59D3\u540D\u3002",(0,l.jsx)("br",{}),"\uFF082\uFF09\u5982\u6536\u8D39\u91D1\u989D\u4E2D\u5305\u542B\u4EE3\u7406\u8D39\uFF0C\u8BF7\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u5907\u6CE8\u6E05\u695A\u3002",(0,l.jsx)("br",{}),"\uFF083\uFF09\u5B66\u5386\u9879\u76EE\u8BF7\u6309\u4EE5\u4E0B\u793A\u4F8B\u586B\u5199\u5907\u6CE8\u680F\uFF1A",(0,l.jsx)("br",{}),"\u2460\u6210\u8003\uFF1A",(0,l.jsx)("br",{}),"A.\u672A\u4EA4\u9F50\u7B2C\u4E00\u5E74\u5B66\u8D39\uFF1A\u670D\u52A1\u8D391200+\u7B2C\u4E00\u5E74\u5B66\u8D39\u7B2C\u4E00\u6B21\u4ED8\u6B3E1000\uFF0823\u5E74 \u6E56\u5357\u5DE5\u4E1A\u5927\u5B66 \u673A\u7535\u4E00\u4F53\u5316\u679D\u672F \u9AD8\u5347\u4E13 \uFF09 \u56E0\u4E2A\u4EBA\u539F\u56E0\u62A5\u8003\u6210\u529F\uFF0C\u8003\u8BD5\u51FA\u73B00\u5206\uFF0C\u5F55\u53D6\u4E0D\u8BFB\uFF0C\u6B64\u8D39\u7528\u5747\u4E0D\u9000\uFF0C\u53EF\u5EF6\u7EED\u670D\u52A1",(0,l.jsx)("br",{}),"B.\u7B2C\u4E8C\u6B21\u4ED8\u6B3E\u5E76\u4EA4\u9F50\u7B2C\u4E00\u5E74\u5B66\u8D39\u7684\uFF1A\u7B2C\u4E00\u5E74\u5B66\u8D39\u5C3E\u6B3E1200\uFF0823\u5E74 \u6E56\u5357\u5DE5\u4E1A\u5927\u5B66 \u673A\u7535\u4E00\u4F53\u5316\u679D\u672F \u9AD8\u5347\u4E13 \uFF09",(0,l.jsx)("br",{}),"\u2461\u56FD\u5F00\u548C\u7F51\u6559\uFF1A",(0,l.jsx)("br",{}),"A.\u7B2C\u4E00\u6B21\u4ED8\u6B3E\uFF0C\u672A\u4EA4\u9F50\u7B2C\u4E00\u5E74\u5B66\u8D39\u7684\uFF1A\u7B2C\u4E00\u5E74\u5B66\u8D39\u7B2C\u4E00\u6B21\u4ED8\u6B3E2000\uFF0823\u6625 \u6B66\u6C49\u7406\u5DE5\u5927\u5B66 \u4E13\u5347\u672C \u571F\u6728\u5DE5\u7A0B\u4E13\u4E1A\uFF09",(0,l.jsx)("br",{}),"B.\u7B2C\u4E8C\u6B21\u4ED8\u6B3E\u5E76\u4EA4\u9F50\u7B2C\u4E00\u5E74\u5B66\u8D39\u7684\uFF1A\u7B2C\u4E00\u5E74\u5B66\u8D39\u5C3E\u6B3E2500\uFF0823\u6625 \u6B66\u6C49\u7406\u5DE5\u5927\u5B66 \u4E13\u5347\u672C \u571F\u6728\u5DE5\u7A0B\u4E13\u4E1A\uFF09"]})]}),De.type!="orders"?"":(0,l.jsxs)("div",{children:[(0,l.jsxs)(ie.ZP.Group,{title:"\u9000\u6B3E\u9886\u53D6\u4EBA\u4FE1\u606F",children:[(0,l.jsx)(le.Z,{name:"recipientName",label:"\u9000\u8D39\u9886\u53D6\u4EBA",rules:[{required:!0}],width:"sm"}),(0,l.jsx)(s.Z,{label:"\u9000\u6B3E\u7C7B\u578B",name:"refundType",width:"md",request:(0,f.Z)((0,F.Z)().mark(function Ke(){return(0,F.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",et.Z.getList("dict_refundType"));case 1:case"end":return R.stop()}},Ke)})),fieldProps:{onChange:function(_){qt(_),_==1?ee(!1):ee(!0)}},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9000\u6B3E\u7C7B\u578B"}]})]}),(0,l.jsxs)(ie.ZP.Group,{children:[(0,l.jsx)(le.Z,{name:"accountName",label:"\u5F00\u6237\u540D",width:"md",rules:[{required:Q}]}),(0,l.jsx)(le.Z,{name:"account",label:"\u5361\u53F7",width:"md",rules:[{required:Q}]}),(0,l.jsx)(le.Z,{name:"bank",label:"\u5F00\u6237\u884C\uFF08\u7CBE\u786E\u5230\u652F\u884C\uFF09",width:"md",rules:[{required:Q}]})]}),(0,l.jsxs)(m.Z,{children:[(0,l.jsx)(le.Z,{name:"agent",label:"\u7ECF\u529E\u4EBA",width:"sm"}),(0,l.jsx)(i.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,f.Z)((0,F.Z)().mark(function Ke(){return(0,F.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(b){R.next=4;break}return R.next=3,ae.Z.get("/sms/share/getDepartmentAndUser");case 3:b=R.sent;case 4:k({content:b.data,type:"order"}),Qe(!0);case 6:case"end":return R.stop()}},Ke)})),children:"\u9009\u62E9"})]}),(0,l.jsx)(ie.ZP.Group,{title:"\u5B8C\u7ED3\u5B66\u5458"}),(0,l.jsx)(pe.Z,{rowSelection:{onChange:function(_,R){ve(_)}},columns:Tr,dataSource:br,search:!1})]})]}),vt&&(0,l.jsx)(tr.Z,{CardVisible:vt,CardContent:W,setCardVisible:function(){return Qe(!1)},setDepartment:function(_){return Lr(_)},departments:[hr]}),_e&&(0,l.jsx)(Ft.Z,{imgSrc:Yt,isModalVisibles:_e,setisModalVisibles:function(_){return or(_)}}),(0,l.jsx)(g.Z,{open:fr,onCancel:function(){Ue(!1)},onOk:function(){Ue(!1)},okText:"\u8FD4\u56DE\u4FEE\u6539",cancelText:"",children:(0,l.jsxs)("div",{style:{textAlign:"center"},children:[(0,l.jsx)("div",{style:{marginBottom:"20px"},children:"\u6CE8\u610F!"}),(0,l.jsx)("div",{children:"\u5F53\u524D\u8BA2\u5355\u6B20\u8D39\u91D1\u989D\u4E3A\u8D1F\u6570,\u8BF7\u786E\u8BA4\u662F\u5426\u6709\u8BEF"})]})}),(0,l.jsx)(g.Z,{width:1200,open:Pe,onCancel:function(){return ze(!1)},onOk:function(){return ze(!1)},children:(0,l.jsx)(he.Z,{setChargeModal:function(){return ze(!1)},setChargeInfo:function(_){return lt(_)},type:"0",studentType:De.studentType,chargeType:"chargeList",chargeTypes:!0})}),(0,l.jsx)(g.Z,{width:1e3,open:S,onCancel:function(){return Xe(!1)},onOk:function(){return Xe(!1)},children:(0,l.jsx)(t.Z,{setChargeModals:function(){return Xe(!1)},setFromDataUp:function(_){nt(_)}})})]})}},9686:function(ce,D,e){"use strict";var j=e(57338),g=e(273),V=e(71194),o=e(50146),I=e(12968),i=e(20352),A=e(13062),m=e(71230),L=e(43185),M=e(43027),d=e(71153),J=e(60331),ne=e(98858),X=e(4914),x=e(57663),F=e(71577),f=e(34792),P=e(48086),r=e(39428),p=e(3182),O=e(86582),c=e(11849),a=e(2824),h=e(67294),ie=e(45510),Ee=e(37476),s=e(952),le=e(31199),$=e(64317),bt=e(22452),pe=e(90672),Ct=e(80876),gt=e(5966),et=e(30381),ae=e.n(et),ut=e(37490),ot=e(63863),tr=e(68503),he=e(22),Ft=e(14037),gr=e(21010),it=e(5909),t=e(21874),Ye=e(181),l=e(42025),u=e(85893),b=null;D.Z=function(n){var ht,jr,$e,sr=n.modalVisible,Y=n.setModalVisible,Dt=n.callbackRef,re=n.renderData,Xt=n.callback,B=n.admin,Z=n.isEdit,nr=n.setPreviewImage,De=n.setPreviewVisible;console.log(re,"renderData======");var xr=(0,gr.tT)("@@initialState"),zt=xr.initialState,Ut=(0,h.useState)(!1),Gt=(0,a.Z)(Ut,2),kt=Gt[0],Kt=Gt[1],Bt=(0,h.useState)(!1),Ie=(0,a.Z)(Bt,2),Ot=Ie[0],Je=Ie[1],jt=(0,h.useState)(),_t=(0,a.Z)(jt,2),at=_t[0],Ht=_t[1],qt=(0,h.useState)(!1),yr=(0,a.Z)(qt,2),Zr=yr[0],_e=yr[1],or=(0,h.useState)(!1),Zt=(0,a.Z)(or,2),Fe=Zt[0],vt=Zt[1],Qe=(0,h.useState)(!1),Be=(0,a.Z)(Qe,2),Mt=Be[0],fr=Be[1],Ue=(0,h.useState)("edit"),vr=(0,a.Z)(Ue,2),Tt=vr[0],Pe=vr[1],ze=(0,h.useState)(!1),Ae=(0,a.Z)(ze,2),Rt=Ae[0],S=Ae[1],Xe=(0,h.useState)(),we=(0,a.Z)(Xe,2),qe=we[0],Yt=we[1],Te=(0,h.useState)({amount:0,discount:0}),N=(0,a.Z)(Te,2),y=N[0],W=N[1],k=(0,h.useState)(!1),xe=(0,a.Z)(k,2),ye=xe[0],Ne=xe[1],je=(0,h.useState)(),q=(0,a.Z)(je,2),G=q[0],K=q[1],Et=(0,h.useState)(!1),yt=(0,a.Z)(Et,2),er=yt[0],Se=yt[1],Vt=(0,h.useState)(!1),Nt=(0,a.Z)(Vt,2),tt=Nt[0],ir=Nt[1],wt=(0,h.useState)({}),Or=(0,a.Z)(wt,2),We=Or[0],Le=Or[1],ve=(0,h.useRef)(null),st=(0,h.useRef)(),ct=(0,h.useRef)(),br=(0,h.forwardRef)(it.Z),_r=(0,h.useState)((ht=re.servedOrderIds)===null||ht===void 0?void 0:ht.split(",").map(function(H){return Number(H)})),Fr=(0,a.Z)(_r,2),Ir=Fr[0],Ar=Fr[1],Ge=(0,h.useState)([]),Pr=(0,a.Z)(Ge,2),wr=Pr[0],Re=Pr[1],lt=(0,h.useState)({name:zt==null||(jr=zt.currentUser)===null||jr===void 0?void 0:jr.name,id:zt==null||($e=zt.currentUser)===null||$e===void 0?void 0:$e.userid}),Ze=(0,a.Z)(lt,2),cr=Ze[0],Q=Ze[1],ee=function(){var w;be==null||(w=be.current)===null||w===void 0||w.setFieldsValue({agent:cr.name})};(0,h.useEffect)(function(){ee()},[cr]);var T=sessionStorage.getItem("tokenName"),me=sessionStorage.getItem("tokenValue"),U={};U[T]=me;var Me=re.type=="1"?"\u9000\u8D39":"\u6536\u8D39",It=re.type=="1"?"\uFF08-\uFF09":"\uFF08+\uFF09",be=(0,h.useRef)(),z=function(){ot.Z.get("/sms/business/bizOrder",{id:re.orderId}).then(function(w){var C;Je(w.data.content[0]),ct==null||(C=ct.current)===null||C===void 0||C.reload()})};(0,h.useEffect)(function(){var H;if(W({amount:re.amount,discount:re.discount}),z(),re.type=="1"){var w={};re.studentType==1?w.parentId=re.orderId:w.id=re.orderId,ot.Z.get("/sms/business/bizOrder/registration",w).then(function(C){Re(C.data.content)})}re.types=="eidt"&&setTimeout(function(){var C,Oe,Ce=re,nt=[];re.files&&re.files.split(",").forEach(function(pr,Qt){nt.push({uid:Qt+1,name:pr,response:{data:pr}})}),Ce.type=Ce.type+"",Ce.refundType=Ce.refundType+"",Ce.agent=re.agentName,ve==null||(C=ve.current)===null||C===void 0||C.setDepartment({id:re.userId,name:re.userName}),K({name:re.userName,id:re.userId}),be==null||(Oe=be.current)===null||Oe===void 0||Oe.setFieldsValue((0,c.Z)((0,c.Z)({},Ce),{},{method:re.method.toString(),files:nt}))},100),Q({name:re.agentName,id:re.agent}),be==null||(H=be.current)===null||H===void 0||H.setFieldsValue({chargeTime:ae()().format("YYYY-MM-DD")})},[]);var He=[{title:"\u5B66\u5458",dataIndex:"studentName",sorter:!0},{title:"\u6240\u5C5E\u56E2\u7EC4",dataIndex:"studentParentName",sorter:!0,render:function(w,C){return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)("span",{children:[" ",C.studentParentName]})})}},{title:"\u62A5\u8003\u73ED\u578B",dataIndex:"classType",sorter:!0,valueEnum:ut.Z.getSearch("dict_class_type"),render:function(w,C){return(0,u.jsx)(u.Fragment,{children:ut.Z.getName("dict_class_type",C.classType)})}},{title:"\u73ED\u578B\u5E74\u9650",sorter:!0,dataIndex:"classYear",valueEnum:ut.Z.getSearch("dict_class_year"),render:function(w,C){return(0,u.jsx)(u.Fragment,{children:ut.Z.getName("dict_class_year",C.classYear)})}},{title:"\u8003\u8BD5\u7C7B\u578B",sorter:!0,dataIndex:"examType",valueEnum:ut.Z.getSearch("dict_exam_type"),render:function(w,C){return(0,u.jsx)(u.Fragment,{children:ut.Z.getName("dict_exam_type",C.examType)})}},{title:"\u62A5\u8003\u5C97\u4F4D",dataIndex:"project",key:"project",sorter:!0,valueType:"cascader",fieldProps:{options:ut.Z.getCascader("dict_reg_job")},render:function(w,C){return(0,u.jsx)("span",{children:C.project&&(0,O.Z)(new Set(C.project.split(","))).map(function(Oe,Ce){return(0,u.jsxs)("span",{children:[ut.Z.getCascaderName("dict_reg_job",Oe)," ",(0,u.jsx)("br",{})]},"charge-order-audit-".concat(Oe,"-").concat(Ce))})},"project")}}],Sr=function(){var H=(0,p.Z)((0,r.Z)().mark(function w(C,Oe){var Ce;return(0,r.Z)().wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Ce=Oe.slice(Oe.indexOf(".")),pr.next=3,(0,tr.Z)("/sms/business/bizCharge/download",C,Oe).then(function(Qt){Ht(Qt),Ce==".png"||Ce==".jpg"||Ce==".jpeg"?_e(!0):(nr(Qt),De(!0))});case 3:case"end":return pr.stop()}},w)}));return function(C,Oe){return H.apply(this,arguments)}}(),Jt=function(w,C){return C.some(function(Oe){return Oe.label.toLowerCase().indexOf(w.toLowerCase())>-1})};function mr(H,w){console.log(H,w)}var Er=function(w,C){if(w.files.length>0){var Oe=[];w.files.forEach(function(Ce){Oe.push(Ce.response.data)}),w.files=Oe.join(",")}else delete w.files;return re.orderId?w.id=re.id:w.orderId=re.id,console.log("userNameId",G),re.type=="1"?(w.agent=cr.id,w.chargeTime=ae()(w.chargeTime).format("YYYY-MM-DD HH:mm:ss"),w.paymentTime=w.chargeTime,w.userId=G.id,w.userName=G.name,(Ir==null?void 0:Ir.length)>0?w.servedOrderIds=Ir.join(","):w.servedOrderIds=""):(w.userId=G.id,w.userName=G.name),w.isSubmit=!0,console.log("valuevalue",w),delete w.isCalculation,new Promise(function(Ce){var nt="",pr=void 0,Qt=void 0;C=="edit"?(nt="/sms/business/bizCharge/edit",pr=[w],Qt=!0):C=="submit"?(nt="/sms/business/bizCharge",pr=w,Qt=!1):C=="audit"&&(nt="/sms/business/bizCharge/edit/1",pr=[w],Qt=!0);var mt=function(Lr,Br){if(Lr.status=="success"&&Br=="edit")P.default.success("\u64CD\u4F5C\u6210\u529F"),Y(),Dt(),Ce(!0);else if(Lr.status=="success"&&Br=="submit")P.default.success("\u64CD\u4F5C\u6210\u529F"),Y(),Dt(),Ce(!0);else if(Lr.status=="success"&&Br=="audit"){var Vr=0;re.type==1&&(Vr=re.auditNum?re.auditNum+1:1),ot.Z.post("/sms/business/bizAudit/audit/".concat(Vr),{confirm:!0,entityId:re.id}).then(function(Wr){Wr.status=="success"&&(P.default.success("\u64CD\u4F5C\u6210\u529F"),Y(),Dt(),Ce(!0))})}};Qt?ot.Z.postAll(nt,pr).then(function(hr){mt(hr,C)}):ot.Z.post(nt,pr).then(function(hr){mt(hr,C)})})};return(0,u.jsxs)(Ee.Y,{title:Me,width:950,formRef:be,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){Y()},maskClosable:!1,okText:"\u4FEE\u6539"},submitter:{render:function(w,C){return[].concat((0,O.Z)(C),[(0,u.jsx)(F.Z,{htmlType:"button",type:"primary",hidden:!re.isSubmit,onClick:(0,p.Z)((0,r.Z)().mark(function Oe(){var Ce,nt;return(0,r.Z)().wrap(function(Qt){for(;;)switch(Qt.prev=Qt.next){case 0:if(!(Ot.arrears-y.amount-y.discount<0)){Qt.next=4;break}return fr(!0),Pe("audit"),Qt.abrupt("return");case 4:(Ce=be.current)===null||Ce===void 0||(nt=Ce.validateFieldsReturnFormatValue)===null||nt===void 0||nt.call(Ce).then(function(){var mt=(0,p.Z)((0,r.Z)().mark(function hr(Lr){var Br;return(0,r.Z)().wrap(function(Wr){for(;;)switch(Wr.prev=Wr.next){case 0:return console.log("\u6821\u9A8C\u8868\u5355\u5E76\u8FD4\u56DE\u683C\u5F0F\u5316\u540E\u7684\u6240\u6709\u6570\u636E\uFF1A",Lr),Br=(0,c.Z)((0,c.Z)({},Lr),{},{chargeTime:ae()(Lr.chargeTime).format("YYYY-MM-DD HH:mm:ss")}),Wr.next=4,Er(Br,"audit");case 4:case"end":return Wr.stop()}},hr)}));return function(hr){return mt.apply(this,arguments)}}());case 5:case"end":return Qt.stop()}},Oe)})),children:"\u4FEE\u6539\u5E76\u5BA1\u6838\u901A\u8FC7"},"edit-charge-order-audit-1"),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(F.Z,{htmlType:"button",type:"dashed",hidden:!re.isSubmit,onClick:(0,p.Z)((0,r.Z)().mark(function Oe(){return(0,r.Z)().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:Le((0,c.Z)((0,c.Z)({},re),{},{confirm:!1})),ir(!0);case 2:case"end":return nt.stop()}},Oe)})),children:"\u4E0D\u901A\u8FC7"},"edit-charge-order-audit-1"),(0,u.jsx)(l.Z,{setModalVisible:function(){ir(!1),Y()},modalVisible:tt,callbackRef:function(){return Dt()},renderData:We})]}),(0,u.jsx)(F.Z,{htmlType:"button",type:"primary",hidden:re.isSubmit,onClick:(0,p.Z)((0,r.Z)().mark(function Oe(){var Ce,nt;return(0,r.Z)().wrap(function(Qt){for(;;)switch(Qt.prev=Qt.next){case 0:if(!(Ot.arrears-y.amount-y.discount<0)){Qt.next=4;break}return fr(!0),Pe("submit"),Qt.abrupt("return");case 4:(Ce=be.current)===null||Ce===void 0||(nt=Ce.validateFieldsReturnFormatValue)===null||nt===void 0||nt.call(Ce).then(function(){var mt=(0,p.Z)((0,r.Z)().mark(function hr(Lr){return(0,r.Z)().wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:return Vr.next=2,Er(Lr,"submit");case 2:case"end":return Vr.stop()}},hr)}));return function(hr){return mt.apply(this,arguments)}}());case 5:case"end":return Qt.stop()}},Oe)})),children:"\u4FEE\u6539\u5E76\u63D0\u4EA4"},"edit-charge-order-audit-2")])}},onFinish:function(){var H=(0,p.Z)((0,r.Z)().mark(function w(C){return(0,r.Z)().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(re.type!=1){Ce.next=7;break}if(!(Ot.charge-y.amount<0)){Ce.next=5;break}return fr(!0),Pe("edit"),Ce.abrupt("return");case 5:Ce.next=11;break;case 7:if(!(Ot.arrears-y.amount-y.discount<0)){Ce.next=11;break}return fr(!0),Pe("edit"),Ce.abrupt("return");case 11:return Ce.next=13,Er(C,"edit");case 13:case"end":return Ce.stop()}},w)}));return function(w){return H.apply(this,arguments)}}(),visible:sr,children:[Ot&&(0,u.jsxs)(X.Z,{title:"\u8BA2\u5355\u4FE1\u606F:".concat(Ot.num?Ot.num:""),bordered:!0,size:"small",style:{marginBottom:"10px"},children:[(0,u.jsx)(X.Z.Item,{label:"\u5B66\u5458/\u4F01\u4E1A",children:Ot.studentName}),(0,u.jsx)(X.Z.Item,{label:"\u8BA2\u5355\u603B\u6536\u8D39\u91D1\u989D",children:Ot.totalReceivable}),(0,u.jsx)(X.Z.Item,{label:"\u8BA2\u5355\u5B9E\u9645\u5E94\u6536\u91D1\u989D",children:Ot.actualReceivable}),(0,u.jsx)(X.Z.Item,{label:"\u8BA2\u5355\u5DF2\u6536\u91D1\u989D",children:(0,u.jsx)("span",{style:{color:"green"},children:Ot.charge})}),(0,u.jsx)(X.Z.Item,{label:"\u8BA2\u5355\u7D2F\u8BA1\u4F18\u60E0\u91D1\u989D",children:Ot.discount}),(0,u.jsx)(X.Z.Item,{label:"\u8BA2\u5355\u672A\u6536\u91D1\u989D",children:(0,u.jsx)("span",{style:{color:"red"},children:Ot.arrears})}),(0,u.jsx)(X.Z.Item,{label:"\u62A5\u540D\u4EBA\u6570",children:Ot.quantity}),(0,u.jsx)(X.Z.Item,{label:"\u4E0B\u5355\u65F6\u95F4",children:Ot.createTime}),(0,u.jsx)(X.Z.Item,{label:"\u662F\u5426\u5DF2\u5B8C\u7ED3",children:Ot.isServed===!0?(0,u.jsx)(J.Z,{color:"#87d068",children:"\u5DF2\u5B8C\u7ED3"}):(0,u.jsx)(J.Z,{color:"#FF0000",children:"\u672A\u5B8C\u7ED3"})}),(0,u.jsx)(X.Z.Item,{label:"\u5DF2\u5F00\u7968\u91D1\u989D",span:3,children:(0,u.jsx)("span",{style:{color:"red"},children:Ot.invoiceAmount})}),re.type==1?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(X.Z.Item,{label:"\u672C\u6B21\u8BA2\u5355\u9000\u8D39\u91D1\u989D",children:(0,u.jsx)("span",{style:{color:"green"},children:y.amount})}),(0,u.jsx)(X.Z.Item,{label:"\u672C\u6B21\u8BA2\u5355\u9000\u8D39\u7ED3\u4F59",span:2,children:(0,u.jsx)("span",{style:{color:"red"},children:(Ot.charge-y.amount).toFixed(2)})})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(X.Z.Item,{label:"\u672C\u6B21\u8BA2\u5355\u6536\u8D39\u91D1\u989D",children:(0,u.jsx)("span",{style:{color:"green"},children:y.amount})}),(0,u.jsx)(X.Z.Item,{label:"\u672C\u6B21\u8BA2\u5355\u4F18\u60E0\u91D1\u989D",children:(0,u.jsx)("span",{style:{color:"green"},children:y.discount})}),(0,u.jsx)(X.Z.Item,{label:"\u672C\u6B21\u8BA2\u5355\u6536\u8D39\u7ED3\u4F59",children:(0,u.jsx)("span",{style:{color:"red"},children:Ot.arrears-y.amount-y.discount})})]})]}),(0,u.jsx)("span",{style:{margin:"15px",float:"right"},children:(0,u.jsx)(F.Z,{type:"primary",onClick:function(){return Se(!0)},children:"\u67E5\u770B\u53D1\u7968"})}),(0,u.jsx)("span",{style:{margin:"15px",float:"right"},children:(0,u.jsx)(F.Z,{type:"primary",onClick:function(){return S(!0)},children:"\u7F16\u8F91\u8BA2\u5355"})}),(0,u.jsxs)(s.ZP.Group,{children:[(0,u.jsx)(le.Z,{label:"\u672C\u6B21".concat(Me,"\u91D1\u989D"),name:"amount",width:"md",fieldProps:{precision:2,onChange:function(w){var C={amount:w};W((0,c.Z)((0,c.Z)({},y),C))}},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u91D1\u989D"}]}),(0,u.jsx)(le.Z,{label:"\u9000\u8D39\u4E1A\u7EE9\u91D1\u989D"+It,name:"performanceAmount",width:"sm",rules:[{required:!0}]}),(0,u.jsx)(le.Z,{label:"\u9000\u8D39\u63D0\u6210\u91D1\u989D",name:"commissionBase",width:"sm",rules:[{required:!0}]}),(0,u.jsx)($.Z,{label:"\u4ED8\u6B3E\u65B9\u5F0F",name:"method",width:"sm",request:(0,p.Z)((0,r.Z)().mark(function H(){return(0,r.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",ut.Z.getList("dict_stu_refund_type"));case 1:case"end":return C.stop()}},H)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4ED8\u6B3E\u65B9\u5F0F"}]}),(0,u.jsx)($.Z,{label:"\u7F34\u8D39\u7C7B\u578B",name:"type",width:"sm",valueEnum:{0:"\u8BA2\u5355\u7F34\u8D39",1:"\u8BA2\u5355\u9000\u8D39"},required:!0,disabled:!0,fieldProps:{defaultValue:re.type=="1"?["\u8BA2\u5355\u9000\u8D39"]:["\u8BA2\u5355\u7F34\u8D39"]}})]}),(0,u.jsxs)(s.ZP.Group,{children:[(0,u.jsx)(ie.Z,{name:"chargeTime",fieldProps:{showTime:!1,onChange:function(w){console.log(w)}},width:"md",label:"".concat(Me,"\u65E5\u671F"),rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7F34\u8D39\u65E5\u671F"}]}),re.type==0?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(bt.Z,{name:"paymentTime",fieldProps:{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"},width:"md",label:"".concat(Me=="\u6536\u8D39"?"\u5B9E\u9645\u5230\u8D26":Me,"\u65E5\u671F"),rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7F34\u8D39\u65E5\u671F"}]}),(0,u.jsx)(bt.Z,{name:"nextPaymentTime",width:"md",label:"\u4E0B\u6B21\u7F34\u8D39\u65F6\u95F4",fieldProps:{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"},hidden:re.type=="orders",disabled:re.type=="orders"})]}):"",(0,u.jsx)(t.Z,{ref:ve,userLabel:"\u62DB\u751F\u8001\u5E08(\u5728\u804C\u8001\u5E08\u53EF\u4EE5\u8F93\u5165\u540D\u5B57\u641C\u7D22)",userNames:"userName",userPlaceholder:"\u8BF7\u8F93\u5165\u62DB\u751F\u8001\u5E08\u7684\u540D\u5B57",flag:!0,setUserNameId:function(w){return K(w)}})]}),(0,u.jsxs)(s.ZP.Group,{children:[(0,u.jsx)(pe.Z,{width:800,label:"\u5907\u6CE8",name:"description",rules:[{required:!0}]}),(0,u.jsx)(pe.Z,{width:800,label:"\u6536\u636E\u5907\u6CE8",name:"description2"}),(0,u.jsx)(Ct.Z,{width:800,label:"\u4E0A\u4F20\u9644\u4EF6",name:"files",action:"/sms/business/bizCharge/upload",fieldProps:{multiple:!0,headers:(0,c.Z)({},U),listType:"picture",defaultFileList:[],onDrop:function(w){},beforeUpload:function(w){if(w.size>4096e4)return P.default.error("\u4E0A\u6B21\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC740M"),M.Z.LIST_IGNORE;if(w.type!="image/png"&&w.type!="image/jpeg"&&w.type!="application/pdf")return P.default.error("\u53EA\u80FD\u4E0A\u4F20png\u3001jpg\u6216\u8005PDF\u683C\u5F0F"),M.Z.LIST_IGNORE},onPreview:function(){var H=(0,p.Z)((0,r.Z)().mark(function C(Oe){return(0,r.Z)().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:Sr(re.id,Oe.name);case 1:case"end":return nt.stop()}},C)}));function w(C){return H.apply(this,arguments)}return w}(),onChange:function(w){var C=w.file.status;C==="done"?P.default.success("".concat(w.file.name," \u4E0A\u4F20\u6210\u529F.")):C==="error"&&P.default.error("".concat(w.file.name," \u4E0A\u4F20\u5931\u8D25."))}}})]}),re.type!="1"?"":(0,u.jsxs)("div",{children:[(0,u.jsxs)(s.ZP.Group,{title:"\u9000\u6B3E\u9886\u53D6\u4EBA\u4FE1\u606F",children:[(0,u.jsx)(gt.Z,{name:"recipientName",label:"\u9000\u8D39\u9886\u53D6\u4EBA",rules:[{required:!0}],width:"sm"}),(0,u.jsx)($.Z,{label:"\u9000\u6B3E\u7C7B\u578B",name:"refundType",width:"md",request:(0,p.Z)((0,r.Z)().mark(function H(){return(0,r.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",ut.Z.getList("dict_refundType"));case 1:case"end":return C.stop()}},H)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9000\u6B3E\u7C7B\u578B"}]})]}),(0,u.jsxs)(s.ZP.Group,{children:[(0,u.jsx)(gt.Z,{name:"accountName",label:"\u5F00\u6237\u540D",width:"md"}),(0,u.jsx)(gt.Z,{name:"account",label:"\u5361\u53F7",width:"md"}),(0,u.jsx)(gt.Z,{name:"bank",label:"\u5F00\u6237\u884C\uFF08\u7CBE\u786E\u5230\u652F\u884C\uFF09",width:"md"})]}),(0,u.jsxs)(m.Z,{children:[(0,u.jsx)(gt.Z,{name:"agent",label:"\u7ECF\u529E\u4EBA",width:"sm"}),(0,u.jsx)(F.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,p.Z)((0,r.Z)().mark(function H(){return(0,r.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(b){C.next=4;break}return C.next=3,ot.Z.get("/sms/share/getDepartmentAndUser");case 3:b=C.sent;case 4:Yt({content:b.data,type:"order"}),vt(!0);case 6:case"end":return C.stop()}},H)})),children:"\u9009\u62E9"})]}),(0,u.jsx)(s.ZP.Group,{title:"\u5B8C\u7ED3\u5B66\u5458"}),(0,u.jsx)(he.Z,{rowSelection:{onChange:function(w,C){console.log("e",w),Ar(w)},defaultSelectedRowKeys:Ir},columns:He,dataSource:wr,search:!1,rowKey:"id"})]}),(0,u.jsx)("div",{style:{display:"none"},children:(0,u.jsx)(i.Z,{width:200,style:{display:"none"},preview:{visible:Zr,src:at,onVisibleChange:function(w){_e(w)}}})}),Fe&&(0,u.jsx)(Ft.Z,{CardVisible:Fe,CardContent:qe,setCardVisible:function(){return vt(!1)},setDepartment:function(w){return Q(w)},departments:[cr]}),(0,u.jsx)(o.Z,{open:Mt,onCancel:function(){fr(!1)},onOk:function(){var w,C;fr(!1),(w=be.current)===null||w===void 0||(C=w.validateFieldsReturnFormatValue)===null||C===void 0||C.call(w).then(function(){var Oe=(0,p.Z)((0,r.Z)().mark(function Ce(nt){return(0,r.Z)().wrap(function(Qt){for(;;)switch(Qt.prev=Qt.next){case 0:return Qt.next=2,Er(nt,Tt);case 2:case"end":return Qt.stop()}},Ce)}));return function(Ce){return Oe.apply(this,arguments)}}()),fr(!1)},okText:"\u786E\u8BA4\u65E0\u8BEF\u63D0\u4EA4",cancelText:"\u8FD4\u56DE\u4FEE\u6539",children:(0,u.jsxs)("div",{style:{textAlign:"center"},children:[(0,u.jsx)("div",{style:{marginBottom:"20px"},children:"\u6CE8\u610F!"}),(0,u.jsx)("div",{children:"\u5F53\u524D\u8BA2\u5355\u6B20\u8D39\u91D1\u989D\u4E3A\u8D1F\u6570,\u8BF7\u786E\u8BA4\u662F\u5426\u6709\u8BEF"})]})}),(0,u.jsx)(o.Z,{title:"\u7F16\u8F91",width:1200,visible:Rt,onCancel:function(){return S(!1)},destroyOnClose:!0,footer:null,children:Rt&&(0,u.jsx)(br,{ref:st,setModalVisible:function(){return S(!1)},modalVisible:Rt,callbackRef:function(){return z()},renderData:(0,c.Z)((0,c.Z)({},Ot),{},{type:"order",orderNumber:0,projectClassExamList:[]})})}),(0,u.jsx)(g.Z,{open:er,onClose:function(){return Se(!1)},width:1400,children:(0,u.jsx)(Ye.Z,{param:{orderIds:","+(Ot==null?void 0:Ot.id)+","}})})]})}},19103:function(ce,D,e){"use strict";var j=e(43185),g=e(43027),V=e(67294),o=e(85893),I=g.Z.Dragger,i=function(m){return(0,o.jsx)(o.Fragment,{})};D.Z=i},79438:function(ce,D,e){"use strict";var j=e(57338),g=e(273),V=e(71153),o=e(60331),I=e(98858),i=e(4914),A=e(11849),m=e(39428),L=e(3182),M=e(2824),d=e(37490),J=e(67294),ne=e(61261),X=e(28975),x=e(63863),F=e(7903),f=e(85893);D.Z=function(P){var r=P.modalVisible,p=P.setModalVisible,O=P.renderData,c=(0,J.useState)([]),a=(0,M.Z)(c,2),h=a[0],ie=a[1],Ee=(0,J.useState)(!1),s=(0,M.Z)(Ee,2),le=s[0],$=s[1],bt=(0,J.useState)(),pe=(0,M.Z)(bt,2),Ct=pe[0],gt=pe[1],et=(0,J.useState)(),ae=(0,M.Z)(et,2),ut=ae[0],ot=ae[1],tr=(0,J.useState)(!1),he=(0,M.Z)(tr,2),Ft=he[0],gr=he[1],it=(0,J.useState)(!1),t=(0,M.Z)(it,2),Ye=t[0],l=t[1],u=(0,J.useState)(),b=(0,M.Z)(u,2),n=b[0],ht=b[1],jr=function(){var Y=(0,L.Z)((0,m.Z)().mark(function Dt(re){var Xt;return(0,m.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,x.Z.get("/sms/business/bizCharge",{"id-in":re});case 2:Xt=Z.sent.data.content,ie(Xt);case 4:case"end":return Z.stop()}},Dt)}));return function(re){return Y.apply(this,arguments)}}(),$e=function(){var Y=(0,L.Z)((0,m.Z)().mark(function Dt(re){var Xt;return(0,m.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,x.Z.get("/sms/business/bizInvoice",{chargeIds:",".concat(re,",")});case 2:Xt=Z.sent.data.content,l(Xt);case 4:case"end":return Z.stop()}},Dt)}));return function(re){return Y.apply(this,arguments)}}();(0,J.useEffect)(function(){if(O.chargeIds&&jr(O.chargeIds),O.types=="charges"?$e(O.id):l([O]),O.chargeIds!=null){for(var Y={},Dt=O.chargeIds.split(",").filter(function(B){return!!B}),re=O.usedAmounts.split(","),Xt=0;Xt<Dt.length;Xt++)Y[Dt[Xt]]=re[Xt];ht(Y)}},[]);var sr=function(Dt){x.Z.get("/sms/business/bizStudentUser",{id:Dt}).then(function(re){ot((0,A.Z)({},re.data.content[0])),gr(!0)})};return(0,f.jsxs)(g.Z,{open:r,onClose:function(){return p()},width:1200,children:[Ye&&Ye.map(function(Y){return(0,f.jsxs)(i.Z,{title:"\u53D1\u7968\u4FE1\u606F",column:2,bordered:!0,size:"small",children:[(0,f.jsx)(i.Z.Item,{label:"\u53D1\u7968\u53F7\u7801",children:Y.no}),(0,f.jsx)(i.Z.Item,{label:"\u5F00\u7968\u65F6\u95F4",children:Y.time}),(0,f.jsx)(i.Z.Item,{label:"\u53D1\u7968\u62AC\u5934",span:2,children:Y.title}),(0,f.jsx)(i.Z.Item,{label:"\u5546\u54C1\u79CD\u7C7B",children:d.Z.getName("invoiceProductType",Y.productType)}),(0,f.jsx)(i.Z.Item,{label:"\u53D1\u7968\u7A0E\u53F7",children:Y.taxCode}),(0,f.jsx)(i.Z.Item,{label:"\u53D1\u7968\u91D1\u989D",children:Y.amount}),(0,f.jsx)(i.Z.Item,{label:"\u90AE\u7BB1",children:Y.email}),(0,f.jsx)(i.Z.Item,{label:"\u53D1\u7968\u5907\u6CE8",span:2,children:Y.remark}),(0,f.jsx)(i.Z.Item,{label:"\u6CE8\u610F\u4E8B\u9879",span:2,children:Y.cautions}),(0,f.jsx)(i.Z.Item,{label:"\u53D1\u7968\u79CD\u7C7B",span:2,children:d.Z.getName("invoiceType",Y.type)}),(0,f.jsx)(i.Z.Item,{label:"\u5F00\u6237\u884C",children:Y.bank}),(0,f.jsx)(i.Z.Item,{label:"\u8D26\u53F7",children:Y.account}),(0,f.jsx)(i.Z.Item,{label:"\u7535\u8BDD",children:Y.mobile}),(0,f.jsx)(i.Z.Item,{label:"\u5730\u5740",children:Y.address}),(0,f.jsx)(i.Z.Item,{label:"\u8981\u6C42\u5F00\u7968\u516C\u53F8",span:2,children:Y.chargeAccount!==null?d.Z.getName("dict_stu_refund_type",Y.chargeAccount):""}),(0,f.jsx)(i.Z.Item,{label:"\u5355\u4EF7",children:Y.price}),(0,f.jsx)(i.Z.Item,{label:"\u6570\u91CF",children:Y.quantity})]})}),(0,f.jsx)(i.Z,{title:"\u7F34\u8D39\u4FE1\u606F",bordered:!0,size:"small"}),h.map(function(Y,Dt){return(0,f.jsxs)(i.Z,{title:(0,f.jsxs)("span",{children:["\u7F34\u8D39\u7F16\u53F7:".concat(Y.num?Y.num:"\u672A\u5BA1\u6838")," ","\u5F00\u7968\u91D1\u989D:".concat(n[Y.id]),"  \u5B66\u5458\u59D3\u540D:",Y.studentUserId?(0,f.jsx)("a",{onClick:function(){return sr(Y.studentUserId)},children:Y.studentName}):Y.studentName]}),bordered:!0,size:"small",style:{marginBottom:"30px"},children:[(0,f.jsx)(i.Z.Item,{label:"\u6536\u8D39\u91D1\u989D",children:Y.amount}),(0,f.jsx)(i.Z.Item,{label:"\u6536\u6B3E\u65B9\u5F0F",children:d.Z.getCascaderName("dict_stu_refund_type",Y.method)}),(0,f.jsx)(i.Z.Item,{label:"\u672C\u6B21\u6298\u6263\u91D1\u989D",children:Y.discount}),(0,f.jsx)(i.Z.Item,{label:"\u672C\u6B21\u6298\u6263\u539F\u56E0",children:Y.discountRemark}),(0,f.jsx)(i.Z.Item,{label:"\u6536\u8D39\u4EBA",children:Y.userName}),(0,f.jsx)(i.Z.Item,{label:"\u7F34\u8D39\u65E5\u671F",children:Y.paymentTime}),(0,f.jsx)(i.Z.Item,{label:"\u4E0B\u6B21\u7F34\u8D39\u65F6\u95F4",children:Y.nextPaymentTime}),(0,f.jsx)(i.Z.Item,{label:"\u5BA1\u6838\u4EBA",children:Y.auditor}),(0,f.jsx)(i.Z.Item,{label:"\u5BA1\u6838\u72B6\u6001",children:Y.confirm===!0?(0,f.jsx)(o.Z,{color:"#87d068",children:"\u5BA1\u6838\u901A\u8FC7"}):Y.confirm===!1?(0,f.jsx)(o.Z,{color:"#FF0000",children:"\u5BA1\u6838\u672A\u901A\u8FC7"}):(0,f.jsx)(o.Z,{color:"#f50",children:"\u672A\u5BA1\u6838"})}),(0,f.jsx)(i.Z.Item,{label:"\u7F34\u8D39\u5907\u6CE8",span:3,children:Y.description}),(0,f.jsx)(i.Z.Item,{label:"\u8D22\u52A1\u5907\u6CE8",span:3,children:Y.description2}),(0,f.jsx)(i.Z.Item,{label:"\u5BA1\u6838\u5907\u6CE8",span:3,children:Y.remark}),(0,f.jsx)(i.Z.Item,{label:"\u9644\u4EF6",children:Y!=null&&Y.files?Y.files.split(",").map(function(re,Xt){return(0,f.jsxs)("div",{className:"notice-files",children:["\u9644\u4EF6\u5185\u5BB9\uFF1A"," ",(0,f.jsx)("a",{onClick:function(){(0,ne.Z)(Y.id,re,"/sms/business/bizCharge/download",gt,$)},children:re})]},Xt)}):""})]},"has-invoice-info-".concat(Dt))}),le&&(0,f.jsx)(X.Z,{imgSrc:Ct,isModalVisibles:le,setisModalVisibles:function(Dt){return $(Dt)}}),Ft&&(0,f.jsx)(F.Z,{setModalVisible:function(){return gr(!1)},modalVisible:Ft,renderData:ut})]})}},35338:function(ce,D,e){"use strict";var j=e(57663),g=e(71577),V=e(2824),o=e(61120),I=e.n(o),i=e(37490),A=e(67294),m=e(21010),L=e(47038),M=e(85893);D.Z=function(d){var J=d.src,ne=d.companyName,X=d.order,x=X===void 0?{}:X,F=d.charge,f=F===void 0?{}:F,P=d.showInfo,r=P===void 0?!0:P,p=(0,m.tT)("@@initialState"),O=p.initialState,c=(0,A.useState)(!1),a=(0,V.Z)(c,2),h=a[0],ie=a[1],Ee=(0,A.useState)(),s=(0,V.Z)(Ee,2),le=s[0],$=s[1];return(0,A.useEffect)(function(){ne?$(ne.slice(0,6)+`
`+ne.slice(6)):(0,L.ZL)().then(function(bt){var pe,Ct=O==null||(pe=O.currentUser)===null||pe===void 0?void 0:pe.companyId;bt.forEach(function(gt){gt.value==Ct&&$(gt.label.slice(0,6)+`
`+gt.label.slice(6))})})}),(0,M.jsxs)("div",{className:"qrcodeInfo",children:[(0,M.jsxs)("div",{className:"payment-card",children:[(0,M.jsxs)("div",{className:"header",children:[(0,M.jsx)("h1",{style:{whiteSpace:"pre"},children:le}),(0,M.jsx)("p",{children:"\u4E8C\u7EF4\u7801\u5FEB\u6377\u652F\u4ED8"})]}),(0,M.jsxs)("div",{className:"amount",hidden:!r,children:["\uFFE5",f.amount]}),(0,M.jsx)("div",{className:"qr-container",children:(0,M.jsx)("div",{className:"qr-code",children:(0,M.jsx)("img",{src:J})})}),(0,M.jsxs)("div",{className:"payment-method",children:[(0,M.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1448",width:"32",height:"32",children:(0,M.jsx)("path",{d:"M1024.0512 701.0304V196.864A196.9664 196.9664 0 0 0 827.136 0H196.864A196.9664 196.9664 0 0 0 0 196.864v630.272A196.9152 196.9152 0 0 0 196.864 1024h630.272a197.12 197.12 0 0 0 193.8432-162.0992c-52.224-22.6304-278.528-120.32-396.4416-176.64-89.7024 108.6976-183.7056 173.9264-325.3248 173.9264s-236.1856-87.2448-224.8192-194.048c7.4752-70.0416 55.552-184.576 264.2944-164.9664 110.08 10.3424 160.4096 30.8736 250.1632 60.5184 23.1936-42.5984 42.496-89.4464 57.1392-139.264H248.064v-39.424h196.9152V311.1424H204.8V267.776h240.128V165.632s2.1504-15.9744 19.8144-15.9744h98.4576V267.776h256v43.4176h-256V381.952h208.8448a805.9904 805.9904 0 0 1-84.8384 212.6848c60.672 22.016 336.7936 106.3936 336.7936 106.3936zM283.5456 791.6032c-149.6576 0-173.312-94.464-165.376-133.9392 7.8336-39.3216 51.2-90.624 134.4-90.624 95.5904 0 181.248 24.4736 284.0576 74.5472-72.192 94.0032-160.9216 150.016-253.0816 150.016z",fill:"#009FE8","p-id":"1449"})}),"\u652F\u4ED8\u5B9D \xA0\xA0",(0,M.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1609",width:"32",height:"32",children:(0,M.jsx)("path",{d:"M404.511405 600.865957c-4.042059 2.043542-8.602935 3.223415-13.447267 3.223415-11.197016 0-20.934798-6.169513-26.045189-15.278985l-1.959631-4.296863-81.56569-178.973184c-0.880043-1.954515-1.430582-4.14746-1.430582-6.285147 0-8.251941 6.686283-14.944364 14.938224-14.944364 3.351328 0 6.441713 1.108241 8.94165 2.966565l96.242971 68.521606c7.037277 4.609994 15.433504 7.305383 24.464181 7.305383 5.40101 0 10.533914-1.00284 15.328104-2.75167l452.645171-201.459315C811.496653 163.274644 677.866167 100.777241 526.648117 100.777241c-247.448742 0-448.035176 167.158091-448.035176 373.361453 0 112.511493 60.353576 213.775828 154.808832 282.214547 7.582699 5.405103 12.537548 14.292518 12.537548 24.325012 0 3.312442-0.712221 6.358825-1.569752 9.515724-7.544837 28.15013-19.62599 73.202209-20.188808 75.314313-0.940418 3.529383-2.416026 7.220449-2.416026 10.917654 0 8.245801 6.692423 14.933107 14.944364 14.933107 3.251044 0 5.89015-1.202385 8.629541-2.7793l98.085946-56.621579c7.377014-4.266164 15.188934-6.89913 23.790846-6.89913 4.577249 0 9.003048 0.703011 13.174044 1.978051 45.75509 13.159718 95.123474 20.476357 146.239666 20.476357 247.438509 0 448.042339-167.162184 448.042339-373.372709 0-62.451354-18.502399-121.275087-51.033303-173.009356L407.778822 598.977957 404.511405 600.865957z",fill:"#00C800","p-id":"1610"})}),"\u5FAE\u4FE1\u652F\u4ED8"]}),(0,M.jsx)("div",{className:"expire-time",children:"\u201C\u4E3A\u6BCF\u4E00\u4F4D\u5B66\u5458\u63D0\u4F9B\u6700\u503C\u5F97\u4FE1\u8D56\u7684\u670D\u52A1\u201D"}),(0,M.jsxs)("div",{className:"order-info",hidden:!r,children:[(0,M.jsxs)("div",{className:"info-row",children:[(0,M.jsx)("span",{className:"info-label",children:"\u8BA2\u5355\u7F16\u53F7"}),(0,M.jsx)("span",{className:"info-value",children:f.num2})]}),(0,M.jsxs)("div",{className:"info-row",children:[(0,M.jsx)("span",{className:"info-label",children:"\u5B66\u5458\u59D3\u540D"}),(0,M.jsx)("span",{className:"info-value",children:f.studentName})]}),(0,M.jsxs)("div",{className:"info-row",children:[(0,M.jsx)("span",{className:"info-label",children:"\u670D\u52A1\u9879\u76EE"}),(0,M.jsxs)("span",{className:"info-value",children:[i.Z.getCascaderAllName("dict_reg_job",x.project),"\u2014",i.Z.getCascaderName("dict_reg_job",x.project)]})]}),(0,M.jsxs)("div",{className:"info-row",children:[(0,M.jsx)("span",{className:"info-label",children:"\u62DB\u751F\u8001\u5E08"}),(0,M.jsx)("span",{className:"info-value",children:f.userName})]}),(0,M.jsxs)("div",{className:"info-row",children:[(0,M.jsx)("span",{className:"info-label",children:"\u521B\u5EFA\u65F6\u95F4"}),(0,M.jsx)("span",{className:"info-value",children:f.createTime})]})]}),(0,M.jsx)("div",{className:"footer",children:"\u652F\u4ED8\u5B8C\u6210\u540E\uFF0C\u7CFB\u7EDF\u5C06\u81EA\u52A8\u5904\u7406\u60A8\u7684\u8BA2\u5355"})]}),(0,M.jsx)(g.Z,{style:{display:"block",margin:"auto"},type:"primary",loading:h,onClick:function(){ie(!0),I()(document.querySelector(".payment-card")).then(function(pe){var Ct=pe.toDataURL("image/jpeg"),gt=document.createElement("a");if(gt.href=Ct,f.studentName)gt.download=f.studentName+"\u652F\u4ED8\u4E8C\u7EF4\u7801.jpg";else{var et;gt.download=(O==null||(et=O.currentUser)===null||et===void 0?void 0:et.name)+"\u4E13\u5C5E\u6536\u6B3E\u4E8C\u7EF4\u7801.jpg"}gt.click(),ie(!1)})},children:"\u4E0B\u8F7D\u6536\u6B3E\u7801"})]})}},84956:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var antd_es_button_style__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(57663),antd_es_button__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(71577),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(86582),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(11849),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(2824),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(39428),antd_es_message_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(34792),antd_es_message__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(48086),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(3182),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(5894),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(59962),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(24739),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(8214),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(64317),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(31199),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(5966),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(19054),_ant_design_pro_card__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(30202),_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(37490),_services_ant_design_pro_apiRequest__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(63863),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(67294),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(85893),JobClassExamA=[],quantitys=[0,0,0,0,0,0,0,0,0],comNumbers=[0,0,0,0,0,0,0,0,0],ClassList=(0,react__WEBPACK_IMPORTED_MODULE_4__.forwardRef)(function(props,ref){var renderData=props.renderData,onTotalPriceChange=props.onTotalPriceChange,onTotalQuantityChange=props.onTotalQuantityChange,onAddClassType=props.onAddClassType,onRemoveClassType=props.onRemoveClassType;(0,react__WEBPACK_IMPORTED_MODULE_4__.useImperativeHandle)(ref,function(){return{getFormValues:function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function e(){var j,g,V;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.prev=0,I.next=3,(j=formRef.current)===null||j===void 0?void 0:j.validateFields();case 3:return g=I.sent,I.abrupt("return",g);case 7:throw I.prev=7,I.t0=I.catch(0),I.t0&&I.t0.errorFields?(V=I.t0.errorFields[0],antd_es_message__WEBPACK_IMPORTED_MODULE_8__.default.error(V.errors[0]||"\u8868\u5355\u9A8C\u8BC1\u5931\u8D25")):antd_es_message__WEBPACK_IMPORTED_MODULE_8__.default.error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u8868\u5355\u586B\u5199\u662F\u5426\u5B8C\u6574"),I.t0;case 11:case"end":return I.stop()}},e,null,[[0,7]])}));function D(){return ce.apply(this,arguments)}return D}(),resetForm:function(){var D,e;(D=formRef.current)===null||D===void 0||D.resetFields(),setTotalPrice(0),setTotalQuantity(0),setJobClassExam([]);var j=[{project:[],quantity:1,receivable:0,discount:0,discountRemark:"",source:""}];(e=formRef.current)===null||e===void 0||e.setFieldsValue({users:j})}}});var _useState=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(),_useState2=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_useState,2),userNameId=_useState2[0],setUserNameId=_useState2[1],_useState3=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)([]),_useState4=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_useState3,2),orderList=_useState4[0],setOrderList=_useState4[1],_useState5=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)([]),_useState6=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_useState5,2),JobClassExam=_useState6[0],setJobClassExam=_useState6[1],_useState7=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(0),_useState8=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_useState7,2),totalPrice=_useState8[0],setTotalPrice=_useState8[1],_useState9=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(0),_useState10=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_useState9,2),totalQuantity=_useState10[0],setTotalQuantity=_useState10[1],formRef=(0,react__WEBPACK_IMPORTED_MODULE_4__.useRef)(null),userRef=(0,react__WEBPACK_IMPORTED_MODULE_4__.useRef)(null);(0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(function(){var ce;formRef==null||(ce=formRef.current)===null||ce===void 0||ce.setFieldsValue({provider:userNameId==null?void 0:userNameId.id})},[userNameId]),(0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(function(){if(!renderData){var _formRef$current5;formRef==null||(_formRef$current5=formRef.current)===null||_formRef$current5===void 0||_formRef$current5.setFieldsValue({users:[{project:[],quantity:1,receivable:0,discount:0,discountRemark:""}]});return}renderData.project&&handleChangeProject([renderData.project],0);var list=[],orderList=[renderData];setOrderList(orderList),orderList.forEach(function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function D(e,j){return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:e.project&&handleChangeProject([e.project],j),quantitys[j]=e.quantity||1,comNumbers[j]=e.receivable||0,list.push({project:e.project?_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__.Z.getCascaderValue("dict_reg_job",e.project):[],quantity:e.quantity||1,receivable:e.receivable||0,discount:e.discount||0,source:e.studentSource?_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__.Z.getName("dict_source",e.studentSource):void 0,discountRemark:e.discountRemark||"",provider:{value:renderData.provider},studentUserId:e.id||null});case 4:case"end":return V.stop()}},D)}));return function(D,e){return ce.apply(this,arguments)}}()),setTimeout((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function _callee3(){var _formRef$current6,_userRef$current,data;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:formRef==null||(_formRef$current6=formRef.current)===null||_formRef$current6===void 0||_formRef$current6.setFieldsValue((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},renderData),{},{percent:renderData.percent?renderData.percent*100:0,quantity:quantitys.length>0?eval(quantitys.join("+")):1,project:renderData.project?_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__.Z.getCascaderValue("dict_reg_job",renderData.project):[],users:list,provider:renderData.provider})),renderData.provider&&renderData.providerName&&(data={id:renderData.provider,name:renderData.providerName},userRef==null||(_userRef$current=userRef.current)===null||_userRef$current===void 0||_userRef$current.setDepartment(data),setUserNameId(data));case 2:case"end":return _context3.stop()}},_callee3)})),500)},[renderData]);var filter=function(D,e){return e.some(function(j){return j.label.toLowerCase().indexOf(D.toLowerCase())>-1})},handleChangeProject=function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function D(e,j){var g,V,o,I,i;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(formRef==null||(g=formRef.current)===null||g===void 0||g.setFieldsValue({JobClassExam:"",receivable:0}),V=JSON.parse(JSON.stringify(JobClassExam)),!(e&&e.length>0)){m.next=17;break}return m.prev=3,m.next=6,_services_ant_design_pro_apiRequest__WEBPACK_IMPORTED_MODULE_3__.Z.get("/sms/business/bizChargeStandard?project="+e[e.length-1]+"&useNum=0&_size=999&enable=true");case 6:o=m.sent,I=o.data.content,I&&I.length>0?(V[j]=projectClassExamListFn(I),JobClassExamA[j]=projectClassExamListFn(I)):V[j]=null,m.next=15;break;case 11:m.prev=11,m.t0=m.catch(3),console.error("\u83B7\u53D6\u73ED\u578B\u6570\u636E\u5931\u8D25:",m.t0),V[j]=null;case 15:m.next=18;break;case 17:V[j]=null;case 18:i=renderData||{},setTimeout(function(){try{var L=i.type||"";setJobClassExam(L!=="order"?V:JobClassExamA)}catch(M){console.error("\u8BBE\u7F6E\u73ED\u578B\u6570\u636E\u5931\u8D25:",M),setJobClassExam(V)}},100);case 20:case"end":return m.stop()}},D,null,[[3,11]])}));return function(e,j){return ce.apply(this,arguments)}}();function projectClassExamListFn(ce){var D=[];return ce.forEach(function(e){D.push({label:_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__.Z.getName("dict_class_type",e.classType)+"/"+_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__.Z.getName("dict_exam_type",e.examType)+"/"+_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__.Z.getName("dict_class_year",e.classYear),value:JSON.stringify({classType:e.classType,examType:e.examType,classYear:e.classYear,receivable:e.receivable,project:e.project})})}),D}var getDepartment=function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function D(){var e,j,g;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return e=function I(i){var A=[];return i.forEach(function(m,L){var M=[];m.children&&(M=I(m.children));var d="",J=!1,ne={};m.departmentName?(d=m.departmentName,ne.id=m.id,J=!0):m.enable&&(d=m.name,ne.userId=m.userId,J=!0),J&&(M.length>0?A.push((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},ne),{},{title:d,parentId:m.parentId,children:M})):A.push((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},ne),{},{title:d,parentId:m.parentId})))}),A},j=function I(i,A){i.forEach(function(m,L){m.value=m.userId,m.value||(m.value=A+"-"+L),m.children&&I(m.children,m.value)})},g=e(JSON.parse(localStorage.getItem("Department"))),j(g,0),o.abrupt("return",g.reverse());case 5:case"end":return o.stop()}},D)}));return function(){return ce.apply(this,arguments)}}();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_11__.A,{formRef,submitter:!1,onFinish:function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function D(e){return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",console.log(e));case 1:case"end":return g.stop()}},D)}));return function(D){return ce.apply(this,arguments)}}(),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_12__.u,{name:"users",creatorButtonProps:{creatorButtonText:"\u65B0\u589E\u4E00\u6761\u73ED\u578B\u4FE1\u606F"},creatorRecord:function(){var D,e,j={project:renderData!=null&&renderData.project?_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__.Z.getCascaderValue("dict_reg_job",renderData.project):[],quantity:1,source:renderData!=null&&renderData.source?renderData.source.toString():void 0,provider:{value:(D=renderData==null?void 0:renderData.provider)!==null&&D!==void 0?D:null},receivable:0,studentUserId:(e=renderData==null?void 0:renderData.id)!==null&&e!==void 0?e:null,discount:0,discountRemark:"",JobClassExam:null};return renderData?j:(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},j),{},{project:[],source:"",provider:{value:null},studentUserId:null})},actionGuard:{beforeAddRow:function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function e(j,g){var V;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.prev=0,V=(renderData==null?void 0:renderData.project)||[],I.next=4,handleChangeProject(Array.isArray(V)?V:[V],g);case 4:onAddClassType&&onAddClassType(),I.next=10;break;case 7:I.prev=7,I.t0=I.catch(0),console.error("\u6DFB\u52A0\u884C\u65F6\u5904\u7406\u9879\u76EE\u5931\u8D25:",I.t0);case 10:return I.abrupt("return",new Promise(function(i){setTimeout(function(){var A,m,L=(formRef==null||(A=formRef.current)===null||A===void 0?void 0:A.getFieldValue("users"))||[],M=L.reduce(function(J,ne){return J+(Number(ne.receivable)||0)},0),d=L.reduce(function(J,ne){return J+(Number(ne.quantity)||0)},0);setTotalPrice(M),setTotalQuantity(d),onTotalPriceChange==null||onTotalPriceChange(M),onTotalQuantityChange==null||onTotalQuantityChange(d),formRef==null||(m=formRef.current)===null||m===void 0||m.setFieldsValue({receivable:M,quantity:d}),i(!0)},1e3)}));case 11:case"end":return I.stop()}},e,null,[[0,7]])}));function D(e,j){return ce.apply(this,arguments)}return D}(),beforeRemoveRow:function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function e(j){return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.abrupt("return",new Promise(function(o){var I;if(j===0){antd_es_message__WEBPACK_IMPORTED_MODULE_8__.default.error("\u8FD9\u884C\u4E0D\u80FD\u5220"),o(!1);return}props.onRemoveClassType&&props.onRemoveClassType(j);var i=(formRef==null||(I=formRef.current)===null||I===void 0?void 0:I.getFieldValue("users"))||[],A=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_13__.Z)(i);A.splice(j,1);var m=A.reduce(function(M,d){return M+(Number(d.receivable)||0)},0),L=A.reduce(function(M,d){return M+(Number(d.quantity)||0)},0);setTotalPrice(m),setTotalQuantity(L),onTotalPriceChange==null||onTotalPriceChange(m),onTotalQuantityChange==null||onTotalQuantityChange(L),setTimeout(function(){var M;formRef==null||(M=formRef.current)===null||M===void 0||M.setFieldsValue({receivable:m,quantity:L}),o(!0)},100)}));case 1:case"end":return V.stop()}},e)}));function D(e){return ce.apply(this,arguments)}return D}()},itemRender:function(D,e){var j=D.listDom,g=D.action,V=e.record,o=e.index;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_card__WEBPACK_IMPORTED_MODULE_14__.ZP,{bordered:!0,title:"\u62A5\u8003\u73ED\u578B",extra:g,style:{marginBlockEnd:8},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_15__.UW,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_11__.A.Group,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_16__.Z,{width:"sm",name:"project",placeholder:"\u54A8\u8BE2\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__.Z.getCascader("dict_reg_job"),showSearch:{filter},onChange:function(i){handleChangeProject(i,o)}}}),JobClassExam[o]?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_17__.Z,{label:"\u73ED\u578B\u9009\u62E9",name:"JobClassExam",fieldProps:{options:JobClassExam[o],showSearch:!0,onSelect:function(i){try{var A,m,L,M=JSON.parse(i);if(!M||typeof M!="object")throw new Error("Invalid data format");var d=(formRef==null||(A=formRef.current)===null||A===void 0?void 0:A.getFieldValue("users"))||[];if(!Array.isArray(d))throw new Error("Users data is not an array");var J=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_13__.Z)(d);J[o]=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},J[o]),{},{receivable:M.receivable||0}),formRef==null||(m=formRef.current)===null||m===void 0||m.setFieldsValue({users:J});var ne=J.reduce(function(x,F){return x+(Number(F.receivable)||0)},0),X=J.reduce(function(x,F){return x+(Number(F.quantity)||0)},0);setTotalPrice(ne),setTotalQuantity(X),onTotalPriceChange==null||onTotalPriceChange(ne),onTotalQuantityChange==null||onTotalQuantityChange(X),formRef==null||(L=formRef.current)===null||L===void 0||L.setFieldsValue({receivable:ne,quantity:X})}catch(x){antd_es_message__WEBPACK_IMPORTED_MODULE_8__.default.error("\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}}},width:"sm",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u73ED\u578B\u9009\u62E9"}]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(antd_es_button__WEBPACK_IMPORTED_MODULE_18__.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function I(){var i;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:i=JSON.parse(JSON.stringify(JobClassExam)),i[o]=!1,setJobClassExam(i);case 3:case"end":return m.stop()}},I)})),children:"\u53D6\u6D88"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_19__.Z,{name:"quantity",width:"sm",label:"\u62A5\u540D\u4EBA\u6570",disabled:!0,fieldProps:{onChange:function(i){}},rules:[{required:!0,message:"\u8BF7\u586B\u5199\u62A5\u540D\u4EBA\u6570"}]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_19__.Z,{name:"receivable",label:"\u6536\u8D39\u6807\u51C6",width:"sm",disabled:JobClassExam[o],fieldProps:{onChange:function(i){}},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u91D1\u989D"}]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_17__.Z,{label:"\u8BA2\u5355\u6765\u6E90",name:"source",placeholder:"\u8BF7\u9009\u62E9\u8BA2\u5355\u6765\u6E90",width:"sm",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8BA2\u5355\u6765\u6E90"}],request:(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_6__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().mark(function I(){return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_7__.Z)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_2__.Z.getList("dict_source"));case 1:case"end":return A.stop()}},I)})),allowClear:!0,fieldProps:{showSearch:!0,placeholder:"\u8BF7\u9009\u62E9\u8BA2\u5355\u6765\u6E90"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_19__.Z,{name:"discount",label:"\u8BA2\u5355\u4F18\u60E0\u91D1\u989D",min:-999999,width:280,rules:[{required:!0}],fieldProps:{precision:2,onChange:function(i){}}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_20__.Z,{name:"discountRemark",label:"\u8BA2\u5355\u4F18\u60E0\u539F\u56E0",width:"sm",fieldProps:{autoComplete:"no"},rules:[]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_20__.Z,{name:"studentUserId",hidden:!0,label:"\u8BA2\u5355\u4F18\u60E0\u539F\u56E0",width:"sm",fieldProps:{autoComplete:"no"},rules:[]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_21__.Z,{name:"provider",label:"\u4FE1\u606F\u63D0\u4F9B\u4EBA",placeholder:"\u8BF7\u8F93\u5165\u4FE1\u606F\u63D0\u4F9B\u4EBA",allowClear:!0,width:"sm",secondary:!0,request:function(){return getDepartment()},required:!0,fieldProps:{treeDefaultExpandAll:!0,filterTreeNode:!0,showSearch:!0,dropdownMatchSelectWidth:!1,labelInValue:!0,treeNodeFilterProp:"title",fieldNames:{label:"title"}}})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("span",{style:{display:"inline-block",marginTop:"32px"},children:"\u8BE5\u9879\u76EE\u5C1A\u672A\u8BBE\u7F6E\u6536\u8D39\u6807\u51C6,\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u8BBE\u7F6E!"})]})},"admin-order-class-type-".concat(o))})}})})});__webpack_exports__.Z=ClassList},63930:function(ce,D,e){"use strict";var j=e(71194),g=e(50146),V=e(67294),o=e(6274),I=e(85893);D.Z=function(i){var A=i.modalVisible,m=i.setModalVisible,L=i.callbackRef,M=i.parentId,d=M===void 0?"-1":M,J=i.renderData,ne=i.setStudentId,X=i.companyStudent,x=X===void 0?null:X,F=i.isFormal,f=F===void 0?!1:F;return(0,I.jsx)(g.Z,{title:"\u9009\u62E9\u5B66\u5458",width:1200,onCancel:function(){return m()},onOk:function(){return m()},visible:A,destroyOnClose:!0,children:(0,I.jsx)(o.Z,{order:J.type,setStudentId:function(r){ne(r)},companyStudent:x,parentId:d,isFormal:f,type:"\u5B66\u5458",setStudentVisible:function(){return m(!1)},oncancel:function(){m(),L()}})})}},90437:function(ce,D,e){"use strict";e.d(D,{Z:function(){return Zt}});var j=e(20228),g=e(11382),V=e(57338),o=e(273),I=e(49111),i=e(19650),A=e(66456),m=e(15885),L=e(32059),M=e(62350),d=e(24565),J=e(22385),ne=e(94199),X=e(57663),x=e(71577),F=e(86582),f=e(71153),P=e(60331),r=e(39428),p=e(3182),O=e(34792),c=e(48086),a=e(11849),h=e(2824),ie=e(71194),Ee=e(50146),s=e(67294),le=e(68855),$=e(8212),bt=e(26589),pe=e(82061),Ct=e(26271),gt=e(51042),et=e(63863),ae=e(37490),ut=e(92205),ot=e(5909),tr=e(7903),he=e(63930),Ft=e(26802),gr=e(76294),it=e(27510),t=e(952),Ye=e(64317),l=e(45510),u=e(22452),b=e(21874),n=e(85893),ht=function(Fe,vt){var Qe=Fe.setModalVisible,Be=Qe===void 0?void 0:Qe,Mt=Fe.callbackRef,fr=Mt===void 0?void 0:Mt,Ue=Fe.renderData,vr=Fe.admin,Tt=Fe.chargeType,Pe=(0,s.useState)(Ue.list),ze=(0,h.Z)(Pe,2),Ae=ze[0],Rt=ze[1],S=(0,s.useState)(),Xe=(0,h.Z)(S,2),we=Xe[0],qe=Xe[1],Yt=(0,s.useRef)(null);return console.log(Ue.list,"renderDatalist"),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(it.Z,{children:Ae.map(function(Te,N){return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(t.ZP,{autoFocusFirstInput:!0,submitter:!1,children:[(0,n.jsxs)(t.ZP.Group,{children:[Ue.type=="orders"?(0,n.jsx)(Ye.Z,{label:"\u7F34\u8D39\u7C7B\u578B",name:"type",width:"md",request:(0,p.Z)((0,r.Z)().mark(function y(){return(0,r.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.abrupt("return",ae.Z.getList("chargeType"));case 1:case"end":return k.stop()}},y)})),required:!0,disabled:!0,fieldProps:{defaultValue:Ue.type=="orders"?["\u8BA2\u5355\u9000\u8D39"]:["\u8BA2\u5355\u7F34\u8D39"]}}):(0,n.jsx)(Ye.Z,{label:"\u7F34\u8D39\u7C7B\u578B",name:"type",width:"md",request:(0,p.Z)((0,r.Z)().mark(function y(){var W;return(0,r.Z)().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return xe.abrupt("return",(W=ae.Z.getList("chargeType"))===null||W===void 0?void 0:W.filter(function(ye){return["0","4","5","6"].indexOf(ye.value)!=-1}));case 1:case"end":return xe.stop()}},y)})),fieldProps:{onChange:function(W){console.log("e",W)}},required:!0,initialValue:Tt,disabled:Tt!=null}),(0,n.jsx)(Ye.Z,{label:"\u4ED8\u6B3E\u65B9\u5F0F",name:"method",width:"md",request:(0,p.Z)((0,r.Z)().mark(function y(){return(0,r.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.abrupt("return",ae.Z.getList("dict_stu_refund_type"));case 1:case"end":return k.stop()}},y)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4ED8\u6B3E\u65B9\u5F0F"}]}),(0,n.jsx)(b.Z,{ref:Yt,userLabel:Ue.type=="orders"?"\u9000\u8D39\u4EBA":"\u6536\u8D39\u4EBA",userNames:"userId",userPlaceholder:"\u8BF7\u8F93\u5165\u62DB\u751F\u8001\u5E08\u7684\u540D\u5B57",setUserNameId:function(W){return qe(W)},flag:!0})]}),(0,n.jsx)(t.ZP.Group,{children:Ue.type=="orders"?"":(0,n.jsx)(n.Fragment,{})}),(0,n.jsxs)(t.ZP.Group,{children:[(0,n.jsx)(l.Z,{name:"chargeTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},label:"\u7F34\u8D39\u65E5\u671F",width:"md",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7F34\u8D39\u65E5\u671F"}]}),(0,n.jsx)(u.Z,{name:"paymentTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"md",hidden:Ue.type=="orders",label:"\u6536\u8D39\u65E5\u671F"}),(0,n.jsx)(u.Z,{name:"nextPaymentTime",width:"md",label:"\u4E0B\u6B21\u7F34\u8D39\u65F6\u95F4",fieldProps:{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"},hidden:Ue.type=="orders",disabled:Ue.type=="orders"})]}),(0,n.jsx)(it.Z,{title:"\u8BA2\u5355\u73ED\u578B\u8BE6\u60C5\u7F34\u8D39"})]})})})})})},jr=e(38282),$e=e(21010),sr=e(41574),Y=e(66801),Dt=e(15258),re=function(Fe){var vt=Fe.modalVisible,Qe=Fe.setModalVisible,Be=Fe.callbackRef,Mt=Fe.renderData,fr=(0,s.useRef)(),Ue=(0,s.useState)(!1),vr=(0,h.Z)(Ue,2),Tt=vr[0],Pe=vr[1],ze=(0,s.useState)([]),Ae=(0,h.Z)(ze,2),Rt=Ae[0],S=Ae[1],Xe=(0,s.useState)("/sms/business/bizOrder/batch/import"),we=(0,h.Z)(Xe,2),qe=we[0],Yt=we[1],Te={};(0,s.useEffect)(function(){var W=[];Te={classType:Mt.order.classType,examType:Mt.order.examType,classYear:Mt.order.classYear,project:Mt.order.project,orderId:Mt.order.orderId,receivable:Mt.order.receivable,quantity:1},Object.keys(Te).forEach(function(k){W.push(encodeURIComponent(k)+"="+encodeURIComponent(Te[k]))}),Yt(qe+"?"+W.join("&"))},[]),(0,s.useEffect)(function(){console.log("editableKeys",Rt)},[Rt]);var N=function(){fr.current.reload()},y=function(k){N()};return(0,n.jsxs)(Ee.Z,{width:1200,title:"\u5B50\u8BA2\u5355\u5B66\u5458\u8D39\u7528\u5206\u914D",onCancel:function(){Qe()},onOk:function(){return Qe()},visible:vt,destroyOnClose:!0,children:[(0,n.jsx)(Y.ZP,{columns:[{title:"\u5B66\u5458",dataIndex:"studentName",readonly:!0},{title:"\u73ED\u578B\u5E94\u6536\u91D1\u989D",dataIndex:"receivable",readonly:!0},{title:"\u73ED\u578B\u4EBA\u6570",dataIndex:"quantity",readonly:!0},{title:"\u62A5\u8003\u5C97\u4F4D",search:!1,readonly:!0,render:function(k,xe){return(0,n.jsx)("span",{children:xe.project&&(0,F.Z)(new Set(xe.project.split(","))).map(function(ye,Ne){return(0,n.jsxs)("span",{children:[ae.Z.getCascaderName("dict_reg_job",ye)," ",(0,n.jsx)("br",{})]},"company-student-class-".concat(ye,"-").concat(Ne))})})}},{title:"\u73ED\u7EA7\u7C7B\u578B",dataIndex:"classType",search:!1,readonly:!0,render:function(k,xe){return(0,n.jsx)("span",{children:ae.Z.getName("dict_class_type",xe.classType)})}},{title:"\u73ED\u578B\u5E74\u9650",dataIndex:"classYear",search:!1,readonly:!0,render:function(k,xe){return(0,n.jsx)("span",{children:ae.Z.getName("dict_class_year",xe.classYear)})}},{title:"\u8003\u8BD5\u7C7B\u578B",dataIndex:"examType",readonly:!0,search:!1,render:function(k,xe){return(0,n.jsx)("span",{children:ae.Z.getName("dict_exam_type",xe.examType)})}},{title:"\u521B\u5EFA\u65F6\u95F4",key:"createTime",sorter:!0,dataIndex:"createTime",valueType:"dateRange",render:function(k,xe){return(0,n.jsx)("span",{children:xe.createTime})}}],search:!1,cardBordered:!0,rowKey:"id",actionRef:fr,editable:{type:"multiple",editableKeys:Rt,onSave:function(){var W=(0,p.Z)((0,r.Z)().mark(function xe(ye,Ne,je){var q;return(0,r.Z)().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(q=[{amount:Ne.amount,id:Ne.id}],console.log(Ne),!(Ne.amount>Ne.averageReceivable)){K.next=6;break}return c.default.error("\u5206\u914D\u91D1\u989D\u4E0D\u5F97\u5927\u4E8E\u5B9E\u9645\u5E94\u6536\u91D1\u989D"),N(),K.abrupt("return",!1);case 6:et.Z.postAll("/sms/business/bizOrder/saveArray",{array:q}),setTimeout(function(){N()},500);case 8:case"end":return K.stop()}},xe)}));function k(xe,ye,Ne){return W.apply(this,arguments)}return k}(),onChange:S},request:(0,p.Z)((0,r.Z)().mark(function W(){var k,xe,ye,Ne,je=arguments;return(0,r.Z)().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return k=je.length>0&&je[0]!==void 0?je[0]:{},xe=je.length>1?je[1]:void 0,ye=je.length>2?je[2]:void 0,k.parentId=Mt.id,G.next=6,et.Z.get("/sms/business/bizOrder",(0,a.Z)({},k));case 6:return Ne=G.sent,G.abrupt("return",{data:Ne.data.content,success:Ne.success,total:Ne.data.totalElements});case 8:case"end":return G.stop()}},W)}))}),Tt&&(0,n.jsx)(Dt.Z,{setModalVisible:function(){return Pe(!1)},modalVisible:Tt,url:qe,type:"student",propsData:{resourceType:0,parentId:Mt.studentId},callbackRef:function(){return N()},callbackFn:function(k){return y(k)}})]})},Xt=e(13062),B=e(71230),Z=e(89032),nr=e(15746),De=e(18106),xr=e(63885),zt=e(74912),Ut=e(22),Gt=e(54493),kt=function(Fe){var vt=Fe.type,Qe=Fe.isFormal,Be=Qe===void 0?!1:Qe,Mt=Fe.StudentMessage,fr=Fe.setOrderModalVisible,Ue=(0,s.useRef)(),vr=(0,s.useState)({}),Tt=(0,h.Z)(vr,2),Pe=Tt[0],ze=Tt[1],Ae=(0,$e.tT)("@@initialState"),Rt=Ae.initialState,S="/sms/business/bizStudentUser",Xe=(0,s.useRef)();(0,s.useEffect)(function(){we()},[vt]),(0,s.useEffect)(function(){var N;(N=Xe.current)===null||N===void 0||N.setFieldsValue($e.m8.location.query),ze($e.m8.location.query)},[]);var we=function(){var y,W;Ue==null||(y=Ue.current)===null||y===void 0||y.reload(),Ue==null||(W=Ue.current)===null||W===void 0||W.clearSelected()},qe=[{title:"\u540D\u79F0",dataIndex:"name",align:"center",key:"name"},{title:"\u54A8\u8BE2\u5C97\u4F4D",dataIndex:"project-in",sorter:!0,key:"project-in",valueType:"select",fieldProps:{options:ae.Z.getCascader("dict_reg_job"),showSearch:{filter:Gt.Z},mode:"tags"},render:function(y,W){return(0,n.jsx)("span",{children:ae.Z.getCascaderName("dict_reg_job",W.project)})}},{title:"\u624B\u673A\u53F7",dataIndex:"mobile",key:"mobile"},{title:"\u5FAE\u4FE1\u53F7",dataIndex:"weChat",key:"weChat",hideInTable:Be,width:100,render:function(y,W){return(0,n.jsx)("span",{style:{userSelect:"none"},children:W.weChat})}},{title:"QQ",dataIndex:"qq",key:"qq",hideInTable:Be,width:100,render:function(y,W){return(0,n.jsx)("span",{style:{userSelect:"none"},children:W.qq})}},{title:"\u8EAB\u4EFD\u8BC1",dataIndex:"idCard",key:"idCard",hideInTable:!0},{title:"\u5BA2\u6237\u6765\u6E90",dataIndex:"studentSource",valueType:"select",key:"studentSource",filters:!0,filterMultiple:!1,valueEnum:ae.Z.getSearch("dict_source"),render:function(y,W){return(0,n.jsx)("span",{children:ae.Z.getName("dict_source",W.studentSource)})}},{title:"\u6240\u5C5E\u8001\u5E08",dataIndex:"userName"},{title:"\u4FE1\u606F\u6240\u6709\u4EBA",dataIndex:"ownerName"},{title:"\u4FE1\u606F\u63D0\u4F9B\u4EBA",dataIndex:"providerName"}],Yt={isPay:!0,isFormal:!0,"userId-isNull":!1,type:0,_orderBy:"isPay,isFormal,createTime",_direction:"asc,asc,desc",_page:0,_size:10},Te={};return Object.assign(Yt,Pe),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(Ut.Z,{columns:qe,className:"student",actionRef:Ue,formRef:Xe,cardBordered:!0,scroll:{x:1500},search:{labelWidth:120,defaultCollapsed:!0},onReset:function(){ze({})},toolbar,toolBarRender:[(0,n.jsx)(x.Z,{type:"primary",icon:(0,n.jsx)(gt.Z,{}),onClick:function(){fr(!0)},children:"\u65B0\u5EFA\u5B66\u5458"},"add-formal-student")],request:{url:S,params:Yt,sortList:Te},rowSelection:{type:"radio",onSelect:Mt}})})},Kt=e(84956),Bt=e(5966),Ie=e(31199),Ot=e(30202),Je=e(30381),jt=e.n(Je),_t=e(81927),at=(0,s.forwardRef)(function(Fe,vt){var Qe=Fe.renderData,Be=Fe.payMessage,Mt=(0,s.useState)([0]),fr=(0,h.Z)(Mt,2),Ue=fr[0],vr=fr[1],Tt=(0,s.useRef)({}),Pe=(0,s.useState)(!1),ze=(0,h.Z)(Pe,2),Ae=ze[0],Rt=ze[1],S=(0,s.useState)(),Xe=(0,h.Z)(S,2),we=Xe[0],qe=Xe[1];(0,s.useImperativeHandle)(vt,function(){return{getFormValues:function(){var je=(0,p.Z)((0,r.Z)().mark(function G(){var K,Et,yt;return(0,r.Z)().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return Se.prev=0,Se.next=3,Promise.all(Ue.map(function(){var Vt=(0,p.Z)((0,r.Z)().mark(function Nt(tt){return(0,r.Z)().wrap(function(wt){for(;;)switch(wt.prev=wt.next){case 0:if(!Tt.current[tt]){wt.next=4;break}return wt.next=3,Tt.current[tt].validateFields();case 3:return wt.abrupt("return",wt.sent);case 4:return wt.abrupt("return",null);case 5:case"end":return wt.stop()}},Nt)}));return function(Nt){return Vt.apply(this,arguments)}}()));case 3:if(K=Se.sent,Et=K.filter(Boolean),yt=0,Et.forEach(function(Vt){Vt.amount&&(yt+=parseFloat(Vt.amount))}),!(Be!=null&&Be.amount&&Math.abs(yt-Be.amount)>.01)){Se.next=9;break}return Se.abrupt("return",{values:Et});case 9:return Se.abrupt("return",Et);case 12:throw Se.prev=12,Se.t0=Se.catch(0),console.error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25:",Se.t0),Se.t0;case 16:case"end":return Se.stop()}},G,null,[[0,12]])}));function q(){return je.apply(this,arguments)}return q}(),addPayWayItem:function(){var q=Math.max.apply(Math,(0,F.Z)(Ue))+1;vr([].concat((0,F.Z)(Ue),[q]))},removePayWayItem:function(q){Ue.length>1&&(vr(Ue.filter(function(G){return G!==q})),delete Tt.current[q],delete Yt.current[q],W(function(G){var K=(0,a.Z)({},G);return delete K[q],K}))},resetPayWay:function(){vr([0]),Tt.current={},Yt.current={},W({}),Ne("6"),setTimeout(function(){if(Tt.current[0]){var q={chargeTime:jt()().format("YYYY-MM-DD HH:mm:ss"),type:"6",chargeLogName:"",paymentTime:"",userId:(Be==null?void 0:Be.userId)+"",method:"",chargeLogIds:"",amount:"",departmentId:""};Qe!=null&&Qe.departmentId&&(q.departmentId=Qe.departmentId),Tt.current[0].setFieldsValue(q)}},0)}}});var Yt=(0,s.useRef)({}),Te=(0,s.useState)({}),N=(0,h.Z)(Te,2),y=N[0],W=N[1],k=(0,s.useState)("6"),xe=(0,h.Z)(k,2),ye=xe[0],Ne=xe[1];return(0,s.useEffect)(function(){if(we){Rt(!1);var je=Ue[0];Tt.current[je]&&(Tt.current[je].setFieldsValue({chargeLogIds:we[0].id,chargeLogName:we.map(function(q){return q.name}).join("\u3001")+"\u7684\u6536\u6B3E\u8BB0\u5F55",paymentTime:we[0].paymentTime,userId:we[0].userId+"",method:we[0].method+""}),we[0].userId&&(Yt.current[je]&&Yt.current[je].setDepartment({id:we[0].userId,name:ae.Z.getDepartmentUserName(we[0].userId)}),W(function(q){return(0,a.Z)((0,a.Z)({},q),{},(0,L.Z)({},je,{id:we[0].userId,name:ae.Z.getDepartmentUserName(we[0].userId)}))})))}},[we]),(0,s.useEffect)(function(){Ue.length>0&&Ue.forEach(function(je){if(Tt.current[je]){var q={chargeTime:jt()().format("YYYY-MM-DD HH:mm:ss")};Qe!=null&&Qe.departmentId&&(q.departmentId=Qe.departmentId),je===Ue[je]&&Be&&(Object.assign(q,{chargeLogName:"".concat(Be==null?void 0:Be.name,"\u7684\u6536\u6B3E\u8BB0\u5F55"),paymentTime:Be==null?void 0:Be.paymentTime,userId:(Be==null?void 0:Be.userId)+"",method:(Be==null?void 0:Be.method)+"",chargeLogIds:Be==null?void 0:Be.id,amount:Be==null?void 0:Be.amount}),Yt.current[je]&&Yt.current[je].setDepartment({id:Be==null?void 0:Be.userId,name:ae.Z.getDepartmentUserName(Be==null?void 0:Be.userId)}),W(function(G){return(0,a.Z)((0,a.Z)({},G),{},(0,L.Z)({},je,{id:Be==null?void 0:Be.userId,name:ae.Z.getDepartmentUserName(Be==null?void 0:Be.userId)}))})),Tt.current[je].setFieldsValue(q)}})},[Be,Qe,Ue]),(0,n.jsx)(n.Fragment,{children:Ue.map(function(je){return(0,n.jsx)(Ot.ZP,{bordered:!0,title:"\u652F\u4ED8\u65B9\u5F0F",style:{marginBlockEnd:8,position:"relative",marginBottom:je!==Ue[Ue.length-1]?16:0},children:(0,n.jsxs)(t.ZP,{formRef:function(G){G&&(Tt.current[je]=G)},submitter:!1,children:[(0,n.jsxs)(t.ZP.Group,{children:[(0,n.jsx)(Ye.Z,{label:"\u7F34\u8D39\u7C7B\u578B",name:"type",width:"md",initialValue:ye,request:(0,p.Z)((0,r.Z)().mark(function q(){var G;return(0,r.Z)().wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return Et.abrupt("return",(G=ae.Z.getList("chargeType"))===null||G===void 0?void 0:G.filter(function(yt){return["0","4","5","6"].indexOf(yt.value)!=-1}));case 1:case"end":return Et.stop()}},q)})),fieldProps:{onChange:function(G){Ne(G)}},required:!0}),(0,n.jsx)(Bt.Z,{label:"chargeLogIds",name:"chargeLogIds",width:"md",hidden:!0}),ye==="6"?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(Bt.Z,{label:"\u6536\u6B3E\u8BB0\u5F55",name:"chargeLogName",width:"md",rules:[{required:!0}],fieldProps:{onClick:function(){return qe(null),Rt(!0),!1}}})}):null,(0,n.jsx)(Ye.Z,{label:"\u4ED8\u6B3E\u65B9\u5F0F",name:"method",width:"md",request:(0,p.Z)((0,r.Z)().mark(function q(){return(0,r.Z)().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",ae.Z.getList("dict_stu_refund_type"));case 1:case"end":return K.stop()}},q)})),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4ED8\u6B3E\u65B9\u5F0F"}]}),(0,n.jsx)(Ye.Z,{label:"\u4ED8\u6B3E\u65B9\u5F0F",name:"departmentId",width:"md",hidden:!0}),(0,n.jsx)(b.Z,{ref:function(G){G&&(Yt.current[je]=G)},width:300,userLabel:"\u6536\u8D39\u4EBA",userNames:"userId",userPlaceholder:"\u8BF7\u9009\u62E9\u6536\u8D39\u4EBA",setUserNameId:function(G){W(function(K){return(0,a.Z)((0,a.Z)({},K),{},(0,L.Z)({},je,G))})},flag:!0}),(0,n.jsx)(u.Z,{name:"chargeTime",width:"md",label:"\u6536\u8D39\u65E5\u671F",fieldProps:{value:jt()(),onChange:function(G){var K;(K=Tt.current[je])===null||K===void 0||K.setFieldValue("paymentTime",void 0)},format:"YYYY-MM-DD HH:mm:ss"},rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7F34\u8D39\u65E5\u671F"}]}),(0,n.jsx)(u.Z,{name:"paymentTime",label:"\u5B9E\u9645\u5230\u8D26\u65E5\u671F",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",onChange:function(G){if(G){var K;(K=Tt.current[je])===null||K===void 0||K.setFieldValue("paymentTime",jt()(G).format("YYYY-MM-DD HH:mm:ss"))}}},width:"md",disabled:ye=="4"||ye=="6",rules:[{required:["4","6"].indexOf(ye)==-1,message:"\u8BF7\u586B\u5199\u7F34\u8D39\u65E5\u671F"}]}),(0,n.jsx)(u.Z,{name:"nextPaymentTime",width:"md",label:"\u4E0B\u6B21\u7F34\u8D39\u65F6\u95F4",fieldProps:{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",onChange:function(G){if(G){var K;(K=Tt.current[je])===null||K===void 0||K.setFieldValue("nextPaymentTime",jt()(G).format("YYYY-MM-DD HH:mm:ss"))}}}}),(0,n.jsx)(Ie.Z,{label:"\u672C\u6B21\u6536\u8D39\u91D1\u989D",name:"amount",width:"sm",fieldProps:{precision:2,min:0,formatter:function(G){return G?"\xA5 ".concat(G).replace(/\B(?=(\d{3})+(?!\d))/g,","):""},parser:function(G){return G?G.replace(/\\s?|(,*)/g,""):""}},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6536\u8D39\u91D1\u989D"},{type:"number",min:0,message:"\u91D1\u989D\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E0"},{validator:function(){var q=(0,p.Z)((0,r.Z)().mark(function K(Et,yt){return(0,r.Z)().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:if(!(yt&&yt>999999999)){Se.next=2;break}throw new Error("\u91D1\u989D\u4E0D\u80FD\u8D85\u8FC79\u4F4D\u6570");case 2:return Se.abrupt("return",Promise.resolve());case 3:case"end":return Se.stop()}},K)}));function G(K,Et){return q.apply(this,arguments)}return G}()}]}),(0,n.jsx)(Ie.Z,{tooltip:"\u8FD4\u4EE3\u7406\u8D39\u3001\u5FEB\u9012\u8D39\u3001\u7A0E\u8D39\uFF0C\u4E0D\u5305\u542B\u5728\u6536\u8D39\u6807\u51C6\u91CC\u7684\u62A5\u540D\u8D39\u7B49",label:"\u4EE3\u6536\u6B3E\u9879",name:"collectedAmount",width:"sm",fieldProps:{precision:2,min:0,formatter:function(G){return G?"\xA5 ".concat(G).replace(/\B(?=(\d{3})+(?!\d))/g,","):""},parser:function(G){return G?G.replace(/\\s?|(,*)/g,""):""}},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4EE3\u6536\u6B3E\u9879\u91D1\u989D"},{type:"number",min:0,message:"\u91D1\u989D\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E0"},{validator:function(){var q=(0,p.Z)((0,r.Z)().mark(function K(Et,yt){return(0,r.Z)().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:if(!(yt&&yt>999999999)){Se.next=2;break}throw new Error("\u91D1\u989D\u4E0D\u80FD\u8D85\u8FC79\u4F4D\u6570");case 2:return Se.abrupt("return",Promise.resolve());case 3:case"end":return Se.stop()}},K)}));function G(K,Et){return q.apply(this,arguments)}return G}()}]})]}),(0,n.jsx)(Ee.Z,{title:"\u9009\u62E9\u6536\u6B3E\u8BB0\u5F55",width:1200,open:Ae,onCancel:function(){return Rt(!1)},footer:null,children:(0,n.jsx)(_t.default,{select:qe,type:1})})]})},"admin-order-paylist-".concat(je))})})}),Ht=at,qt=e(8214),yr=e(12741),Zr=xr.Z.TabPane,_e=function(Fe){var vt=(0,$e.tT)("@@initialState"),Qe=vt.initialState,Be=Fe.modalVisible,Mt=Fe.setModalVisible,fr=Fe.callbackRef,Ue=(0,s.useState)("1"),vr=(0,h.Z)(Ue,2),Tt=vr[0],Pe=vr[1],ze=(0,s.useState)(null),Ae=(0,h.Z)(ze,2),Rt=Ae[0],S=Ae[1],Xe=(0,s.useState)(null),we=(0,h.Z)(Xe,2),qe=we[0],Yt=we[1],Te=(0,s.useState)(),N=(0,h.Z)(Te,2),y=N[0],W=N[1],k=(0,s.useState)(!1),xe=(0,h.Z)(k,2),ye=xe[0],Ne=xe[1],je=(0,s.useState)(!1),q=(0,h.Z)(je,2),G=q[0],K=q[1],Et=(0,s.useState)(!1),yt=(0,h.Z)(Et,2),er=yt[0],Se=yt[1],Vt=(0,s.useState)({}),Nt=(0,h.Z)(Vt,2),tt=Nt[0],ir=Nt[1],wt=(0,s.useRef)(),Or=(0,s.useRef)(null),We=(0,s.useRef)(null);(0,s.useEffect)(function(){var be;wt==null||(be=wt.current)===null||be===void 0||be.setFieldsValue({classId:tt.id,className:tt.name})},[tt]);var Le=(0,s.useRef)(null),ve=(0,s.useRef)(null),st=(0,s.useRef)(null),ct=(0,s.useState)(),br=(0,h.Z)(ct,2),_r=br[0],Fr=br[1],Ir=(0,s.useState)(),Ar=(0,h.Z)(Ir,2),Ge=Ar[0],Pr=Ar[1],wr=(0,s.useState)(),Re=(0,h.Z)(wr,2),lt=Re[0],Ze=Re[1],cr=(0,s.useState)(0),Q=(0,h.Z)(cr,2),ee=Q[0],T=Q[1],me=function(z){S(z),W(z)},U=function(z){Yt(z),W(z)},Me=function(){var z=Tt==="1"?Rt:qe;if(!z){c.default.error("\u8BF7\u5148\u9009\u62E9\u4E00\u540D\u5B66\u5458");return}setTimeout(function(){var He,Sr,Jt,mr;(He=wt.current)===null||He===void 0||He.setFieldsValue({name:z.name,mobile:z.mobile,idCard:z.idCard,owner:z.owner,provider:z.provider,userId:z.userId,source:z.studentSource.toString(),project:ae.Z.getCascaderValue("dict_reg_job",z.project)});var Er={},H={id:z.userId,name:z.userName},w={};if(z.provider)Er={id:z.provider,name:z.providerName};else{var C,Oe;Er={name:Qe==null||(C=Qe.currentUser)===null||C===void 0?void 0:C.name,id:Qe==null||(Oe=Qe.currentUser)===null||Oe===void 0?void 0:Oe.userid}}if(z.owner)w={id:z.owner,name:z.ownerName?z.ownerName:"\u65E0"};else{var Ce,nt;w={name:Qe==null||(Ce=Qe.currentUser)===null||Ce===void 0?void 0:Ce.name,id:Qe==null||(nt=Qe.currentUser)===null||nt===void 0?void 0:nt.userid}}Le==null||(Sr=Le.current)===null||Sr===void 0||Sr.setDepartment(H),ve==null||(Jt=ve.current)===null||Jt===void 0||Jt.setDepartment(Er),st==null||(mr=st.current)===null||mr===void 0||mr.setDepartment(w),Fr(H),Pr(Er),Ze(w)},100),Ne(!0)},It=function(){var be=(0,p.Z)((0,r.Z)().mark(function z(){var He,Sr,Jt,mr,Er,H,w,C,Oe,Ce,nt,pr;return(0,r.Z)().wrap(function(mt){for(;;)switch(mt.prev=mt.next){case 0:return K(!0),Sr={},mt.prev=2,mt.next=5,(Jt=wt.current)===null||Jt===void 0?void 0:Jt.validateFields();case 5:He=mt.sent,He.project=String(He.project[0]),He.type=0,Sr=He,mt.next=15;break;case 11:return mt.prev=11,mt.t0=mt.catch(2),K(!1),mt.abrupt("return");case 15:return mt.prev=15,mt.next=18,(Er=Or.current)===null||Er===void 0?void 0:Er.getFormValues();case 18:if(mr=mt.sent,!(!mr||!mr.users||mr.users.length===0)){mt.next=23;break}return c.default.error("\u8BF7\u81F3\u5C11\u6DFB\u52A0\u4E00\u4E2A\u73ED\u7EA7\u4FE1\u606F"),K(!1),mt.abrupt("return");case 23:H=0;case 24:if(!(H<mr.users.length)){mt.next=41;break}if(w=mr.users[H],!(!w.project||w.project.length===0)){mt.next=30;break}return c.default.error("\u7B2C".concat(H+1,"\u4E2A\u73ED\u7EA7\u7684\u62A5\u8003\u5C97\u4F4D\u4E0D\u80FD\u4E3A\u7A7A")),K(!1),mt.abrupt("return");case 30:if(w.JobClassExam){mt.next=34;break}return c.default.error("\u7B2C".concat(H+1,"\u4E2A\u73ED\u7EA7\u7684\u73ED\u578B\u9009\u62E9\u4E0D\u80FD\u4E3A\u7A7A")),K(!1),mt.abrupt("return");case 34:if(w.source){mt.next=38;break}return c.default.error("\u7B2C".concat(H+1,"\u4E2A\u73ED\u7EA7\u7684\u8BA2\u5355\u6765\u6E90\u4E0D\u80FD\u4E3A\u7A7A")),K(!1),mt.abrupt("return");case 38:H++,mt.next=24;break;case 41:mt.next=47;break;case 43:return mt.prev=43,mt.t1=mt.catch(15),K(!1),mt.abrupt("return");case 47:return C=ae.Z.filterByValue(mr),mt.prev=48,mt.next=51,(nt=We.current)===null||nt===void 0?void 0:nt.getFormValues();case 51:Oe=mt.sent,Ce=Oe.map(function(hr){var Lr=hr.userId&&typeof hr.userId=="object"?ae.Z.getUserId(hr.userId.label):hr.userId;return(0,a.Z)((0,a.Z)({},hr),{},{userId:Lr[0]})}),mt.next=59;break;case 55:return mt.prev=55,mt.t2=mt.catch(48),K(!1),mt.abrupt("return");case 59:pr=C.map(function(hr,Lr){return{student:Sr,order:hr,charge:Ce[Lr]}}),et.Z.postAll("/sms/business/bizOrder/intelligence",pr).then(function(hr){if(hr.status=="success"){var Lr,Br,Vr,Wr;c.default.success("\u64CD\u4F5C\u6210\u529F"),K(!1),(Lr=wt.current)===null||Lr===void 0||Lr.resetFields(),Le==null||(Br=Le.current)===null||Br===void 0||Br.setDepartment({}),ve==null||(Vr=ve.current)===null||Vr===void 0||Vr.setDepartment({}),st==null||(Wr=st.current)===null||Wr===void 0||Wr.setDepartment({}),Or.current&&Or.current.resetForm(),We.current&&We.current.resetPayWay()}else c.default.error(hr.msg)}).catch(function(hr){hr.status=="error"&&K(!1)}),fr&&fr(),Ne(!1);case 63:case"end":return mt.stop()}},z,null,[[2,11],[15,43],[48,55]])}));return function(){return be.apply(this,arguments)}}();return(0,n.jsxs)("div",{children:[(0,n.jsx)(Ee.Z,{title:"\u9009\u62E9\u5B66\u5458",visible:Be,onCancel:function(){return Mt(!1)},width:1400,destroyOnClose:!0,onOk:Me,children:(0,n.jsxs)(xr.Z,{defaultActiveKey:Tt,style:{marginBottom:32},onChange:function(z){Pe(z)},children:[(0,n.jsx)(Zr,{tab:"\u6F5C\u5728\u5B66\u5458",children:(0,n.jsx)(zt.Z,{StudentMessage:me,setOrderModalVisible:Ne})},"1"),(0,n.jsx)(Zr,{tab:"\u6B63\u5F0F\u5B66\u5458",children:(0,n.jsx)(kt,{StudentMessage:U,setOrderModalVisible:Ne})},"2")]})}),(0,n.jsxs)(Ee.Z,{title:"\u4E0B\u5355",open:ye,confirmLoading:G,onCancel:function(){return Ne(!1)},width:1200,destroyOnClose:!0,onOk:function(){It()},children:[(0,n.jsx)(t.ZP,{formRef:wt,submitter:!1,children:(0,n.jsxs)(t.ZP.Group,{children:[(0,n.jsx)(Bt.Z,{name:"name",width:300,label:"\u5B66\u5458\u59D3\u540D",placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D"}),(0,n.jsx)(Bt.Z,{name:"className",width:300,label:"\u73ED\u7EA7",placeholder:"\u8BF7\u9009\u62E9\u73ED\u7EA7",fieldProps:{onClick:function(){Se(!0)}}}),(0,n.jsx)(Bt.Z,{hidden:!0,name:"classId"}),(0,n.jsx)(Bt.Z,{name:"quantity",label:"\u5F53\u524D\u8BA2\u5355\u62A5\u540D\u4EBA\u6570",required:!0,readonly:!0,width:"sm"}),(0,n.jsx)(Bt.Z,{name:"totalReceivable",label:"\u5F53\u524D\u8BA2\u5355\u5E94\u6536\u603B\u989D",required:!0,readonly:!0,width:"sm"}),(0,n.jsx)(Bt.Z,{name:"mobile",width:"sm",label:"\u624B\u673A\u53F7\u7801",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"}),(0,n.jsx)(Bt.Z,{name:"idCard",width:"sm",label:"\u8EAB\u4EFD\u8BC1\u53F7",placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u53F7\u7801",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u8EAB\u4EFD\u8BC1\u53F7"}]}),(0,n.jsx)(Ye.Z,{label:"\u5BA2\u6237\u6765\u6E90",name:"source",width:"sm",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5BA2\u6237\u6765\u6E90"}],request:(0,p.Z)((0,r.Z)().mark(function be(){return(0,r.Z)().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return He.abrupt("return",ae.Z.getList("dict_source"));case 1:case"end":return He.stop()}},be)}))}),(0,n.jsx)(qt.Z,{width:"sm",name:"project",placeholder:"\u54A8\u8BE2\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:ae.Z.getCascader("dict_reg_job"),onSearch:function(z){return console.log(z)}}}),(0,n.jsx)(b.Z,{ref:Le,width:300,userLabel:"\u62DB\u751F\u8001\u5E08",userNames:"userId",userPlaceholder:"\u8BF7\u8F93\u5165\u62DB\u751F\u8001\u5E08",setUserNameId:function(z){return Fr(z.value)},flag:!0}),(0,n.jsx)(b.Z,{ref:ve,width:300,userLabel:"\u4FE1\u606F\u63D0\u4F9B\u4EBA",userNames:"provider",userPlaceholder:"\u8BF7\u8F93\u5165\u4FE1\u606F\u63D0\u4F9B\u4EBA",setUserNameId:function(z){return Pr(z.value)},flag:!0}),(0,n.jsx)(b.Z,{ref:st,width:300,userLabel:"\u4FE1\u606F\u6240\u6709\u4EBA",filter:function(z){return z.unshift({title:"\u65E0",userId:-1,value:"-1"}),z},userNames:"owner",newMedia:!1,userPlaceholder:"\u8BF7\u8F93\u5165\u4FE1\u606F\u6240\u6709\u4EBA",setUserNameId:function(z){return Ze(z.value)},flag:!0})]})}),(0,n.jsxs)(B.Z,{style:{width:"1100px",backgroundColor:"#d9edf7",border:"1px solid #bce8f1",padding:"20px",marginBottom:"20px"},children:[(0,n.jsx)(nr.Z,{span:2,style:{color:"red"},children:"\u6CE8\u610F\uFF1A"}),(0,n.jsx)(nr.Z,{span:22,children:"\uFF081\uFF09\u5982\u679C\u4F60\u7684\u6536\u8D39\u91D1\u989D\u5927\u4E8E\u4E86\u6536\u8D39\u6807\u51C6\uFF0C\u8BF7\u5728\u8BA2\u5355\u4F18\u60E0\u91D1\u989D\u91CC\u586B\u5199\u591A\u6536\u91D1\u989D\u7684\u8D1F\u6570\u3002"})]}),(0,n.jsx)(Kt.Z,{ref:Or,renderData:y,onTotalPriceChange:function(z){var He;T(z),(He=wt.current)===null||He===void 0||He.setFieldsValue({totalReceivable:z})},onTotalQuantityChange:function(z){var He;(He=wt.current)===null||He===void 0||He.setFieldsValue({quantity:z})},onAddClassType:function(){var z,He;(z=We.current)===null||z===void 0||(He=z.addPayWayItem)===null||He===void 0||He.call(z)},onRemoveClassType:function(z){if(We.current){var He=We.current;He.removePayWayItem&&He.removePayWayItem(z)}}}),(0,n.jsx)(Ht,{renderData:y,ref:We})]}),(0,n.jsx)(Ee.Z,{open:er,width:1200,onOk:function(){return Se(!1)},onCancel:function(){return Se(!1)},footer:null,children:(0,n.jsx)(yr.default,{setClassRef:ir,setClassFalg:function(){return Se(!1)}})})]})},or=Ee.Z.confirm,Zt=function(Fe){var vt=Fe.admins,Qe=Fe.admin,Be=Fe.refund,Mt=Fe.suppOrder,fr=Fe.studentUserId,Ue=fr===void 0?"":fr,vr=Fe.type,Tt=vr===void 0?0:vr,Pe=Fe.orderId,ze=Pe===void 0?"":Pe,Ae=Fe.orderIds,Rt=Ae===void 0?void 0:Ae,S=Fe.searchFalg,Xe=S===void 0?!1:S,we=Fe.searchParams,qe=Fe.showType,Yt=Fe.showStudentBtn,Te=Fe.orderType,N=(0,s.useState)(!1),y=(0,h.Z)(N,2),W=y[0],k=y[1],xe=(0,s.useState)(!1),ye=(0,h.Z)(xe,2),Ne=ye[0],je=ye[1],q=(0,s.useState)(!1),G=(0,h.Z)(q,2),K=G[0],Et=G[1],yt=(0,s.useState)(!1),er=(0,h.Z)(yt,2),Se=er[0],Vt=er[1],Nt=(0,s.useState)(!1),tt=(0,h.Z)(Nt,2),ir=tt[0],wt=tt[1],Or=(0,s.useState)(!1),We=(0,h.Z)(Or,2),Le=We[0],ve=We[1],st=(0,s.useState)(!1),ct=(0,h.Z)(st,2),br=ct[0],_r=ct[1],Fr=(0,s.useState)(!1),Ir=(0,h.Z)(Fr,2),Ar=Ir[0],Ge=Ir[1],Pr=(0,s.useState)(!1),wr=(0,h.Z)(Pr,2),Re=wr[0],lt=wr[1],Ze=(0,s.useState)(!1),cr=(0,h.Z)(Ze,2),Q=cr[0],ee=cr[1],T=(0,s.useState)(!1),me=(0,h.Z)(T,2),U=me[0],Me=me[1],It=(0,s.useState)(!1),be=(0,h.Z)(It,2),z=be[0],He=be[1],Sr=(0,s.useState)(!1),Jt=(0,h.Z)(Sr,2),mr=Jt[0],Er=Jt[1],H=(0,s.useState)(null),w=(0,h.Z)(H,2),C=w[0],Oe=w[1],Ce=(0,s.useState)(),nt=(0,h.Z)(Ce,2),pr=nt[0],Qt=nt[1],mt=(0,s.useState)({}),hr=(0,h.Z)(mt,2),Lr=hr[0],Br=hr[1],Vr=(0,s.useState)(null),Wr=(0,h.Z)(Vr,2),rr=Wr[0],Nr=Wr[1],tu=(0,s.useState)([]),Tr=(0,h.Z)(tu,2),lr=Tr[0],Xr=Tr[1],ru=(0,s.useState)(!1),uu=(0,h.Z)(ru,2),su=uu[0],eu=uu[1],au=(0,s.useState)(""),Ke=(0,h.Z)(au,2),_=Ke[0],R=Ke[1],v=(0,s.useState)([]),ft=(0,h.Z)(v,2),Lt=ft[0],ur=ft[1],dt="/sms/business/bizStudentUser",dr="/sms/business/bizCharge",Pt="/sms/business/bizOrder",$r=(0,s.forwardRef)(ot.Z),du=(0,s.forwardRef)(Ft.Z),nu=(0,s.forwardRef)(gr.Z),iu=(0,s.forwardRef)(ht),lu=(0,s.useRef)(),St=(0,s.useRef)(),se=(0,s.useRef)(),ke=(0,s.useRef)();(0,s.useEffect)(function(){fe()},[Tt]),(0,s.useEffect)(function(){Kr(),Br((0,a.Z)((0,a.Z)({},$e.m8.location.query),we))},[]);var fe=function(){var xt;se.current.reload(),ke==null||(xt=ke.current)===null||xt===void 0||xt.reload(),ve(!1)};(0,s.useEffect)(function(){var Ve=[],xt=[],E=[],Cr={};if(rr){ve(!0);var Rr=[];Array.isArray(rr)?Rr=rr:Rr=[rr],Cr.parentId=C.id,Cr.project=C.order.project,console.log("Student",Rr,C),Rr.forEach(function(ar){xt.push({studentUserId:ar.id,classType:C.order.classType,examType:C.order.examType,classYear:C.order.classYear,receivable:C.order.receivable,project:C.order.project,parentId:C.id,quantity:1,discount:C.discount,source:C.source,provider:C.provider,discountRemark:C.discountRemark})}),et.Z.postAll("/sms/business/bizOrder/saveArray",{array:xt}).then(function(ar){ar.status=="success"&&c.default.success("\u64CD\u4F5C\u6210\u529F"),fe()}),ve(!1)}},[rr]);var pt=function(){var Ve=(0,p.Z)((0,r.Z)().mark(function xt(E,Cr){var Rr;return(0,r.Z)().wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return Dr.next=2,et.Z.get("/sms/business/bizCharge",{orderId:E,enable:Cr});case 2:return Rr=Dr.sent.data.content,Dr.abrupt("return",Rr);case 4:case"end":return Dr.stop()}},xt)}));return function(E,Cr){return Ve.apply(this,arguments)}}(),Wt=function(xt,E){or({title:xt.title,icon:(0,n.jsx)(le.Z,{}),content:xt.content,onOk:function(){E()},onCancel:function(){console.log("Cancel")}})},ue=[{width:120,title:"\u8BA2\u5355\u7F16\u53F7",dataIndex:"num",sorter:!0,fixed:"left"},{width:100,title:"\u5B66\u5458/\u4F01\u4E1A",dataIndex:"studentName",sorter:!0,fixed:"left",render:function(xt,E){return(0,n.jsx)(n.Fragment,{children:Ue?(0,n.jsxs)("span",{children:[" ",E.studentName]}):(0,n.jsxs)("a",{onClick:function(){et.Z.get(dt,{id:E.studentUserId}).then(function(Rr){Oe((0,a.Z)((0,a.Z)({},Rr.data.content[0]),{},{admin:Qe})),Er(!0)})},children:[E.studentName,E.isPeer&&(0,n.jsx)(P.Z,{color:"#87CEEB",children:"\u540C\u884C\u4F01\u4E1A"}),!E.enable&&(0,n.jsx)(P.Z,{color:"red",children:"\u5DF2\u5E9F\u9664"})]})})}},{title:"\u662F\u5426\u662F\u540C\u884C\u4F01\u4E1A",dataIndex:"isPeer",valueType:"select",key:"isPeer",valueEnum:{false:"\u5426",true:"\u662F"},hideInTable:!0,sorter:!0},{width:100,title:"\u8BA2\u5355\u91D1\u989D",dataIndex:"totalReceivable",sorter:!0,search:!1},{width:100,title:"\u8BA2\u5355\u5B9E\u9645\u5E94\u6536\u91D1\u989D",dataIndex:"actualReceivable",sorter:!0,search:!1},{width:100,title:"\u7D2F\u8BA1\u5B9E\u6536",sorter:!0,dataIndex:"charge",search:!1},{width:100,title:"\u7D2F\u8BA1\u4F18\u60E0",sorter:!0,dataIndex:"discount",search:!1},{width:80,title:"\u6B20\u8D39",dataIndex:"arrears",sorter:!0,search:!1,render:function(xt,E){return(0,n.jsx)("span",{style:{color:"red"},children:E.arrears})}},{width:120,title:"\u8BA2\u5355\u6765\u6E90",dataIndex:"source",valueType:"select",key:"source",filters:!0,sorter:!0,filterMultiple:!1,valueEnum:ae.Z.getSearch("dict_source"),render:function(xt,E){return(0,n.jsx)("span",{children:ae.Z.getName("dict_source",E.source)})}},{width:100,title:"\u9879\u76EE\u603B\u79F0",dataIndex:"parentProjects",key:"parentProjects",sorter:!0,valueType:"cascader",fieldProps:{options:ae.Z.getList("dict_reg_job"),showSearch:{filter:Gt.Z}},render:function(xt,E){return(0,n.jsx)("span",{children:ae.Z.getCascaderAllName("dict_reg_job",E.project)},"parentProjects")}},{width:100,title:"\u62A5\u8003\u5C97\u4F4D",dataIndex:"project",sorter:!0,key:"project",valueType:"cascader",fieldProps:{options:ae.Z.getCascader("dict_reg_job"),showSearch:{filter:Gt.Z}},render:function(xt,E){return(0,n.jsx)("span",{children:E.project&&(0,F.Z)(new Set(E.project.split(","))).map(function(Cr,Rr){return(0,n.jsxs)("span",{children:[ae.Z.getCascaderName("dict_reg_job",Cr)," ",(0,n.jsx)("br",{})]},"project-".concat(Cr,"-").concat(Rr))})})}},{width:100,title:"\u62A5\u8003\u4EBA\u6570",dataIndex:"quantity",sorter:!0,search:!1},{width:80,title:"\u5907\u6CE8",dataIndex:"description",search:!1,sorter:!0,ellipsis:!0,tip:"\u5907\u6CE8\u8FC7\u957F\u4F1A\u81EA\u52A8\u6536\u7F29"},{width:100,title:"\u4E0B\u5355\u65F6\u95F4",key:"createTime",sorter:!0,dataIndex:"createTime",valueType:"dateRange",render:function(xt,E){return(0,n.jsx)("span",{children:E.createTime})}},{width:120,title:"\u7F34\u8D39\u72B6\u6001",dataIndex:"status",filters:!0,sorter:!0,filterMultiple:!1,valueType:"select",valueEnum:{"0":{text:(0,n.jsx)(P.Z,{color:"#FF0000",children:ae.Z.getName("orderStatus","0")}),status:"Processing"},"1":{text:(0,n.jsx)(P.Z,{color:"#f50",children:ae.Z.getName("orderStatus","1")}),status:"Error"},"2":{text:(0,n.jsx)(P.Z,{color:"#87d068",children:ae.Z.getName("orderStatus","2")}),status:"Success"}},render:function(xt,E){return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(P.Z,{color:E.status==0?"#FF0000":E.status==1?"#f50":"#87d068",children:ae.Z.getName("orderStatus",E.status)})})}},{width:100,title:"\u62A5\u8003\u5C97\u4F4D",search:!1,sorter:!0,render:function(xt,E){return(0,n.jsx)("span",{children:E.project&&(0,F.Z)(new Set(E.project.split(","))).map(function(Cr,Rr){return(0,n.jsxs)("span",{children:[ae.Z.getCascaderName("dict_reg_job",Cr)," ",(0,n.jsx)("br",{})]},"project-".concat(Cr,"-").concat(Rr))})})}},{width:100,title:"\u73ED\u7EA7\u7C7B\u578B",dataIndex:"classType",search:!1,sorter:!0,render:function(xt,E){var Cr=ae.Z.getName("dict_class_type",E.classType);return Cr?(0,n.jsx)("span",{children:Cr}):(0,n.jsx)(x.Z,{type:"primary",size:"small",icon:(0,n.jsx)($.Z,{}),className:"tablebut",onClick:(0,p.Z)((0,r.Z)().mark(function Rr(){return(0,r.Z)().wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:Oe((0,a.Z)((0,a.Z)({},E),{},{type:"order",orderNumber:0,projectClassExamList:[]})),wt(!0);case 2:case"end":return Dr.stop()}},Rr)})),children:"\u5B8C\u5584\u73ED\u578B\u4FE1\u606F"},"editable-admin-order-1")}},{width:100,title:"\u73ED\u578B\u5E74\u9650",dataIndex:"classYear",search:!1,sorter:!0,render:function(xt,E){return(0,n.jsx)("span",{children:ae.Z.getName("dict_class_year",E.classYear)})}},{title:"\u8003\u8BD5\u7C7B\u578B",dataIndex:"examType",search:!1,sorter:!0,render:function(xt,E){return(0,n.jsx)("span",{children:ae.Z.getName("dict_exam_type",E.examType)})}},{title:"\u73ED\u578B\u4EBA\u6570",dataIndex:"quantity",sorter:!0,hideInTable:Tt==0},{title:"\u62A5\u8003\u5C97\u4F4D\u6570\u91CF",dataIndex:"studentQuantity",hideInTable:Tt==0,sorter:!0},{title:"\u6536\u8D39\u4EBA",dataIndex:"userName",sorter:!0},{title:"\u4FE1\u606F\u6240\u6709\u4EBA",dataIndex:"ownerName",sorter:!0,render:function(xt,E){return(0,n.jsxs)("div",{children:[E.ownerName,(0,n.jsx)("span",{children:E.ownerName&&"("+E.percent*100+"%)"})]})}},{title:"\u4FE1\u606F\u63D0\u4F9B\u4EBA",dataIndex:"providerName",sorter:!0},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:170,fixed:"right",render:function(xt,E,Cr,Rr){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ne.Z,{placement:"topLeft",title:"\u8BA2\u5355\u7F34\u8D39",children:(0,n.jsx)(x.Z,{size:"small",type:"primary",hidden:!Mt,icon:(0,n.jsx)(bt.Z,{}),className:"tablebut",onClick:(0,p.Z)((0,r.Z)().mark(function ar(){var Dr,oe;return(0,r.Z)().wrap(function(kr){for(;;)switch(kr.prev=kr.next){case 0:return console.log(E,"record------>"),kr.next=3,pt(E.id,!0);case 3:Dr=kr.sent,Dr.length>0&&Dr.every(function(qr){return qr.confirm!==!0})?Wt({title:"\u8BE5\u8BA2\u5355\u5C1A\u6709\u7F34\u8D39\u672A\u5BA1\u6838\uFF01",content:"\u70B9\u51FB\u786E\u5B9A\u7EE7\u7EED\u7F34\u8D39"},function(){var qr=E;qr.orderId=E.id,Oe({list:[qr],type:"charge",orderNumber:0}),lt(!0)}):(oe=E,oe.orderId=E.id,Oe({list:[oe],type:"charge",orderNumber:0}),lt(!0));case 5:case"end":return kr.stop()}},ar)})),children:"\u8865\u7F34\u4E0B\u5355"},"jiaofei")}),(0,n.jsx)(ne.Z,{placement:"topLeft",title:"\u8BA2\u5355\u7F34\u8D39",children:(0,n.jsx)(x.Z,{hidden:E.parentId!="-1"||Te=="sp"||Be||Mt,size:"small",type:"primary",icon:(0,n.jsx)(bt.Z,{}),className:"tablebut",onClick:(0,p.Z)((0,r.Z)().mark(function ar(){var Dr,oe;return(0,r.Z)().wrap(function(kr){for(;;)switch(kr.prev=kr.next){case 0:return kr.next=2,pt(E.id,!0);case 2:Dr=kr.sent,Dr.length>0&&Dr.every(function(qr){return qr.confirm!==!0})?Wt({title:"\u8BE5\u8BA2\u5355\u5C1A\u6709\u7F34\u8D39\u672A\u5BA1\u6838\uFF01",content:"\u70B9\u51FB\u786E\u5B9A\u7EE7\u7EED\u7F34\u8D39"},function(){var qr=E;qr.orderId=E.id,Oe({list:[qr],type:"charge",orderNumber:0}),Ge(!0)}):(oe=E,oe.orderId=E.id,Oe({list:[oe],type:"charge",orderNumber:0}),Ge(!0));case 4:case"end":return kr.stop()}},ar)})),children:"\u7F34\u8D39"},"jiaofei")}),(0,n.jsx)(ne.Z,{placement:"topLeft",title:"\u7F16\u8F91\u8BA2\u5355",children:(0,n.jsx)(x.Z,{type:"primary",size:"small",hidden:qe=="refund"||Te=="sp"||Be||Mt,icon:(0,n.jsx)($.Z,{}),className:"tablebut",onClick:(0,p.Z)((0,r.Z)().mark(function ar(){return(0,r.Z)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:Oe((0,a.Z)((0,a.Z)({},E),{},{type:"order",orderNumber:0,projectClassExamList:[]})),Vt(!0);case 2:case"end":return oe.stop()}},ar)})),children:"\u7F16\u8F91"},"editable-admin-order-2")}),(0,n.jsx)(x.Z,{size:"small",type:"primary",onClick:function(){if(E.charge<=0){c.default.error("\u5F53\u524D\u8BA2\u5355\u7D2F\u8BA1\u5B9E\u6536\u4E3A0\uFF0C\u4E0D\u80FD\u8FDB\u884C\u9000\u8D39",5);return}Oe((0,a.Z)((0,a.Z)({},E),{},{type:"orders",orderNumber:0})),_r(!0)},hidden:E.parentId!="-1"||Te=="sp"||Mt,icon:(0,n.jsx)(bt.Z,{}),className:"tablebut",danger:!0,children:"\u9000\u8D39"},"deletejiaofei"),(0,n.jsx)(d.Z,{title:"\u662F\u5426\u786E\u5B9A\u5220\u9664\uFF1F",onConfirm:(0,p.Z)((0,r.Z)().mark(function ar(){var Dr;return(0,r.Z)().wrap(function(zr){for(;;)switch(zr.prev=zr.next){case 0:return zr.next=2,pt(E.id,!0);case 2:if(Dr=zr.sent,!(Dr.length>0)){zr.next=6;break}return c.default.error("\u8BE5\u8BA2\u5355\u5C1A\u6709\u7F34\u8D39\u8BB0\u5F55\uFF0C\u8BF7\u5148\u5E9F\u9664\u7F34\u8D39\u8BB0\u5F55\uFF01",5),zr.abrupt("return");case 6:et.Z.post("/sms/business/bizOrder/disable/"+E.id).then(function(kr){kr.status=="success"&&(c.default.success("\u5E9F\u9664\u6210\u529F"),fe())});case 7:case"end":return zr.stop()}},ar)})),okText:"\u5E9F\u9664",cancelText:"\u53D6\u6D88",children:(0,n.jsx)(x.Z,{hidden:E.parentId!="-1"||qe=="refund"||Te=="sp"||Be||Mt,size:"small",type:"primary",danger:!0,icon:(0,n.jsx)(pe.Z,{}),children:"\u5E9F\u9664"},"delete")},E.id),(0,n.jsx)(ne.Z,{placement:"topLeft",title:"\u7F34\u8D39\u4FE1\u606F",children:(0,n.jsx)(x.Z,{size:"small",type:"primary",className:"tablebut",hidden:qe=="refund"||Be,icon:(0,n.jsx)(Ct.Z,{}),onClick:(0,p.Z)((0,r.Z)().mark(function ar(){return(0,r.Z)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:ve(!0),Oe({orderId:E.id}),Me(!0),ve(!1);case 4:case"end":return oe.stop()}},ar)})),children:"\u7F34\u8D39\u4FE1\u606F"},"ljiaofei")}),(0,n.jsxs)("div",{hidden:E.studentType==0||qe=="refund"||Te=="sp"||Be||Mt,children:[(0,n.jsx)(x.Z,{size:"small",type:"primary",className:"tablebut",icon:(0,n.jsx)(Ct.Z,{}),onClick:(0,p.Z)((0,r.Z)().mark(function ar(){return(0,r.Z)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:Oe((0,a.Z)((0,a.Z)({},E),{},{order:(0,a.Z)((0,a.Z)({},E),{},{parentId:E.id})})),k(!0);case 2:case"end":return oe.stop()}},ar)})),children:"\u67E5\u770B\u8BA2\u5355\u5B66\u5458"},"banxin"),(0,n.jsx)(x.Z,{size:"small",type:"primary",onClick:(0,p.Z)((0,r.Z)().mark(function ar(){var Dr;return(0,r.Z)().wrap(function(zr){for(;;)switch(zr.prev=zr.next){case 0:Dr="/sms/business/bizOrder/saveStudentAndOrder",Oe((0,a.Z)((0,a.Z)({},E),{},{order:(0,a.Z)((0,a.Z)({},E),{},{parentId:E.id})})),R(Dr+"?id="+E.id),ee(!0);case 4:case"end":return zr.stop()}},ar)})),children:"\u6279\u91CF\u5BFC\u5165\u5B66\u5458\u5230\u73ED\u578B"},"daoru"),(0,n.jsx)(x.Z,{size:"small",type:"primary",style:{margin:"5px 0"},onClick:(0,p.Z)((0,r.Z)().mark(function ar(){var Dr,oe;return(0,r.Z)().wrap(function(kr){for(;;)switch(kr.prev=kr.next){case 0:Dr=E.studentName+"\u8D44\u6599\u6536\u96C6",oe={classType:E.classType,examType:E.examType,classYear:E.classYear,receivable:E.receivable,u:E.createBy,t:"3",source:E.source,provider:E.provider,p:E.project,parentId:E.id},et.Z.post2("/sms/business/bizFile/createWeChatMiniQRCode",{fileName:Dr},oe).then(function(qr){qr.status=="success"&&$e.m8.push("/business/qrcode")});case 3:case"end":return kr.stop()}},ar)})),children:"\u8D44\u6599\u6536\u96C6"},"dataJob"),(0,n.jsx)(x.Z,{size:"small",type:"primary",style:{margin:"5px 0"},onClick:function(){Oe((0,a.Z)((0,a.Z)({},E),{},{order:(0,a.Z)((0,a.Z)({},E),{},{parentId:E.id}),type:"orders"})),je(!0)},children:"\u9009\u62E9\u5DF2\u6709\u5B66\u5458\u6DFB\u52A0\u5230\u73ED\u578B"},"daoruxueyuan")]})]})}}],te=Tt=="all"?{}:{studentType:Tt},$t=Tt==3?{parentId:"-1",enable:!1}:(0,a.Z)((0,a.Z)({parentId:"-1"},te),{},{enable:!0}),Mr=void 0;Ue&&($t.studentUserId=Ue),ze&&($t["id-in"]=ze);var At=(0,L.Z)({},"createTime,status","desc,asc");Xe&&($t=(0,a.Z)((0,a.Z)({},$t),Xe));var Kr=function(){var Ve=(0,p.Z)((0,r.Z)().mark(function xt(){var E,Cr;return(0,r.Z)().wrap(function(ar){for(;;)switch(ar.prev=ar.next){case 0:if(!vt){ar.next=6;break}return ar.next=3,et.Z.get("/sms/business/bizOrder/lastDealOrder",{id:Ue});case 3:E=ar.sent,Cr=E.data,Xr([Cr]);case 6:case"end":return ar.stop()}},xt)}));return function(){return Ve.apply(this,arguments)}}();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(g.Z,{spinning:Le,children:[vt?(0,n.jsx)(Ut.Z,{columns:ue,className:"Order",scroll:{x:2500},actionRef:se,cardBordered:!0,dataSource:lr,rowKey:"id"}):(0,n.jsx)(Ut.Z,{columns:ue,className:"Order",scroll:{x:2500},actionRef:se,cardBordered:!0,request:{url:Pt,params:(0,a.Z)((0,a.Z)({},$t),Lr),sortList:At},rowKey:"id",toolbar:Mr,rowSelection:{selections:[m.Z.SELECTION_ALL,m.Z.SELECTION_INVERT],onChange:function(xt,E){ur(E)}},tableAlertOptionRender:function(xt){var E=xt.selectedRowKeys,Cr=xt.selectedRows,Rr=xt.onCleanSelected;return(0,n.jsxs)(i.Z,{size:24,children:[(0,n.jsx)("span",{children:(0,n.jsx)("a",{style:{marginInlineStart:8},onClick:Rr,children:"\u53D6\u6D88\u9009\u62E9"})}),(0,n.jsx)("a",{onClick:function(){Cr.forEach(function(Dr){Dr.orderId=Dr.id}),Oe({list:Cr,type:"charge"}),Ge(!0)},children:"\u591A\u8BA2\u5355\u7F34\u8D39"})]})},toolBarRender:[(0,n.jsx)(x.Z,{type:"primary",icon:(0,n.jsx)(gt.Z,{}),onClick:(0,p.Z)((0,r.Z)().mark(function Ve(){return(0,r.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(Lt.length!=0){E.next=3;break}return c.default.error("\u8BF7\u5148\u52FE\u9009\u81F3\u5C11\u4E00\u7B14\u8BA2\u5355\u8FDB\u884C\u7F34\u8D39!"),E.abrupt("return");case 3:Lt.forEach(function(Cr){Cr.orderId=Cr.id}),Oe({list:Lt,type:"charge"}),Ge(!0);case 6:case"end":return E.stop()}},Ve)})),hidden:Xe,children:"\u52FE\u9009\u591A\u4E2A\u8BA2\u5355\u5408\u5E76\u7F34\u8D39"},"add-admin-order")],search:ze||Xe?!1:{defaultCollapsed:!1,labelWidth:120}},$t),(0,n.jsx)(Ee.Z,{title:"\u7F16\u8F91",width:1200,visible:Se,onCancel:function(){return Vt(!1)},destroyOnClose:!0,maskClosable:!1,footer:null,children:Se&&(0,n.jsx)($r,{ref:lu,setModalVisible:function(){return Vt(!1)},modalVisible:Se,callbackRef:function(){return fe()},renderData:C})}),(0,n.jsx)(Ee.Z,{title:"\u5B8C\u5584\u73ED\u578B\u4FE1\u606F",width:1200,visible:ir,onCancel:function(){return wt(!1)},destroyOnClose:!0,maskClosable:!1,footer:null,children:ir&&(0,n.jsx)($r,{ref:lu,setModalVisible:function(){return wt(!1)},modalVisible:ir,callbackRef:function(){return fe()},renderData:C,url:"/sms/business/bizOrder/improveAndSubmit"})}),(0,n.jsx)(Ee.Z,{title:(C==null?void 0:C.type)=="order"?"\u7F34\u8D39":"\u9000\u8D39",width:1200,visible:br,onCancel:function(){return _r(!1)},maskClosable:!1,footer:null,children:(0,n.jsx)(du,{ref:St,setModalVisible:function(){return _r(!1)},modalVisible:br,renderData:C,callbackRef:function(){return fe()},setPreviewImage:function(xt){return Qt(xt)},setPreviewVisible:function(){return eu(!0)}})}),Ne&&(0,n.jsx)(he.Z,{setModalVisible:function(){return je(!1)},modalVisible:Ne,callbackRef:function(){return fe()},renderData:C,maskClosable:!1,isFormal:null,parentId:C.studentId,setStudentId:function(xt){Nr(xt)}}),W&&(0,n.jsx)(re,{setModalVisible:function(){return k(!1)},modalVisible:W,callbackRef:function(){return fe()},renderData:C,setStudentId:function(xt){Nr(xt)}}),K&&(0,n.jsx)(ut.Z,{setModalVisible:function(){return Et(!1)},modalVisible:K,callbackRef:function(){return fe()},renderData:C}),mr&&(0,n.jsx)(tr.Z,{setModalVisible:function(){return Er(!1)},modalVisible:mr,renderData:C,callbackRef:function(){return fe()}}),(0,n.jsx)(o.Z,{title:"\u8865\u7F34\u4E0B\u5355",width:1200,visible:Re,onClose:function(){return lt(!1)},maskClosable:!1,footer:null,destroyOnClose:!0,children:(0,n.jsx)(nu,{setModalVisible:function(){return lt(!1)},modalVisible:Re,renderData:C,supple:!0,callbackRef:function(){return fe()}})}),(0,n.jsx)(o.Z,{title:"\u7F34\u8D39",width:1200,visible:Ar,onClose:function(){return Ge(!1)},maskClosable:!1,footer:null,destroyOnClose:!0,children:(0,n.jsx)(nu,{setModalVisible:function(){return Ge(!1)},modalVisible:Ar,renderData:C,callbackRef:function(){return fe()}})}),U&&(0,n.jsx)(jr.Z,{setModalVisible:function(){return Me(!1)},modalVisible:U,renderData:C,callbackRef:function(){return fe()},setPreviewImage:function(xt){return Qt(xt)},setPreviewVisible:function(){return eu(!0)}}),z&&(0,n.jsx)(_e,{setModalVisible:function(){return He(!1)},modalVisible:z,renderData:C,callbackRef:function(){return fe()}}),Q&&(0,n.jsx)(Dt.Z,{setModalVisible:function(){return ee(!1)},modalVisible:Q,url:_,type:"studentOrder",propsData:{resourceType:0,parentId:C.studentId},callbackFn:function(xt){return k(!0)}}),(0,n.jsx)(sr.Z,{previewVisible:su,setPreviewVisible:function(){return eu(!1)},previewImage:pr})]})})}},5909:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var antd_es_spin_style__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20228),antd_es_spin__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(11382),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(86582),antd_es_button_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(57663),antd_es_button__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(71577),antd_es_row_style__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13062),antd_es_row__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(71230),antd_es_col_style__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(89032),antd_es_col__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(15746),antd_es_space_style__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(49111),antd_es_space__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(19650),antd_es_message_style__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(34792),antd_es_message__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(48086),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(11849),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(39428),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(3182),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(32059),E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(2824),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(67294),umi__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(21010),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(59962),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(24739),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(19054),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(952),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(5966),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(31199),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(8214),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(64317),_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(90672),_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(37490),_services_ant_design_pro_apiRequest__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(63863),_Department_UserManageCard__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(14037),_Modals__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(63930),_ant_design_icons__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(73218),_ant_design_pro_card__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(30202),antd_lib_modal_Modal__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(83663),_pages_Business_ClassList__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(12741),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(85893),content=null,quantitys=[0,0,0,0,0,0,0,0,0],comNumbers=[0,0,0,0,0,0,0,0,0],JobClassExamA=[];__webpack_exports__.Z=function(props,childRef){var _providerEnum,_initialState$current,_initialState$current2,modalVisible=props.modalVisible,_props$setModalVisibl=props.setModalVisible,setModalVisible=_props$setModalVisibl===void 0?void 0:_props$setModalVisibl,_props$callbackRef=props.callbackRef,callbackRef=_props$callbackRef===void 0?void 0:_props$callbackRef,renderData=props.renderData,admin=props.admin,_props$editAll=props.editAll,editAll=_props$editAll===void 0?!1:_props$editAll,url=props.url,callback=props.callback,_useModel=(0,umi__WEBPACK_IMPORTED_MODULE_13__.tT)("@@initialState"),initialState=_useModel.initialState,_useState=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),_useState2=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState,2),CardVisible=_useState2[0],_setCardVisible=_useState2[1],_useState3=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(!0),_useState4=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState3,2),spinning=_useState4[0],setSpinning=_useState4[1],_useState5=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(),_useState6=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState5,2),CardContent=_useState6[0],setCardContent=_useState6[1],_useState7=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)([0,0,0,0,0,0,0,0,0]),_useState8=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState7,2),quantity=_useState8[0],setquantity=_useState8[1],_useState9=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)([0,0,0,0,0,0,0,0,0]),_useState10=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState9,2),receivable=_useState10[0],setreceivable=_useState10[1],_useState11=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)([0,0,0,0,0,0,0,0,0]),_useState12=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState11,2),discountOrder=_useState12[0],setdiscountOrder=_useState12[1],_useState13=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)([]),_useState14=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState13,2),JobClassExam=_useState14[0],setJobClassExam=_useState14[1],_useState15=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)("9"),_useState16=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState15,2),sources=_useState16[0],setSource=_useState16[1],_useState17=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)([]),_useState18=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState17,2),orderLists=_useState18[0],setOrderList=_useState18[1],_useState19=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(),_useState20=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState19,2),userNameId=_useState20[0],setUserNameId=_useState20[1],_useState21=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)({}),_useState22=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState21,2),providerData=_useState22[0],setprovider=_useState22[1],_useState23=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),_useState24=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState23,2),ClassFalg=_useState24[0],_setClassFalg=_useState24[1],providerEnum=(_providerEnum={},(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_15__.Z)(_providerEnum,renderData.userId,renderData.userName),(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_15__.Z)(_providerEnum,renderData.provider,renderData.providerName),_providerEnum),userRef=(0,react__WEBPACK_IMPORTED_MODULE_6__.useRef)(null),_useState25=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)({}),_useState26=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState25,2),classRef=_useState26[0],setClassRef=_useState26[1];(0,react__WEBPACK_IMPORTED_MODULE_6__.useImperativeHandle)(childRef,function(){return{submitok,formRefs:formRef,submitAddNew}});var _useState27=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),_useState28=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState27,2),StudentModalsVisible=_useState28[0],setStudentModalsVisible=_useState28[1],_useState29=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)([]),_useState30=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState29,2),companyStudent=_useState30[0],setCompanyStudent=_useState30[1],_useState31=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)([0,0,0,0,0,0,0,0,0]),_useState32=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState31,2),comNumber=_useState32[0],setComNumber=_useState32[1],_useState33=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)({name:initialState==null||(_initialState$current=initialState.currentUser)===null||_initialState$current===void 0?void 0:_initialState$current.name,id:initialState==null||(_initialState$current2=initialState.currentUser)===null||_initialState$current2===void 0?void 0:_initialState$current2.userid}),_useState34=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(_useState33,2),department=_useState34[0],_setDepartment=_useState34[1],urlGroup="/sms/business/bizOrder",eidtUrl=url||"/sms/business/bizOrder/editOrder",eidtUrls="/sms/business/bizOrder/editOrders",formRef=(0,react__WEBPACK_IMPORTED_MODULE_6__.useRef)(),actionRefs=(0,react__WEBPACK_IMPORTED_MODULE_6__.useRef)(),ment=function(){var D;formRef==null||(D=formRef.current)===null||D===void 0||D.setFieldsValue({userName:department.name})};(0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)(function(){var ce;formRef==null||(ce=formRef.current)===null||ce===void 0||ce.setFieldsValue({classId:classRef.id,className:classRef.name})},[classRef]),(0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)(function(){var ce;formRef==null||(ce=formRef.current)===null||ce===void 0||ce.setFieldsValue({provider:userNameId==null?void 0:userNameId.id})},[userNameId]),(0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)(function(){quantitys=[0,0,0,0,0,0,0,0,0],comNumbers=[0,0,0,0,0,0,0,0,0]},[modalVisible]),(0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)(function(){ment()},[department]),(0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)(function(){var _formRef$current4,numberQ=eval(quantitys.join("+")),numberS=eval(discountOrder.join("+")),numberQ2=0;quantitys.forEach(function(ce,D){numberQ2=numberQ2+ce*comNumbers[D]}),formRef==null||(_formRef$current4=formRef.current)===null||_formRef$current4===void 0||_formRef$current4.setFieldsValue({quantity:numberQ,receivable:comNumber[0],totalReceivable:numberQ2-numberS})},[quantity,comNumber,discountOrder]),(0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)(function(){if(renderData.type=="order"&&renderData.orderNumber===0){++renderData.orderNumber;var list=[],orderList=[renderData];setOrderList(orderList),orderList.forEach(function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().mark(function D(e,j){return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:_onChange2([e.project],j),quantitys[j]=e.quantity,comNumbers[j]=e.receivable,setquantity(quantitys),list.push({project:_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getCascaderValue("dict_reg_job",e.project),JobClassExam:JSON.stringify({classType:e.classType,examType:e.examType,classYear:e.classYear,receivable:e.receivable,project:e.project}),quantity:e.quantity,receivable:e.receivable,discount:e.discount,source:e.source+"",discountRemark:e.discountRemark,provider:{value:renderData.provider}});case 5:case"end":return V.stop()}},D)}));return function(D,e){return ce.apply(this,arguments)}}()),setTimeout((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().mark(function _callee2(){var _formRef$current5,_userRef$current,data;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:formRef==null||(_formRef$current5=formRef.current)===null||_formRef$current5===void 0||_formRef$current5.setFieldsValue((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)({},renderData),{},{percent:renderData.percent*100,quantity:eval(quantitys.join("+")),userName:department.name,project:_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getCascaderValue("dict_reg_job",renderData.project),standards:list,provider:renderData.provider})),data={id:renderData.provider,name:renderData.providerName},userRef==null||(_userRef$current=userRef.current)===null||_userRef$current===void 0||_userRef$current.setDepartment(data),setUserNameId(data);case 4:case"end":return _context2.stop()}},_callee2)})),500)}if(renderData.typee=="add"&&renderData.orderNumber===0){var source=renderData.studentSource+"";++renderData.orderNumber,renderData.project&&_onChange2([renderData.project],0),setTimeout(function(){var ce;formRef==null||(ce=formRef.current)===null||ce===void 0||ce.setFieldsValue({project:renderData.isFormal?"":_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getCascaderValue("dict_reg_job",renderData.project),studentName:renderData.name,userName:department.name,standards:[{project:_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getCascaderValue("dict_reg_job",renderData.project),quantity:1,source,provider:renderData.isFormal?renderData.userId:renderData.provider}]}),quantitys[0]=1,setSource(source),setquantity(quantitys),setSpinning(!1)},100)}},[]);var getDepartment=function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().mark(function D(){var e,j,g;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return e=function I(i){var A=[];return i.forEach(function(m,L){var M=[];m.children&&(M=I(m.children));var d="",J=!1,ne={};m.departmentName?(d=m.departmentName,ne.id=m.id,J=!0):m.enable&&(d=m.name,ne.userId=m.userId,J=!0),J&&(M.length>0?A.push((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)({},ne),{},{title:d,parentId:m.parentId,children:M})):A.push((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)({},ne),{},{title:d,parentId:m.parentId})))}),A},j=function I(i,A){i.forEach(function(m,L){m.value=m.userId,m.value||(m.value=A+"-"+L),m.children&&I(m.children,m.value)})},g=e(JSON.parse(localStorage.getItem("Department"))),j(g,0),o.abrupt("return",g.reverse());case 5:case"end":return o.stop()}},D)}));return function(){return ce.apply(this,arguments)}}(),filter=function(D,e){return e.some(function(j){return j.label.toLowerCase().indexOf(D.toLowerCase())>-1})};function projectClassExamListFn(ce){var D=[];return ce.forEach(function(e){D.push({label:_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getName("dict_class_type",e.classType)+"/"+_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getName("dict_exam_type",e.examType)+"/"+_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getName("dict_class_year",e.classYear),value:JSON.stringify({classType:e.classType,examType:e.examType,classYear:e.classYear,receivable:e.receivable,project:e.project})})}),D}function _onChange2(ce,D,e){return _onChange.apply(this,arguments)}function _onChange(){return _onChange=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().mark(function ce(D,e,j){var g,V,o,I,i,A;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(D){L.next=2;break}return L.abrupt("return");case 2:return setSpinning(!0),formRef==null||(g=formRef.current)===null||g===void 0||g.setFieldsValue({JobClassExam:"",receivable:0}),I=JSON.parse(JSON.stringify(JobClassExam)),L.next=7,_services_ant_design_pro_apiRequest__WEBPACK_IMPORTED_MODULE_8__.Z.get("/sms/business/bizChargeStandard?project="+D[D.length-1]+"&useNum=0&_size=999&enable=true");case 7:i=L.sent.data.content,i.length!=0?(I[e]=projectClassExamListFn(i),JobClassExamA[e]=projectClassExamListFn(i)):I[e]=null,A=formRef!=null&&(V=formRef.current)!==null&&V!==void 0&&V.getFieldValue("standards")?formRef==null||(o=formRef.current)===null||o===void 0?void 0:o.getFieldValue("standards"):[],A[e]&&(A[e].JobClassExam=void 0),setTimeout(function(){var M;renderData.type!="order"?setJobClassExam(I):setJobClassExam(JobClassExamA),formRef==null||(M=formRef.current)===null||M===void 0||M.setFieldsValue({standards:A}),setSpinning(!1)},100);case 12:case"end":return L.stop()}},ce)})),_onChange.apply(this,arguments)}var submitAddNew=function(D){var e=D.standards;return e.forEach(function(j){var g=JSON.parse(j.JobClassExam);j.studentUserId=renderData.id,j.classId=D.classId,Object.keys(g).forEach(function(V){j[V]=g[V]}),delete j.JobClassExam}),new Promise(function(j){_services_ant_design_pro_apiRequest__WEBPACK_IMPORTED_MODULE_8__.Z.postAll("/sms/business/bizOrder/saveArray",{array:e}).then(function(g){g.status=="success"&&(antd_es_message__WEBPACK_IMPORTED_MODULE_19__.default.success("\u64CD\u4F5C\u6210\u529F"),quantitys=[0,0,0,0,0,0,0,0,0],comNumbers=[0,0,0,0,0,0,0,0,0],setModalVisible&&(setModalVisible(),callbackRef())),j(g)}).catch(function(g){j(!0)})})},submitAdd=function(D){renderData.typee=="add"&&(D.studentUserId=renderData.id,delete D.id);var e={},j=JSON.parse(D.JobClassExam);Object.keys(j).forEach(function(o){e[o]=j[o]});var g={};g.userId=department.id,g.project=D.project[D.project.length-1],g.quantity=1,g.receivable=D.totalReceivable,renderData.typee=="add"?g.studentUserId=renderData.id:g.id=renderData.id,D.description&&(g.description=D.description);var V=D.standards;return renderData.parentId!="-1"&&(D.parentId=renderData.parentId),new Promise(function(o){_services_ant_design_pro_apiRequest__WEBPACK_IMPORTED_MODULE_8__.Z.post(urlGroup,(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)({},e),g)).then(function(I){I.status=="success"&&(antd_es_message__WEBPACK_IMPORTED_MODULE_19__.default.success("\u64CD\u4F5C\u6210\u529F"),quantitys=[0,0,0,0,0,0,0,0,0],comNumbers=[0,0,0,0,0,0,0,0,0],setModalVisible&&(setModalVisible(),callbackRef())),o(I)}).catch(function(I){o(!0)})})},submitEidt=function(D){var e=D,j=e.standards;return D=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_18__.Z)({},D),j[0]),JSON.parse(j[0].JobClassExam)),D.id=renderData.id,D.provider&&(D.provider=D.provider.value),D.percent&&(D.percent=D.percent/100),delete D.standards,delete D.JobClassExam,delete D.totalReceivable,new Promise(function(g){_services_ant_design_pro_apiRequest__WEBPACK_IMPORTED_MODULE_8__.Z.post(editAll?eidtUrl:urlGroup,D).then(function(V){V.status=="success"&&(antd_es_message__WEBPACK_IMPORTED_MODULE_19__.default.success("\u64CD\u4F5C\u6210\u529F"),quantitys=[0,0,0,0,0,0,0,0,0],comNumbers=[0,0,0,0,0,0,0,0,0],setModalVisible&&(setModalVisible(),callbackRef())),g(V)}).catch(function(V){g(!0)})})},submitok=function(D){return renderData.type=="order"?submitEidt(D):submitAdd(D)},onChange1=function(D){},_onSearch=function(D){};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_20__.ZP,{submitter:admin==="step"?!1:{render:function(D,e){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(antd_es_row__WEBPACK_IMPORTED_MODULE_21__.Z,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(antd_es_col__WEBPACK_IMPORTED_MODULE_22__.Z,{span:24,offset:21,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(antd_es_space__WEBPACK_IMPORTED_MODULE_23__.Z,{children:e})})})}},formRef,autoFocusFirstInput:!0,onFinish:function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().mark(function D(e){return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return renderData.studentId&&(e.id=renderData.studentId),g.next=3,submitok(e);case 3:case"end":return g.stop()}},D)}));return function(D){return ce.apply(this,arguments)}}(),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(antd_es_spin__WEBPACK_IMPORTED_MODULE_24__.Z,{spinning,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_20__.ZP.Group,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_25__.Z,{name:"studentName",width:"sm",label:renderData.group?"\u4F01\u4E1A\u56E2\u7EC4":"\u5B66\u5458\u59D3\u540D",placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",disabled:!0}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_25__.Z,{hidden:renderData.typee!="add"||renderData.group,name:"className",width:"sm",label:"\u73ED\u7EA7",placeholder:"\u8BF7\u9009\u62E9\u73ED\u7EA7",fieldProps:{onClick:function(){_setClassFalg(!0)}}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_25__.Z,{hidden:!0,name:"classId"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_25__.Z,{name:"quantity",label:"\u5F53\u524D\u8BA2\u5355\u62A5\u540D\u4EBA\u6570",required:!0,readonly:!0,width:"sm"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_25__.Z,{name:"totalReceivable",label:"\u5F53\u524D\u8BA2\u5355\u5E94\u6536\u603B\u989D",required:!0,readonly:!0,width:"sm"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_26__.Z,{hidden:!editAll,name:"percent",label:"\u4E1A\u7EE9\u5206\u6210\u6BD4\u4F8B\uFF08%\uFF09",width:"sm",min:0,max:100})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(antd_es_row__WEBPACK_IMPORTED_MODULE_21__.Z,{style:{width:"1100px",backgroundColor:"#d9edf7",border:"1px solid #bce8f1",padding:"20px",marginBottom:"20px"},hidden:renderData.type=="orders",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(antd_es_col__WEBPACK_IMPORTED_MODULE_22__.Z,{span:2,style:{color:"red"},children:"\u6CE8\u610F\uFF1A"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(antd_es_col__WEBPACK_IMPORTED_MODULE_22__.Z,{span:22,children:"\uFF081\uFF09\u5982\u679C\u4F60\u7684\u6536\u8D39\u91D1\u989D\u5927\u4E8E\u4E86\u6536\u8D39\u6807\u51C6\uFF0C\u8BF7\u5728\u8BA2\u5355\u4F18\u60E0\u91D1\u989D\u91CC\u586B\u5199\u591A\u6536\u91D1\u989D\u7684\u8D1F\u6570\u3002"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_27__.u,{name:"standards",max:renderData.type=="order"?1:9,min:1,deleteIconProps:{Icon:_ant_design_icons__WEBPACK_IMPORTED_MODULE_28__.Z,tooltipText:"\u4E0D\u9700\u8981\u8FD9\u884C\u4E86"},creatorButtonProps:{creatorButtonText:"\u65B0\u589E\u4E00\u6761\u73ED\u578B\u4FE1\u606F"},creatorRecord:{project:_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getCascaderValue("dict_reg_job",renderData.project),quantity:1,source:sources,provider:renderData.isFormal?renderData.userId:renderData.provider},actionGuard:{beforeAddRow:function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().mark(function e(j,g){var V;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return _onChange2([renderData.project],g),V=JSON.parse(JSON.stringify(quantity)),V[g]=1,quantitys[g]=1,setquantity(V),I.abrupt("return",new Promise(function(i){setTimeout(function(){return i(!0)},1e3)}));case 6:case"end":return I.stop()}},e)}));function D(e,j){return ce.apply(this,arguments)}return D}(),beforeRemoveRow:function(){var ce=(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().mark(function e(j){return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.abrupt("return",new Promise(function(o){if(j===0){antd_es_message__WEBPACK_IMPORTED_MODULE_19__.default.error("\u8FD9\u884C\u4E0D\u80FD\u5220"),o(!1);return}var I=JSON.parse(JSON.stringify(quantity)),i=JSON.parse(JSON.stringify(receivable)),A=JSON.parse(JSON.stringify(comNumber));I[j]=0,i[j]=0,A[j]=0,quantitys[j]=0,comNumbers[j]=0,setquantity(I),setreceivable(i),setTimeout(function(){return o(!0)},300)}));case 1:case"end":return V.stop()}},e)}));function D(e){return ce.apply(this,arguments)}return D}()},itemRender:function(D,e){var j=D.listDom,g=D.action,V=e.record,o=e.index,I=e.name;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_card__WEBPACK_IMPORTED_MODULE_29__.ZP,{bordered:!0,extra:g,title:"\u62A5\u8003\u73ED\u578B",style:{marginBottom:8},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_30__.UW,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_20__.ZP.Group,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_31__.Z,{width:"sm",name:"project",placeholder:"\u9009\u62E9\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getCascader("dict_reg_job"),showSearch:{filter},onChange:function(A){return _onChange2(A,o,"change")}}}),JobClassExam[o]?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_32__.Z,{label:"\u73ED\u578B\u9009\u62E9",name:"JobClassExam",fieldProps:{options:JobClassExam[o],showSearch:!0,onChange:function(A){onChange1(A)},onSearch:function(A){_onSearch(A)},filterOption:function(A,m){var L,M;return((L=m.children)===null||L===void 0||(M=L.props)===null||M===void 0?void 0:M.label.indexOf(A))>=0},onSelect:function(A){var m,L=JSON.parse(A),M=JSON.parse(JSON.stringify(comNumber)),d=formRef==null||(m=formRef.current)===null||m===void 0?void 0:m.getFieldValue("standards");d[o].receivable=L.receivable,M[o]=L.receivable,comNumbers[o]=L.receivable,setComNumber(M)}},width:"sm",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u73ED\u578B\u9009\u62E9"}]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(antd_es_button__WEBPACK_IMPORTED_MODULE_33__.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().mark(function i(){var A;return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:A=JSON.parse(JSON.stringify(JobClassExam)),A[o]=!1,setJobClassExam(A);case 3:case"end":return L.stop()}},i)})),children:"\u53D6\u6D88"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_26__.Z,{name:"quantity",width:"sm",label:"\u62A5\u540D\u4EBA\u6570",disabled:renderData.type==0,fieldProps:{onChange:function(A){(A==null||A=="")&&(A=0);var m=JSON.parse(JSON.stringify(quantity));m[o]=A,quantitys[o]=A,setquantity(m)}},rules:[{required:!0,message:"\u8BF7\u586B\u5199\u62A5\u540D\u4EBA\u6570"}]},"company-order-student-count-".concat(o)),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_26__.Z,{name:"receivable",label:"\u6536\u8D39\u6807\u51C6",disabled:JobClassExam[o],fieldProps:{onChange:function(A){(A==null||A=="")&&(A=0);var m=JSON.parse(JSON.stringify(comNumber));m[o]=A,comNumbers[o]=A,setComNumber(m)}},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u91D1\u989D"}]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_32__.Z,{label:"\u8BA2\u5355\u6765\u6E90",name:"source",width:200,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8BA2\u5355\u6765\u6E90"}],request:(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_16__.Z)((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().mark(function i(){return(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_17__.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",_services_util_dictionaries__WEBPACK_IMPORTED_MODULE_7__.Z.getList("dict_source"));case 1:case"end":return m.stop()}},i)}))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_26__.Z,{name:"discount",label:"\u8BA2\u5355\u4F18\u60E0\u91D1\u989D",disabled:renderData.type=="orders",hidden:renderData.type=="orders",min:-999999,width:280,rules:[{required:!0}],fieldProps:{precision:2,onChange:function(A){(A==null||A=="")&&(A=0);var m=JSON.parse(JSON.stringify(discountOrder));m[o]=A,setdiscountOrder(m)}}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_25__.Z,{name:"discountRemark",label:"\u8BA2\u5355\u4F18\u60E0\u539F\u56E0",width:"sm",fieldProps:{autoComplete:"no"},disabled:renderData.type=="orders",hidden:renderData.type=="orders",rules:[{required:discountOrder[o],message:"\u8BF7\u586B\u5199\u672C\u6B21\u6298\u6263\u539F\u56E0"}]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_34__.Z,{name:"provider",label:"\u4FE1\u606F\u63D0\u4F9B\u4EBA",placeholder:"\u8BF7\u8F93\u5165\u4FE1\u606F\u63D0\u4F9B\u4EBA",allowClear:!0,width:"sm",secondary:!0,request:function(){return getDepartment()},required:!0,fieldProps:{treeDefaultExpandAll:!0,filterTreeNode:!0,showSearch:!0,dropdownMatchSelectWidth:!1,labelInValue:!0,treeNodeFilterProp:"title",fieldNames:{label:"title"}}})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("span",{style:{display:"inline-block",marginTop:"32px"},children:"\u8BE5\u9879\u76EE\u5C1A\u672A\u8BBE\u7F6E\u6536\u8D39\u6807\u51C6,\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u8BBE\u7F6E!"})]})},"company-order-".concat(o))})}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_20__.ZP.Group,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ant_design_pro_form__WEBPACK_IMPORTED_MODULE_35__.Z,{width:1e3,label:"\u5907\u6CE8",name:"description"})}),CardVisible&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_Department_UserManageCard__WEBPACK_IMPORTED_MODULE_9__.Z,{CardVisible,CardContent,setCardVisible:function(){return _setCardVisible(!1)},setDepartment:function(D){return _setDepartment(D)},departments:[department]}),StudentModalsVisible&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_Modals__WEBPACK_IMPORTED_MODULE_10__.Z,{type:0,modalVisible:StudentModalsVisible,parentId:renderData.studentId,setModalVisible:function(){return setStudentModalsVisible(!1)},renderData:{type:"order"},companyStudent,setStudentId:function(D){var e=Array.isArray(D)?D:[D];setCompanyStudent([].concat((0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_36__.Z)(companyStudent),(0,E_project_2025_3_huide_wxq_crm_ui_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_36__.Z)(e)))}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(antd_lib_modal_Modal__WEBPACK_IMPORTED_MODULE_37__.Z,{open:ClassFalg,width:1200,onOk:function(){return _setClassFalg(!1)},onCancel:function(){return _setClassFalg(!1)},footer:null,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_pages_Business_ClassList__WEBPACK_IMPORTED_MODULE_11__.default,{setClassRef,setClassFalg:function(){return _setClassFalg(!1)}})})]})})}},92205:function(ce,D,e){"use strict";var j=e(86582),g=e(57663),V=e(71577),o=e(34792),I=e(48086),i=e(39428),A=e(3182),m=e(11849),L=e(2824),M=e(67294),d=e(21010),J=e(37476),ne=e(952),X=e(5966),x=e(8214),F=e(31199),f=e(64317),P=e(37490),r=e(63863),p=e(14037),O=e(63930),c=e(82061),a=e(85893),h=null;D.Z=function(ie){var Ee,s,le=ie.modalVisible,$=ie.setModalVisible,bt=ie.callbackRef,pe=ie.renderData,Ct=ie.admin,gt=ie.callback,et=(0,d.tT)("@@initialState"),ae=et.initialState,ut=(0,M.useState)(!1),ot=(0,L.Z)(ut,2),tr=ot[0],he=ot[1],Ft=(0,M.useState)(!1),gr=(0,L.Z)(Ft,2),it=gr[0],t=gr[1],Ye=(0,M.useState)(),l=(0,L.Z)(Ye,2),u=l[0],b=l[1],n=(0,M.useState)(null),ht=(0,L.Z)(n,2),jr=ht[0],$e=ht[1],sr=(0,M.useState)(!1),Y=(0,L.Z)(sr,2),Dt=Y[0],re=Y[1],Xt=(0,M.useState)([]),B=(0,L.Z)(Xt,2),Z=B[0],nr=B[1],De=(0,M.useState)({name:ae==null||(Ee=ae.currentUser)===null||Ee===void 0?void 0:Ee.name,id:ae==null||(s=ae.currentUser)===null||s===void 0?void 0:s.userid}),xr=(0,L.Z)(De,2),zt=xr[0],Ut=xr[1],Gt="/sms/business/bizChargeStandard",kt=(0,M.useRef)(),Kt=function(){var _t;kt==null||(_t=kt.current)===null||_t===void 0||_t.setFieldsValue({userId:zt.name})};(0,M.useEffect)(function(){},[Z]),(0,M.useEffect)(function(){Kt()},[zt]),pe.type=="companyStudent"&&pe.orderNumber===0&&(setTimeout(function(){var jt;kt==null||(jt=kt.current)===null||jt===void 0||jt.setFieldsValue((0,m.Z)((0,m.Z)({},pe),{},{classYear:pe.classYear+"",classType:pe.classType+"",examType:pe.examType+"",quantity:1,receivable:pe.receivable,userName:zt.name,project:P.Z.getCascaderValue("dict_reg_job",pe.project)}))},100),he(!0),++pe.orderNumber),pe.type=="order"&&setTimeout((0,A.Z)((0,i.Z)().mark(function jt(){var _t;return(0,i.Z)().wrap(function(Ht){for(;;)switch(Ht.prev=Ht.next){case 0:pe.orderNumber===0&&(Ie([pe.project]),kt==null||(_t=kt.current)===null||_t===void 0||_t.setFieldsValue((0,m.Z)((0,m.Z)({},pe),{},{userName:zt.name,project:P.Z.getCascaderValue("dict_reg_job",pe.project),JobClassExam:JSON.stringify({receivable:pe.receivable,standardId:pe.standardId})})),++pe.orderNumber);case 1:case"end":return Ht.stop()}},jt)})),100);var Bt=function(_t,at){return at.some(function(Ht){return Ht.label.toLowerCase().indexOf(_t.toLowerCase())>-1})};function Ie(jt,_t){return Ot.apply(this,arguments)}function Ot(){return Ot=(0,A.Z)((0,i.Z)().mark(function jt(_t,at){var Ht,qt;return(0,i.Z)().wrap(function(Zr){for(;;)switch(Zr.prev=Zr.next){case 0:return Zr.next=2,r.Z.get("/sms/business/bizChargeStandard?project="+_t.at(-1));case 2:Ht=Zr.sent.data.content,Ht.length!=0?(qt=[],Ht.forEach(function(_e){qt.push({label:P.Z.getName("dict_class_type",_e.classType)+"/"+P.Z.getName("dict_exam_type",_e.examType)+"/"+P.Z.getName("dict_class_year",_e.classYear),value:JSON.stringify({receivable:_e.receivable,standardId:_e.id})})}),$e(qt)):$e(null);case 4:case"end":return Zr.stop()}},jt)})),Ot.apply(this,arguments)}var Je=function(_t){var at={};return at.orderId=pe.orderId,at.quantity=_t.quantity,at.standardId=JSON.parse(_t.JobClassExam).standardId,at.id=pe.id,new Promise(function(Ht){r.Z.post("/sms/business/orderStandard",at).then(function(qt){qt.status=="success"&&(I.default.success("\u64CD\u4F5C\u6210\u529F"),$(),bt())}).catch(function(qt){Ht(!0)})})};return(0,a.jsxs)(J.Y,{title:"\u4E0B\u5355",width:700,formRef:kt,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){$()},maskClosable:!1},onFinish:function(){var jt=(0,A.Z)((0,i.Z)().mark(function _t(at){return(0,i.Z)().wrap(function(qt){for(;;)switch(qt.prev=qt.next){case 0:return pe.id&&(at.id=pe.id),qt.next=3,Je(at);case 3:case"end":return qt.stop()}},_t)}));return function(_t){return jt.apply(this,arguments)}}(),visible:le,children:[(0,a.jsxs)(ne.ZP.Group,{children:[(0,a.jsx)(X.Z,{name:"studentName",width:"sm",label:pe.group?"\u4F01\u4E1A\u56E2\u7EC4":"\u5B66\u5458\u59D3\u540D",placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",disabled:!tr,rules:[{required:!0,pattern:new RegExp(/^\S*$/),message:"\u4E0D\u80FD\u5305\u542B\u7A7A\u683C/\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u7528\u6237\u540D"}]}),(0,a.jsx)(x.Z,{width:"md",name:"project",placeholder:"\u9009\u62E9\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",disabled:tr,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:P.Z.getCascader("dict_reg_job"),showSearch:{filter:Bt},onChange:Ie,onSearch:function(_t){return console.log(_t)}}})]}),(0,a.jsxs)(ne.ZP.Group,{children:[(0,a.jsx)(F.Z,{name:"quantity",width:"sm",label:"\u62A5\u540D\u4EBA\u6570",disabled:pe.type==0||tr}),jr?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(f.Z,{label:"\u73ED\u578B\u9009\u62E9",disabled:tr,name:"JobClassExam",options:jr,fieldProps:{onChange:function(_t){var at,Ht=JSON.parse(_t);kt==null||(at=kt.current)===null||at===void 0||at.setFieldsValue({receivable:Ht.receivable})}},width:"sm"})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("span",{style:{display:"inline-block",marginTop:"32px"},children:"\u8BE5\u9879\u76EE\u5C1A\u672A\u8BBE\u7F6E\u6536\u8D39\u6807\u51C6\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u8BBE\u7F6E\uFF01"})})]}),(0,a.jsxs)(ne.ZP.Group,{children:[(0,a.jsx)(F.Z,{name:"receivable",label:"\u6536\u8D39\u6807\u51C6",disabled:jr||tr,width:"sm",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u91D1\u989D"}]}),(0,a.jsx)(X.Z,{name:"userName",label:"\u6536\u8D39\u4EBA",required:!0}),(0,a.jsx)(V.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,A.Z)((0,i.Z)().mark(function jt(){return(0,i.Z)().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:if(h){at.next=4;break}return at.next=3,r.Z.get("/sms/share/getDepartmentAndUser");case 3:h=at.sent;case 4:b({content:h.data,type:"order"}),t(!0);case 6:case"end":return at.stop()}},jt)})),children:"\u9009\u62E9"})]}),(0,a.jsx)(ne.ZP.Group,{children:pe.group&&(0,a.jsx)(V.Z,{type:"primary",onClick:(0,A.Z)((0,i.Z)().mark(function jt(){return(0,i.Z)().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:re(!0);case 1:case"end":return at.stop()}},jt)})),children:"\u6DFB\u52A0\u5B66\u5458"})}),Z.length>0&&Z.map(function(jt,_t){return(0,a.jsxs)(ne.ZP.Group,{children:[(0,a.jsx)(X.Z,{name:"studentNames",width:"xs",label:"\u5B66\u5458\u59D3\u540D",placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",disabled:!0,fieldProps:{value:jt.name}}),(0,a.jsx)(f.Z,{label:"\u73ED\u578B\u9009\u62E9",name:"JobClassExam",options:jr,fieldProps:{onChange:function(Ht){var qt,yr=JSON.parse(Ht),Zr={};Zr["receivables"+_t]=yr.receivable,kt==null||(qt=kt.current)===null||qt===void 0||qt.setFieldsValue(Zr)}},disabled:!0,width:"sm"}),(0,a.jsx)(F.Z,{fieldProps:{precision:2},name:"receivable",label:"\u672C\u6B21\u6536\u8D39",width:"xs",disabled:!0}),(0,a.jsx)(c.Z,{style:{marginTop:"40px",marginLeft:"-15px",cursor:"pointer"},onClick:function(){var Ht=JSON.parse(JSON.stringify(Z));Ht.splice(_t,1),nr(Ht)}})]},"student-order-".concat(_t))}),it&&(0,a.jsx)(p.Z,{CardVisible:it,CardContent:u,setCardVisible:function(){return t(!1)},setDepartment:function(_t){return Ut(_t)},departments:[zt]}),Dt&&(0,a.jsx)(O.Z,{type:0,modalVisible:Dt,parentId:pe.id,setModalVisible:function(){return re(!1)},renderData:{type:"order"},companyStudent:Z,setStudentId:function(_t){var at=Array.isArray(_t)?_t:[_t];nr([].concat((0,j.Z)(Z),(0,j.Z)(at)))}})]})}},48814:function(ce,D,e){"use strict";var j=e(66456),g=e(15885),V=e(39428),o=e(3182),I=e(57663),i=e(71577),A=e(11849),m=e(2824),L=e(67294),M=e(8212),d=e(51042),J=e(66801),ne=e(63863),X=e(37490),x=e(31392),F=e(7903),f=e(21010),P=e(85893);D.Z=function(r){var p=r.admin,O=r.studentUserId,c=O===void 0?"":O,a=(0,L.useState)(null),h=(0,m.Z)(a,2),ie=h[0],Ee=h[1],s=(0,L.useState)(!1),le=(0,m.Z)(s,2),$=le[0],bt=le[1],pe=(0,L.useState)(!1),Ct=(0,m.Z)(pe,2),gt=Ct[0],et=Ct[1],ae=(0,L.useState)(!1),ut=(0,m.Z)(ae,2),ot=ut[0],tr=ut[1],he=(0,L.useRef)(),Ft="/sms/business/bizStudentUser",gr="/sms/business/bizReturnVisit",it=function(){he.current.reload()};(0,L.useEffect)(function(){var Ye;if((Ye=f.m8.location.query)!==null&&Ye!==void 0&&Ye.nextVisitDate){var l;tr((l=f.m8.location.query)===null||l===void 0?void 0:l.nextVisitDate)}},[]);var t=[{title:"\u59D3\u540D",dataIndex:"studentName",sorter:!0,render:function(l,u){return(0,P.jsx)(P.Fragment,{children:c?(0,P.jsx)("span",{children:u.studentName}):(0,P.jsx)("a",{onClick:function(){ne.Z.get(Ft,{id:u.studentUserId}).then(function(n){Ee((0,A.Z)((0,A.Z)({},n.data.content[0]),{},{admin:p})),et(!0)})},children:u.studentName})})}},{title:"\u6C9F\u901A\u7C7B\u578B",dataIndex:"type",valueEnum:X.Z.getSearch("dict_c_type"),render:function(l,u){return(0,P.jsx)(P.Fragment,{children:X.Z.getName("dict_c_type",u.type)})},sorter:!0},{title:"\u610F\u5411\u7EA7\u522B",dataIndex:"intention",sorter:!0,valueEnum:X.Z.getSearch("dict_intention_level"),render:function(l,u){return(0,P.jsx)(P.Fragment,{children:X.Z.getName("dict_intention_level",u.intention)})}},{title:"\u6C9F\u901A\u5185\u5BB9",dataIndex:"content",sorter:!0},{title:"\u6C9F\u901A\u65F6\u95F4",key:"createTime",dataIndex:"createTime",valueType:"dateRange",sorter:!0,render:function(l,u){return(0,P.jsx)("span",{children:u.createTime})}},{title:"\u4E0B\u4E00\u6B21\u8DDF\u8FDB\u65F6\u95F4",key:"nextVisitDate",dataIndex:"nextVisitDate",valueType:"dateRange",sorter:!0,render:function(l,u){return(0,P.jsx)("span",{children:u.nextVisitDate})}},{title:"\u6C9F\u901A\u8001\u5E08",dataIndex:"userName",sorter:!0},{title:"\u64CD\u4F5C",valueType:"option",key:"option",render:function(l,u,b,n){return(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(i.Z,{type:"primary",size:"small",icon:(0,P.jsx)(M.Z,{}),style:{marginRight:"10px",marginBottom:"8px"},onClick:function(){Ee({id:u.studentUserId,types:"add",n:0}),bt(!0)},children:"\u56DE\u8BBF"},"editable")})}}];return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(J.ZP,{columns:t,actionRef:he,cardBordered:!0,request:function(){var Ye=(0,o.Z)((0,V.Z)().mark(function l(u,b,n){var ht;return(0,V.Z)().wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return c&&(u.studentUserId=c),ot&&(u.nextVisitDate=ot),$e.next=4,ne.Z.get("/sms/business/bizReturnVisit",u);case 4:return ht=$e.sent,$e.abrupt("return",{data:ht.data.content,success:ht.success,total:ht.data.totalElements});case 6:case"end":return $e.stop()}},l)}));return function(l,u,b){return Ye.apply(this,arguments)}}(),rowKey:"id",search:{labelWidth:"auto",defaultCollapsed:!1},pagination:{pageSize:10},rowSelection:{selections:[g.Z.SELECTION_ALL,g.Z.SELECTION_INVERT],onChange:function(l,u){console.log("selectedRows",u),console.log("e",l)}},dateFormatter:"string",headerTitle:"\u56DE\u8BBF\u8BB0\u5F55",toolBarRender:function(){return[(0,P.jsx)(i.Z,{icon:(0,P.jsx)(d.Z,{}),type:"primary",onClick:function(){Ee({type:"order",orderNumber:0}),bt(!0)},children:"\u6DFB\u52A0\u5B66\u5458\u8DDF\u8FDB/\u56DE\u8BBF\u8BB0\u5F55"},"button")]}}),ie&&(0,P.jsx)(F.Z,{setModalVisible:function(){return et(!1)},modalVisible:gt,renderData:ie,admin:p,callbackRef:function(){return it()}}),ie&&(0,P.jsx)(x.Z,{setModalVisible:function(){return bt(!1)},modalVisible:$,callbackRef:function(){return it()},renderData:ie,admin:p,url:gr})]})}},31392:function(ce,D,e){"use strict";var j=e(57663),g=e(71577),V=e(34792),o=e(48086),I=e(11849),i=e(39428),A=e(3182),m=e(2824),L=e(67294),M=e(21010),d=e(63930),J=e(37476),ne=e(952),X=e(5966),x=e(64317),F=e(22452),f=e(45510),P=e(90672),r=e(37490),p=e(63863),O=e(30381),c=e.n(O),a=e(85893);D.Z=function(h){var ie,Ee=h.modalVisible,s=h.setModalVisible,le=h.callbackRef,$=h.renderData,bt=h.url,pe=(0,M.tT)("@@initialState"),Ct=pe.initialState,gt=(0,L.useState)(!1),et=(0,m.Z)(gt,2),ae=et[0],ut=et[1],ot=(0,L.useState)(null),tr=(0,m.Z)(ot,2),he=tr[0],Ft=tr[1],gr=(0,L.useState)(),it=(0,m.Z)(gr,2),t=it[0],Ye=it[1],l=(0,L.useRef)(),u=(0,L.useState)(!1),b=(0,m.Z)(u,2),n=b[0],ht=b[1],jr=function(){var $e=(0,A.Z)((0,i.Z)().mark(function sr(){var Y,Dt;return(0,i.Z)().wrap(function(Xt){for(;;)switch(Xt.prev=Xt.next){case 0:Dt=c()().add(Number(4)-1,"days"),l==null||(Y=l.current)===null||Y===void 0||Y.setFieldsValue({nextVisitDate:Dt.format("YYYY-MM-DD HH:mm:ss")});case 2:case"end":return Xt.stop()}},sr)}));return function(){return $e.apply(this,arguments)}}();return(0,L.useEffect)(function(){var $e;he&&(l==null||($e=l.current)===null||$e===void 0||$e.setFieldsValue({studentName:he.name}))},[he]),(0,L.useEffect)(function(){jr()},[]),$.types=="edit"&&$.n===0&&(setTimeout(function(){var $e;l==null||($e=l.current)===null||$e===void 0||$e.setFieldsValue((0,I.Z)((0,I.Z)({},$),{},{type:$.type+"",intention:$.intention+""}))},100),++$.n),$.types=="add"&&$.n===0&&(setTimeout(function(){var $e;l==null||($e=l.current)===null||$e===void 0||$e.setFieldsValue({studentName:$.name})},100),++$.n),(0,a.jsxs)(J.Y,{title:"\u56DE\u8BBF\u5B66\u5458",formRef:l,visible:Ee,width:800,autoFocusFirstInput:!0,modalProps:{onCancel:function(){return s()},destroyOnClose:!0},onFinish:function(){var $e=(0,A.Z)((0,i.Z)().mark(function sr(Y){var Dt;return(0,i.Z)().wrap(function(Xt){for(;;)switch(Xt.prev=Xt.next){case 0:if(!n){Xt.next=4;break}return Xt.abrupt("return");case 4:ht(!0);case 5:o.default.loading("\u52A0\u8F7D\u4E2D",0),Y.updateBy=Ct==null||(Dt=Ct.currentUser)===null||Dt===void 0?void 0:Dt.userid,Y.studentUserId=he?he.id:$.id,$.types=="edit"&&(Y.id=$.id),console.log(Y),p.Z.post(bt,Y).then(function(B){return ht(!1),B.status=="success"?(o.default.destroy(),o.default.success("\u64CD\u4F5C\u6210\u529F"),s(),le(),!0):(o.default.error(B.msg),!1)}).catch(function(B){return ht(!1),o.default.error(B),!1});case 11:case"end":return Xt.stop()}},sr)}));return function(sr){return $e.apply(this,arguments)}}(),children:[(0,a.jsxs)(ne.ZP.Group,{children:[(0,a.jsx)(X.Z,{width:"lg",name:"studentName",label:"\u5B66\u5458",tooltip:"\u6700\u957F\u4E3A 24 \u4F4D",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",required:!0,disabled:!0}),(0,a.jsx)(g.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",disabled:$.types,onClick:(0,A.Z)((0,i.Z)().mark(function $e(){return(0,i.Z)().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:ut(!0);case 1:case"end":return Y.stop()}},$e)})),children:"\u9009\u62E9"})]}),(0,a.jsxs)(ne.ZP.Group,{children:[(0,a.jsx)(x.Z,{label:"\u6C9F\u901A\u65B9\u5F0F",name:"type",width:"md",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u6C9F\u901A\u65B9\u5F0F"}],request:(0,A.Z)((0,i.Z)().mark(function $e(){return(0,i.Z)().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.abrupt("return",r.Z.getList("dict_c_type"));case 1:case"end":return Y.stop()}},$e)}))}),(0,a.jsx)(x.Z,{label:"\u610F\u5411\u7EA7\u522B",name:"intention",width:"md",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u610F\u5411\u7EA7\u522B"}],request:(0,A.Z)((0,i.Z)().mark(function $e(){return(0,i.Z)().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.abrupt("return",r.Z.getList("dict_intention_level"));case 1:case"end":return Y.stop()}},$e)}))})]}),(0,a.jsxs)(ne.ZP.Group,{children:[(0,a.jsx)(X.Z,{label:"\u8DDF\u8FDB\u4EBA",name:"updateBy",width:"md",fieldProps:{value:Ct==null||(ie=Ct.currentUser)===null||ie===void 0?void 0:ie.name,readOnly:!0}}),(0,a.jsx)(F.Z,{width:"md",name:"createTime",label:"\u8DDF\u8FDB\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u8DDF\u8FDB\u65F6\u95F4"}]}),(0,a.jsx)(f.Z,{width:"md",name:"nextVisitDate",label:"\u4E0B\u4E00\u6B21\u8DDF\u8FDB\u65F6\u95F4"})]}),(0,a.jsx)(P.Z,{width:750,label:"\u8DDF\u8FDB\u5185\u5BB9",name:"content",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u8DDF\u8FDB\u5185\u5BB9"}]}),ae&&(0,a.jsx)(d.Z,{modalVisible:ae,setModalVisible:function(){return ut(!1)},renderData:{type:"order"},setStudentId:function(sr){Ft(sr)}})]})}},12156:function(ce,D,e){"use strict";var j=e(49111),g=e(19650),V=e(62350),o=e(24565),I=e(57663),i=e(71577),A=e(71153),m=e(60331),L=e(11849),M=e(34792),d=e(48086),J=e(2824),ne=e(22),X=e(37490),x=e(63863),F=e(67294),f=e(40110),P=e(41574),r=e(7903),p=e(26816),O=e(54493),c=e(79046),a=e(85893),h={\u5E8F\u53F7:"nums",\u5408\u540C\u5BF9\u5E94\u9879\u76EE:"project",\u5F52\u6863\u7F16\u53F7:"filingNum",\u7B7E\u8BA2\u65E5\u671F:"otherSignTime",\u5BF9\u65B9\u5355\u4F4D:"studentName",\u5408\u540C\u603B\u91D1\u989D:"amount",\u6211\u65B9\u5355\u4F4D:"companyName",\u62DB\u751F\u8001\u5E08\u59D3\u540D:"userName",\u90E8\u95E8:"departmentId",\u5408\u540C\u7F16\u53F7:"num"};D.Z=function(ie){var Ee=ie.type,s=Ee===void 0?"":Ee,le=ie.setCompanyId,$=ie.onCancel,bt=ie.mobile,pe=bt===void 0?!1:bt,Ct=(0,F.useState)(null),gt=(0,J.Z)(Ct,2),et=gt[0],ae=gt[1],ut=(0,F.useState)(!1),ot=(0,J.Z)(ut,2),tr=ot[0],he=ot[1],Ft=(0,F.useState)(!1),gr=(0,J.Z)(Ft,2),it=gr[0],t=gr[1],Ye=(0,F.useState)(!1),l=(0,J.Z)(Ye,2),u=l[0],b=l[1],n=(0,F.useState)([]),ht=(0,J.Z)(n,2),jr=ht[0],$e=ht[1],sr=(0,F.useState)([]),Y=(0,J.Z)(sr,2),Dt=Y[0],re=Y[1],Xt=(0,F.useState)(),B=(0,J.Z)(Xt,2),Z=B[0],nr=B[1],De=(0,F.useRef)(),xr="/sms/business/bizStudentUser",zt=function(){De.current.reload()},Ut=function(Bt){x.Z.post("/sms/contract/conContract/filing",{id:Bt}).then(function(Ie){Ie.status=="success"&&(d.default.success("\u64CD\u4F5C\u6210\u529F"),zt())})};(0,F.useEffect)(function(){X.Z.getDepartmentName()},[]);var Gt=[{title:"\u5408\u540C\u7F16\u53F7",dataIndex:"num",width:130,sorter:!0,fixed:"left"},{width:100,title:"\u5408\u540C\u540D\u79F0",dataIndex:"name",sorter:!0},{title:"\u5B66\u5458\u59D3\u540D",width:100,dataIndex:"studentName",render:function(Bt,Ie){return(0,a.jsx)("a",{onClick:function(){x.Z.get(xr,{id:Ie.studentUserId}).then(function(Je){ae((0,L.Z)({},Je.data.content[0])),he(!0)})},children:Ie.studentName})}},{width:100,title:"\u5B66\u5458\u7C7B\u578B",dataIndex:"type",filters:!0,filterMultiple:!1,valueType:"select",valueEnum:{0:{text:"\u4E2A\u4EBA"},1:{text:"\u4F01\u4E1A/\u540C\u884C\u673A\u6784"},2:{text:"\u4EE3\u7406\u4EBA"}},render:function(Bt,Ie){return(0,a.jsx)("span",{children:X.Z.getName("studentType",Ie.type)})}},{width:100,title:"\u9879\u76EE\u603B\u79F0",dataIndex:"parentProjects",key:"parentProjects",sorter:!0,valueType:"cascader",fieldProps:{options:X.Z.getList("dict_reg_job"),showSearch:{filter:O.Z}},render:function(Bt,Ie){return(0,a.jsx)("span",{children:X.Z.getCascaderAllName("dict_reg_job",Ie.project)},"parentProjects")}},{width:100,title:"\u5BF9\u5E94\u9879\u76EE",dataIndex:"project",key:"project",sorter:!0,valueType:"cascader",fieldProps:{options:X.Z.getCascader("dict_reg_job"),showSearch:{filter:O.Z}},render:function(Bt,Ie){return(0,a.jsx)("span",{children:X.Z.getCascaderName("dict_reg_job",Ie.project)})}},{width:100,title:"\u5408\u540C\u91D1\u989D",dataIndex:"amount"},{width:100,title:"\u7B7E\u7F72\u8001\u5E08",dataIndex:"userName"},{width:90,title:"\u5907\u6CE8",dataIndex:"description",ellipsis:!0,tip:"\u8FC7\u957F\u4F1A\u81EA\u52A8\u6536\u7F29"},{width:100,title:"\u7B7E\u7F72\u72B6\u6001",dataIndex:"isFinish",filters:!0,filterMultiple:!1,valueType:"select",valueEnum:{false:{text:"\u672A\u7B7E\u7F72"},true:{text:"\u5DF2\u7B7E\u7F72"}},render:function(Bt,Ie){return(0,a.jsx)(m.Z,{color:Ie.isFinish?"#87d068":"#FF0000",children:Ie.isFinish?"\u5DF2\u7B7E\u7F72":"\u672A\u7B7E\u7F72"})}},{width:100,title:"\u7B7E\u7F72\u65F6\u95F4",key:"otherSignTime",dataIndex:"otherSignTime",valueType:"dateRange",sorter:!0,render:function(Bt,Ie){return(0,a.jsx)("span",{children:Ie.otherSignTime})}},{width:100,title:"\u5F52\u6863\u72B6\u6001",dataIndex:"filingNum",filters:!0,filterMultiple:!1,valueType:"select",valueEnum:{null:{text:"\u672A\u5F52\u6863"},GD:{text:"\u5DF2\u5F52\u6863"}},render:function(Bt,Ie){return(0,a.jsx)(m.Z,{color:Ie!=null&&Ie.filingNum?"#87d068":"#FF0000",children:Ie.filingNum?"\u5DF2\u5F52\u6863":"\u672A\u5F52\u6863"})}},{title:"\u5F52\u6863\u7F16\u53F7",dataIndex:"filingNum",width:130,sorter:!0},{width:100,title:"\u5BA1\u6838\u65F6\u95F4",key:"auditTime",dataIndex:"auditTime",valueType:"dateRange",sorter:!0,render:function(Bt,Ie){return(0,a.jsx)("span",{children:Ie.auditTime})}},{width:100,title:"\u521B\u5EFA\u65F6\u95F4",key:"createTime",dataIndex:"createTime",valueType:"dateRange",sorter:!0,render:function(Bt,Ie){return(0,a.jsx)("span",{children:Ie.createTime})}},{width:100,title:"\u5408\u540C\u72B6\u6001",key:"isRepealed",dataIndex:"isRepealed",valueType:"dateRange",sorter:!0,render:function(Bt,Ie){return(0,a.jsx)(m.Z,{color:Ie.isRepealed=="1"?"#FF0000":"#87d068",children:Ie.isRepealed=="1"?"\u5DF2\u5E9F\u9664":"\u751F\u6548\u4E2D"})}},{width:100,title:"\u67E5\u770B",dataIndex:"options",search:!1,render:function(Bt,Ie){return[(0,a.jsx)(i.Z,{type:"primary",size:"small",hidden:s==="contract",icon:(0,a.jsx)(f.Z,{}),style:{marginRight:"15px"},onClick:function(){ae(Ie),b(!0)}},"eidt"),(0,a.jsx)(i.Z,{hidden:s==="",type:"primary",onClick:function(){le(Ie),$()},children:"\u9009\u62E9"},"xuanze")]}},{title:"\u64CD\u4F5C",search:!1,fixed:"right",width:90,render:function(Bt,Ie){return[(0,a.jsx)(o.Z,{title:"\u662F\u5426\u5F52\u6863",onConfirm:function(){Ut(Ie.id)},okText:"\u5F52\u6863",children:(0,a.jsx)(i.Z,{type:"primary",size:"small",style:{marginBottom:"10px"},children:"\u5408\u540C\u5F52\u6863"},"guidang")}),(0,a.jsx)(o.Z,{title:"\u662F\u5426\u5E9F\u9664",okText:"\u5E9F\u9664",cancelText:"\u53D6\u6D88",onConfirm:function(){x.Z.post("/sms/contract/conContract/repealed",{id:Ie.id}).then(function(Je){Je.status=="success"&&(d.default.success("\u64CD\u4F5C\u6210\u529F!"),zt())})},children:(0,a.jsx)(i.Z,{type:"primary",size:"small",danger:!0,style:{marginBottom:"10px"},children:"\u5E9F\u9664\u5408\u540C"},"delete")},"deletes"),(0,a.jsx)(i.Z,{type:"primary",size:"small",href:Ie.downloadUrl,children:"\u5408\u540C\u4E0B\u8F7D"},"upDown")]}}],kt={};return kt.auditType=5,kt.confirm=!0,pe&&(kt.mobile=pe),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ne.Z,{actionRef:De,columns:Gt,request:{url:"/sms/contract/conContract",params:kt},search:{defaultCollapsed:!0,defaultColsNumber:10},scroll:{x:1500},rowSelection:{onChange:function(Bt,Ie){$e(Bt),re(Ie)}},tableAlertOptionRender:function(){return(0,a.jsxs)(g.Z,{size:24,children:[(0,a.jsx)("a",{onClick:function(){if(Dt.length==0){d.default.error("\u8BF7\u9009\u62E9\u9700\u8981\u5BFC\u51FA\u7684\u5408\u540C\uFF01");return}(0,c.Z)(Dt,h,"\u5408\u540C\u4FE1\u606F","charge")},children:"\u6279\u91CF\u5BFC\u51FA"}),(0,a.jsx)("a",{onClick:function(){Ut(jr.join(","))},children:"\u6279\u91CF\u5F52\u6863"})]})}}),(0,a.jsx)(P.Z,{previewVisible:it,setPreviewVisible:function(){return t(!1)},previewImage:Z}),tr&&(0,a.jsx)(r.Z,{setModalVisible:function(){return he(!1)},modalVisible:tr,renderData:et,callbackRef:function(){return zt()}}),u&&(0,a.jsx)(p.Z,{setModalVisibles:function(){return b(!1)},ModalVisibles:u,renderData:et})]})}},26816:function(ce,D,e){"use strict";var j=e(57338),g=e(273),V=e(71153),o=e(60331),I=e(98858),i=e(4914),A=e(2824),m=e(67294),L=e(37490),M=e(86707),d=e(85893);D.Z=function(J){var ne=J.ModalVisibles,X=J.setModalVisibles,x=J.renderData,F=(0,m.useState)((0,M.Z)()),f=(0,A.Z)(F,2),P=f[0],r=f[1];return(0,d.jsxs)(g.Z,{placement:"right",onClose:function(){return X()},open:ne,width:P.innerWidth/1.5,children:[(0,d.jsxs)(i.Z,{title:"\u5408\u540C\u8BE6\u60C5",bordered:!0,size:"small",children:[(0,d.jsx)(i.Z.Item,{label:"\u5408\u540C\u7F16\u53F7",children:x.num}),(0,d.jsx)(i.Z.Item,{label:"\u7B7E\u7F72\u4EBA\u59D3\u540D",children:x.studentName}),(0,d.jsx)(i.Z.Item,{label:"\u7B7E\u7F72\u4EBA\u7C7B\u578B",children:L.Z.getName("studentType",x.type)}),(0,d.jsx)(i.Z.Item,{label:"\u5408\u540C\u540D\u79F0",children:x.name}),(0,d.jsx)(i.Z.Item,{label:"\u5408\u540C\u91D1\u989D",children:x.amount}),(0,d.jsx)(i.Z.Item,{label:"\u7B7E\u7F72\u8001\u5E08",children:x.userName}),(0,d.jsx)(i.Z.Item,{label:"\u5BF9\u5E94\u9879\u76EE",children:L.Z.getCascaderName("dict_reg_job",x.project)}),(0,d.jsx)(i.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:x.createTime}),(0,d.jsx)(i.Z.Item,{label:"\u5BA1\u6838\u65F6\u95F4",children:x.auditTime?x.auditTime:(0,d.jsx)(o.Z,{color:"#FF0000",children:"\u672A\u5BA1\u6838"})}),(0,d.jsx)(i.Z.Item,{label:"\u5BA1\u6838\u72B6\u6001",children:(0,d.jsx)(o.Z,{color:x.auditType==5?"#87d068":"#FF0000",children:x.auditType==5?"\u5DF2\u5BA1\u6838":"\u672A\u5BA1\u6838"})}),(0,d.jsx)(i.Z.Item,{label:"\u5BA1\u6838\u4EBA",children:x.auditor}),(0,d.jsx)(i.Z.Item,{label:"\u5BA1\u6838\u5EFA\u8BAE",children:x.remark}),(0,d.jsx)(i.Z.Item,{label:"\u7B7E\u7F72\u72B6\u6001",children:(0,d.jsx)(o.Z,{color:x.isFinish?"#87d068":"#FF0000",children:x.isFinish?"\u5DF2\u7B7E\u7F72":"\u672A\u7B7E\u7F72"})}),(0,d.jsx)(i.Z.Item,{label:"\u7B7E\u7F72\u65F6\u95F4",children:x.otherSignTime?x.otherSignTime:(0,d.jsx)(o.Z,{color:"#FF0000",children:"\u672A\u7B7E\u7F72"})}),(0,d.jsx)(i.Z.Item,{label:"\u5F52\u6863\u72B6\u6001",children:(0,d.jsx)(o.Z,{color:x!=null&&x.filingNum?"#87d068":"#FF0000",children:x.filingNum?"\u5DF2\u5F52\u6863":"\u672A\u5F52\u6863"})})]}),(0,d.jsx)("iframe",{src:x.viewUrl,style:{width:"100%",height:"600px"}})]})}},37423:function(ce,D,e){"use strict";var j=e(71194),g=e(50146),V=e(402),o=e(97272),I=e(21010),i=e(90437),A=e(85893),m=o.Z.Title,L=o.Z.Paragraph,M=o.Z.Text;D.Z=function(d){var J=d.setModalVisible,ne=d.modalVisible,X=d.renderData,x=d.callbackRef,F=d.placeAnOrder;console.log(X,"dnmd");var f=X.chargeType=="0"?"\u7F34\u8D39":"\u9000\u8D39",P=function(p){p==0?I.m8.push("/business/oldcharge/charges/audit"):I.m8.push("/business/oldcharge/refundCharges/audit")};return(0,A.jsx)(g.Z,{title:(0,A.jsxs)(o.Z,{children:[(0,A.jsxs)(m,{style:{fontSize:"20px"},children:["\u8BF7\u9009\u62E9\u8BA2\u5355\u8FDB\u884C",f]}),(0,A.jsxs)(L,{style:{fontSize:"14px"},children:["\u5982\u679C\u4E0B\u5217\u8868\u683C\u4E3A\u7A7A,\u800C\u4F60\u9700\u8981\u4E0B\u5355\u8BF7\u5148\u53BB",(0,A.jsx)("a",{onClick:function(){F(X),J()},children:"\u65B0\u589E\u8BA2\u5355!"})]}),(0,A.jsxs)(L,{style:{fontSize:"14px"},children:["\u5982\u679C\u662F\u8001\u7CFB\u7EDF\u5B66\u5458\u9700\u8981\u7ED9\u8001\u7CFB\u7EDF\u7684\u8BA2\u5355\u7F34\u7EB3\u5C3E\u6B3E\u6216\u8005\u7ED9\u8001\u7CFB\u7EDF\u7684\u8BA2\u5355\u8FDB\u884C\u9000\u8D39,\u8BF7\u53BB\u5386\u53F2\u9057\u7559\u8FDB\u884C",(0,A.jsx)("a",{onClick:function(){return P(0)},children:"\u7F34\u8D39"}),"\u6216 ",(0,A.jsx)("a",{onClick:function(){return P(1)},children:"\u9000\u8D39"}),"!"]})]}),open:ne,onCancel:function(){return J()},footer:null,width:1500,children:(0,A.jsx)(i.Z,{studentUserId:X.id,type:X.type,showType:X.Type,showStudentBtn:X.chargeBtn})})}},6274:function(ce,D,e){"use strict";e.d(D,{Z:function(){return Tt}});var j=e(39428),g=e(3182),V=e(71194),o=e(50146),I=e(32059),i=e(49111),A=e(19650),m=e(62350),L=e(24565),M=e(57663),d=e(71577),J=e(22385),ne=e(94199),X=e(71153),x=e(60331),F=e(11849),f=e(34792),P=e(48086),r=e(2824),p=e(67294),O=e(40110),c=e(79278),a=e(3248),h=e(31223),ie=e(51042),Ee=e(54977),s=e(90631),le=e(63863),$=e(37490),bt=e(66371),pe=e(86582),Ct=e(47673),gt=e(4107),et=e(21010),ae=e(952),ut=e(64317),ot=e(37476),tr=e(8214),he=e(45510),Ft=e(5966),gr=e(80876),it=e(90672),t=e(85893),Ye=gt.Z.Search,l=function(Pe){var ze,Ae=Pe.modalVisible,Rt=Pe.setModalVisible,S=Pe.renderData,Xe=Pe.url,we=(0,et.tT)("@@initialState"),qe=we.initialState,Yt=(0,p.useState)(!1),Te=(0,r.Z)(Yt,2),N=Te[0],y=Te[1],W=(0,p.useState)(),k=(0,r.Z)(W,2),xe=k[0],ye=k[1],Ne=(0,p.useState)(),je=(0,r.Z)(Ne,2),q=je[0],G=je[1],K=(0,p.useState)([]),Et=(0,r.Z)(K,2),yt=Et[0],er=Et[1],Se=(0,p.useState)([]),Vt=(0,r.Z)(Se,2),Nt=Vt[0],tt=Vt[1],ir=(0,p.useState)(""),wt=(0,r.Z)(ir,2),Or=wt[0],We=wt[1],Le=function(lt){Nt.includes(lt)?tt(Nt.filter(function(Ze){return Ze!==lt})):tt([].concat((0,pe.Z)(Nt),[lt]))},ve=function(lt){We(lt.id),setTimeout(function(){var Ze;_r==null||(Ze=_r.current)===null||Ze===void 0||Ze.setFieldsValue({content:lt.content,project:$.Z.getCascaderValue("dict_reg_job",lt.project),type:$.Z.getName("dict_c_type",lt.type),intention:$.Z.getName("dict_intention_level",lt.intention),createTime:lt.createTime,nextVisitDate:lt.nextVisitDate})},100),y(!0)};(0,p.useEffect)(function(){ct()},[Xe]);var st={studentUserId:S.id},ct=function(){var Re=(0,g.Z)((0,j.Z)().mark(function lt(){var Ze;return(0,j.Z)().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,le.Z.get(Xe,st);case 2:Ze=Q.sent,er(Ze.data.content);case 4:case"end":return Q.stop()}},lt)}));return function(){return Re.apply(this,arguments)}}(),br=function(){var Re=(0,g.Z)((0,j.Z)().mark(function lt(Ze){var cr;return(0,j.Z)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,le.Z.get(Xe,{content:Ze,studentUserId:S.id});case 2:cr=ee.sent,er(cr.data.content);case 4:case"end":return ee.stop()}},lt)}));return function(Ze){return Re.apply(this,arguments)}}(),_r=(0,p.useRef)(),Fr=(0,p.useRef)(null),Ir=sessionStorage.getItem("tokenName"),Ar=sessionStorage.getItem("tokenValue"),Ge={};Ar!==null?Ge[Ir]=Ar:console.error("Token value is null");var Pr=function(){var Re=(0,g.Z)((0,j.Z)().mark(function lt(Ze,cr){var Q,ee,T;return(0,j.Z)().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:Q=sessionStorage.getItem("tokenName"),ee=sessionStorage.getItem("tokenValue"),T="/sms/business/bizReturnVisit/download?id="+Ze+"&fileName="+cr+"&"+Q+"="+ee,ye(T),G(!0);case 5:case"end":return U.stop()}},lt)}));return function(Ze,cr){return Re.apply(this,arguments)}}(),wr=function(){console.log(Or),y(!0)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.Z,{width:1200,title:"\u8DDF\u8FDB\u8BB0\u5F55",open:Ae,onCancel:function(){return Rt(!1)},footer:null,children:[(0,t.jsxs)("div",{className:"header_top",children:[(0,t.jsxs)("p",{children:["\u59D3\u540D\uFF1A",S.name]}),(0,t.jsxs)("p",{children:["\u8054\u7CFB\u7535\u8BDD\uFF1A",S.mobile]}),(0,t.jsxs)("p",{children:["\u5FAE\u4FE1\u53F7\uFF1A",S.weChat||"\u672A\u586B\u5199"]})]}),(0,t.jsxs)("div",{className:"header_search",children:[(0,t.jsxs)("div",{className:"search_left",children:[(0,t.jsx)(Ye,{style:{width:"200px",marginLeft:"20px"},placeholder:"\u8F93\u5165\u8DDF\u8FDB\u5185\u5BB9",onSearch:br,enterButton:!0}),(0,t.jsx)(ut.Z,{style:{width:"200px",marginTop:"24px"},name:"type",width:"xl",placeholder:"\u8BF7\u9009\u62E9\u6C9F\u901A\u7C7B\u578B",fieldProps:{onChange:function(){var Re=(0,g.Z)((0,j.Z)().mark(function Ze(cr){var Q,ee;return(0,j.Z)().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(cr){me.next=7;break}return me.next=3,le.Z.get(Xe,{studentUserId:S.id});case 3:Q=me.sent,er(Q.data.content),me.next=11;break;case 7:return me.next=9,le.Z.get(Xe,{type:cr,studentUserId:S.id});case 9:ee=me.sent,er(ee.data.content);case 11:case"end":return me.stop()}},Ze)}));function lt(Ze){return Re.apply(this,arguments)}return lt}()},request:(0,g.Z)((0,j.Z)().mark(function Re(){return(0,j.Z)().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return Ze.abrupt("return",$.Z.getList("dict_c_type"));case 1:case"end":return Ze.stop()}},Re)}))})]}),(0,t.jsx)("div",{className:"search_right",children:(0,t.jsx)(d.Z,{type:"primary",onClick:wr,children:"\u6DFB\u52A0\u8DDF\u8FDB\u8BB0\u5F55"},"add-follow-record")})]}),(0,t.jsxs)("div",{className:"header_bottom",children:[(0,t.jsxs)("div",{className:"table_header",children:[(0,t.jsx)("div",{children:"\u6C9F\u901A\u7C7B\u578B"}),(0,t.jsx)("div",{children:"\u8DDF\u8FDB\u9879\u76EE"}),(0,t.jsx)("div",{children:"\u8DDF\u8FDB\u5185\u5BB9"}),(0,t.jsx)("div",{children:"\u8DDF\u8FDB\u65F6\u95F4"}),(0,t.jsx)("div",{children:"\u8DDF\u8FDB\u4EBA"}),(0,t.jsx)("div",{children:"\u4E0B\u6B21\u8DDF\u8FDB\u65F6\u95F4"}),(0,t.jsx)("div",{children:"\u64CD\u4F5C"})]}),(0,t.jsx)("div",{className:"table_content",children:yt.map(function(Re){return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"header_content_top",children:[(0,t.jsx)("div",{children:$.Z.getName("dict_c_type",Re.type)}),(0,t.jsx)("div",{children:$.Z.getCascaderName("dict_reg_job",Re.project)}),(0,t.jsx)("div",{children:Re.content}),(0,t.jsx)("div",{children:Re.createTime}),(0,t.jsx)("div",{children:Re.userName}),(0,t.jsx)("div",{children:Re.nextVisitDate}),(0,t.jsxs)("div",{children:[(0,t.jsx)("a",{onClick:function(){return Le(Re.id)},children:Nt.includes(Re.id)?"\u6536\u8D77":"\u8BE6\u60C5"}),",",(0,t.jsx)("a",{onClick:function(){return ve(Re)},children:"\u7F16\u8F91"})]})]}),Nt.includes(Re.id)&&(0,t.jsxs)("div",{className:"header_content",children:[(0,t.jsx)("div",{className:"content_top",children:(0,t.jsxs)("div",{className:"projectName",children:[(0,t.jsxs)("div",{className:"left",children:[$.Z.getCascaderName("dict_reg_job",Re.project)," "]}),(0,t.jsxs)("div",{children:["\u8DDF\u8FDB\u4EBA\uFF1A",Re.userName]})]})}),(0,t.jsxs)("div",{className:"content_middle",style:{marginTop:"20px"},children:["\u6C9F\u901A\u5185\u5BB9\uFF1A",Re.content]}),(0,t.jsxs)("div",{className:"content_middle",children:["\u4E0B\u6B21\u8DDF\u8FDB\u65F6\u95F4\uFF1A",Re.nextVisitDate]}),(0,t.jsx)("div",{className:"content_middle",children:(0,t.jsx)(d.Z,{onClick:function(){return Pr(Re.id,Re.file)},type:"primary",size:"small",children:"\u67E5\u770B\u56FE\u7247"})})]})]})})})]})]}),(0,t.jsx)(ot.Y,{title:Or?"\u7F16\u8F91":"\u65B0\u5EFA",formRef:_r,visible:N,width:1e3,autoFocusFirstInput:!0,modalProps:{onCancel:function(){y(!1),We("")},destroyOnClose:!0},onFinish:function(){var Re=(0,g.Z)((0,j.Z)().mark(function lt(Ze){var cr,Q;return(0,j.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:Ze.project&&(Ze.project=Ze.project[Ze.project.length-1]),Ze.studentUserId=S.id,Ze.updateBy=qe==null||(cr=qe.currentUser)===null||cr===void 0?void 0:cr.userid,Ze.filess&&(Q=[],Ze.filess.forEach(function(me){Q.push(me.response.data)}),delete Ze.filess,Ze.file=Q.join(","),console.log(Ze.files)),Ze.files=Ze.files,console.log(Ze,"values"),We(""),Or&&(Ze.id=Or,Ze.type=$.Z.getValue("dict_c_type",Ze.type),Ze.intention=$.Z.getValue("dict_intention_level",Ze.intention)),le.Z.post(Xe,Ze).then(function(me){return me.status=="success"&&(P.default.success("\u64CD\u4F5C\u6210\u529F"),y(!1),ct()),!0}).catch(function(me){return!0});case 9:case"end":return T.stop()}},lt)}));return function(lt){return Re.apply(this,arguments)}}(),children:(0,t.jsxs)(ae.ZP.Group,{children:[(0,t.jsx)(tr.Z,{width:"sm",name:"project",placeholder:"\u54A8\u8BE2\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:$.Z.getCascader("dict_reg_job"),onSearch:function(lt){return console.log(lt)}}}),(0,t.jsx)(ut.Z,{label:"\u6C9F\u901A\u65B9\u5F0F",name:"type",width:"sm",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u6C9F\u901A\u65B9\u5F0F"}],request:(0,g.Z)((0,j.Z)().mark(function Re(){return(0,j.Z)().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return Ze.abrupt("return",$.Z.getList("dict_c_type"));case 1:case"end":return Ze.stop()}},Re)}))}),(0,t.jsx)(ut.Z,{label:"\u610F\u5411\u7EA7\u522B",name:"intention",width:"sm",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u610F\u5411\u7EA7\u522B"}],request:(0,g.Z)((0,j.Z)().mark(function Re(){return(0,j.Z)().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return Ze.abrupt("return",$.Z.getList("dict_intention_level"));case 1:case"end":return Ze.stop()}},Re)}))}),(0,t.jsx)(he.Z,{name:"createTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"sm",label:"\u8DDF\u8FDB\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8DDF\u8FDB\u65F6\u95F4"}]}),(0,t.jsx)(he.Z,{name:"nextVisitDate",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"sm",label:"\u4E0B\u6B21\u8DDF\u8FDB\u65F6\u95F4"}),(0,t.jsx)(Ft.Z,{label:"\u8DDF\u8FDB\u4EBA",name:"updateBy",width:"md",fieldProps:{value:qe==null||(ze=qe.currentUser)===null||ze===void 0?void 0:ze.name,readOnly:!0}}),(0,t.jsx)(gr.Z,{width:"xl",label:"\u4E0A\u4F20\u56FE\u7247",name:"filess",action:"/sms/business/bizReturnVisit/upload",fieldProps:{multiple:!0,headers:(0,F.Z)({},Ge),accept:"image/*",listType:"picture",onRemove:function(lt){},beforeUpload:function(lt){console.log("file",lt);var Ze=lt.type.startsWith("image/");return Ze?!0:(P.default.error("\u53EA\u80FD\u4E0A\u4F20\u56FE\u7247"),!1)},onPreview:function(){var Re=(0,g.Z)((0,j.Z)().mark(function Ze(cr){return(0,j.Z)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:console.log("file",cr),!cr.url&&!cr.preview&&console.log("1");case 2:case"end":return ee.stop()}},Ze)}));function lt(Ze){return Re.apply(this,arguments)}return lt}(),onChange:function(lt){var Ze=lt.file.status;Ze==="done"?P.default.success("".concat(lt.file.name," \u4E0A\u4F20\u6210\u529F.")):Ze==="error"&&P.default.error("".concat(lt.file.name," \u4E0A\u4F20\u5931\u8D25."))}}}),(0,t.jsx)(it.Z,{width:800,label:"\u8DDF\u8FDB\u5185\u5BB9",name:"content",rules:[{required:!0}]})]})}),(0,t.jsx)(o.Z,{title:"\u8DDF\u8FDB\u8BB0\u5F55\u56FE",width:400,open:q,onOk:function(){G(!1)},onCancel:function(){G(!1)},children:(0,t.jsx)("img",{style:{width:"100%"},src:xe})})]})},u=e(7903),b=e(92205),n=e(20228),ht=e(11382),jr=e(88983),$e=e(55742),sr=e(35556),Y=e(75899),Dt=e(5909),re=e(26802),Xt=e(76294),B=e(90437),Z=e(30381),nr=e.n(Z),De=e(68855),xr=e(35338),zt=Y.Z.Step,Ut=o.Z.confirm,Gt=function(Pe){var ze,Ae,Rt=Pe.modalVisible,S=Pe.setModalVisible,Xe=Pe.callbackRef,we=Pe.renderData,qe=Pe.admin,Yt=Pe.callback,Te=(0,et.tT)("@@initialState"),N=Te.initialState,y=N==null||(ze=N.currentUser)===null||ze===void 0?void 0:ze.userid,W=(0,p.useState)(0),k=(0,r.Z)(W,2),xe=k[0],ye=k[1],Ne=(0,p.useState)(),je=(0,r.Z)(Ne,2),q=je[0],G=je[1],K=(0,p.useState)(),Et=(0,r.Z)(K,2),yt=Et[0],er=Et[1],Se=(0,p.useState)(),Vt=(0,r.Z)(Se,2),Nt=Vt[0],tt=Vt[1],ir=(0,p.useState)(!1),wt=(0,r.Z)(ir,2),Or=wt[0],We=wt[1],Le=(0,p.useState)(),ve=(0,r.Z)(Le,2),st=ve[0],ct=ve[1],br=(0,p.useState)(),_r=(0,r.Z)(br,2),Fr=_r[0],Ir=_r[1],Ar=(0,p.useState)(),Ge=(0,r.Z)(Ar,2),Pr=Ge[0],wr=Ge[1],Re=(0,p.forwardRef)(Dt.Z),lt=(0,p.forwardRef)(re.Z),Ze=(0,p.forwardRef)(Xt.Z),cr=(0,p.useState)(!1),Q=(0,r.Z)(cr,2),ee=Q[0],T=Q[1],me=(0,p.useRef)(),U=(0,p.useRef)(),Me=$.Z.list.find(function(H){return H.code=="chargeType"}).children.filter(function(H){return["0","4","5","6"].includes(H.value)}).map(function(H){return{style:{margin:"20px 150px 0px",display:"block"},label:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("b",{children:H.name}),H.description&&"\uFF1A"+H.description]}),value:H.value,sort:H.sort}}).sort(function(H,w){return H.sort-w.sort})||[{}];console.log("chargeTypeOptions",$.Z.list),console.log("chargeTypeOptions",Me);var It=we.type===1?[{title:"\u4E0B\u5355",content:(0,t.jsx)(Re,{ref:me,renderData:we,admin:"step"})},{title:"\u9009\u62E9\u7F34\u8D39\u65B9\u5F0F",content:(0,t.jsx)($e.ZP.Group,{onChange:function(w){ct(w.target.value)},name:"chargeType",options:Me})},{title:"\u7F34\u8D39",content:(0,t.jsx)(Ze,{ref:U,renderData:q,chargeType:st==null?void 0:st.toString(),admin:"step"})},{title:"\u6DFB\u52A0\u5B66\u5458",content:(0,t.jsx)(B.Z,{orderId:yt,type:"1",orderIds:[yt]})}]:[{title:"\u4E0B\u5355",content:(0,t.jsx)(Re,{ref:me,renderData:we,admin:"step"})},{title:"\u9009\u62E9\u7F34\u8D39\u65B9\u5F0F",content:(0,t.jsx)($e.ZP.Group,{onChange:function(w){ct(w.target.value)},name:"chargeType",options:Me})},{title:"\u7F34\u8D39",content:(0,t.jsx)(Ze,{ref:U,renderData:q,chargeType:st==null?void 0:st.toString(),admin:"step"})},{title:"\u83B7\u53D6\u7F34\u8D39\u4FE1\u606F",content:(0,t.jsx)(t.Fragment,{children:Nt})}],be=function(){S(!1),Xe()},z=function(w,C,Oe){Ut({title:w.title,icon:(0,t.jsx)(De.Z,{}),content:w.content,onOk:function(){C()},onCancel:function(){var nt="/business/businessorder?studentName=".concat(we.name,"&project=").concat(Oe.project,"&classType=").concat(Oe.classType,"&classYear=").concat(Oe.classYear,"&examType=").concat(Oe.examType);et.m8.push(nt)},okText:"\u7EE7\u7EED\u4E0B\u5355\u7F34\u8D39",cancelText:"\u524D\u5F80\u8BA2\u5355\u5217\u8868"})},He=function(){var H=(0,g.Z)((0,j.Z)().mark(function w(){return(0,j.Z)().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:case"end":return Oe.stop()}},w)}));return function(){return H.apply(this,arguments)}}(),Sr=function(){var H=(0,g.Z)((0,j.Z)().mark(function w(){var C,Oe,Ce,nt,pr,Qt,mt,hr;return(0,j.Z)().wrap(function(Br){for(;;)switch(Br.prev=Br.next){case 0:if(xe!=0){Br.next=24;break}return C=me.current.formRefs.current.getFieldsValue(),Oe=C,Ce=Oe.standards,nt=[],Br.next=6,Ce.forEach(function(){var Vr=(0,g.Z)((0,j.Z)().mark(function Wr(rr,Nr){return(0,j.Z)().wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:rr.provider&&(typeof rr.provider=="number"?rr.provider=rr.provider:rr.provider=rr.provider.value),rr.discount||(nt[Nr]=!0),rr.discount!==0?(nt[Nr]=!0,!rr.discountRemark||rr.discountRemark===""||rr.discountRemark===void 0?nt[Nr]=!0:nt[Nr]=!1):nt[Nr]=!1;case 2:case"end":return Tr.stop()}},Wr)}));return function(Wr,rr){return Vr.apply(this,arguments)}}());case 6:if(C=(0,F.Z)((0,F.Z)({},C),C.standards[0]),!(!C.JobClassExam||C.project==""||!C.provider||nt.indexOf(!0)>=0)){Br.next=10;break}return P.default.error("\u6709\u9009\u9879\u672A\u586B\u5B8C!"),Br.abrupt("return");case 10:return pr=JSON.parse(C.JobClassExam),We(!0),Qt={parentId:"-1",enable:!0,idCard:we.idCard,jobClassExam:pr},Br.next=15,le.Z.get("/sms/business/bizOrder",Qt);case 15:if(mt=Br.sent.data.content,console.log("values",C),hr=function(){me.current.submitAddNew(C).then(function(){var Wr=(0,g.Z)((0,j.Z)().mark(function rr(Nr){var tu;return(0,j.Z)().wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(Nr.status!=="success"){lr.next=10;break}return lr.next=3,le.Z.get("/sms/business/bizOrder",{"id-in":Nr.data.join(",")});case 3:tu=lr.sent.data.content,tu.forEach(function(Xr){Xr.orderId=Xr.id}),G({list:tu,type:"add"}),wr(tu[0]),er(Nr.data.join(",")),We(!1),ye(1);case 10:case"end":return lr.stop()}},rr)}));return function(rr){return Wr.apply(this,arguments)}}())},!(mt.length>0&&mt.every(function(Vr){return Vr.status===0})&&Ce.length<=1)){Br.next=23;break}return z({title:"\u8BE5\u5B66\u5458\u5DF2\u7ECF\u6709\u9009\u62E9\u7684\u9879\u76EE\u73ED\u578B\u8BA2\u5355",content:"\u8BF7\u9009\u62E9\u662F\u5426\u7EE7\u7EED\u4E0B\u76F8\u540C\u9879\u76EE\u8BA2\u5355"},hr,Qt),Br.abrupt("return");case 23:hr();case 24:xe==1&&(st==null?P.default.error("\u8BF7\u9009\u62E9\u7F34\u8D39\u65B9\u5F0F\uFF01"):(ye(2),setTimeout(function(){U.current.formRefs.current.setFieldsValue({type:st+""})},1e3))),xe==2&&(T(!0),mr("next"));case 26:case"end":return Br.stop()}},w)}));return function(){return H.apply(this,arguments)}}(),Jt=function(){be()},mr=function(w){var C=U.current.formRefs.current.getFieldsValue();if(C.discount&&C.discountRemark===void 0){P.default.error("\u8BF7\u586B\u5199\u4F18\u60E0\u539F\u56E0"),T(!1),We(!1);return}if(C.paymentTime===void 0&&["4","5"].indexOf(C.type)==-1){P.default.error("\u8BF7\u586B\u5199\u5230\u8D26\u65E5\u671F"),T(!1),We(!1);return}if(C.method===void 0){P.default.error("\u8BF7\u586B\u5199\u4ED8\u6B3E\u65B9\u5F0F"),T(!1),We(!1);return}C.fFalg=="false"&&delete C.fapiao,Object.keys(C).forEach(function(Oe){C[Oe]==null&&delete C[Oe]}),C.paymentTime=nr()(C.paymentTime).format("YYYY-MM-DD HH:mm:ss"),C.chargeTime=nr()(C.chargeTime).format("YYYY-MM-DD HH:mm:ss"),C.nextPaymentTime=nr()(C.nextPaymentTime).format("YYYY-MM-DD HH:mm:ss"),U.current.submitok(C).then(function(Oe){Oe.status==="success"?w=="next"?(T(!1),We(!1),Ir(Oe.data[0]),C.type==0&&(tt((0,t.jsx)("div",{style:{textAlign:"center",marginTop:"75px",fontSize:"25px"},children:"\u5DF2\u63D0\u4EA4\u7F34\u8D39\uFF0C\u8BF7\u7B49\u5F85\u8D22\u52A1\u5BA1\u6838"})),ye(3)),C.type==4&&le.Z.get("/sms/business/bizCharge",{id:Oe.data[0]}).then(function(Ce){if(Ce.status=="success"){T(!1);var nt=sessionStorage.getItem("tokenName"),pr=sessionStorage.getItem("tokenValue");tt((0,t.jsx)(xr.Z,{src:"/sms/business/bizChargeQrcode/download?id="+Ce.data.content[0].chargeQrcodeId+"&fileName="+Ce.data.content[0].file+"&"+nt+"="+pr,order:Pr,charge:Ce.data.content[0]})),ye(3)}}),C.type==5&&le.Z.get("/sms/business/bizCharge",{id:Oe.data[0]}).then(function(Ce){Ce.status=="success"&&(T(!1),tt((0,t.jsxs)("div",{style:{textAlign:"center",marginTop:"75px",fontSize:"25px"},children:["\u5BF9\u516C\u6253\u6B3E\u5907\u6CE8\u7801\u5DF2\u751F\u6210\uFF1A",Ce.data.content[0].code]})),ye(3))}),C.type==6&&(T(!1),tt((0,t.jsx)("div",{style:{textAlign:"center",marginTop:"75px",fontSize:"25px"},children:"\u5DF2\u5B8C\u6210\u7F34\u8D39"})),ye(3))):(T(!1),We(!1),be()):(T(!1),We(!1))})},Er=function(){xe==1?(We(!0),mr("over")):be()};return(0,t.jsx)(o.Z,{width:1200,footer:null,title:"\u5B66\u5458\u4E0B\u5355",maskClosable:!1,visible:Rt,onCancel:function(){return S(!1)},children:(0,t.jsxs)(ht.Z,{spinning:Or,children:[(0,t.jsx)(Y.Z,{current:xe,children:It.map(function(H){return(0,t.jsx)(zt,{title:H.title},H.title)})}),(0,t.jsx)("div",{className:"steps-content",children:(Ae=It[xe])===null||Ae===void 0?void 0:Ae.content}),(0,t.jsxs)("div",{className:"steps-action",style:{textAlign:"right"},children:[xe>0&&(0,t.jsx)(d.Z,{style:{margin:"0 8px"},onClick:function(){return Jt()},children:"\u8DF3\u8FC7"}),xe<It.length-1&&(0,t.jsx)(d.Z,{type:"primary",loading:ee,onClick:function(){return Sr()},children:"\u4E0B\u4E00\u6B65"}),xe===It.length-1&&(0,t.jsx)(d.Z,{type:"primary",onClick:function(){return Er()},children:"\u5B8C\u6210"})]})]})})},kt=e(31392),Kt=e(15258),Bt=e(14037),Ie=e(10875),Ot=e(37423),Je=e(12968),jt=e(20352),_t=e(43185),at=e(43027),Ht=function(Pe){var ze=Pe.setModalVisible,Ae=Pe.modalVisible,Rt=Pe.callbackRef,S=Pe.renderData,Xe=(0,p.useState)(!1),we=(0,r.Z)(Xe,2),qe=we[0],Yt=we[1],Te=(0,p.useState)(),N=(0,r.Z)(Te,2),y=N[0],W=N[1],k=(0,p.useRef)();(S==null?void 0:S.type)=="eidt"&&(S==null?void 0:S.renderDataNumber)===0&&(setTimeout(function(){var q;k==null||(q=k.current)===null||q===void 0||q.setFieldsValue({name:S.name,code:S.code,description:S.description,codeFile:[{uid:"1",name:S.codeFile,response:{data:S.codeFile}}],powerAttorneyFile:[{uid:"1",name:S.powerAttorneyFile,response:{data:S.powerAttorneyFile}}]})},100),++S.renderDataNumber);var xe=sessionStorage.getItem("tokenName"),ye=sessionStorage.getItem("tokenValue"),Ne={};Ne[xe]=ye;var je=function(G){return new Promise(function(K){le.Z.post("/sms/business/bizStudent",G).then(function(Et){console.log("res",Et),Et.status=="success"&&(P.default.success("\u64CD\u4F5C\u6210\u529F!"),ze(),Rt(),K(!0))}).catch(function(Et){K(!0)})})};return(0,t.jsx)(ot.Y,{width:905,formRef:k,onFinish:function(){var q=(0,g.Z)((0,j.Z)().mark(function G(K){return(0,j.Z)().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:return K.id=S.studentId,K.codeFile&&(K.codeFile=K.codeFile.at(-1).response.data),K.powerAttorneyFile&&(K.powerAttorneyFile=K.powerAttorneyFile.at(-1).response.data),console.log("values",K),yt.next=6,je(K);case 6:case"end":return yt.stop()}},G)}));return function(G){return q.apply(this,arguments)}}(),modalProps:{destroyOnClose:!0,onCancel:function(){Rt(),ze()},maskClosable:!1},visible:Ae,children:(0,t.jsxs)(ae.ZP.Group,{children:[(0,t.jsx)(gr.Z,{width:400,label:"\u7EDF\u4E00\u793E\u4F1A\u4FE1\u7528\u7801\u7535\u5B50\u7248",name:"codeFile",required:!0,action:"/sms/business/bizStudent/upload",fieldProps:{multiple:!1,headers:(0,F.Z)({},Ne),listType:"picture",defaultFileList:[],beforeUpload:function(G){if(console.log("file",G),G.type!="image/png"&&G.type!="image/jpeg")return P.default.error("\u53EA\u80FD\u4E0A\u4F20png\u3001jpg\u683C\u5F0F"),at.Z.LIST_IGNORE},onPreview:function(){var q=(0,g.Z)((0,j.Z)().mark(function K(Et){return(0,j.Z)().wrap(function(er){for(;;)switch(er.prev=er.next){case 0:W(Et.thumbUrl),Yt(!0);case 2:case"end":return er.stop()}},K)}));function G(K){return q.apply(this,arguments)}return G}(),onChange:function(G){var K=G.file.status;K==="done"?P.default.success("".concat(G.file.name," \u4E0A\u4F20\u6210\u529F.")):K==="error"&&P.default.error("".concat(G.file.name," \u4E0A\u4F20\u5931\u8D25."))}}}),(0,t.jsx)("div",{style:{display:"none"},children:(0,t.jsx)(jt.Z,{width:200,style:{display:"none"},preview:{visible:qe,src:y,onVisibleChange:function(G){Yt(G)}}})})]})})},qt=e(41574),yr=e(22),Zr=e(89015),_e=e(31199),or=e(63434),Zt=e(59962),Fe=e(99772),vt=e(58937),Qe=e(35562),Be=e(8252),Mt=e(2759),fr=function(Pe){var ze=Pe.setModalVisible,Ae=Pe.modalVisible,Rt=Pe.callbackRef,S=Pe.renderData,Xe=(0,et.tT)("@@initialState"),we=Xe.initialState,qe=Xe.setInitialState,Yt=we.currentUser,Te=(0,p.useState)(),N=(0,r.Z)(Te,2),y=N[0],W=N[1],k=(0,p.useState)(),xe=(0,r.Z)(k,2),ye=xe[0],Ne=xe[1],je=(0,p.useState)(!1),q=(0,r.Z)(je,2),G=q[0],K=q[1],Et=(0,p.useState)(!1),yt=(0,r.Z)(Et,2),er=yt[0],Se=yt[1],Vt=(0,p.useState)(!1),Nt=(0,r.Z)(Vt,2),tt=Nt[0],ir=Nt[1],wt=(0,p.useState)(!1),Or=(0,r.Z)(wt,2),We=Or[0],Le=Or[1],ve=(0,p.useState)(!1),st=(0,r.Z)(ve,2),ct=st[0],br=st[1],_r=(0,p.useState)(),Fr=(0,r.Z)(_r,2),Ir=Fr[0],Ar=Fr[1],Ge=(0,p.useRef)();S.addNumber===0&&(setTimeout(function(){var me;Ge==null||(me=Ge.current)===null||me===void 0||me.setFieldsValue({name:$.Z.getCascaderName("dict_reg_job",S.project)+"("+S.name+")",project:$.Z.getCascaderValue("dict_reg_job",S.project),userName:S.name})},100),++S.addNumber),S.type=="staff"&&setTimeout(function(){var me;Ge==null||(me=Ge.current)===null||me===void 0||me.setFieldsValue({name:"\u670D\u52A1\u534F\u8BAE("+$.Z.getCascaderName("certificateKind",S.kind)+")",project:$.Z.getCascaderValue("dict_reg_job",S.project),userName:S.userName})},100),(0,p.useEffect)(function(){le.Z.get("/sms/contract/conContract/findCompany",{id:S.id}).then(function(me){var U;(U=me.data)!==null&&U!==void 0&&U.id&&W(me.data)})},[S]),(0,p.useEffect)(function(){!y||wr()},[y]),(0,p.useEffect)(function(){var me,U;Ge==null||(me=Ge.current)===null||me===void 0||me.setFieldsValue({parameter:[{}]});var Me=[];!ye||(ye&&(Ge==null||(U=Ge.current)===null||U===void 0||U.setFieldsValue({templateId:ye.name})),Me=ye.parameter.map(function(It){return Re(It)}),K(Me),wr(),Pr(),console.log(ye,"CompanyIds.name-------->"))},[ye]);var Pr=function(){var me=(0,g.Z)((0,j.Z)().mark(function U(){return(0,j.Z)().wrap(function(It){for(;;)switch(It.prev=It.next){case 0:return It.next=2,(0,Qe.Z)("/sms/contract/conTemplate/download",ye.id,ye.file).then(function(be){Ar(be.pdfUrl[0])});case 2:case"end":return It.stop()}},U)}));return function(){return me.apply(this,arguments)}}(),wr=function(){var U,Me,It,be=["partBCardBankName","partBCardName","partBCardNo","signatureDate"],z=JSON.parse(JSON.stringify(Ge==null||(U=Ge.current)===null||U===void 0?void 0:U.getFieldValue("parameter")));ye==null||(Me=ye.parameter)===null||Me===void 0||Me.forEach(function(He){He.code=="partBCardName"&&(z[0].partBCardBankName=y==null?void 0:y.bank,z[0].partBCardName=y==null?void 0:y.accountName,z[0].partBCardNo=y==null?void 0:y.account),He.code=="timeOutPartA"&&(z[0].timeOutPartA=nr()().format("YYYY-MM-DD")),He.code=="timeOutPartB"&&(z[0].timeOutPartB=nr()().format("YYYY-MM-DD")),He.code=="partA"&&(z[0].partA=S!=null&&S.name?S==null?void 0:S.name:S==null?void 0:S.userName),He.code=="partB"&&(z[0].partB=y==null?void 0:y.name),He.code=="linkTelephonePartA"&&(z[0].linkTelephonePartA=S==null?void 0:S.mobile),He.code=="linkTelephonePartB"&&(z[0].linkTelephonePartB=Yt==null?void 0:Yt.mobile),He.code=="idCard"&&(z[0].idCard=S==null?void 0:S.idCard)}),Ge==null||(It=Ge.current)===null||It===void 0||It.setFieldsValue({ourSeal:y==null?void 0:y.name,parameter:z})},Re=function(U){return U.type=="0"?(0,t.jsx)(Ft.Z,{name:U.code,label:U.name,width:"sm",rules:[{required:U.isRequired,message:"\u8BF7\u586B\u5199".concat(U.name)}]},U.code):U.type=="1"?(0,t.jsx)(_e.Z,{name:U.code,label:U.name,width:"sm",rules:[{required:U.isRequired,message:"\u8BF7\u586B\u5199".concat(U.name)}]},U.code):U.type=="5"?(0,t.jsx)(he.Z,{name:U.code,label:U.name,width:"sm",rules:[{required:U.isRequired,message:"\u8BF7\u586B\u5199".concat(U.name)}]},U.code):U.type=="2"?(0,t.jsx)(or.Z,{name:U.code,label:U.name,width:"sm",rules:[{required:U.isRequired,message:"\u8BF7\u586B\u5199".concat(U.name)}]},U.code):U.type=="3"?(0,t.jsxs)(ae.ZP.Group,{children:[(0,t.jsx)(_e.Z,{name:U.code,label:U.name,width:"sm",fieldProps:{precision:2,onChange:function(It){var be,z,He=JSON.parse(JSON.stringify(Ge==null||(be=Ge.current)===null||be===void 0?void 0:be.getFieldValue("parameter")));He[0][U.code+"Big"]=(0,Be.Z)(It),Ge==null||(z=Ge.current)===null||z===void 0||z.setFieldsValue({parameter:He})}},rules:[{required:U.isRequired,message:"\u8BF7\u586B\u5199".concat(U.name)}]},U.code+"s"),(0,t.jsx)(Ft.Z,{name:U.code+"Big",label:"".concat(U.name,"\u5927\u5199"),width:"sm",disabled:!0},"".concat(U.name,"big"))]},U.code):U.type=="4"?(0,t.jsxs)(ae.ZP.Group,{children:[(0,t.jsx)(Ft.Z,{name:"partBCardName",label:"\u5F00\u6237\u540D",width:"sm",disabled:!0,fieldProps:{defaultValue:y==null?void 0:y.partBCardName}},"partBCardName"),(0,t.jsx)(Ft.Z,{name:"partBCardBankName",label:"\u5F00\u6237\u884C",width:"sm",disabled:!0,fieldProps:{defaultValue:y==null?void 0:y.partBCardBankName}},"partBCardBankName"),(0,t.jsx)(Ft.Z,{name:"partBCardNo",label:"\u8D26\u53F7",width:"sm",disabled:!0,fieldProps:{defaultValue:y==null?void 0:y.partBCardNo}},"partBCardNo")]},"banks"):U.type=="6"?(0,t.jsx)(ut.Z,{label:U.name,name:U.code,width:"sm",request:(0,g.Z)((0,j.Z)().mark(function Me(){return(0,j.Z)().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:return be.abrupt("return",$.Z.getList("companyAddress"));case 1:case"end":return be.stop()}},Me)})),rules:[{required:U.isRequired,message:"\u8BF7\u586B\u5199".concat(U.name)}]},U.code):(0,t.jsx)(Ft.Z,{name:U.code,label:U.name,width:"sm",rules:[{required:U.isRequired,message:"\u8BF7\u586B\u5199".concat(U.name)}]},U.code)},lt=sessionStorage.getItem("tokenName"),Ze=sessionStorage.getItem("tokenValue"),cr={};Ze!==null?cr[lt]=Ze:console.error("Token value is null");var Q=function(U){var Me=S.type=="staff"?"/sms/business/bizCertificateApply/createServiceFile":"/sms/contract/conContract";return new Promise(function(It){le.Z.post(Me,U).then(function(be){be.status=="success"&&(P.default.success("\u64CD\u4F5C\u6210\u529F!"),Se(!0),It(!0))}).catch(function(be){It(!0)})})},ee=function(U,Me){return Me.some(function(It){return It.label.toLowerCase().indexOf(U.toLowerCase())>-1})};function T(me,U){}return(0,t.jsxs)(ot.Y,{width:1600,title:"\u5408\u540C\u7B7E\u7F72",formRef:Ge,onFinish:function(){var me=(0,g.Z)((0,j.Z)().mark(function U(Me){var It;return(0,j.Z)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(Me.templateId=ye.id,Object.keys(Me.parameter[0]).forEach(function(He){Me.parameter[0][He]===!0&&(Me.parameter[0][He]="\u662F")}),S.type!="staff"){z.next=13;break}return It={},It.id=S.id,It.serviceName=Me.name,It.param=JSON.stringify(Me.parameter[0]),It.templateId=ye.id,It.companyId=y.id,z.next=11,Q(It);case 11:z.next=20;break;case 13:return Me.studentUserId=S.id,Me.ourSeal=y.id,Me.parameter=JSON.stringify(Me.parameter[0]),Me.project&&(Me.project=Me.project[Me.project.length-1]),delete Me.userName,z.next=20,Q(Me);case 20:console.log("values",Me);case 21:case"end":return z.stop()}},U)}));return function(U){return me.apply(this,arguments)}}(),modalProps:{destroyOnClose:!0,onCancel:function(){ze()},maskClosable:!1},visible:Ae,children:[(0,t.jsxs)("div",{className:"common",children:[(0,t.jsxs)("div",{className:"common_left",children:[(0,t.jsx)(Ft.Z,{label:"\u5408\u540C\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u5408\u540C\u540D\u79F0"}]}),(0,t.jsx)(ae.ZP.Group,{label:"\u5408\u540C\u4FE1\u606F\uFF1A",children:(0,t.jsxs)("div",{hidden:S.type=="staff",children:[(0,t.jsx)(tr.Z,{width:"sm",name:"project",placeholder:"\u54A8\u8BE2\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:S.type!="staff",message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:$.Z.getCascader("dict_reg_job"),showSearch:{filter:ee},onChange:T,onSearch:function(U){return console.log(U)}}}),(0,t.jsx)(_e.Z,{name:"amount",label:"\u5408\u540C\u5171\u8BA1\u91D1\u989D",width:"sm",rules:[{required:S.type!="staff"}]})]})}),(0,t.jsxs)(ae.ZP.Group,{children:[(0,t.jsx)(Ft.Z,{label:"\u5408\u540C\u6A21\u677F",name:"templateId",width:"sm",rules:[{required:!0}]}),(0,t.jsx)(d.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,g.Z)((0,j.Z)().mark(function me(){return(0,j.Z)().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:Le(!0);case 1:case"end":return Me.stop()}},me)})),children:"\u9009\u62E9\u5408\u540C\u6A21\u677F"}),(0,t.jsx)(Ft.Z,{label:"\u6211\u65B9\u7B7E\u7F72\u516C\u53F8",name:"ourSeal",width:"sm",rules:[{required:!0}]}),(0,t.jsx)(d.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",onClick:(0,g.Z)((0,j.Z)().mark(function me(){return(0,j.Z)().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:ir(!0);case 1:case"end":return Me.stop()}},me)})),children:"\u9009\u62E9\u516C\u53F8"})]}),(0,t.jsx)(ae.ZP.Group,{label:"\u4EE5\u4E0B\u4E3A\u5408\u540C\u586B\u5145\u4FE1\u606F(\u9009\u62E9\u6A21\u677F\u540E\u5C55\u793A)\uFF1A",children:(0,t.jsx)(Zt.u,{name:"parameter",initialValue:[{}],creatorButtonProps:!1,creatorRecord:{useMode:"none"},copyIconProps:!1,deleteIconProps:!1,children:(0,t.jsx)(ae.ZP.Group,{children:G})})})]}),(0,t.jsx)("div",{className:"common_right",children:Ir?(0,t.jsx)("iframe",{src:Ir,style:{width:"100%",height:"100%"}}):(0,t.jsx)("div",{className:"noFile",children:"\u6682\u672A\u9009\u62E9\u5408\u540C"})})]}),tt&&(0,t.jsx)(Fe.Z,{modalVisible:tt,setModalVisible:function(){return ir(!1)},setCompanyId:function(U){W(U)}}),We&&(0,t.jsx)(vt.Z,{modalVisible:We,setModalVisible:function(){return Le(!1)},setCompanyId:function(U){Ne(U)}}),(0,t.jsx)(qt.Z,{previewVisible:ct,setPreviewVisible:function(){return br(!1)},previewImage:Ir}),er&&(0,t.jsx)(Mt.Z,{setModalVisible:function(){return Se(!1)},modalVisible:er,callbackRef:function(){return Rt()},setPModalVisible:function(){return ze()}})]})},Ue=e(54493),vr=e(21874),Tt=function(Pe){var ze,Ae=Pe.TabListNuber,Rt=Pe.order,S=Rt===void 0?"":Rt,Xe=Pe.admin,we=Pe.oncancel,qe=Pe.type,Yt=Pe.toolbar,Te=Pe.setStudentId,N=Pe.setStudentVisible,y=Pe.isFormal,W=y===void 0?!1:y,k=Pe.isPay,xe=k===void 0?null:k,ye=Pe.parentId,Ne=ye===void 0?null:ye,je=Pe.companyStudent,q=je===void 0?null:je,G=Pe.recommend,K=G===void 0?!1:G,Et=Pe.userIds,yt=Et===void 0?!1:Et,er=Pe.source,Se=er===void 0?!1:er,Vt=(0,p.useRef)(),Nt=(0,p.useState)(!1),tt=(0,r.Z)(Nt,2),ir=tt[0],wt=tt[1],Or=(0,p.useState)(!1),We=(0,r.Z)(Or,2),Le=We[0],ve=We[1],st=(0,p.useState)(!1),ct=(0,r.Z)(st,2),br=ct[0],_r=ct[1],Fr=(0,p.useState)(!1),Ir=(0,r.Z)(Fr,2),Ar=Ir[0],Ge=Ir[1],Pr=(0,p.useState)(!1),wr=(0,r.Z)(Pr,2),Re=wr[0],lt=wr[1],Ze=(0,p.useState)(!1),cr=(0,r.Z)(Ze,2),Q=cr[0],ee=cr[1],T=(0,p.useState)(!1),me=(0,r.Z)(T,2),U=me[0],Me=me[1],It=(0,p.useState)(!1),be=(0,r.Z)(It,2),z=be[0],He=be[1],Sr=(0,p.useState)(!1),Jt=(0,r.Z)(Sr,2),mr=Jt[0],Er=Jt[1],H=(0,p.useState)(void 0),w=(0,r.Z)(H,2),C=w[0],Oe=w[1],Ce=(0,p.useState)(!1),nt=(0,r.Z)(Ce,2),pr=nt[0],Qt=nt[1],mt=(0,p.useState)(!1),hr=(0,r.Z)(mt,2),Lr=hr[0],Br=hr[1],Vr=(0,p.useState)(!1),Wr=(0,r.Z)(Vr,2),rr=Wr[0],Nr=Wr[1],tu=(0,p.useState)(!1),Tr=(0,r.Z)(tu,2),lr=Tr[0],Xr=Tr[1],ru=(0,p.useState)(!1),uu=(0,r.Z)(ru,2),su=uu[0],eu=uu[1],au=(0,p.useState)(!1),Ke=(0,r.Z)(au,2),_=Ke[0],R=Ke[1],v=(0,p.useState)(!1),ft=(0,r.Z)(v,2),Lt=ft[0],ur=ft[1],dt=(0,p.useState)(!1),dr=(0,r.Z)(dt,2),Pt=dr[0],$r=dr[1],du=(0,p.useState)(!1),nu=(0,r.Z)(du,2),iu=nu[0],lu=nu[1],St=(0,p.useState)(null),se=(0,r.Z)(St,2),ke=se[0],fe=se[1],pt=(0,p.useState)([]),Wt=(0,r.Z)(pt,2),ue=Wt[0],te=Wt[1],$t=(0,p.useState)([]),Mr=(0,r.Z)($t,2),At=Mr[0],Kr=Mr[1],Ve=(0,p.useState)("/sms/business/bizStudent/saveArray"),xt=(0,r.Z)(Ve,2),E=xt[0],Cr=xt[1],Rr=(0,p.useState)({}),ar=(0,r.Z)(Rr,2),Dr=ar[0],oe=ar[1],zr=(0,p.useState)(!1),kr=(0,r.Z)(zr,2),qr=kr[0],Ou=kr[1],yu=(0,p.useState)(),pu=(0,r.Z)(yu,2),Iu=pu[0],$u=pu[1],Au=(0,et.tT)("@@initialState"),ou=Au.initialState,Tu=(0,p.useState)(),hu=(0,r.Z)(Tu,2),vu=hu[0],Ru=hu[1],Su=(0,p.useState)(),Du=(0,r.Z)(Su,2),bu=Du[0],Lu=Du[1],Uu=(0,p.useState)({}),Cu=(0,r.Z)(Uu,2),_u=Cu[0],gu=Cu[1],wu=(0,p.useState)("0"),ju=(0,r.Z)(wu,2),zu=ju[0],Yu=ju[1],Wu=(0,p.useState)(!1),Zu=(0,r.Z)(Wu,2),Ku=Zu[0],Pu=Zu[1],mu=W?"/sms/business/bizStudent":"/sms/business/bizStudentUser/potentialStudent",xu=(0,p.useRef)(),fu=(0,p.useRef)();(0,p.useEffect)(function(){Vt.current&&Vt.current.reload()},[Ae]),(0,p.useEffect)(function(){Yr()},[qe]),(0,p.useEffect)(function(){var ge;(ge=xu.current)===null||ge===void 0||ge.setFieldsValue(et.m8.location.query),oe(et.m8.location.query)},[]),(0,p.useEffect)(function(){if(JSON.stringify(_u)!="{}"){var ge=_u.id,rt=[];ue.forEach(function(de){rt.push(de.id)}),le.Z.post("/sms/business/bizStudentUser/presentation",{userId:ge,studentUserIdList:rt.join(",")}).then(function(de){de.status=="success"&&(P.default.success("\u64CD\u4F5C\u6210\u529F\uFF01"),te([]),gu({}),Yr())})}},[_u]);var Vu=Yt=="\u6F5C\u5728\u5B66\u5458"?{menu:{type:"tab",items:[{key:"0",label:(0,t.jsx)("span",{children:"\u5168\u90E8"})},{key:"1",label:(0,t.jsx)("span",{children:"\u4ECA\u65E5\u5F85\u8DDF\u8FDB"})},{key:"2",label:(0,t.jsx)("span",{children:"\u4ECA\u65E5\u5DF2\u8054\u7CFB"})},{key:"3",label:(0,t.jsx)("span",{children:"\u4ECE\u672A\u8DDF\u8FDB"})}],onChange:function(rt){Oe(rt),Yr()}}}:void 0,Gu={\u59D3\u540D:"name",\u62A5\u8003\u5C97\u4F4D:"project",\u5B66\u5458\u7C7B\u578B:"type",\u5BA2\u6237\u6765\u6E90:"source",\u5907\u6CE8:"description",\u54A8\u8BE2\u65F6\u95F4:"createTime"},Yr=function(){var rt,de;Vt==null||(rt=Vt.current)===null||rt===void 0||rt.reload(),Vt==null||(de=Vt.current)===null||de===void 0||de.clearSelected()},Nu=function(rt){return rt.provider!=rt.userId?"highlight-row":""},Fu=function(rt){qe=="\u5B66\u5458"||qe=="\u4E2A\u4EBA\u4EE3\u7406"?!rt.mobile||!rt.name?(P.default.error("\u8BF7\u5148\u8865\u5145\u5B66\u5458\u59D3\u540D\u3001\u624B\u673A\u53F7\u540E\u5728\u8FDB\u884C\u4E0B\u5355"),fe((0,F.Z)((0,F.Z)({},rt),{},{typee:"eidt"})),wt(!0)):(fe((0,F.Z)((0,F.Z)({},rt),{},{typee:"add",orderNumber:0,group:qe=="\u4E2A\u4EBA\u4EE3\u7406"})),eu(!0)):rt.code?(fe((0,F.Z)((0,F.Z)({},rt),{},{typee:"add",orderNumber:0,group:!0})),eu(!0)):P.default.error("\u8BF7\u5148\u4E0A\u4F20\u4F01\u4E1A\u7EDF\u4E00\u793E\u4F1A\u4FE1\u7528\u4EE3\u7801")},ku=[{width:100,fixed:"left",title:qe||"\u5B66\u5458/\u4F01\u4E1A",dataIndex:"name",align:"center",key:"name",render:function(rt,de){return(0,t.jsxs)("div",{children:[(0,t.jsxs)("a",{onClick:function(){fe((0,F.Z)((0,F.Z)({},de),{},{admin:Xe})),Me(!0)},children:[de.name,(0,t.jsx)(O.Z,{})]}),(0,t.jsx)("div",{children:de.isPeer&&(0,t.jsx)(x.Z,{color:"#87CEEB",children:"\u540C\u884C\u4F01\u4E1A"})}),(0,t.jsxs)("div",{hidden:W,children:[(0,t.jsx)(x.Z,{color:de.visitTime?"success":"error",children:de.visitTime?"\u5DF2\u56DE\u8BBF":"\u672A\u56DE\u8BBF"}),de.lastDealTime?(0,t.jsx)(ne.Z,{title:"\u540C\u624B\u673A\u53F7\u5DF2\u6709\u4ED6\u4EBA\u4E0B\u8FC7\u5355(\u70B9\u51FB\u67E5\u770B)",children:(0,t.jsx)(x.Z,{color:"success",onClick:function(){fe((0,F.Z)((0,F.Z)({},de),{},{admin:Xe,lastDealTime:!0,key:"8"})),Me(!0)},style:{cursor:"pointer"},children:"!\u5DF2\u4E0B\u5355"})}):""]})]})}},{title:"\u5FAE\u4FE1\u53F7",dataIndex:"weChat",key:"weChat",hideInTable:W,width:85,render:function(rt,de){return(0,t.jsx)("span",{style:{userSelect:"none"},children:de.weChat})}},{title:"\u624B\u673A\u53F7",dataIndex:"mobile",key:"mobile",hideInTable:W,width:130,render:function(rt,de){return(0,t.jsx)("div",{children:(0,t.jsxs)("a",{onClick:function(){fe((0,F.Z)((0,F.Z)({},de),{},{types:"add",n:0})),lu(!0),$.Z.phoneCall(de.id)},style:{userSelect:"none"},children:[(0,t.jsx)(c.Z,{}),":",de.mobile]})})}},{width:90,title:"\u6240\u5C5E\u8001\u5E08",dataIndex:"userName"},{width:100,title:"\u4FE1\u606F\u6240\u6709\u4EBA",dataIndex:"ownerName",render:function(rt,de){return(0,t.jsxs)("div",{children:[de.ownerName,(0,t.jsx)("span",{children:de.ownerName&&"("+de.percent*100+"%)"})]})}},{width:100,title:"\u4FE1\u606F\u63D0\u4F9B\u4EBA",dataIndex:"providerName"},{width:100,title:"\u5BA2\u6237\u6765\u6E90",dataIndex:"studentSource",valueType:"select",key:"studentSource",filters:!0,filterMultiple:!1,valueEnum:$.Z.getSearch("dict_source"),render:function(rt,de){return(0,t.jsx)("span",{children:$.Z.getName("dict_source",de.studentSource)})}},{width:100,title:"\u54A8\u8BE2\u5C97\u4F4D",dataIndex:"project-in",sorter:!0,key:"project-in",valueType:"select",fieldProps:{options:$.Z.getCascader("dict_reg_job"),showSearch:{filter:Ue.Z},mode:"tags"},render:function(rt,de){return(0,t.jsx)("span",{children:$.Z.getCascaderName("dict_reg_job",de.project)})}},{width:100,title:"\u4F01\u4E1A\u8D1F\u8D23\u4EBA",dataIndex:"chargePersonName",key:"chargePersonName",hideInTable:qe=="\u5B66\u5458"},{width:100,title:"\u4E0A\u6B21\u56DE\u8BBF\u65F6\u95F4",search:!1,align:"center",hideInTable:W||K,render:function(rt,de){return(0,t.jsx)("span",{children:de.visitTime})}},{title:"\u6027\u522B",dataIndex:"sex",width:70,valueType:"select",key:"sex",valueEnum:{false:"\u7537",true:"\u5973"},render:function(rt,de){return(0,t.jsx)("span",{children:de.sex==null?"\u672A\u77E5":de.sex?"\u5973":"\u7537"})}},{title:"\u9879\u76EE\u603B\u79F0",dataIndex:"parentProjects",key:"parentProjects",sorter:!0,valueType:"select",fieldProps:{options:$.Z.getList("dict_reg_job"),mode:"tags"},width:100,render:function(rt,de){return(0,t.jsx)("span",{children:$.Z.getCascaderAllName("dict_reg_job",de.project)},"parentProjects")}},{title:"QQ",dataIndex:"qq",key:"qq",hideInTable:W,width:100,render:function(rt,de){return(0,t.jsx)("span",{style:{userSelect:"none"},children:de.qq})}},{title:"\u8EAB\u4EFD\u8BC1",dataIndex:"idCard",key:"idCard",hideInTable:!0},{title:"\u4FE1\u7528\u4EE3\u7801",dataIndex:"code",key:"code",hideInTable:!0},{title:"\u662F\u5426\u662F\u540C\u884C\u4F01\u4E1A",dataIndex:"isPeer",valueType:"select",key:"isPeer",valueEnum:{false:"\u5426",true:"\u662F"},hideInTable:!0},{dataIndex:"isFormal",search:!1,key:"isFormal",hideInTable:!Xe,render:function(rt,de){return(0,t.jsx)("span",{style:{color:de.isFormal?"rgb(0,172,132)":"red"},children:de.isFormal?"\u6B63\u5F0F":"\u6F5C\u5728"})}},{width:100,title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"source",valueType:"select",key:"source",filters:!0,filterMultiple:!1,valueEnum:$.Z.getSearch("circulationType"),render:function(rt,de){return(0,t.jsx)("span",{children:$.Z.getName("circulationType",de.source)})}},{width:100,title:"\u63A5\u6536\u4FE1\u606F\u8D1F\u8D23\u4EBA",dataIndex:"userName",key:"userNames",search:!1,hideInTable:!K},{width:110,title:"\u4FE1\u606F\u63D0\u4F9B\u4EBA\u6240\u5360\u4E1A\u7EE9\u6BD4\u4F8B(%)",sorter:!0,dataIndex:"percent",hideInTable:!K,render:function(rt,de){return(0,t.jsxs)("span",{children:[de.percent*100,"%"]},"parentProjects")}},{width:100,title:"\u9886\u53D6\u65F6\u95F4",key:"receiveTime",dataIndex:"circulationTime",valueType:"dateRange",sorter:!0,hideInTable:K,render:function(rt,de){return(0,t.jsx)("span",{children:de.circulationTime})}},{width:100,title:"\u4ECB\u7ECD\u65F6\u95F4",key:"createTime",dataIndex:"createTimes",valueType:"dateRange",hideInTable:!K,sorter:!0,render:function(rt,de){return(0,t.jsx)("span",{children:de.createTime})}},{width:100,title:"\u4E0B\u5355\u65F6\u95F4",key:"lastDealTime",dataIndex:"lastDealTime",valueType:"dateRange",hideInTable:!K,sorter:!0,render:function(rt,de){return(0,t.jsx)("span",{children:de.lastDealTime?de.lastDealTime:(0,t.jsx)(x.Z,{color:"error",children:"\u672A\u4E0B\u5355"})})}},{width:100,title:"\u521B\u5EFA\u65F6\u95F4",key:"createTime",dataIndex:"createTime",valueType:"dateRange",hideInTable:K,sorter:!0,render:function(rt,de){return(0,t.jsx)("span",{children:de.createTime})}},{width:100,title:"\u54A8\u8BE2\u65F6\u95F4",key:"consultationTime",dataIndex:"consultationTime",valueType:"dateRange",hideInTable:K,sorter:!0,render:function(rt,de){return(0,t.jsx)("span",{children:de.consultationTime})}},{title:"\u662F\u5426\u4E3A\u51FA\u955C\u4EBA\u4E13\u5C5E\u8D44\u6E90",key:"isLive",dataIndex:"isLive",valueType:"select",valueEnum:{true:"\u662F",false:"\u5426"},hideInTable:!0},{width:100,title:"\u5907\u6CE8",dataIndex:"description",key:"descriptions",search:!1,ellipsis:!0,tip:"\u5907\u6CE8\u8FC7\u957F\u4F1A\u81EA\u52A8\u6536\u7F29"},{title:"\u64CD\u4F5C",valueType:"option",width:260,key:"options",fixed:"right",render:function(rt,de,Gr,Qr){return(0,t.jsx)(t.Fragment,{children:S?(0,t.jsx)(d.Z,{type:"primary",size:"small",icon:(0,t.jsx)(a.Z,{}),style:{marginRight:"15px",marginBottom:"8px"},onClick:function(){Te({id:de.id,name:de.name,record:de}),N()},children:"\u9009\u62E9"},"looks-student-manage"):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:(0,t.jsxs)(A.Z,{children:[Se!=8||de.userId!=null||(0,t.jsx)(L.Z,{title:"\u662F\u5426\u786E\u5B9A\u8BA4\u9886\uFF1F",style:{marginRight:"15px",marginBottom:"8px"},onConfirm:function(){le.Z.post("/sms/business/bizStudentUser/receive",{ids:de.id,source:8}).then(function(Ur){Ur.status=="success"&&(P.default.success("\u8BA4\u9886\u6210\u529F"),Yr())})},okText:"\u8BA4\u9886",cancelText:"\u53D6\u6D88",children:(0,t.jsx)("a",{children:"\u8BA4\u9886"},"receive")},"receivePop"),(0,t.jsx)("a",{hidden:Ne,onClick:function(){fe((0,F.Z)({},de)),Me(!0)},children:"\u67E5\u770B"},"look-student"),(0,t.jsx)("a",{onClick:function(){fe((0,F.Z)((0,F.Z)({},de),{},{typee:"eidt"})),wt(!0)},children:"\u7F16\u8F91"},"editable"),(0,t.jsx)("a",{hidden:Ne,type:"primary",onClick:function(){fe((0,F.Z)((0,F.Z)({},de),{},{types:"add",n:0})),lu(!0)},children:"\u56DE\u8BBF"},"edit-student-manage"),qe!="\u5B66\u5458"?(0,t.jsx)(d.Z,{size:"small",hidden:!0,type:"primary",icon:(0,t.jsx)(h.Z,{}),onClick:function(){fe({typee:"add",parentId:de.id}),wt(!0)},children:"\u6DFB\u52A0"},"parentIds"):"",(0,t.jsx)("a",{type:"primary",hidden:Ne||K&&de.lastDealTime,onClick:function(){Fu(de)},children:"\u4E0B\u5355"},"editable2"),(0,t.jsx)("a",{type:"primary",hidden:W,onClick:function(){ve(!0),fe((0,F.Z)({},de))},children:"\u8DDF\u8FDB\u8BB0\u5F55"})]})}),(0,t.jsxs)(A.Z,{children:[(0,t.jsx)("div",{hidden:!W,children:(0,t.jsxs)(A.Z,{children:[(0,t.jsx)("a",{onClick:function(){fe((0,F.Z)((0,F.Z)({},de),{},{chargeType:"0"})),Br(!0)},children:"\u7F34\u8D39"}),(0,t.jsx)("a",{style:{color:"red"},onClick:function(){fe((0,F.Z)((0,F.Z)({},de),{},{chargeType:"1",showStudent:!1})),Br(!0)},children:"\u9000\u8D39"})]})}),(0,t.jsx)(L.Z,{title:"\u662F\u5426\u786E\u5B9A\u5220\u9664\uFF1F",style:{marginRight:"15px",marginBottom:"8px"},onConfirm:function(){le.Z.delete("/sms/business/bizStudentUser",{id:de.id}).then(function(Ur){Ur.status=="success"&&(P.default.success("\u5220\u9664\u6210\u529F"),Yr())})},okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",children:(0,t.jsx)("a",{style:{color:"red"},children:"\u5220\u9664"},"deletes")},"deletePop"),(0,t.jsx)(L.Z,{title:"\u662F\u5426\u786E\u5B9A\u9501\u5B9A\uFF1F",style:{marginRight:"15px",marginBottom:"8px"},onConfirm:function(){le.Z.post("/sms/business/bizStudent/lock/".concat(de.id)).then(function(Ur){Ur.status=="success"&&(P.default.success("\u5DF2\u9501\u5B9A"),Yr())})},okText:"\u9501\u5B9A",cancelText:"\u53D6\u6D88",children:(0,t.jsx)("a",{style:{color:"brown"},children:"\u9501\u5B9A\u5B66\u5458"},"lock-student-manage")},"deletePop")]})]})})}}],Bu=function(){le.Z.post("/sms/business/bizStudent/buildAccount",{id:ue[0].studentId}).then(function(rt){rt.status=="success"&&(P.default.success("\u64CD\u4F5C\u6210\u529F"),Yr())})},Hr={},cu={};if(Ne&&(Hr.parentId=Ne),q&&q.length>0){var Mu=[];q.forEach(function(ge){Mu.push(ge.id)}),Hr["id-notIn"]=Mu.join(",")}return xe!=null&&(Hr.isPay=xe),W!=null&&(Hr.isFormal=W),W===!0?(cu={createTime:"desc"},Hr["userId-isNull"]=!1):cu=(0,I.Z)({},"visitTime,circulationTime,createTime","asc,desc,desc"),Xe||(qe=="\u5B66\u5458"&&(Hr.type="0"),qe=="\u4F01\u4E1A/\u540C\u884C\u673A\u6784"&&(Hr.type="1"),qe=="\u4E2A\u4EBA\u4EE3\u7406"&&(Hr.type="2"),qe=="\u540C\u884C\u673A\u6784"&&(Hr.type="1")),K?(Hr.source=3,delete Hr.isFormal,delete Hr.type,cu=(0,I.Z)({},"lastDealTime,createTime","asc,desc")):W||(Hr["source-notIn"]=3),yt&&(Hr.userId=ou==null||(ze=ou.currentUser)===null||ze===void 0?void 0:ze.userid),Se&&(delete Hr.isFormal,Hr.source=Se),Object.assign(Hr,Dr),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(yr.Z,{columns:ku,className:"student",actionRef:Vt,formRef:xu,cardBordered:!0,scroll:{x:1800},search:{labelWidth:"auto",defaultCollapsed:!0,defaultColsNumber:10},rowClassName:Nu,onReset:function(){oe({})},toolbar:Vu,request:S==="BlacklistStudent"?{url:mu}:{url:mu,params:(0,F.Z)((0,F.Z)({},Hr),C!==void 0&&{followStatus:C}),sortList:cu},rowSelection:{onChange:function(rt,de){Kr(rt),te(de)}},tableAlertOptionRender:function(){return(0,t.jsxs)(A.Z,{size:16,children:[(0,t.jsx)("a",{style:{color:"red"},onClick:function(){if(console.log("type",ue[0]),ue.length==0||ue.length>1){P.default.error("\u8BF7\u53EA\u9009\u62E9\u4E00\u4F4D\u5B66\u5458!");return}if(qe=="\u5B66\u5458")Bu();else{if(ue.length==0||ue.length>1){P.default.error("\u8BF7\u9009\u62E9\u4E00\u4F4D\u5B66\u5458\u7B7E\u7F72\u5408\u540C!");return}!ue[0].codeFile&&!ue[0].powerAttorneyFile?o.Z.info({title:"\u5C1A\u672A\u4E0A\u4F20\u4F01\u4E1A\u6388\u6743\u4FE1\u606F!",content:(0,t.jsx)("p",{children:"\u8BF7\u5148\u8865\u5145\u4FE1\u606F\u5728\u7B7E\u7F72\u5408\u540C"}),okText:"\u8865\u5145",onOk:function(){fe((0,F.Z)((0,F.Z)({},ue[0]),{},{addNumber:0,typee:"eidt"})),ee(!0)}}):Bu()}},children:"\u91CD\u6784\u6CD5\u5927\u5927\u8D26\u53F7"},"orderq"),(0,t.jsx)("a",{onClick:function(){var de=ue.map(function(Gr){return{id:Gr.studentId,isInWhitelist:!0}});le.Z.postAll("/sms/business/bizStudent/saveArray",{array:de}).then(function(Gr){Gr.status=="success"&&(P.default.success("\u52A0\u5165\u6210\u529F!"),Yr())})},children:"\u52A0\u5165\u767D\u540D\u5355"}),(0,t.jsx)("a",{hidden:!Ne||S=="order",onClick:function(){var de=[];ue.forEach(function(Gr){de.push({id:Gr.id,name:Gr.name})}),Te(de),N()},children:"\u9009\u62E9\u5B66\u5458"},"orders")]})},toolBarRender:[(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,t.jsxs)(A.Z,{style:{marginLeft:"auto"},children:[(0,t.jsx)("a",{hidden:S=="order"||W||K,download:"\u65B0\u5B66\u5458\u5BFC\u5165\u6A21\u677F",href:"./template/\u65B0\u5B66\u5458\u5BFC\u5165\u6A21\u677F.xlsx",children:"\u4E0B\u8F7D\u5BFC\u5165\u6A21\u677F"},"ordera"),(0,t.jsx)(d.Z,{icon:(0,t.jsx)(ie.Z,{}),type:"primary",hidden:S=="order"||W||K,onClick:function(){fe(Ne?{typee:"add",parentId:Ne,newMedia:!1,teacher:!0}:{typee:"add",newMedia:!1,teacher:!0}),wt(!0),Pu(!1)},children:"\u65B0\u5EFA"},"add-student"),(0,t.jsx)(d.Z,{icon:(0,t.jsx)(ie.Z,{}),type:"primary",hidden:S=="order"||W||K,onClick:function(){fe(Ne?{typee:"add",parentId:Ne,newMedia:!0,teacher:!1}:{typee:"add",newMedia:!0,teacher:!1}),wt(!0),Pu(!0)},children:"\u65B0\u5EFA\u65B0\u5A92\u4F53\u5B66\u5458"},"add-newmedia-student"),(0,t.jsx)(d.Z,{type:"primary",hidden:W||K,icon:(0,t.jsx)(ie.Z,{}),onClick:(0,g.Z)((0,j.Z)().mark(function ge(){return(0,j.Z)().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(ue.length!=0){de.next=3;break}return P.default.error("\u8BF7\u5148\u52FE\u9009\u81F3\u5C11\u4E00\u4E2A\u5B66\u5458\u5728\u8FDB\u884C\u63A8\u8350!"),de.abrupt("return");case 3:$r(!0);case 4:case"end":return de.stop()}},ge)})),children:"\u63A8\u8350\u5DF2\u6709\u5B66\u5458\u7ED9\u4ED6\u4EBA"},"recommend-student"),(0,t.jsx)(d.Z,{type:"primary",hidden:W||K,icon:(0,t.jsx)(ie.Z,{}),onClick:(0,g.Z)((0,j.Z)().mark(function ge(){return(0,j.Z)().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(ue.length!=0){de.next=3;break}return P.default.error("\u8BF7\u5148\u52FE\u9009\u81F3\u5C11\u4E00\u4E2A\u5B66\u5458\u5728\u8FDB\u884C\u5206\u914D!"),de.abrupt("return");case 3:ur(!0);case 4:case"end":return de.stop()}},ge)})),children:"\u91CD\u65B0\u5206\u914D\u8001\u5E08"},"reassign-teacher"),(0,t.jsx)(d.Z,{icon:(0,t.jsx)(ie.Z,{}),type:"primary",hidden:S=="order"||W,onClick:function(){fe(Ne?{typee:"recommend",parentId:Ne}:{typee:"recommend"}),wt(!0)},children:"\u65B0\u5EFA\u63A8\u8350\u5B66\u5458"},"buttonq")]}),(0,t.jsxs)(A.Z,{style:{marginLeft:"auto"},children:[(0,t.jsx)(d.Z,{icon:(0,t.jsx)(Ee.Z,{}),type:"primary",hidden:!W,onClick:(0,g.Z)((0,j.Z)().mark(function ge(){var rt,de,Gr,Qr;return(0,j.Z)().wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:return Ur.next=2,le.Z.get("/sms/share/isVerify");case 2:return rt=Ur.sent.data,Ur.next=5,le.Z.get("/sms/share/isVerifyAutoSign");case 5:if(de=Ur.sent.data,!(rt&&de)){Ur.next=25;break}if(!(ou!=null&&(Gr=ou.currentUser)!==null&&Gr!==void 0&&Gr.idCard)){Ur.next=22;break}if(!(ue.length==0||ue.length>1)){Ur.next=11;break}return P.default.error("\u8BF7\u9009\u62E9\u4E00\u4F4D\u5B66\u5458\u7B7E\u7F72\u5408\u540C!"),Ur.abrupt("return");case 11:if(fe((0,F.Z)((0,F.Z)({},ue[0]),{},{addNumber:0,typee:"eidt"})),(Qr=ue[0])!==null&&Qr!==void 0&&Qr.idCard){Ur.next=16;break}return P.default.error("\u8BF7\u5148\u8865\u5145\u5B66\u5458/\u8D1F\u8D23\u4EBA\u7684\u8EAB\u4EFD\u8BC1\u4FE1\u606F\uFF01"),wt(!0),Ur.abrupt("return");case 16:if(!(ue[0].type==1&&!ue[0].codeFile)){Ur.next=19;break}return o.Z.info({title:"\u5C1A\u672A\u4E0A\u4F20\u4F01\u4E1A\u6388\u6743\u4FE1\u606F!",content:(0,t.jsx)("p",{children:"\u8BF7\u5148\u8865\u5145\u4FE1\u606F\u5728\u7B7E\u7F72\u5408\u540C"}),okText:"\u8865\u5145",onOk:function(){ee(!0)}}),Ur.abrupt("return");case 19:_r(!0),Ur.next=23;break;case 22:P.default.error("\u8BF7\u5148\u5B8C\u5584\u60A8\u7684\u8EAB\u4EFD\u8BC1\u4FE1\u606F\u540E\u518D\u7B7E\u7F72\u5408\u540C\uFF01");case 23:Ur.next=27;break;case 25:fe([rt,de]),lt(!0);case 27:case"end":return Ur.stop()}},ge)})),children:"\u5408\u540C\u7B7E\u7F72"},"buttons"),(0,t.jsx)(d.Z,{hidden:S=="order"||W||K,icon:(0,t.jsx)(s.Z,{}),type:"primary",onClick:function(){Nr(!0),Cr("/sms/business/bizStudent/batch/importForOther")},children:"\u6279\u91CF\u5BFC\u5165\u83B7\u5BA2\u6570\u636E"},"butto-import-other"),(0,t.jsx)(d.Z,{hidden:S=="order"||W||K,icon:(0,t.jsx)(s.Z,{}),type:"primary",onClick:function(){Qt(!0),Cr("/sms/business/bizStudent/batch/import")},children:"\u6279\u91CF\u5BFC\u5165\u5B66\u5458\u548C\u56DE\u8BBF\u8BB0\u5F55"},"butto-import"),(0,t.jsx)(d.Z,{hidden:S=="order"||W||K,icon:(0,t.jsx)(s.Z,{}),type:"primary",onClick:function(){Qt(!0),Cr("/sms/business/bizStudent/saveArray")},children:"\u6279\u91CF\u5BFC\u5165\u5B66\u5458"},"buttona")]})]},"toolbar-container")]}),Le&&(0,t.jsx)(l,{setModalVisible:function(){return ve(!1)},modalVisible:Le,renderData:ke,url:"/sms/business/bizReturnVisit",callbackRef:function(){return Yr()}}),ir&&(0,t.jsx)(bt.Z,{setModalVisible:function(){return wt(!1)},modalVisible:ir,callbackRef:function(){return Yr()},isShowMedium:Ku,renderData:ke,url:mu,type:qe}),U&&(0,t.jsx)(u.Z,{setModalVisible:function(){return Me(!1)},modalVisible:U,renderData:ke,admin:Xe,callbackRef:function(){return Yr()}}),iu&&(0,t.jsx)(kt.Z,{setModalVisible:function(){return lu(!1)},modalVisible:iu,renderData:ke,url:"/sms/business/bizReturnVisit",callbackRef:function(){return Yr()}}),lr&&(0,t.jsx)(b.Z,{setModalVisible:function(){return Xr(!1)},modalVisible:lr,renderData:ke,callbackRef:function(){return Yr()},callback:function(){return we()},admin:Xe}),Lr&&(0,t.jsx)(Ot.Z,{setModalVisible:function(){return Br(!1)},modalVisible:Lr,renderData:ke,callbackRef:function(){return Yr()},placeAnOrder:function(rt){return Fu(rt)}}),su&&(0,t.jsx)(Gt,{setModalVisible:function(){return eu(!1)},modalVisible:su,renderData:ke,callbackRef:function(){return Yr()},callback:function(){return we()},admin:Xe}),Q&&(0,t.jsx)(Ht,{setModalVisible:function(){return ee(!1)},modalVisible:Q,renderData:ke,callbackRef:function(){return Yr()},callback:function(){return we()}}),br&&(0,t.jsx)(Ie.Z,{setModalVisible:function(){return _r(!1)},modalVisible:br,renderData:ke,callbackRef:function(){return Yr()}}),z&&(0,t.jsx)(qt.Z,{setPreviewVisible:function(){return He(!1)},previewVisible:z,previewImage:mr,callbackRef:function(){return Yr()}}),pr&&(0,t.jsx)(Kt.Z,{setModalVisible:function(){return Qt(!1)},modalVisible:pr,url:E,type:"student",propsData:{parentId:Ne||"-1"},callbackRef:function(){return Yr()}}),rr&&(0,t.jsx)(Kt.Z,{setModalVisible:function(){return Nr(!1)},modalVisible:rr,url:E,type:"student",upType:"post2",propsData:{parentId:Ne||"-1"},callbackRef:function(){return Yr()}}),qr&&(0,t.jsx)(Bt.Z,{CardVisible:qr,CardContent:Iu,setCardVisible:function(){return Ou(!1)},setDepartment:function(rt){return gu(rt)},departments:[_u]}),Ar&&(0,t.jsx)(fr,{modalVisible:Ar,setModalVisible:function(){return Ge(!1)},renderData:ke}),Re&&(0,t.jsx)(Zr.Z,{modalVisible:Re,setModalVisible:function(){return lt(!1)},renderData:ke}),_&&(0,t.jsx)(ot.Y,{width:350,visible:_,modalProps:{destroyOnClose:!0,maskClosable:!1,onCancel:function(){R(!1)}},formRef:fu,onFinish:function(){var ge=(0,g.Z)((0,j.Z)().mark(function rt(de){var Gr;return(0,j.Z)().wrap(function(Jr){for(;;)switch(Jr.prev=Jr.next){case 0:console.log("value",de),Gr=de.project[de.project.length-1],new Promise(function(Ur){le.Z.post("/sms/business/bizStudentUser/presentation",{studentUserIdList:At.join(","),project:Gr}).then(function(Eu){Eu.status=="success"&&(P.default.success("\u63A8\u8350\u6210\u529F!"),R(!1),Yr(),Ur(Eu))})});case 3:case"end":return Jr.stop()}},rt)}));return function(rt){return ge.apply(this,arguments)}}(),children:(0,t.jsx)(tr.Z,{width:"sm",name:"project",placeholder:"\u54A8\u8BE2\u62A5\u8003\u5C97\u4F4D",label:"\u63A8\u8350\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:$.Z.getCascader("dict_reg_job"),showSearch:{filter:Ue.Z},onSearch:function(rt){return console.log(rt)}}})}),Lt&&(0,t.jsx)(ot.Y,{width:450,visible:Lt,modalProps:{maskClosable:!1,onCancel:function(){ur(!1)}},formRef:fu,onFinish:function(){var ge=(0,g.Z)((0,j.Z)().mark(function rt(de){return(0,j.Z)().wrap(function(Qr){for(;;)switch(Qr.prev=Qr.next){case 0:if(bu){Qr.next=3;break}return P.default.error("\u8BF7\u9009\u62E9\u8001\u5E08\uFF01"),Qr.abrupt("return");case 3:console.log("selectedRowsId",At),new Promise(function(Jr){le.Z.postAll("/sms/business/bizStudentUser/assign/".concat(bu.id),At).then(function(Ur){Ur.status=="success"&&(P.default.success("\u5206\u914D\u6210\u529F!"),ur(!1),Yr())})});case 5:case"end":return Qr.stop()}},rt)}));return function(rt){return ge.apply(this,arguments)}}(),children:(0,t.jsx)(vr.Z,{ref:null,userLabel:"\u63A8\u8350\u7ED9",userNames:"userId",enable:!0,userPlaceholder:"\u8BF7\u9009\u62E9\u8001\u5E08",setUserNameId:function(rt){return Lu(rt)},flag:!0})}),Pt&&(0,t.jsx)(ot.Y,{width:450,visible:Pt,modalProps:{maskClosable:!1,onCancel:function(){$r(!1)}},formRef:fu,onFinish:function(){var ge=(0,g.Z)((0,j.Z)().mark(function rt(de){return(0,j.Z)().wrap(function(Qr){for(;;)switch(Qr.prev=Qr.next){case 0:if(vu){Qr.next=3;break}return P.default.error("\u8BF7\u9009\u62E9\u62DB\u751F\u8001\u5E08\uFF01"),Qr.abrupt("return");case 3:console.log("value",de),new Promise(function(Jr){le.Z.post("/sms/business/bizStudentUser/diyPresentation",{studentUserIdList:At.join(","),userId:vu.id}).then(function(Ur){Ur.status=="success"&&(P.default.success("\u63A8\u8350\u6210\u529F!"),$r(!1),Yr())})});case 5:case"end":return Qr.stop()}},rt)}));return function(rt){return ge.apply(this,arguments)}}(),children:(0,t.jsx)(vr.Z,{ref:null,userLabel:"\u63A8\u8350\u7ED9",userNames:"userId",enable:!0,userPlaceholder:"\u8BF7\u9009\u62E9\u88AB\u63A8\u8350\u4EBA",setUserNameId:function(rt){return Ru(rt)},flag:!0})})]})}},7903:function(ce,D,e){"use strict";var j=e(57338),g=e(273),V=e(48736),o=e(27049),I=e(98858),i=e(4914),A=e(71153),m=e(60331),L=e(2824),M=e(18106),d=e(63885),J=e(67294),ne=e(37490),X=e(86707),x=e(90437),F=e(48814),f=e(6274),P=e(12156),r=e(98580),p=e(68878),O=e(181),c=e(85893),a=d.Z.TabPane;D.Z=function(h){var ie=h.modalVisible,Ee=h.setModalVisible,s=h.renderData,le=h.mobileHide,$=(0,J.useState)(s.key?s.key:"1"),bt=(0,L.Z)($,2),pe=bt[0],Ct=bt[1],gt=(0,J.useState)(null),et=(0,L.Z)(gt,2),ae=et[0],ut=et[1],ot=(0,J.useState)(null),tr=(0,L.Z)(ot,2),he=tr[0],Ft=tr[1],gr=(0,J.useState)(null),it=(0,L.Z)(gr,2),t=it[0],Ye=it[1],l=(0,J.useState)(null),u=(0,L.Z)(l,2),b=u[0],n=u[1],ht=(0,J.useState)(null),jr=(0,L.Z)(ht,2),$e=jr[0],sr=jr[1],Y=(0,J.useState)(null),Dt=(0,L.Z)(Y,2),re=Dt[0],Xt=Dt[1],B=(0,J.useState)(null),Z=(0,L.Z)(B,2),nr=Z[0],De=Z[1],xr=(0,J.useState)(null),zt=(0,L.Z)(xr,2),Ut=zt[0],Gt=zt[1],kt=(0,J.useState)(null),Kt=(0,L.Z)(kt,2),Bt=Kt[0],Ie=Kt[1],Ot=(0,J.useState)((0,X.Z)()),Je=(0,L.Z)(Ot,2),jt=Je[0],_t=Je[1];(0,J.useEffect)(function(){if(pe=="1"&&!t&&s.id){var Ht=(0,c.jsx)(F.Z,{admin:s.admin,studentUserId:s.id});Ye(Ht)}if(pe=="2"&&!ae&&s.id){var qt=(0,c.jsx)(x.Z,{studentUserId:s.id,type:s.type});ut(qt)}if(pe=="8"&&!he&&s.id){var yr=(0,c.jsx)(x.Z,{admins:s.lastDealTime,studentUserId:s.id,type:s.type});ut(yr)}if(pe=="4"&&!Ut&&s.id){var Zr=(0,c.jsx)(p.Z,{studentUserId:s.id});Gt(Zr)}if(pe=="6"&&!b&&s.id){var _e=(0,c.jsx)(f.Z,{parentId:s.id,isFormal:null});n(_e)}if(pe=="5"&&!$e&&s.id){var or=(0,c.jsx)(P.Z,{mobile:s.mobile});sr(or)}if(pe=="3"&&!nr&&s.id){var Zt=(0,c.jsx)(r.Z,{type:"1",studentType:s.type,chargeType:"refund",studentUserId:s.id});De(Zt)}if(pe=="7"&&!re&&s.id){var Fe=(0,c.jsx)(r.Z,{type:"0",studentType:s.type,chargeType:"chargeList",studentUserId:s.id});Xt(Fe)}if(pe=="9"){var vt=(0,c.jsx)(O.Z,{param:{studentUserIds:","+s.id+","}});Ie(vt)}},[pe,s]);var at="\u5B66\u5458";switch(s.type){case 1:at="\u4F01\u4E1A";break;case 2:at="\u4EE3\u7406\u4EBA";break;case 3:at="\u4ECB\u7ECD\u4EBA";break}return(0,c.jsx)(g.Z,{onClose:function(){Ct("1"),ut(null),n(null),Ye(null),Ee()},width:jt.innerWidth/1.5,visible:ie,destroyOnClose:!0,children:s&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(i.Z,{title:(0,c.jsxs)("span",{children:[at,"\u4FE1\u606F ",s.isInWhitelist?(0,c.jsx)(m.Z,{color:"green",children:"\u767D\u540D\u5355"}):(0,c.jsx)(c.Fragment,{})]}),bordered:!0,size:"small",labelStyle:{fontSize:"12px"},children:[(0,c.jsxs)(i.Z.Item,{label:at=="\u4F01\u4E1A"?"\u4F01\u4E1A\u540D\u79F0":at+"\u59D3\u540D",children:[(0,c.jsx)("div",{children:s.name}),(0,c.jsxs)("div",{children:[" ",s.isPeer&&(0,c.jsx)(m.Z,{color:"#87CEEB",children:"\u540C\u884C\u4F01\u4E1A"})]})]}),(0,c.jsx)(i.Z.Item,{label:"\u7C7B\u578B",children:ne.Z.getName("studentType",s.type)}),s.parentName?(0,c.jsx)(i.Z.Item,{label:"\u6240\u5C5E\u4F01\u4E1A",children:s.parentName}):(0,c.jsx)(i.Z.Item,{label:"\u4F01\u4E1A\u8D1F\u8D23\u4EBA",children:s.chargePersonName}),(0,c.jsx)(i.Z.Item,{label:"\u6027\u522B",children:s.sex==null?"\u672A\u77E5":s.sex?"\u5973":"\u7537"}),(0,c.jsx)(i.Z.Item,{label:"\u8054\u7CFB\u7535\u8BDD",children:!le&&s.mobile}),(0,c.jsx)(i.Z.Item,{label:"\u8EAB\u4EFD\u8BC1",children:s.idCard}),(0,c.jsx)(i.Z.Item,{label:"\u5FAE\u4FE1",children:s.weChat}),(0,c.jsx)(i.Z.Item,{label:"QQ",children:s.qq}),(0,c.jsx)(i.Z.Item,{label:"\u662F\u5426\u6B63\u5F0F\u5B66\u5458",contentStyle:{color:s.isFormal?"rgb(0,172,132)":"red"},children:s.isFormal?"\u6B63\u5F0F"+at:"\u6F5C\u5728"+at}),(0,c.jsx)(i.Z.Item,{label:"\u5BA2\u6237\u6765\u6E90",children:ne.Z.getName("dict_source",s.studentSource)}),(0,c.jsx)(i.Z.Item,{label:"\u6D41\u8F6C\u6B21\u6570",children:s.receiveNum}),(0,c.jsx)(i.Z.Item,{label:"\u8D44\u6E90\u7C7B\u578B",children:ne.Z.getName("circulationType",s.source)}),(0,c.jsx)(i.Z.Item,{label:"\u662F\u5426\u4E3A\u51FA\u955C\u4EBA\u4E13\u5C5E\u8D44\u6E90",children:s.isLive?"\u662F":"\u5426"}),(0,c.jsx)(i.Z.Item,{label:"\u7528\u6237\u72B6\u6001",contentStyle:{color:s.enable===!1?"red":"rgb(0,172,132)"},children:s.enable===!1?"\u7981\u7528":"\u4F7F\u7528\u4E2D"}),(0,c.jsx)(i.Z.Item,{label:"\u54A8\u8BE2\u65F6\u95F4",children:s.createTime}),(0,c.jsx)(i.Z.Item,{label:"\u5B66\u5386",children:ne.Z.getName("dict_education",s.education)}),(0,c.jsx)(i.Z.Item,{label:"\u8054\u7CFB\u5730\u5740",children:s.address}),(0,c.jsx)(i.Z.Item,{label:"\u5907\u6CE8",children:s.description})]}),(0,c.jsx)(o.Z,{}),(0,c.jsx)("div",{children:(0,c.jsxs)(d.Z,{centered:!0,defaultActiveKey:pe,size:"large",style:{marginBottom:32},onChange:function(qt){Ct(qt)},children:[(0,c.jsx)(a,{tab:"\u8DDF\u8FDB/\u56DE\u8BBF\u8FDB\u5EA6",children:t},"1"),(0,c.jsx)(a,{tab:"\u540C\u9879\u76EE\u8BA2\u5355",children:ae},"8"),s.isFormal?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a,{tab:"\u8BA2\u5355\u8BB0\u5F55",children:ae},"2"),(0,c.jsx)(a,{tab:"\u7F34\u8D39\u8BB0\u5F55",children:re},"7"),(0,c.jsx)(a,{tab:"\u5F00\u7968\u8BB0\u5F55",children:Bt},"9"),(0,c.jsx)(a,{tab:"\u9000\u8D39\u8BB0\u5F55",children:nr},"3"),(0,c.jsx)(a,{tab:"\u5408\u540C\u5217\u8868",children:$e},"5")]}):(0,c.jsx)(a,{tab:"\u9886\u53D6\u8BB0\u5F55",children:Ut},"4")]})})]})})}},66371:function(ce,D,e){"use strict";var j=e(12968),g=e(20352),V=e(43185),o=e(43027),I=e(402),i=e(97272),A=e(57663),m=e(71577),L=e(34792),M=e(48086),d=e(39428),J=e(3182),ne=e(11849),X=e(2824),x=e(71194),F=e(50146),f=e(47673),P=e(4107),r=e(67294),p=e(8214),O=e(45510),c=e(86615),a=e(80876),h=e(37476),ie=e(952),Ee=e(64317),s=e(5966),le=e(63434),$=e(90672),bt=e(37490),pe=e(63863),Ct=e(30381),gt=e.n(Ct),et=e(14037),ae=e(63930),ut=e(21010),ot=e(21874),tr=e(42709),he=e(85893),Ft=P.Z.TextArea,gr=F.Z.confirm,it=null;D.Z=function(t){var Ye=(0,ut.tT)("@@initialState"),l=Ye.initialState,u=(0,r.useState)("\u5B66\u5458\u59D3\u540D"),b=(0,X.Z)(u,2),n=b[0],ht=b[1],jr=t.modalVisible,$e=t.setModalVisible,sr=t.callbackRef,Y=t.url,Dt=t.type,re=t.sourceType,Xt=t.isShowMedium,B=t.renderData;console.log(B.from,"isShowMedium");var Z=(0,r.useState)(!1),nr=(0,X.Z)(Z,2),De=nr[0],xr=nr[1],zt=(0,r.useState)(null),Ut=(0,X.Z)(zt,2),Gt=Ut[0],kt=Ut[1],Kt=(0,r.useState)(!1),Bt=(0,X.Z)(Kt,2),Ie=Bt[0],Ot=Bt[1],Je=(0,r.useState)(),jt=(0,X.Z)(Je,2),_t=jt[0],at=jt[1],Ht=(0,r.useState)([{}]),qt=(0,X.Z)(Ht,2),yr=qt[0],Zr=qt[1],_e=(0,r.useState)({}),or=(0,X.Z)(_e,2),Zt=or[0],Fe=or[1],vt=(0,r.useState)(!1),Qe=(0,X.Z)(vt,2),Be=Qe[0],Mt=Qe[1],fr=(0,r.useState)(!1),Ue=(0,X.Z)(fr,2),vr=Ue[0],Tt=Ue[1],Pe=(0,r.useState)(),ze=(0,X.Z)(Pe,2),Ae=ze[0],Rt=ze[1],S=(0,r.useState)({}),Xe=(0,X.Z)(S,2),we=Xe[0],qe=Xe[1],Yt=(0,r.useState)(""),Te=(0,X.Z)(Yt,2),N=Te[0],y=Te[1],W=(0,r.useRef)(null),k=(0,r.useRef)(null),xe=(0,r.useRef)(null),ye=(0,r.useState)(),Ne=(0,X.Z)(ye,2),je=Ne[0],q=Ne[1],G=(0,r.useState)(),K=(0,X.Z)(G,2),Et=K[0],yt=K[1],er=(0,r.useState)(),Se=(0,X.Z)(er,2),Vt=Se[0],Nt=Se[1],tt=(0,r.useRef)(),ir=(0,r.useState)(""),wt=(0,X.Z)(ir,2),Or=wt[0],We=wt[1],Le=(0,r.useState)([]),ve=(0,X.Z)(Le,2),st=ve[0],ct=ve[1],br=(0,r.useState)([]),_r=(0,X.Z)(br,2),Fr=_r[0],Ir=_r[1];(0,r.useEffect)(function(){if(JSON.stringify(we)!="{}"){var Q;console.log(we),tt==null||(Q=tt.current)===null||Q===void 0||Q.setFieldValue("refereeName",we.name)}},[we]),(0,r.useEffect)(function(){if(Gt){var Q=Gt.record;setTimeout(function(){var ee;B.type==1&&ht("\u4F01\u4E1A\u540D\u79F0"),tt==null||(ee=tt.current)===null||ee===void 0||ee.setFieldsValue((0,ne.Z)((0,ne.Z)({},Q),{},{sex:(B==null?void 0:B.sex)===!1?"false":(B==null?void 0:B.sex)===!0?"true":"",type:Q.type.toString(),source:Q.source.toString(),project:bt.Z.getCascaderValue("dict_reg_job",Q.project)}))},100)}},[Gt]),(0,r.useEffect)(function(){if(B.typee=="eidt")delete B.codeFile,delete B.powerAttorneyFile,setTimeout(function(){var z,He,Sr,Jt,mr,Er;B.type==1&&ht("\u4F01\u4E1A\u540D\u79F0"),tt==null||(z=tt.current)===null||z===void 0||z.setFieldsValue((0,ne.Z)((0,ne.Z)({},B),{},{sex:(B==null?void 0:B.sex)===!1?"false":(B==null?void 0:B.sex)===!0?"true":"",type:B.type.toString(),source:(He=B.studentSource)===null||He===void 0?void 0:He.toString(),project:bt.Z.getCascaderValue("dict_reg_job",B.project),education:(Sr=B.education)===null||Sr===void 0?void 0:Sr.toString(),QQ:B==null?void 0:B.qq})),console.log(B.project,"renderData.project"),console.log(bt.Z.getCascaderName("dict_reg_job",B.project));var H={},w={id:B.userId,name:B.userName},C={};if(B.provider)H={id:B.provider,name:B.providerName};else{var Oe,Ce;H={name:l==null||(Oe=l.currentUser)===null||Oe===void 0?void 0:Oe.name,id:l==null||(Ce=l.currentUser)===null||Ce===void 0?void 0:Ce.userid}}if(B.owner)C={id:B.owner,name:B.ownerName?B.ownerName:"\u65E0"};else{var nt,pr;C={name:l==null||(nt=l.currentUser)===null||nt===void 0?void 0:nt.name,id:l==null||(pr=l.currentUser)===null||pr===void 0?void 0:pr.userid}}W==null||(Jt=W.current)===null||Jt===void 0||Jt.setDepartment(w),k==null||(mr=k.current)===null||mr===void 0||mr.setDepartment(H),xe==null||(Er=xe.current)===null||Er===void 0||Er.setDepartment(C),q(w),yt(H),Nt(C)},100);else{var Q,ee,T;tt==null||(Q=tt.current)===null||Q===void 0||Q.setFieldsValue({consultationTime:gt()().format("YYYY-MM-DD HH:mm:ss")});var me={name:l==null||(ee=l.currentUser)===null||ee===void 0?void 0:ee.name,id:l==null||(T=l.currentUser)===null||T===void 0?void 0:T.userid};if(B!=null&&B.teacher){var U,Me,It;W==null||(U=W.current)===null||U===void 0||U.setDepartment(me),q(me),xe==null||(Me=xe.current)===null||Me===void 0||Me.setDepartment(me),Nt(me),k==null||(It=k.current)===null||It===void 0||It.setDepartment(me),yt(me)}if(B!=null&&B.newMedia){var be;k==null||(be=k.current)===null||be===void 0||be.setDepartment(me),yt(me)}}Ar()},[]);var Ar=function(){var Q=(0,J.Z)((0,d.Z)().mark(function ee(){var T,me,U,Me;return(0,d.Z)().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:return be.next=2,pe.Z.get("/sms/share/getDepartment",{_isGetAll:!0});case 2:T=be.sent,me=T.data[0].id,U=T.data.find(function(z){return z.parentId===me}),Me=U?T.data.filter(function(z){return z.parentId===me||z.parentId===-1}):[],console.log(T.data,"=====>contentList.data"),console.log(Me,"=====>result"),ct(Me);case 9:case"end":return be.stop()}},ee)}));return function(){return Q.apply(this,arguments)}}();(Dt=="\u5B66\u5458"||B.parentId!=-1)&&setTimeout(function(){var Q;tt==null||(Q=tt.current)===null||Q===void 0||Q.setFieldsValue({type:"0"})},100),(!B.parentId&&Dt=="\u4F01\u4E1A/\u540C\u884C\u673A\u6784"||!B.parentId&&Dt=="\u540C\u884C\u673A\u6784")&&setTimeout(function(){var Q;ht("\u4F01\u4E1A\u540D\u79F0"),tt==null||(Q=tt.current)===null||Q===void 0||Q.setFieldsValue({type:"1"})},100),Dt=="\u4E2A\u4EBA\u4EE3\u7406"&&!B.parentId&&setTimeout(function(){var Q;ht("\u4EE3\u7406\u4EBA\u59D3\u540D"),tt==null||(Q=tt.current)===null||Q===void 0||Q.setFieldsValue({type:"2"})},100);var Ge=function(){var Q=(0,J.Z)((0,d.Z)().mark(function ee(T){var me,U,Me,It,be,z,He=arguments;return(0,d.Z)().wrap(function(Jt){for(;;)switch(Jt.prev=Jt.next){case 0:if(me=He.length>1&&He[1]!==void 0?He[1]:!0,delete T.userId,T.provider=Et.id||"",T.owner=Vt.id||"",T.createBy=je.id||"",!T.mobile){Jt.next=11;break}return Jt.next=8,pe.Z.get("/sms/business/bizStudent/findOrderByMobile",{mobileList:T.mobile});case 8:Jt.t0=Jt.sent.data,Jt.next=12;break;case 11:Jt.t0={order:[],visit:[]};case 12:if(U=Jt.t0,!((U.order.length!==0||U.visit.length!==0)&&B.typee=="add"&&me)){Jt.next=18;break}return Fe(T),Zr(U),Tt(!0),Jt.abrupt("return");case 18:if(T.type=="1"&&(T.isPeer||(T.isPeer=!1)),B.typee=="eidt"&&(T.id=B.studentId),Gt&&(T.id=Gt.id),B.parentId&&(T.parentId=B.parentId),JSON.stringify(we)!="{}"&&(T.refereeId=we.id,delete T.refereeName),Object.keys(T).forEach(function(mr){T[mr]==""&&B.typee=="add"&&mr!="isPeer"&&delete T[mr]}),re!=1){Jt.next=33;break}return Me=B.newMedia?[T]:T,pe.Z.post2("/sms/business/bizStudent/addCirculationRepository",{departmentId:Fr},[Me]),M.default.success("\u64CD\u4F5C\u6210\u529F"),$e(),sr(),Jt.abrupt("return");case 33:return It=B.newMedia?"/sms/business/bizStudent/batch/importForOther":"/sms/business/bizStudent",be=B.newMedia?[T]:T,z=function(Er){if(Er.status=="success"){if(B.typee=="eidt"){var H={id:B.id,project:T.project,studentSource:T.source,consultationTime:T.consultationTime,provider:Et.id};pe.Z.post("/sms/business/bizStudentUser",H)}return M.default.success("\u64CD\u4F5C\u6210\u529F"),$e(),sr(),!0}},Jt.abrupt("return",new Promise(function(mr){B.newMedia?pe.Z.postAll(It,be).then(function(Er){mr(z(Er))}).catch(function(Er){mr(!0)}):pe.Z.post(It,be).then(function(Er){mr(z(Er))}).catch(function(Er){mr(!0)})}));case 37:case"end":return Jt.stop()}},ee)}));return function(T){return Q.apply(this,arguments)}}(),Pr=function(ee,T){return T.some(function(me){return me.label.toLowerCase().indexOf(ee.toLowerCase())>-1})},wr=function(){var ee=Or;return ee.trim().split(`
`).reduce(function(T,me){var U,Me=me.match(/^([^:]+)[:](.+)$/);if(Me){var It=Me[1].trim(),be=Me[2].trim().replace(/[,.]$/,"");T[It]=be}var z=/^1[3-9]\d{9}$/,He=/^[a-zA-Z][-_a-zA-Z0-9]{5,19}$/;if(console.log(T.\u8054\u7CFB\u65B9\u5F0F,"acc.\u8054\u7CFB\u65B9\u5F0F"),z.test(T.\u8054\u7CFB\u65B9\u5F0F)){var Sr;(Sr=tt.current)===null||Sr===void 0||Sr.setFieldsValue({mobile:T.\u8054\u7CFB\u65B9\u5F0F,weChat:""})}else if(He.test(T.\u8054\u7CFB\u65B9\u5F0F)){var Jt;(Jt=tt.current)===null||Jt===void 0||Jt.setFieldsValue({weChat:T.\u8054\u7CFB\u65B9\u5F0F,mobile:""})}(U=tt.current)===null||U===void 0||U.setFieldsValue({name:T.\u5B66\u5458\u59D3\u540D,education:bt.Z.getValue("dict_education",T.\u5B66\u5386)||void 0,source:bt.Z.getValue("dict_source",T.\u5BA2\u6237\u6765\u6E90),description:T.\u5907\u6CE8,owner:T.\u51FA\u955C\u4EBA});var mr=bt.Z.getUserId(T.\u51FA\u955C\u4EBA);if(T.\u51FA\u955C\u4EBA==="\u65E0"){var Er,H={id:"-1",name:T.\u51FA\u955C\u4EBA};Nt(H),xe==null||(Er=xe.current)===null||Er===void 0||Er.setDepartment(H)}else{var w,C={id:mr==null?void 0:mr[0],name:T.\u51FA\u955C\u4EBA};Nt(C),xe==null||(w=xe.current)===null||w===void 0||w.setDepartment(C)}return T},{})};function Re(Q,ee){}var lt=sessionStorage.getItem("tokenName"),Ze=sessionStorage.getItem("tokenValue"),cr={};return cr[lt]=Ze,(0,he.jsxs)(h.Y,{title:B.typee=="add"?"\u65B0\u5EFA":"\u7F16\u8F91",formRef:tt,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,maskClosable:!1,onCancel:function(){$e()}},onFinish:function(){var Q=(0,J.Z)((0,d.Z)().mark(function ee(T){return(0,d.Z)().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!(!T.QQ&&!T.weChat&&!T.mobile)){U.next=3;break}return M.default.error("QQ\u3001\u5FAE\u4FE1\u3001\u7535\u8BDD\uFF0C\u4E09\u79CD\u8054\u7CFB\u65B9\u5F0F\u5FC5\u987B\u8981\u6DFB\u52A0\u4E00\u4E2A",5),U.abrupt("return");case 3:return B.studentId&&(T.id=B.studentId),T.project&&(T.project=T.project[T.project.length-1]),T.codeFile&&(T.codeFile=T.codeFile.at(-1).response.data),T.powerAttorneyFile&&(T.powerAttorneyFile=T.powerAttorneyFile.at(-1).response.data),U.next=9,Ge(T,!0);case 9:case"end":return U.stop()}},ee)}));return function(ee){return Q.apply(this,arguments)}}(),visible:jr,children:[Xt?(0,he.jsxs)("div",{children:[(0,he.jsx)(Ft,{rows:7,value:Or,style:{marginBottom:"20px"},onChange:function(ee){return We(ee.target.value)},placeholder:`\u793A\u4F8B\u6A21\u677F:
\u5B66\u5458\u59D3\u540D:\u5F20\u4E09777,
\u8054\u7CFB\u65B9\u5F0F:18682478670,
\u5BA2\u6237\u6765\u6E90:\u89C6\u9891\u53F7,
\u51FA\u955C\u4EBA:\u5468\u97E6\u6807,
\u5907\u6CE8:\u73B0\u5728\u5728\u7EBF
\u70B9\u51FB\u4E0B\u65B9\u590D\u5236\u793A\u4F8B\u6A21\u677F`}),(0,he.jsxs)("div",{style:{display:"flex"},children:[(0,he.jsx)(m.Z,{style:{marginBottom:"20px"},onClick:function(){wr()},children:"\u5BFC\u5165\u57FA\u7840\u4FE1\u606F"}),(0,he.jsxs)("div",{children:[(0,he.jsx)(i.Z.Paragraph,{id:"copy",style:{display:"none"},copyable:{text:`\u5B66\u5458\u59D3\u540D:\u5F20\u4E09777,
\u8054\u7CFB\u65B9\u5F0F:18682478670,
\u5BA2\u6237\u6765\u6E90:\u89C6\u9891\u53F7,
\u51FA\u955C\u4EBA:\u5468\u97E6\u6807,
\u5907\u6CE8:\u73B0\u5728\u5728\u7EBF`},children:"\u590D\u5236\u6A21\u677F"}),(0,he.jsx)(m.Z,{type:"primary",style:{marginBottom:"20px",marginLeft:"20px"},onClick:function(){var ee,T=(ee=document.getElementById("copy"))===null||ee===void 0?void 0:ee.getElementsByTagName("div")[0];T&&(M.default.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F"),T==null||T.click())},children:"\u590D\u5236\u793A\u4F8B"})]})]})]}):null,(0,he.jsxs)(ie.ZP.Group,{children:[(0,he.jsx)(Ee.Z,{label:"\u5B66\u5458\u7C7B\u578B",name:"type",width:"xs",disabled:!0,request:(0,J.Z)((0,d.Z)().mark(function Q(){return(0,d.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",bt.Z.getList("studentType"));case 1:case"end":return T.stop()}},Q)})),fieldProps:{onChange:function(ee){ee=="1"?ht("\u4F01\u4E1A\u540D\u79F0"):ee=="2"?ht("\u4EE3\u7406\u4EBA\u59D3\u540D"):ee=="3"?ht("\u4ECB\u7ECD\u4EBA\u59D3\u540D"):ht("\u5B66\u5458\u59D3\u540D")}},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5B66\u5458\u7C7B\u578B"}]}),(0,he.jsx)(s.Z,{name:"name",width:"md",label:n,placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",rules:[{pattern:new RegExp(/^\S*$/),message:"\u4E0D\u80FD\u5305\u542B\u7A7A\u683C/\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u7528\u6237\u540D"}]}),(0,he.jsx)(m.Z,{style:{marginTop:"30px",marginLeft:"-30px"},type:"primary",hidden:B.parentId==null||B.parentId==-1||B.from=="newmide",disabled:B.types,onClick:(0,J.Z)((0,d.Z)().mark(function Q(){return(0,d.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:xr(!0);case 1:case"end":return T.stop()}},Q)})),children:"\u9009\u62E9\u5B66\u5458"}),n==="\u4F01\u4E1A\u540D\u79F0"?(0,he.jsx)(s.Z,{width:"sm",name:"chargePersonName",label:"\u4F01\u4E1A\u8D1F\u8D23\u4EBA",placeholder:"\u8BF7\u8F93\u5165\u4F01\u4E1A\u8D1F\u8D23\u4EBA",rules:[{required:!0,pattern:new RegExp(/^\S*$/),message:"\u4E0D\u80FD\u5305\u542B\u7A7A\u683C/\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u540D\u5B57"}]}):null,re==1?(0,he.jsx)(Ee.Z,{label:"\u90E8\u95E8",name:"departmentId",width:326,options:st.map(function(Q){return{label:Q.name,value:Q.id}}),fieldProps:{onChange:function(ee){return Ir(ee),ee}},rules:[{required:!0,message:"\u90E8\u95E8\u5FC5\u987B\u9009\u62E9"}]}):null]}),(0,he.jsxs)(ie.ZP.Group,{children:[n==="\u4F01\u4E1A\u540D\u79F0"||Dt==="\u4E2A\u4EBA\u4EE3\u7406"?"":(0,he.jsx)(Ee.Z,{label:"\u5B66\u5386",hidden:n==="\u4F01\u4E1A\u540D\u79F0"||Dt==="\u4E2A\u4EBA\u4EE3\u7406",name:"education",width:"xs",request:(0,J.Z)((0,d.Z)().mark(function Q(){return(0,d.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",bt.Z.getList("dict_education"));case 1:case"end":return T.stop()}},Q)}))}),(0,he.jsx)(s.Z,{width:"sm",name:"mobile",label:"\u8054\u7CFB\u7535\u8BDD",placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD",rules:[{pattern:new RegExp(bt.Z.getRegex("mobile")),message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7"}]}),(0,he.jsx)(s.Z,{width:"md",name:"idCard",label:n==="\u4F01\u4E1A\u540D\u79F0"?"\u4F01\u4E1A\u8D1F\u8D23\u4EBA\u8EAB\u4EFD\u8BC1\u53F7":"\u8EAB\u4EFD\u8BC1\u53F7",placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1",rules:[{pattern:new RegExp(bt.Z.getRegex("idCard")),message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u8EAB\u4EFD\u8BC1\u53F7"}]})]}),(0,he.jsxs)(ie.ZP.Group,{children:[(0,he.jsx)(s.Z,{width:"xs",name:"weChat",label:"\u5FAE\u4FE1",placeholder:"\u8BF7\u8F93\u5165\u5FAE\u4FE1"}),(0,he.jsx)(s.Z,{width:"xs",name:"QQ",label:"QQ",placeholder:"\u8BF7\u8F93\u5165QQ"}),(0,he.jsx)(Ee.Z,{label:"\u6027\u522B",name:"sex",width:"xs",valueEnum:{false:"\u7537",true:"\u5973"}}),(0,he.jsx)(p.Z,{width:"sm",name:"project",placeholder:"\u54A8\u8BE2\u62A5\u8003\u5C97\u4F4D",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:bt.Z.getCascader("dict_reg_job"),showSearch:{filter:Pr},onChange:Re,onSearch:function(ee){return console.log(ee)}}}),(0,he.jsx)(Ee.Z,{label:"\u5BA2\u6237\u6765\u6E90",name:"source",width:200,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5BA2\u6237\u6765\u6E90"}],request:(0,J.Z)((0,d.Z)().mark(function Q(){return(0,d.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",bt.Z.getList("dict_source"));case 1:case"end":return T.stop()}},Q)}))}),(0,he.jsx)(O.Z,{name:"consultationTime",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"sm",label:"\u54A8\u8BE2\u65E5\u671F",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u54A8\u8BE2\u65E5\u671F"}]}),n==="\u4F01\u4E1A\u540D\u79F0"?(0,he.jsx)(le.Z,{name:"isPeer",label:"\u662F\u5426\u540C\u884C"}):"",(0,he.jsx)(le.Z,{name:"isLive",label:"\u662F\u5426\u4E3A\u51FA\u955C\u4EBA\u4E13\u5C5E\u8D44\u6E90"}),re==2?(0,he.jsxs)("div",{children:[(0,he.jsx)(s.Z,{readonly:!0,children:"\u610F\u5411\u7B49\u7EA7"}),(0,he.jsx)(c.Z.Group,{fieldProps:{value:N,onChange:function(ee){return y(ee.target.value)}},options:[{label:"\u666E\u901A",value:"normal"},{label:"\u9AD8\u610F\u5411",value:"high"}]})]}):null]}),n==="\u4F01\u4E1A\u540D\u79F0"?(0,he.jsx)(s.Z,{name:"code",label:"\u7EDF\u4E00\u793E\u4F1A\u4FE1\u7528\u4EE3\u7801",rules:[{required:!0,pattern:new RegExp(bt.Z.getRegex("code")),message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u793E\u4F1A\u4FE1\u7528\u4EE3\u7801"}]}):"",re!=2?(0,he.jsx)(ot.Z,{ref:W,userLabel:"\u62DB\u751F\u8001\u5E08",userNames:"userId",newMedia:(B==null?void 0:B.teacher)&&B.typee!="eidt",userPlaceholder:"\u8BF7\u8F93\u5165\u62DB\u751F\u8001\u5E08",setUserNameId:function(ee){return q(ee)},flag:!0}):null,(0,he.jsx)(ot.Z,{ref:k,userLabel:"\u4FE1\u606F\u63D0\u4F9B\u4EBA",userNames:"provider",userPlaceholder:"\u8BF7\u8F93\u5165\u4FE1\u606F\u63D0\u4F9B\u4EBA",setUserNameId:function(ee){return yt(ee)},flag:!0}),(0,he.jsx)(ot.Z,{ref:xe,userLabel:"\u4FE1\u606F\u6240\u6709\u4EBA",filter:function(ee){return ee.unshift({title:"\u65E0",userId:-1,value:"-1"}),ee},userNames:"owner",newMedia:!1,userPlaceholder:"\u8BF7\u8F93\u5165\u4FE1\u606F\u6240\u6709\u4EBA",setUserNameId:function(ee){return Nt(ee)},flag:!0}),(0,he.jsx)($.Z,{name:"address",label:"\u5730\u5740",placeholder:"\u8BF7\u8F93\u5165\u63CF\u8FF0..."}),(0,he.jsx)($.Z,{name:"description",label:"\u5907\u6CE8",placeholder:"\u8BF7\u8F93\u5165\u63CF\u8FF0..."}),n==="\u4F01\u4E1A\u540D\u79F0"?(0,he.jsx)(he.Fragment,{children:(0,he.jsxs)(ie.ZP.Group,{children:[(0,he.jsx)(a.Z,{width:340,label:"\u7EDF\u4E00\u793E\u4F1A\u4FE1\u7528\u7801\u7535\u5B50\u7248",name:"codeFile",action:"/sms/business/bizStudent/upload",fieldProps:{multiple:!1,headers:(0,ne.Z)({},cr),listType:"picture",defaultFileList:[],beforeUpload:function(ee){if(ee.type!="image/png"&&ee.type!="image/jpeg")return M.default.error("\u53EA\u80FD\u4E0A\u4F20png\u3001jpg\u683C\u5F0F"),o.Z.LIST_IGNORE},onPreview:function(){var Q=(0,J.Z)((0,d.Z)().mark(function T(me){return(0,d.Z)().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:at(me.thumbUrl),Ot(!0);case 2:case"end":return Me.stop()}},T)}));function ee(T){return Q.apply(this,arguments)}return ee}(),onChange:function(ee){var T=ee.file.status;T==="done"?M.default.success("".concat(ee.file.name," \u4E0A\u4F20\u6210\u529F.")):T==="error"&&M.default.error("".concat(ee.file.name," \u4E0A\u4F20\u5931\u8D25."))}}}),(0,he.jsx)("div",{style:{display:"none"},children:(0,he.jsx)(g.Z,{width:200,style:{display:"none"},preview:{visible:Ie,src:_t,onVisibleChange:function(ee){Ot(ee)}}})})]})}):null,De&&(0,he.jsx)(ae.Z,{type:0,modalVisible:De,setModalVisible:function(){return xr(!1)},renderData:{type:"order"},setStudentId:function(ee){kt(ee)}}),Be&&(0,he.jsx)(et.Z,{CardVisible:Be,CardContent:Ae,setCardVisible:function(){return Mt(!1)},setDepartment:function(ee){return qe(ee)},departments:[we]}),vr&&(0,he.jsx)(tr.Z,{modalVisible:vr,setModalVisible:function(){return Tt(!1)},dataSource:yr,renderData:Zt,type:"student",submitok:function(ee){return Ge(ee,!1)}})]})}},181:function(ce,D,e){"use strict";e.d(D,{Z:function(){return xr}});var j=e(71194),g=e(50146),V=e(39428),o=e(3182),I=e(66456),i=e(15885),A=e(54029),m=e(79166),L=e(32059),M=e(57663),d=e(71577),J=e(49111),ne=e(19650),X=e(62350),x=e(24565),F=e(71153),f=e(60331),P=e(34792),r=e(48086),p=e(11849),O=e(2824),c=e(67294),a=e(22),h=e(37490),ie=e(79438),Ee=e(57338),s=e(273),le=e(88983),$=e(55742),bt=e(86582),pe=e(952),Ct=e(37476),gt=e(59962),et=e(24739),ae=e(5966),ut=e(31199),ot=e(64317),tr=e(90672),he=e(63434),Ft=e(63863),gr=e(98580),it=e(51042),t=e(68855),Ye=e(30202),l=e(19278),u=e(85893),b=g.Z.confirm,n=function(zt){var Ut=zt.renderDataInvoice,Gt=zt.ModalsVisible,kt=zt.setModalsVisible,Kt=zt.callbackRef,Bt=zt.setAddInvoiceVisible;console.log(Ut,"renderDataInvoice=======>");var Ie=(0,c.useRef)(),Ot=(0,c.useState)(!0),Je=(0,O.Z)(Ot,2),jt=Je[0],_t=Je[1],at=(0,c.useState)(!1),Ht=(0,O.Z)(at,2),qt=Ht[0],yr=Ht[1],Zr=(0,c.useState)(!1),_e=(0,O.Z)(Zr,2),or=_e[0],Zt=_e[1],Fe=(0,c.useState)([]),vt=(0,O.Z)(Fe,2),Qe=vt[0],Be=vt[1],Mt=(0,c.useState)([]),fr=(0,O.Z)(Mt,2),Ue=fr[0],vr=fr[1],Tt=(0,c.useState)(0),Pe=(0,O.Z)(Tt,2),ze=Pe[0],Ae=Pe[1];(0,c.useEffect)(function(){Ut.editType=="edit"&&(Object.keys(Ut).forEach(function(Te){typeof Ut[Te]=="number"&&(Ut[Te]=Ut[Te]+"")}),Ut.type==1&&_t(!1),Rt(Ut),Ut.chargeIds!=null&&Ft.Z.get("/sms/business/bizCharge",{"id-in":Ut.chargeIds}).then(function(Te){for(var N=[],y=Ut.chargeIds.split(",").filter(function(je){return!!je}),W=Ut.chargeNum.split(",").filter(function(je){return!!je}),k=Ut.usedAmounts.split(",").filter(function(je){return!!je}),xe=Ut.chargeAmount.split(",").filter(function(je){return!!je}),ye=function(q){N.push({num:W[q],id:y[q],amount:xe[q],thisUsedAmount:k[q],usedAmount:Te.data.content.filter(function(G){return G.id==y[q]})[0].usedAmount})},Ne=0;Ne<y.length;Ne++)ye(Ne);Xe(N)}))},[]);var Rt=function(N){var y,W=N.title,k=N.productType,xe=N.taxCode,ye=N.amount,Ne=N.email,je=N.remark,q=N.cautions,G=N.type,K=N.bank,Et=N.account,yt=N.mobile,er=N.address,Se=N.chargeAccount,Vt=N.price,Nt=N.quantity;(y=Ie.current)===null||y===void 0||y.setFieldsValue({title:W,productType:k,taxCode:xe,amount:ye,email:Ne,remark:je,cautions:q,type:G,bank:K,account:Et,mobile:yt,address:er,chargeAccount:Se,price:Vt,quantity:Nt})};(0,c.useEffect)(function(){Qe.length>0&&(console.log("ChargeList",Qe),Ut.editType!="edit"&&(Rt({chargeAccount:Qe[0].method+""}),S(Qe[0].studentUserId)),Xe(Qe))},[Qe]);var S=function(){var Te=(0,o.Z)((0,V.Z)().mark(function N(y){var W,k;return(0,V.Z)().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return ye.next=2,Ft.Z.get("/sms/business/bizInvoice",{studentUserId:y});case 2:W=ye.sent.data.content,W.length>0&&(k=W[0],Object.keys(k).forEach(function(Ne){typeof k[Ne]=="number"&&(k[Ne]=k[Ne]+"")}),Rt(k));case 4:case"end":return ye.stop()}},N)}));return function(y){return Te.apply(this,arguments)}}(),Xe=function(N){var y,W=N.map(function(k){return{num:k.num,id:k.id,uamount:k.amount,usedAmount:k.thisUsedAmount,surplusAmount:k.amount-k.usedAmount}});vr(W),(y=Ie.current)===null||y===void 0||y.setFieldsValue({chargeList:W})},we=function(N){Ae(N.target.value)},qe=function(N){var y,W,k,xe=((y=Ie.current)===null||y===void 0?void 0:y.getFieldValue("price"))||0,ye=((W=Ie.current)===null||W===void 0?void 0:W.getFieldValue("quantity"))||0;Ie==null||(k=Ie.current)===null||k===void 0||k.setFieldValue("amount",xe*ye),console.log(xe,ye)},Yt=function(N){var y,W="/sms/business/bizInvoice";return delete N.hasAccount,(y=N)!==null&&y!==void 0&&y.chargeList?N.chargeList.forEach(function(k){k.amount=k.usedAmount,delete k.uamount,delete k.num,delete k.usedAmount,delete k.surplusAmount}):N.chargeList=[],Ut.editType=="edit"&&(N.id=Ut.id,W="/sms/business/bizInvoice/edit",N=[N]),new Promise(function(){var k=(0,o.Z)((0,V.Z)().mark(function xe(ye){return(0,V.Z)().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:Ft.Z.postAll(W,N).then(function(q){q.status=="success"&&(r.default.success("\u64CD\u4F5C\u6210\u529F"),kt(),Kt(),ye(q))}).catch(function(q){ye(!0)});case 1:case"end":return je.stop()}},xe)}));return function(xe){return k.apply(this,arguments)}}())};return(0,u.jsxs)(Ct.Y,{title:"\u5F00\u7968\u4FE1\u606F",visible:Gt,formRef:Ie,width:1200,modalProps:{onCancel:function(){return kt(!1)},maskClosable:!1},onFinish:function(){var Te=(0,o.Z)((0,V.Z)().mark(function N(y){return(0,V.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,Yt(y);case 2:case"end":return k.stop()}},N)}));return function(N){return Te.apply(this,arguments)}}(),submitter:{render:function(N,y){return(0,bt.Z)(y)}},children:[(0,u.jsxs)("div",{hidden:Ut.editType=="edit",children:[(0,u.jsx)(pe.ZP.Group,{title:"\u9996\u5148\u8BF7\u9009\u62E9\u5F00\u7968\u7C7B\u578B"}),(0,u.jsxs)($.ZP.Group,{name:"radiogroup",onChange:function(N){return we(N)},children:[(0,u.jsx)($.ZP,{value:1,children:"\u5DF2\u6709\u7F34\u8D39\u5F00\u5177\u53D1\u7968"}),(0,u.jsx)($.ZP,{value:2,children:"\u5148\u5F00\u7968\u540E\u7F34\u8D39"})]})]}),(0,u.jsxs)("div",{hidden:ze==0&&Ut.editType!="edit",children:[(0,u.jsxs)("div",{hidden:ze==2&&Ut.editType!="edit",style:{marginTop:"30px"},children:[(0,u.jsx)(d.Z,{type:"primary",icon:(0,u.jsx)(it.Z,{}),onClick:function(){return Zt(!0)},children:" \u9009\u62E9\u7F34\u8D39\u4FE1\u606F "}),(0,u.jsx)("span",{children:"\u70B9\u51FB\u9009\u62E9\u7F34\u8D39\u4FE1\u606F,\u9009\u62E9\u4F60\u9700\u8981\u5F00\u7968\u7684\u7F34\u8D39"}),(0,u.jsx)(pe.ZP.Group,{title:"\u5F00\u7968\u7F34\u8D39\u4FE1\u606F",children:(0,u.jsx)(gt.u,{name:"chargeList",creatorButtonProps:!1,deleteIconProps:!1,copyIconProps:!1,itemRender:function(N,y){var W=N.listDom,k=N.action,xe=y.record,ye=y.index,Ne=y.name;return(0,u.jsxs)(Ye.ZP,{title:"\u7F34\u8D39\u4FE1\u606F",bordered:!0,style:{marginBottom:8},children:[(0,u.jsxs)(et.UW,{children:[(0,u.jsx)(ae.Z,{label:"\u7F34\u8D39\u7F16\u53F7",name:"num",readonly:!0}),(0,u.jsx)(ae.Z,{label:"\u7F34\u8D39\u91D1\u989D",name:"uamount",readonly:!0}),(0,u.jsx)(ae.Z,{label:"\u5F53\u524D\u7F34\u8D39\u5269\u4F59\u53EF\u5F00\u7968\u91D1\u989D",name:"surplusAmount",readonly:!0}),(0,u.jsx)(ut.Z,{name:"usedAmount",label:"\u6B64\u7F34\u8D39\u9700\u8981\u5F00\u7968\u91D1\u989D",width:"md",rules:[{required:!0}],fieldProps:{precision:2,onChange:function(q){},onBlur:function(){if(Ut.editType!="edit"){var q,G=(q=Ie.current)===null||q===void 0?void 0:q.getFieldValue("chargeList"),K=G[ye];K.surplusAmount<K.usedAmount&&g.Z.info({title:"\u6CE8\u610F\uFF01\u5F53\u524D\u5F00\u7968\u91D1\u989D\u5927\u4E8E\u5269\u4F59\u53EF\u5F00\u7968\u91D1\u989D\uFF01",icon:(0,u.jsx)(t.Z,{}),onOk:function(){var Vt,Nt,tt=(Vt=Ie.current)===null||Vt===void 0?void 0:Vt.getFieldValue("chargeList"),ir=tt[ye];delete ir.usedAmount,tt[ye]=ir,(Nt=Ie.current)===null||Nt===void 0||Nt.setFieldValue("chargeList",tt)}})}if(Ut.editType=="edit"){var Et,yt=(Et=Ie.current)===null||Et===void 0?void 0:Et.getFieldValue("chargeList"),er=yt[ye];er.surplusAmount<er.usedAmount&&g.Z.info({title:"\u6CE8\u610F\uFF01\u5F53\u524D\u5F00\u7968\u91D1\u989D\u5927\u4E8E\u5269\u4F59\u53EF\u5F00\u7968\u91D1\u989D\uFF01",icon:(0,u.jsx)(t.Z,{}),onOk:function(){var Vt,Nt,tt=(Vt=Ie.current)===null||Vt===void 0?void 0:Vt.getFieldValue("chargeList"),ir=tt[ye];delete ir.usedAmount,tt[ye]=ir,(Nt=Ie.current)===null||Nt===void 0||Nt.setFieldValue("chargeList",tt)}})}}}})]},"invoice-form-group-".concat(ye)),(0,u.jsx)("p",{style:{color:"red"},children:"2024\u5E7410\u670825\u53F7\u540E\uFF08\u542B25\u53F7\uFF09\u5E94\u6025\u9879\u76EE\u586B\u5199\u5F00\u7968\u91D1\u989D\u8981\u51CF\u53BB\u8003\u8BD5\u8D39\uFF08\u6709\u5408\u540C\u7684\u4EE5\u5408\u540C\u7B7E\u8BA2\u65E5\u671F\u4E3A\u51C6\uFF0C\u65E0\u5408\u540C\u7684\u4EE5\u6536\u6B3E\u65E5\u671F\u4E3A\u51C6\uFF09"})]},"invoice-modal-".concat(ye))}})})]}),(0,u.jsxs)("div",{hidden:ze==1&&Qe.length==0,children:[(0,u.jsx)(pe.ZP.Group,{title:"\u7A0E\u7968\u4FE1\u606F",children:(0,u.jsx)(l.Z,{})}),(0,u.jsxs)("div",{children:[(0,u.jsxs)(pe.ZP.Group,{children:[(0,u.jsx)(ae.Z,{name:"title",label:"\u53D1\u7968\u62AC\u5934",width:"lg",rules:[{required:!0}]}),(0,u.jsx)(ot.Z,{label:"\u5546\u54C1\u79CD\u7C7B",name:"productType",width:"md",initialValue:"0",rules:[{required:!0}],request:(0,o.Z)((0,V.Z)().mark(function Te(){return(0,V.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",h.Z.getList("invoiceProductType"));case 1:case"end":return y.stop()}},Te)}))})]}),(0,u.jsxs)(pe.ZP.Group,{children:[(0,u.jsx)(ot.Z,{label:"\u4ED8\u6B3E\u65B9\u5F0F",name:"chargeAccount",rules:[{required:!0}],width:"md",request:(0,o.Z)((0,V.Z)().mark(function Te(){return(0,V.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",h.Z.getList("dict_stu_refund_type"));case 1:case"end":return y.stop()}},Te)}))}),(0,u.jsx)(ut.Z,{name:"price",label:"\u5355\u4EF7",rules:[{required:!0}],fieldProps:{onChange:function(N){return qe(N)}}}),(0,u.jsx)(ut.Z,{name:"quantity",label:"\u6570\u91CF",rules:[{required:!0}],fieldProps:{onChange:function(N){return qe(N)}}})]}),(0,u.jsxs)(pe.ZP.Group,{children:[(0,u.jsx)(ae.Z,{name:"taxCode",label:"\u7A0E\u53F7",width:"md",rules:[{required:!0}]}),(0,u.jsx)(ut.Z,{name:"amount",label:"\u91D1\u989D",width:"md",rules:[{required:!0}],fieldProps:{precision:2}}),(0,u.jsx)(ae.Z,{name:"email",label:"\u5B66\u5458\u90AE\u7BB1",width:"md",rules:[{required:!0}],fieldProps:{autoComplete:"no"}})]}),(0,u.jsxs)(pe.ZP.Group,{children:[(0,u.jsx)(tr.Z,{width:1100,label:"\u53D1\u7968\u5907\u6CE8\uFF08\u5728\u7968\u636E\u4E0A\u663E\u793A\uFF0C\u8C28\u614E\u586B\u5199\uFF09",name:"remark",fieldProps:{autoComplete:"no"}}),(0,u.jsx)(tr.Z,{width:1100,label:"\u6CE8\u610F\u4E8B\u9879",name:"cautions",fieldProps:{autoComplete:"no"}})]}),(0,u.jsxs)(pe.ZP.Group,{children:[(0,u.jsx)(ot.Z,{label:"\u53D1\u7968\u79CD\u7C7B",name:"type",width:"md",rules:[{required:!0}],fieldProps:{onChange:function(N){N==0?(_t(!0),yr(!1)):(_t(!1),yr(!0))}},initialValue:"0",request:(0,o.Z)((0,V.Z)().mark(function Te(){return(0,V.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",h.Z.getList("invoiceType"));case 1:case"end":return y.stop()}},Te)}))}),(0,u.jsx)(he.Z.Group,{hidden:qt,name:"hasAccount",layout:"vertical",options:["\u586B\u5199\u8D26\u53F7\u4FE1\u606F"],fieldProps:{onChange:function(N){console.log(N),N.length>0?_t(!1):_t(!0)}}})]}),(0,u.jsxs)("div",{hidden:jt,children:[(0,u.jsxs)(pe.ZP.Group,{children:[(0,u.jsx)(ae.Z,{name:"bank",label:"\u5F00\u6237\u884C",width:"md",rules:[{required:!jt}]}),(0,u.jsx)(ae.Z,{name:"account",label:"\u8D26\u53F7",width:"md",rules:[{required:!jt}]})]}),(0,u.jsxs)(pe.ZP.Group,{children:[(0,u.jsx)(ae.Z,{name:"mobile",label:"\u7535\u8BDD",width:"md",rules:[{required:!jt}]}),(0,u.jsx)(ae.Z,{name:"address",label:"\u5730\u5740",width:"md",rules:[{required:!jt}]})]})]})]})]})]}),or&&(0,u.jsxs)(s.Z,{open:or,onClose:function(){return Zt(!1)},width:1200,children:[(0,u.jsx)("p",{style:{fontSize:"26px",fontWeight:"bold"},children:"\u8BF7\u52FE\u9009\u4F60\u8981\u5F00\u7968\u7684\u7F34\u8D39\u4FE1\u606F"}),(0,u.jsx)(gr.Z,{setModalsCharge:function(){return Zt(!1)},setChargeList:function(N){return Be(N)},chargeType:"chargeList",studentType:"all",formParam:{confirm:!0}})]})]})},ht=e(45510),jr=e(30381),$e=e.n(jr),sr=g.Z.confirm,Y=function(zt){var Ut=zt.ModalsVisible,Gt=zt.setModalsVisible,kt=zt.renderData,Kt=zt.callbackRef,Bt=(0,c.useState)([]),Ie=(0,O.Z)(Bt,2),Ot=Ie[0],Je=Ie[1],jt=(0,c.useState)(kt.amount),_t=(0,O.Z)(jt,2),at=_t[0],Ht=_t[1],qt=(0,c.useState)(0),yr=(0,O.Z)(qt,2),Zr=yr[0],_e=yr[1],or=(0,c.useState)([]),Zt=(0,O.Z)(or,2),Fe=Zt[0],vt=Zt[1],Qe=(0,c.useRef)(),Be=(0,c.useRef)(),Mt=function(){fr()};(0,c.useEffect)(function(){fr()},[]);var fr=function(){var Pe=(0,o.Z)((0,V.Z)().mark(function ze(){var Ae,Rt,S,Xe;return(0,V.Z)().wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return(Ae=Be.current)===null||Ae===void 0||Ae.setFieldsValue({time:$e()().format("YYYY-MM-DD HH:mm"),amount:0,seller:"",num:""}),Rt=kt.amount,qe.next=4,Ft.Z.get("/sms/business/bizIssueInvoice",{invoiceId:kt.id});case 4:S=qe.sent.data.content,S.length>0&&(Xe=0,S.forEach(function(Yt){Xe=Xe+Yt.amount}),Rt=Rt-Xe),Ht(Rt),Je(S);case 8:case"end":return qe.stop()}},ze)}));return function(){return Pe.apply(this,arguments)}}(),Ue=[{title:"\u53D1\u7968\u53F7",dataIndex:"num",sorter:!0},{title:"\u9500\u552E\u65B9",dataIndex:"seller",sorter:!0,valueType:"select",filters:!0,filterMultiple:!1,valueEnum:h.Z.getSearch("companyInfo")},{title:"\u91D1\u989D",dataIndex:"amount",sorter:!0},{title:"\u5F00\u7968\u65F6\u95F4",dataIndex:"time",valueType:"dateTime",sorter:!0,render:function(ze,Ae){return(0,u.jsx)("span",{children:Ae.time})}},{title:"\u5907\u6CE8",dataIndex:"remark",sorter:!0},{title:"\u64CD\u4F5C",valueType:"option",key:"operation",dataIndex:"operation",render:function(ze,Ae,Rt,S){return(0,u.jsxs)(ne.Z,{children:[(0,u.jsx)("a",{onClick:function(){var we;S==null||(we=S.startEditable)===null||we===void 0||we.call(S,Ae.id)},children:"\u7F16\u8F91"}),(0,u.jsx)(x.Z,{title:"\u662F\u5426\u786E\u5B9A\u5220\u9664\uFF1F",style:{marginRight:"15px",marginBottom:"8px"},onConfirm:function(){Ft.Z.delete("/sms/business/bizIssueInvoice",{id:Ae.id}).then(function(we){we.status=="success"&&(r.default.success("\u5220\u9664\u6210\u529F"),Mt())})},okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",children:(0,u.jsx)("a",{style:{color:"red"},children:"\u5220\u9664"},"deletes")},"deletePop")]})}}],vr=function(){Ft.Z.postAll("/sms/business/bizInvoice/edit",[{id:kt.id,isOver:!0}]).then(function(ze){ze.status=="success"&&(r.default.success("\u64CD\u4F5C\u6210\u529F"),Gt(),Kt())})},Tt=function(ze){return ze.invoiceId=kt.id,new Promise(function(){var Ae=(0,o.Z)((0,V.Z)().mark(function Rt(S){return(0,V.Z)().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:Ft.Z.post("/sms/business/bizIssueInvoice",ze).then(function(qe){qe.status=="success"&&(r.default.success("\u64CD\u4F5C\u6210\u529F"),Mt(),S(qe))}).catch(function(qe){S(!0)});case 1:case"end":return we.stop()}},Rt)}));return function(Rt){return Ae.apply(this,arguments)}}())};return(0,u.jsxs)(s.Z,{title:"\u5F00\u5177\u53D1\u7968\u4FE1\u606F",open:Ut,onClose:function(){return Gt()},maskClosable:!1,width:1200,children:[(0,u.jsx)(a.Z,{actionRef:Qe,columns:Ue,dataSource:Ot,editable:{type:"multiple",editableKeys:Fe,onChange:vt,onSave:function(){var Pe=(0,o.Z)((0,V.Z)().mark(function Ae(Rt,S,Xe){var we,qe,Yt,Te,N,y;return(0,V.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return console.log(S),we=S.amount,qe=S.seller,Yt=S.remark,Te=S.time,N=S.id,y=S.num,k.next=4,Tt({amount:we,seller:qe,remark:Yt,time:Te,id:N,num:y});case 4:case"end":return k.stop()}},Ae)}));function ze(Ae,Rt,S){return Pe.apply(this,arguments)}return ze}()}}),(0,u.jsxs)("div",{children:["\u5F53\u524D\u53D1\u7968\u4FE1\u606F\u8FD8\u80FD\u5F00",at-Zr,"\u5143"]}),(0,u.jsxs)(pe.ZP,{submitter:{render:function(ze,Ae){return[].concat((0,bt.Z)(Ae),[(0,u.jsx)(d.Z,{htmlType:"button",type:"primary",style:{backgroundColor:"green",borderColor:"green"},onClick:function(){return vr()},children:"\u5B8C\u7ED3\u8BE5\u53D1\u7968"},"over")])}},formRef:Be,onFinish:function(){var Pe=(0,o.Z)((0,V.Z)().mark(function ze(Ae){return(0,V.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(at-Zr<0)){S.next=4;break}sr({title:"\u6CE8\u610F\uFF01\u5F53\u524D\u5F00\u7968\u91D1\u989D\u5927\u4E8E\u53D1\u7968\u4FE1\u606F\u91D1\u989D\uFF01",icon:(0,u.jsx)(t.Z,{}),content:"\u662F\u5426\u7EE7\u7EED\u5F00\u7968",onOk:function(){Tt(Ae)},onCancel:function(){console.log("Cancel")},okText:"\u7EE7\u7EED",cancelText:"\u53D6\u6D88"}),S.next=6;break;case 4:return S.next=6,Tt(Ae);case 6:case"end":return S.stop()}},ze)}));return function(ze){return Pe.apply(this,arguments)}}(),children:[(0,u.jsxs)(pe.ZP.Group,{title:"\u65B0\u589E\u53D1\u7968\uFF1A",children:[(0,u.jsx)(ae.Z,{label:"\u53D1\u7968\u53F7",name:"num",width:120,rules:[{required:!0,message:"\u8BF7\u586B\u5199\u53D1\u7968\u53F7"}]}),(0,u.jsx)(ot.Z,{label:"\u9500\u552E\u65B9",name:"seller",width:300,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9500\u552E\u65B9"}],request:(0,o.Z)((0,V.Z)().mark(function Pe(){return(0,V.Z)().wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return Ae.abrupt("return",h.Z.getList("companyInfo"));case 1:case"end":return Ae.stop()}},Pe)}))}),(0,u.jsx)(ut.Z,{name:"amount",label:"\u5F00\u7968\u91D1\u989D",width:"sm",rules:[{required:!0}],fieldProps:{precision:2,onChange:function(ze){_e(ze)}}}),(0,u.jsx)(ht.Z,{name:"time",fieldProps:{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"},width:"sm",label:"\u5F00\u7968\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5F00\u7968\u65F6\u95F4"}]})]}),(0,u.jsx)(tr.Z,{name:"remark",label:"\u5907\u6CE8"})]})]})},Dt=e(90631),re={chargeHeard:{\u521B\u5EFA\u53D1\u7968\u4EBA:"userName",\u53D1\u7968\u91D1\u989D:"amount",\u53D1\u7968\u62AC\u5934:"title",\u5546\u54C1\u79CD\u7C7B:"productType",\u53D1\u7968\u7A0E\u53F7:"taxCode",\u53D1\u7968\u5907\u6CE8:"remark",\u6CE8\u610F\u4E8B\u9879:"cautions",\u53D1\u7968\u79CD\u7C7B:"invoiceType",\u5F00\u6237\u884C:"bank",\u8D26\u53F7:"account",\u7535\u8BDD:"mobile",\u5730\u5740:"address",\u7F34\u8D39\u7F16\u53F7:"chargeNum",\u7F34\u8D39\u65B9\u5F0F:"chargeMethod",\u7F34\u8D39\u91D1\u989D:"chargeAmount",\u5F00\u7968\u4FE1\u606F:"InvoiceChildren",\u662F\u5426\u5DF2\u5B8C\u7ED3:"isOver"},InvoiceHeard:{\u521B\u5EFA\u53D1\u7968\u4EBA:"userName",\u53D1\u7968\u91D1\u989D:"amount",\u53D1\u7968\u62AC\u5934:"title",\u5546\u54C1\u79CD\u7C7B:"productType",\u53D1\u7968\u7A0E\u53F7:"taxCode",\u53D1\u7968\u5907\u6CE8:"remark",\u6CE8\u610F\u4E8B\u9879:"cautions",\u53D1\u7968\u79CD\u7C7B:"invoiceType",\u5F00\u6237\u884C:"bank",\u8D26\u53F7:"account",\u7535\u8BDD:"mobile",\u5730\u5740:"address",\u5F00\u7968\u7F16\u53F7:"childNum",\u5F00\u7968\u9500\u552E\u65B9:"childSeller",\u5F00\u7968\u91D1\u989D:"childAmount",\u5F00\u7968\u5907\u6CE8:"childRemark",\u7F34\u8D39\u4FE1\u606F:"ChargeChildren",\u662F\u5426\u5DF2\u5B8C\u7ED3:"isOver"},All:{\u521B\u5EFA\u53D1\u7968\u4EBA:"userName",\u53D1\u7968\u91D1\u989D:"amount",\u53D1\u7968\u62AC\u5934:"title",\u5546\u54C1\u79CD\u7C7B:"productType",\u53D1\u7968\u7A0E\u53F7:"taxCode",\u53D1\u7968\u5907\u6CE8:"remark",\u6CE8\u610F\u4E8B\u9879:"cautions",\u53D1\u7968\u79CD\u7C7B:"invoiceType",\u5F00\u6237\u884C:"bank",\u8D26\u53F7:"account",\u7535\u8BDD:"mobile",\u5730\u5740:"address",\u5F00\u7968\u7F16\u53F7:"childNum",\u5F00\u7968\u9500\u552E\u65B9:"childSeller",\u5F00\u7968\u91D1\u989D:"childAmount",\u5F00\u7968\u5907\u6CE8:"childRemark",\u7F34\u8D39\u7F16\u53F7:"chargeNum",\u7F34\u8D39\u65B9\u5F0F:"chargeMethod",\u7F34\u8D39\u91D1\u989D:"chargeAmount",\u662F\u5426\u5DF2\u5B8C\u7ED3:"isOver"},Invoice:{\u53D1\u7968\u7533\u8BF7\u4EBA:"userName",\u5B66\u5458\u59D3\u540D:"studentName",\u7F34\u8D39\u7F16\u53F7:"chargeNum",\u7F34\u8D39\u7C7B\u578B:"chargeType",\u6536\u8D39\u4EBA:"chargeUser",\u6536\u8D39\u65B9\u5F0F:"chargeMethod",\u6536\u8D39\u91D1\u989D:"chargeAmount",\u5BA1\u6838\u65E5\u671F:"auditTime",\u53D1\u7968\u540D\u79F0:"title",\u5546\u54C1\u79CD\u7C7B:"productType",\u7A0E\u53F7:"taxCode",\u5355\u4EF7:"price",\u6570\u91CF:"quantity",\u5F00\u7968\u91D1\u989D:"amount",\u6CE8\u610F\u4E8B\u9879:"cautions",\u7535\u5B50\u90AE\u7BB1:"email",\u53D1\u7968\u79CD\u7C7B:"type",\u8425\u4E1A\u6267\u7167\u5730\u5740:"address",\u7535\u8BDD:"mobile",\u5F00\u6237\u884C:"bank",\u5F00\u6237\u5E10\u53F7:"account",\u53D1\u7968\u5907\u6CE8:"remark",\u8981\u6C42\u5F00\u7968\u516C\u53F8:"chargeAccount",\u53D1\u7968\u7F16\u53F7:"num",\u53D1\u7968\u53F7\u7801:"no",\u5F00\u7968\u65F6\u95F4:"time"}},Xt=e(79046),B=e(91566),Z=e(80876),nr=e(25607),De=e(47038),xr=function(zt){var Ut=zt.chargeId,Gt=Ut===void 0?!1:Ut,kt=zt.param,Kt=kt===void 0?{}:kt,Bt=Object.keys(Kt).length!==0;Kt.enable=!0,(0,De.CY)(Kt);var Ie=(0,c.useState)(!1),Ot=(0,O.Z)(Ie,2),Je=Ot[0],jt=Ot[1],_t=(0,c.useState)(null),at=(0,O.Z)(_t,2),Ht=at[0],qt=at[1],yr=(0,c.useState)(!1),Zr=(0,O.Z)(yr,2),_e=Zr[0],or=Zr[1],Zt=(0,c.useState)(!1),Fe=(0,O.Z)(Zt,2),vt=Fe[0],Qe=Fe[1],Be=(0,c.useState)(Kt),Mt=(0,O.Z)(Be,2),fr=Mt[0],Ue=Mt[1],vr=(0,c.useState)([]),Tt=(0,O.Z)(vr,2),Pe=Tt[0],ze=Tt[1],Ae=(0,c.useState)([0,0]),Rt=(0,O.Z)(Ae,2),S=Rt[0],Xe=Rt[1],we=(0,c.useState)(!1),qe=(0,O.Z)(we,2),Yt=qe[0],Te=qe[1],N=(0,c.useState)(),y=(0,O.Z)(N,2),W=y[0],k=y[1],xe=(0,c.useState)(!1),ye=(0,O.Z)(xe,2),Ne=ye[0],je=ye[1],q=(0,c.useRef)(),G=(0,c.useRef)();(0,c.useEffect)(function(){if(Gt){var We=JSON.parse(JSON.stringify(fr)),Le=Gt.id;Ue((0,p.Z)((0,p.Z)({},We),{},{chargeIds:Le}))}Et()},[]);var K=function(){var Le;G==null||(Le=G.current)===null||Le===void 0||Le.reload(),Et()},Et=function(){Ft.Z.get("/sms/business/bizInvoice/statistics",{array:JSON.stringify([{enable:!0,"auditConfirm-isNull":!0}])}).then(function(Le){Xe(Le.data)})},yt=function(){console.log("1a",Pe),Pe.length!=0&&er(Pe,!0)},er=function(Le,ve){var st=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",ct=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"invoice",br=Le.map(function(_r){return{entityId:_r.id,auditType:"11",confirm:ve,remark:st}});Ft.Z.postAll("/sms/business/bizAudit/audits/11",br).then(function(_r){_r.status=="success"&&ct=="invoice"&&(r.default.success("\u64CD\u4F5C\u6210\u529F"),K())})},Se=[{width:85,title:"\u521B\u5EFA\u4EBA",dataIndex:"userName",sorter:!0,fixed:"left"},{width:100,title:"\u5B66\u5458\u59D3\u540D",dataIndex:"studentName",sorter:!0},{width:100,title:"\u53D1\u7968\u7F16\u53F7",dataIndex:"num"},{width:100,title:"\u53D1\u7968\u53F7\u7801",dataIndex:"no"},{width:100,title:"\u5F00\u7968\u65F6\u95F4",valueType:"dateRange",dataIndex:"time",sorter:!0,render:function(Le,ve){return ve.time}},{width:100,title:"\u7F34\u8D39\u7F16\u53F7",dataIndex:"chargeNum",sorter:!0},{width:100,title:"\u7F34\u8D39\u7C7B\u578B",dataIndex:"chargeType",render:function(Le,ve){var st=typeof Le=="string"?Le.split(","):[],ct=localStorage.getItem("dictionariesList"),br=[];if(ct){var _r=JSON.parse(ct)[13].children,Fr=_r.map(function(Ar){return{value:Ar.value,name:Ar.name}});br=Fr}var Ir=st==null?void 0:st.map(function(Ar){var Ge=br.find(function(Pr){return Pr.value===Ar});return Ge?Ge.name:Ar});return(0,u.jsx)("span",{children:Ir==null?void 0:Ir.join(", ")})}},{width:100,title:"\u53D1\u7968\u62AC\u5934",dataIndex:"title",sorter:!0},{width:100,title:"\u5546\u54C1\u79CD\u7C7B",dataIndex:"productType",sorter:!0,render:function(Le,ve){return(0,u.jsx)("span",{children:h.Z.getName("invoiceProductType",ve.productType)})}},{width:100,title:"\u53D1\u7968\u91D1\u989D",dataIndex:"amount",sorter:!0},{width:100,title:"\u53D1\u7968\u5907\u6CE8",ellipsis:!0,dataIndex:"remark",sorter:!0},{width:100,title:"\u6CE8\u610F\u4E8B\u9879",ellipsis:!0,dataIndex:"cautions",sorter:!0},{width:100,title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",valueType:"dateRange",sorter:!0,render:function(Le,ve){return(0,u.jsx)("span",{children:ve.createTime})}},{width:100,title:"\u662F\u5426\u5DF2\u5B8C\u7ED3",dataIndex:"isOver",sorter:!0,render:function(Le,ve){return(0,u.jsx)("span",{children:ve.isOver?(0,u.jsx)(f.Z,{color:"green",children:"\u662F"}):(0,u.jsx)(f.Z,{color:"red",children:"\u5426"})})}},{width:100,title:"\u5BA1\u6838\u72B6\u6001",dataIndex:"auditConfirm",sorter:!0,render:function(Le,ve){return(0,u.jsx)("span",{children:ve.auditConfirm==null?(0,u.jsx)(f.Z,{color:"orange",children:"\u672A\u5BA1\u6838"}):ve.auditConfirm==!0?(0,u.jsx)(f.Z,{color:"green",children:"\u5BA1\u6838\u901A\u8FC7"}):(0,u.jsx)(f.Z,{color:"red",children:"\u5BA1\u6838\u4E0D\u901A\u8FC7"})})},valueEnum:{"-isNull":{text:"\u672A\u5BA1\u6838",status:"Processing"},true:{text:"\u5BA1\u6838\u901A\u8FC7",status:"Success"},false:{text:"\u672A\u901A\u8FC7",status:"Error"}}},{width:100,title:"\u5BA1\u6838\u4EBA",dataIndex:"auditor"},{title:"\u5BA1\u6838\u65F6\u95F4",key:"auditTime",sorter:!0,width:120,dataIndex:"auditTime",valueType:"dateRange",render:function(Le,ve){return(0,u.jsx)("span",{children:ve.auditTime})}},{width:100,title:"\u53D1\u7968\u79CD\u7C7B",dataIndex:"type",sorter:!0,render:function(Le,ve){return(0,u.jsx)("span",{children:h.Z.getName("invoiceType",ve.type)})}},{width:90,title:"\u5F00\u6237\u884C",dataIndex:"bank",sorter:!0,hideInTable:!0},{width:90,title:"\u8D26\u53F7",dataIndex:"account",sorter:!0,hideInTable:!0},{width:90,title:"\u7535\u8BDD",dataIndex:"mobile",sorter:!0},{width:90,title:"\u5730\u5740",dataIndex:"address",sorter:!0,hideInTable:!0},{title:"\u64CD\u4F5C",width:180,fixed:"right",render:function(Le,ve){return(0,u.jsxs)(ne.Z,{children:[(0,u.jsx)("a",{onClick:function(){qt((0,p.Z)((0,p.Z)({},ve),{},{invoiceType:ve.type,invoiceProductType:ve.productType})),jt(!0)},children:"\u67E5\u770B"}),(0,u.jsx)(x.Z,{title:"\u5BA1\u6838",onConfirm:function(){Ft.Z.post("/sms/business/bizAudit",{entityId:ve.id,confirm:!0,auditType:"11"}).then(function(ct){ct.status=="success"&&(r.default.success("\u64CD\u4F5C\u6210\u529F"),K())})},okText:"\u5BA1\u6838\u901A\u8FC7",cancelText:"\u5BA1\u6838\u4E0D\u901A\u8FC7",children:(0,u.jsx)("a",{hidden:ve.auditConfirm!==null,children:"\u5BA1\u6838"})},ve.id+"edit"),(0,u.jsx)("a",{hidden:Gt,onClick:function(){qt((0,p.Z)({editType:"edit"},ve)),or(!0)},children:"\u7F16\u8F91"}),(0,u.jsx)(x.Z,{title:"\u662F\u5426\u5B8C\u7ED3\uFF1F",onConfirm:function(){Ft.Z.postAll("/sms/business/bizInvoice/edit",[{id:ve.id,isOver:!0}]).then(function(ct){ct.status=="success"&&(r.default.success("\u64CD\u4F5C\u6210\u529F"),K())})},okText:"\u5B8C\u7ED3",cancelText:"\u53D6\u6D88",children:(0,u.jsx)("a",{hidden:ve.isOver||Gt,children:"\u5B8C\u7ED3"})},ve.id+"edit"),(0,u.jsx)(x.Z,{title:"\u662F\u5426\u5E9F\u9664\uFF1F",onConfirm:function(){Ft.Z.post("/sms/business/bizInvoice/disable/"+ve.id).then(function(ct){ct.status=="success"&&(r.default.success("\u5E9F\u9664\u6210\u529F"),K())})},okText:"\u5E9F\u9664",cancelText:"\u53D6\u6D88",children:(0,u.jsx)("a",{hidden:Gt,style:{color:"red"},children:"\u5E9F\u9664"})},ve.id+"disable")]})}}],Vt=[(0,u.jsx)(d.Z,{type:"primary",icon:(0,u.jsx)(it.Z,{}),onClick:function(){qt({editType:"add"}),or(!0)},children:"\u65B0\u589E\u53D1\u7968\u4FE1\u606F"}),(0,u.jsx)(d.Z,{type:"primary",icon:(0,u.jsx)(it.Z,{}),onClick:function(){Te(!0)},children:"\u8D22\u52A1\u5F00\u7968"}),(0,u.jsx)(d.Z,{type:"primary",icon:(0,u.jsx)(Dt.Z,{}),loading:Ne,onClick:function(Le){var ve;je(!0);var st=(ve=q.current)===null||ve===void 0?void 0:ve.getFieldsValue();if(Object.keys(st).forEach(function(ct){st[ct]||delete st[ct]}),Object.keys(st).length==0){r.default.error("\u672A\u9009\u62E9\u6761\u4EF6\uFF01"),je(!1);return}st._isGetAll=!0,st.enable=!0,Ft.Z.get("/sms/business/bizInvoice",st).then(function(ct){ct.status=="success"&&(0,Xt.Z)(ct.data.content,re.Invoice,"\u53D1\u7968\u4FE1\u606F","invoice"),je(!1)})},children:"\u6761\u4EF6\u5BFC\u51FA"})],Nt=(0,L.Z)({},"createTime","desc"),tt={menu:{type:"tab",items:Bt?[{key:"all",label:(0,u.jsx)("span",{children:"\u5168\u90E8"})}]:[{key:"all",label:(0,u.jsx)("span",{children:"\u5168\u90E8"})},{key:"auditConfirm-isNull",label:(0,u.jsx)(m.Z,{count:S[0],size:"small",offset:[5,3],children:(0,u.jsx)("span",{children:"\u672A\u5BA1\u6838"})})},{key:"auditConfirm-true",label:(0,u.jsx)("span",{children:"\u5BA1\u6838\u901A\u8FC7"})},{key:"hasChild",label:(0,u.jsx)("span",{children:"\u8FDB\u884C\u4E2D"})},{key:"Completion",label:(0,u.jsx)("span",{children:"\u5DF2\u5B8C\u7ED3"})},{key:"delete",label:(0,u.jsx)("span",{children:"\u5DF2\u5E9F\u9664"})},{key:"auditConfirm-false",label:(0,u.jsx)("span",{children:"\u5BA1\u6838\u672A\u901A\u8FC7"})}],onChange:function(Le){Le=="all"?Ue({enable:!0}):Le=="hasChild"?Ue({enable:!0,isOver:!1,auditConfirm:!0}):Le=="Completion"?Ue({enable:!0,isOver:!0,auditConfirm:!0}):Le=="delete"?Ue({enable:!1}):Le=="auditConfirm-isNull"?Ue({"auditConfirm-isNull":!0,enable:!0}):Le=="auditConfirm-false"?Ue({auditConfirm:!1,enable:!0}):Le=="auditConfirm-true"&&Ue({auditConfirm:!0,enable:!0}),K()}}},ir=function(Le){var ve=[],st=[];Le.forEach(function(ct){if(ct.chargeNum){var br=ct.chargeIds.split();br.forEach(function(_r){_r!=","&&st.push(_r)})}else ve.push(ct)}),ve=ve.map(function(ct){return ct.productType=ct.productType+"",ct.invoiceType=ct.type+"",ct.invoiceAmount=ct.amount,ct.invoiceBank=ct.bank,ct.invoiceAccount=ct.account,delete ct.amount,ct}),(0,B.Z)(st.join(","),ve)},wt=function(Le){if(!Le||Le.length==0){r.default.error("\u672A\u9009\u62E9\u6570\u636E\uFF01");return}Ft.Z.get("/sms/business/bizInvoice",{"id-in":Le.map(function(ve){return ve.id}),_size:100}).then(function(ve){ve.status=="success"&&(0,Xt.Z)(ve.data.content,re.Invoice,"\u53D1\u7968\u4FE1\u606F","invoice")})},Or=function(Le){k((0,De.gZ)(Le))};return(0,u.jsxs)("div",{children:[(0,u.jsx)(a.Z,{actionRef:G,formRef:q,columns:Se,scroll:{x:1500},request:{url:"/sms/business/bizInvoice",sortList:Nt,params:fr},search:Gt||Bt?!1:{labelWidth:120,defaultCollapsed:!0,defaultColsNumber:10},toolbar:Gt?!1:tt,toolBarRender:Gt?!1:Vt,rowSelection:{selections:[i.Z.SELECTION_ALL,i.Z.SELECTION_INVERT],onChange:function(Le,ve){}},onFn:function(Le){return ze(Le)},tableAlertOptionRender:function(Le){var ve=Le.selectedRowKeys,st=Le.selectedRows,ct=Le.onCleanSelected;return(0,u.jsxs)(ne.Z,{size:24,children:[(0,u.jsx)("a",{style:{marginInlineStart:8},onClick:ct,children:"\u53D6\u6D88\u9009\u62E9"}),(0,u.jsx)("a",{onClick:(0,o.Z)((0,V.Z)().mark(function br(){return(0,V.Z)().wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return Fr.abrupt("return",ir(st));case 1:case"end":return Fr.stop()}},br)})),children:"\u8D22\u52A1\u7F34\u8D39\u5BFC\u51FA"}),(0,u.jsx)("a",{onClick:(0,o.Z)((0,V.Z)().mark(function br(){return(0,V.Z)().wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return Fr.abrupt("return",wt(st));case 1:case"end":return Fr.stop()}},br)})),children:"\u5BFC\u51FA\u53D1\u7968"}),(0,u.jsx)(x.Z,{title:"\u5BA1\u6838",onConfirm:function(){er(st,!0)},onCancel:function(){er(st,!1)},okText:"\u5BA1\u6838\u901A\u8FC7",cancelText:"\u5BA1\u6838\u4E0D\u901A\u8FC7",children:(0,u.jsx)("a",{children:"\u5BA1\u6838"})},"Aedit")]})}}),Je&&(0,u.jsx)(ie.Z,{setModalVisible:function(){return jt(!1)},modalVisible:Je,callbackRef:function(){return K()},renderData:Ht}),_e&&(0,u.jsx)(n,{renderDataInvoice:Ht,ModalsVisible:_e,setModalsVisible:function(){return or(!1)},callbackRef:function(){return K()},setAddInvoiceVisible:function(){return Qe(!0)}}),vt&&(0,u.jsx)(Y,{renderData:Ht,ModalsVisible:vt,setModalsVisible:function(){return Qe(!1)},callbackRef:function(){return K()}}),(0,u.jsxs)(g.Z,{title:"\u6279\u91CF\u5BFC\u5165",okText:"\u5BFC\u5165",onCancel:function(){Te(!1)},onOk:(0,o.Z)((0,V.Z)().mark(function We(){return(0,V.Z)().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(W){ve.next=3;break}return r.default.error("\u8BF7\u4E0A\u4F20\u6587\u4EF6"),ve.abrupt("return");case 3:Ft.Z.postAll("/sms/business/bizInvoice/editOfNum",W).then(function(st){st.status=="success"?(r.default.success("\u5BFC\u5165\u6210\u529F"),Te(!1),K()):r.default.error(st.data),k(void 0)});case 4:case"end":return ve.stop()}},We)})),width:800,visible:Yt,children:[(0,u.jsx)("a",{download:"\u6279\u91CF\u5F00\u7968\u6A21\u677F.xlsx",href:"./template/\u6279\u91CF\u5F00\u7968\u6A21\u677F.xlsx",children:"\u4E0B\u8F7D\u6279\u91CF\u5F00\u7968\u6A21\u677F"}),(0,u.jsx)(Z.Z,{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",name:"file",fieldProps:{beforeUpload:function(Le,ve){var st=new FileReader;return st.onload=function(ct){var br=ct.target.result,_r=nr.ij(br,{type:"binary"}),Fr=_r.Sheets[_r.SheetNames[0]],Ir=nr.P6.sheet_to_json(Fr,{header:1});Or(Ir)},st.readAsArrayBuffer(Le),!1}}})]})]})}},19278:function(ce,D,e){"use strict";var j=e(13062),g=e(71230),V=e(89032),o=e(15746),I=e(85893);D.Z=function(){return(0,I.jsxs)(g.Z,{style:{width:"1100px",backgroundColor:"#d9edf7",border:"1px solid #bce8f1",padding:"20px",marginBottom:"20px"},children:[(0,I.jsx)(o.Z,{span:2,style:{color:"red"},children:"\u6CE8\u610F\uFF1A"}),(0,I.jsxs)(o.Z,{span:22,children:["\uFF081\uFF09\u5B66\u5386\u9879\u76EE\u4E0D\u5F00\u53D1\u7968",(0,I.jsx)("br",{}),"\uFF082\uFF09\u62DB\u751F\u8001\u5E08\u5728\u4E0B\u5355\u65F6\u586B\u5199\u53D1\u7968\u7533\u8BF7\u4FE1\u606F\u2192\u51FA\u7EB3\u5BA1\u6838\u2192\u51FA\u7EB3\u5F00\u5177\u53D1\u7968\u2192\u62DB\u751F\u8001\u5E08\u9886\u53D6\u53D1\u7968\u6216\u51FA\u7EB3\u53D1\u9001\u7535\u5B50\u53D1\u7968\u7ED9\u5B66\u5458\uFF1B",(0,I.jsx)("br",{}),"\uFF083\uFF09\u9009\u62E9\u4E0D\u5F00\u7968\u7684\u4E1A\u52A1\u6536\u6B3E\uFF0C\u540E\u671F\u4E0D\u518D\u5F00\u5177\u53D1\u7968\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4\u91CD\u590D\u7F34\u7A0E\u3002",(0,I.jsx)("br",{}),"\uFF084\uFF09\u52A1\u5FC5\u8BE2\u95EE\u5B66\u5458\u662F\u5426\u5F00\u54A8\u8BE2\u8D39\uFF0C\u53EF\u964D\u4F4E\u98CE\u9669\u3002",(0,I.jsx)("br",{}),"\uFF085\uFF09\u804C\u79F0\u8BC4\u5BA1\u53EA\u53EF\u4EE5\u5F00\u54A8\u8BE2\u8D39\u3002",(0,I.jsx)("br",{}),"\uFF086\uFF09\u5982\u679C\u5B66\u5458\u5F00\u4E13\u7968\uFF0C\u9700\u52A0\u6536\u7968\u9762\u7A0E\u7387\u7684\u7A0E\u8D39\uFF082023\u5E74\u4E3A1%\uFF09\uFF0C\u539F\u56E0\u662F\u5C0F\u89C4\u6A21\u7EB3\u7A0E\u4EBA\u5F00\u666E\u7968\u514D\u7A0E\uFF0C\u800C\u5F00\u4E13\u7968\u4E0D\u51CF\u514D\u4EFB\u4F55\u7A0E\u8D39\u3002",(0,I.jsx)("br",{}),"\uFF087\uFF09\u8BF7\u8DDF\u5B66\u5458\u786E\u5B9A\u597D\u5F00\u7968\u4FE1\u606F\uFF0C\u5982\u679C\u9519\u8BEF\u4E0D\u91CD\u5F00\uFF0C\u56E0\u4E3A\u53D1\u7968\u5F20\u6570\u6709\u9650\u3002",(0,I.jsx)("br",{}),"\uFF088\uFF09\u82E5\u5B66\u5458\u5F00\u4E2A\u4EBA\u53D1\u7968\uFF0C\u62DB\u751F\u8001\u5E08\u8BF7\u63D0\u524D\u544A\u77E5\u5B66\u5458\u4E2A\u4EBA\u53D1\u7968\u4E00\u822C\u516C\u53F8\u4E0D\u7ED9\u62A5\u9500\uFF0C\u5982\u56E0\u5F00\u5177\u4E2A\u4EBA\u53D1\u7968\u5B66\u5458\u4E0D\u80FD\u62A5\u9500\u9700\u8981\u9000\u56DE\u91CD\u5F00\uFF0C\u8D22\u52A1\u4E0D\u4E88\u5F00\u5177\u3002",(0,I.jsx)("br",{})]})]})}},73230:function(ce,D,e){"use strict";var j=e(71153),g=e(60331),V=e(98858),o=e(4914),I=e(39428),i=e(3182),A=e(2824),m=e(71975),L=e(67294),M=e(86707),d=e(37490),J=e(28975),ne=e(63863),X=e(66801),x=e(61261),F=e(41574),f=e(85893);D.Z=function(P){var r=P.setModalVisible,p=P.modalVisible,O=P.renderData,c=(0,L.useState)((0,M.Z)()),a=(0,A.Z)(c,2),h=a[0],ie=a[1],Ee=(0,L.useState)(),s=(0,A.Z)(Ee,2),le=s[0],$=s[1],bt=(0,L.useState)(!1),pe=(0,A.Z)(bt,2),Ct=pe[0],gt=pe[1],et=(0,L.useState)(),ae=(0,A.Z)(et,2),ut=ae[0],ot=ae[1],tr=(0,L.useState)(!1),he=(0,A.Z)(tr,2),Ft=he[0],gr=he[1];return(0,f.jsxs)(m.a,{title:"\u7F34\u8D39\u4FE1\u606F",autoFocusFirstInput:!0,drawerProps:{destroyOnClose:!0,onClose:function(){r()}},width:h.innerWidth/1.5,onFinish:function(){var it=(0,i.Z)((0,I.Z)().mark(function t(Ye){return(0,I.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r();case 1:case"end":return u.stop()}},t)}));return function(t){return it.apply(this,arguments)}}(),visible:p,children:[O.type==2?(0,f.jsxs)(o.Z,{bordered:!0,size:"small",style:{marginBottom:"30px"},children:[(0,f.jsx)(o.Z.Item,{label:"\u5B66\u5458",children:O.oldStudentName}),(0,f.jsx)(o.Z.Item,{label:"\u9879\u76EE\u603B\u79F0",children:d.Z.getCascaderAllName("dict_reg_job",O.oldProject)}),(0,f.jsx)(o.Z.Item,{label:"\u7F34\u8D39\u9879\u76EE",children:d.Z.getCascaderName("dict_reg_job",O.oldProject)}),(0,f.jsx)(o.Z.Item,{label:"\u6536\u6B3E\u65B9\u5F0F",children:d.Z.getCascaderName("dict_stu_refund_type",O.method)}),(0,f.jsx)(o.Z.Item,{label:"\u672C\u6B21\u6298\u6263\u91D1\u989D",children:O.discount}),(0,f.jsx)(o.Z.Item,{label:"\u672C\u6B21\u6298\u6263\u539F\u56E0",children:O.discountRemark}),(0,f.jsx)(o.Z.Item,{label:"\u6536\u8D39\u4EBA",children:O.userName}),(0,f.jsx)(o.Z.Item,{label:"\u7F34\u8D39\u65E5\u671F",children:O.paymentTime}),(0,f.jsx)(o.Z.Item,{label:"\u4E0B\u6B21\u7F34\u8D39\u65F6\u95F4",children:O.nextPaymentTime}),(0,f.jsx)(o.Z.Item,{label:"\u5BA1\u6838\u4EBA",children:O.auditor}),(0,f.jsx)(o.Z.Item,{label:"\u5BA1\u6838\u72B6\u6001",children:O.confirm===!0?(0,f.jsx)(g.Z,{color:"#87d068",children:"\u5BA1\u6838\u901A\u8FC7"}):O.confirm===!1?(0,f.jsx)(g.Z,{color:"#FF0000",children:"\u5BA1\u6838\u672A\u901A\u8FC7"}):(0,f.jsx)(g.Z,{color:"#f50",children:"\u672A\u5BA1\u6838"})}),(0,f.jsx)(o.Z.Item,{label:"\u7F34\u8D39\u5907\u6CE8",span:3,children:O.description}),(0,f.jsx)(o.Z.Item,{label:"\u8D22\u52A1\u5907\u6CE8",span:3,children:O.description2}),(0,f.jsx)(o.Z.Item,{label:"\u5BA1\u6838\u5907\u6CE8",span:3,children:O.remark}),(0,f.jsx)(o.Z.Item,{label:"\u9644\u4EF6",children:O!=null&&O.files?O.files.split(",").map(function(it,t){return(0,f.jsxs)("div",{className:"notice-files",children:["\u9644\u4EF6\u5185\u5BB9\uFF1A"," ",(0,f.jsx)("a",{onClick:function(){(0,x.Z)(O.id,it,"/sms/business/bizCharge/download",$,gt)},children:it})]},t)}):""})]},"jiaofei"):(0,f.jsxs)(o.Z,{bordered:!0,size:"small",style:{marginBottom:"30px"},children:[(0,f.jsx)(o.Z.Item,{label:"\u9000\u8D39\u91D1\u989D",style:{width:"150px"},children:O.amount}),(0,f.jsx)(o.Z.Item,{label:"\u9000\u6B3E\u65B9\u5F0F",children:d.Z.getCascaderName("dict_stu_refund_type",O.method)}),(0,f.jsx)(o.Z.Item,{label:"\u6536\u8D39\u4EBA",children:O.userName}),(0,f.jsx)(o.Z.Item,{label:"\u9879\u76EE\u603B\u79F0",children:d.Z.getCascaderAllName("dict_reg_job",O.oldProject)}),(0,f.jsx)(o.Z.Item,{label:"\u9000\u8D39\u9879\u76EE",children:d.Z.getCascaderName("dict_reg_job",O.oldProject)}),(0,f.jsx)(o.Z.Item,{label:"\u7533\u8BF7\u65F6\u95F4",children:O.paymentTime}),(0,f.jsx)(o.Z.Item,{label:"\u9000\u6B3E\u5907\u6CE8",span:3,children:O.description}),(0,f.jsx)(o.Z.Item,{label:"\u8D22\u52A1\u5907\u6CE8",span:3,children:O.description2}),(0,f.jsx)(o.Z.Item,{label:"\u9000\u6B3E\u9886\u53D6\u4EBA",children:O.recipientName}),(0,f.jsx)(o.Z.Item,{label:"\u9000\u6B3E\u7C7B\u578B",children:d.Z.getCascaderName("dict_refundType",O.refundType)}),(0,f.jsx)(o.Z.Item,{label:"\u7ECF\u529E\u4EBA",children:O.agentName}),(0,f.jsx)(o.Z.Item,{label:"\u8D26\u6237",children:O.account}),(0,f.jsx)(o.Z.Item,{label:"\u5F00\u6237\u540D",children:O.accountName}),(0,f.jsx)(o.Z.Item,{label:"\u5F00\u6237\u884C",children:O.bank}),(0,f.jsx)(o.Z.Item,{label:"\u5BA1\u6838\u8FDB\u5EA6",span:3,children:(0,f.jsx)(X.ZP,{bordered:!0,columns:[{title:"\u5BA1\u6838\u6B65\u9AA4",dataIndex:"auditType",search:!1,render:function(t,Ye){return(0,f.jsx)("span",{children:d.Z.getName("auditType",Ye.auditType)})}},{title:"\u5BA1\u6838\u4EBA",dataIndex:"userName",search:!1},{title:"\u5BA1\u6838\u7ED3\u679C",dataIndex:"confirm",search:!1,render:function(t,Ye){return(0,f.jsx)(g.Z,{color:Ye.confirm?"#87d068":"#FF0000",children:Ye.confirm?"\u5BA1\u6838\u901A\u8FC7":"\u5BA1\u6838\u672A\u901A\u8FC7\uFF0C\u5DF2\u9000\u56DE\u4E0A\u4E00\u6B65"})}},{title:"\u5BA1\u6838\u5EFA\u8BAE",dataIndex:"remark",ellipsis:!0,tip:"\u5EFA\u8BAE\u8FC7\u957F\u4F1A\u81EA\u52A8\u6536\u7F29"},{title:"\u5BA1\u6838\u65F6\u95F4",key:"createTime",dataIndex:"createTime",valueType:"dateRange",render:function(t,Ye){return(0,f.jsx)("span",{children:Ye.createTime})}}],headerTitle:!1,search:!1,rowKey:"id",options:!1,request:function(){var it=(0,i.Z)((0,I.Z)().mark(function t(Ye,l,u){var b;return(0,I.Z)().wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:return ht.next=2,ne.Z.get("/sms/business/bizAudit",{entityId:O.id,"auditType-in":"1,2,3,4"});case 2:return b=ht.sent,ht.abrupt("return",{data:b.data.content,success:b.success,total:b.data.totalElements});case 4:case"end":return ht.stop()}},t)}));return function(t,Ye,l){return it.apply(this,arguments)}}(),pagination:!1})}),(0,f.jsx)(o.Z.Item,{label:"\u9644\u4EF6",children:O!=null&&O.files?O.files.split(",").map(function(it,t){return(0,f.jsxs)("div",{className:"notice-files",children:["\u9644\u4EF6\u5185\u5BB9\uFF1A"," ",(0,f.jsx)("a",{onClick:function(){var l=it.slice(it.indexOf("."));l==".png"||l==".jpg"||l==".jpeg"?(0,x.Z)(O.id,it,"/sms/business/bizCharge/download",$,gt):(0,x.Z)(O.id,it,"/sms/business/bizCharge/download",ot,gr)},children:it})]},t)}):""})]},"tuifei"),Ct&&(0,f.jsx)(J.Z,{imgSrc:le,isModalVisibles:Ct,setisModalVisibles:function(t){return gt(t)}}),(0,f.jsx)(F.Z,{previewVisible:Ft,setPreviewVisible:function(){return gr(!1)},previewImage:ut})]})}},68878:function(ce,D,e){"use strict";var j=e(11849),g=e(2824),V=e(22),o=e(37490),I=e(63863),i=e(67294),A=e(7903),m=e(85893);D.Z=function(L){var M=L.studentUserId,d=M===void 0?null:M;console.log("props",L);var J=(0,i.useState)(null),ne=(0,g.Z)(J,2),X=ne[0],x=ne[1],F=(0,i.useState)(!1),f=(0,g.Z)(F,2),P=f[0],r=f[1],p=(0,i.useRef)(),O=function(){p.current.reload()},c=[{title:"\u5B66\u5458/\u4F01\u4E1A",dataIndex:"studentName",render:function(ie,Ee){return(0,m.jsx)("a",{onClick:function(){I.Z.get("/sms/business/bizStudentUser",{id:Ee.studentUserId}).then(function(le){x((0,j.Z)({},le.data.content[0])),r(!0)})},children:Ee.studentName})}},{title:"\u54A8\u8BE2\u5C97\u4F4D",dataIndex:"project",key:"project",valueType:"cascader",fieldProps:{options:o.Z.getCascader("dict_reg_job")},render:function(ie,Ee){return(0,m.jsx)("span",{children:o.Z.getCascaderName("dict_reg_job",Ee.project)})}},{title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"type",valueType:"select",filters:!0,filterMultiple:!1,valueEnum:o.Z.getSearch("circulationType"),render:function(ie,Ee){return(0,m.jsx)("span",{children:o.Z.getName("circulationType",Ee.type)})}},{title:"\u5BA2\u6237\u6765\u6E90",dataIndex:"source",valueType:"select",valueEnum:o.Z.getSearch("dict_source"),render:function(ie,Ee){return(0,m.jsx)("span",{children:o.Z.getName("dict_source",Ee.source)})}},{title:"\u9886\u53D6\u4EBA",dataIndex:"userName"},{title:"\u9886\u53D6\u65F6\u95F4",key:"createTime",sorter:!0,dataIndex:"createTime",valueType:"dateRange",render:function(ie,Ee){return(0,m.jsx)("span",{children:Ee.createTime})}},{title:"\u521B\u5EFA\u4EBA",dataIndex:"creatorName"},{title:"\u5F53\u524D\u5B66\u5458\u72B6\u6001",dataIndex:"studentStatus",valueType:"select",filters:!0,valueEnum:o.Z.getSearch("visitStatus"),render:function(ie,Ee){return(0,m.jsx)("span",{children:o.Z.getName("visitStatus",Ee.studentStatus)})}}],a={};return d&&(a.studentUserId=d),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(V.Z,{actionRef:p,columns:c,request:{url:"/sms/business/bizReceive",params:a}}),X&&(0,m.jsx)(A.Z,{mobileHide:!0,setModalVisible:function(){return r(!1)},modalVisible:P,renderData:X,callbackRef:function(){return O()}})]})}},91566:function(ce,D,e){"use strict";var j=e(86582),g=e(7339),V=e(63863),o=e(79046);function I(i){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];console.log("idList",i),console.log("arr",A),i?V.Z.get("/sms/business/bizCharge/getListOfFinance",{idList:i}).then(function(m){if(m.status=="success"){var L=m.data;(0,o.Z)([].concat((0,j.Z)(L),(0,j.Z)(A)),g.Z.PayHeader,"\u7F34\u8D39\u4FE1\u606F","charge")}}):(0,o.Z)(A,g.Z.PayHeader,"\u7F34\u8D39\u4FE1\u606F","charge")}D.Z=I},66573:function(ce,D,e){"use strict";var j=e(34792),g=e(48086),V=e(11849),o=sessionStorage.getItem("tokenName"),I=sessionStorage.getItem("tokenValue"),i={};i[o]=I;var A=function(L,M){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,J=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".doc",ne="";d?(ne=L+"?id="+M,Object.keys(d).forEach(function(X){ne=ne+"&".concat(X,"=")+d[X]})):ne=L+"?id="+M,fetch(ne,{method:"GET",headers:(0,V.Z)({},i)}).then(function(X){X.blob().then(function(x){var F;F=new Blob([x],{type:"text/piain"});var f=new FileReader;f.readAsText(F,"utf-8"),f.onload=function(){if(f.result.indexOf("error")>0){var P=JSON.parse(f.result);g.default.error(P.msg);return}else{var r=window.URL.createObjectURL(x),p=document.createElement("a");document.body.appendChild(p);var O="\u9644\u4EF6"+J;p.href=r,p.download=O,p.target="_blank",p.click(),p.remove()}}})})};D.Z=A},86707:function(ce,D){"use strict";var e=function(){var g=window,V=g.innerWidth,o=g.innerHeight;return{innerWidth:V,innerHeight:o}};D.Z=e}}]);
