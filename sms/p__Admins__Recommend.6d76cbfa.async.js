(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7364],{63434:function(fe,M,e){"use strict";var h=e(63185),P=e(9676),u=e(28991),i=e(81253),E=e(85893),p=e(96202),I=e(67294),T=e(71436),t=e(53048),c=["options","fieldProps","proFieldProps","valueEnum"],v=I.forwardRef(function(a,Z){var D=a.options,F=a.fieldProps,U=a.proFieldProps,y=a.valueEnum,R=(0,i.Z)(a,c);return(0,E.jsx)(t.Z,(0,u.Z)({ref:Z,valueType:"checkbox",valueEnum:(0,p.h)(y,void 0),fieldProps:(0,u.Z)({options:D},F),lightProps:(0,u.Z)({labelFormatter:function(){return(0,E.jsx)(t.Z,(0,u.Z)({ref:Z,valueType:"checkbox",mode:"read",valueEnum:(0,p.h)(y,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,u.Z)({options:D},F),proFieldProps:U},R))}},R.lightProps),proFieldProps:U},R))}),d=I.forwardRef(function(a,Z){var D=a.fieldProps,F=a.children;return(0,E.jsx)(P.Z,(0,u.Z)((0,u.Z)({ref:Z},D),{},{children:F}))}),A=(0,T.G)(d,{valuePropName:"checked"}),r=A;r.Group=v,M.Z=r},31199:function(fe,M,e){"use strict";var h=e(28991),P=e(81253),u=e(85893),i=e(67294),E=e(53048),p=["fieldProps","min","proFieldProps","max"],I=function(t,c){var v=t.fieldProps,d=t.min,A=t.proFieldProps,r=t.max,a=(0,P.Z)(t,p);return(0,u.jsx)(E.Z,(0,h.Z)({valueType:"digit",fieldProps:(0,h.Z)({min:d,max:r},v),ref:c,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:A},a))};M.Z=i.forwardRef(I)},64317:function(fe,M,e){"use strict";var h=e(28991),P=e(81253),u=e(85893),i=e(96202),E=e(67294),p=e(66758),I=e(53048),T=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],t=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],c=E.forwardRef(function(a,Z){var D=a.fieldProps,F=a.children,U=a.params,y=a.proFieldProps,R=a.mode,W=a.valueEnum,n=a.request,H=a.showSearch,K=a.options,Y=(0,P.Z)(a,T),z=(0,E.useContext)(p.Z);return(0,u.jsx)(I.Z,(0,h.Z)((0,h.Z)({valueEnum:(0,i.h)(W),request:n,params:U,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,h.Z)({options:K,mode:R,showSearch:H,getPopupContainer:z.getPopupContainer},D),ref:Z,proFieldProps:y},Y),{},{children:F}))}),v=E.forwardRef(function(a,Z){var D=a.fieldProps,F=a.children,U=a.params,y=a.proFieldProps,R=a.mode,W=a.valueEnum,n=a.request,H=a.options,K=(0,P.Z)(a,t),Y=(0,h.Z)({options:H,mode:R||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},D),z=(0,E.useContext)(p.Z);return(0,u.jsx)(I.Z,(0,h.Z)((0,h.Z)({valueEnum:(0,i.h)(W),request:n,params:U,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,h.Z)({getPopupContainer:z.getPopupContainer},Y),ref:Z,proFieldProps:y},K),{},{children:F}))}),d=c,A=v,r=d;r.SearchSelect=A,r.displayName="ProFormComponent",M.Z=r},19054:function(fe,M,e){"use strict";var h=e(28991),P=e(81253),u=e(85893),i=e(67294),E=e(53048),p=["fieldProps","request","params","proFieldProps"],I=function(c,v){var d=c.fieldProps,A=c.request,r=c.params,a=c.proFieldProps,Z=(0,P.Z)(c,p);return(0,u.jsx)(E.Z,(0,h.Z)({valueType:"treeSelect",fieldProps:d,ref:v,request:A,params:r,filedConfig:{customLightMode:!0},proFieldProps:a},Z))},T=i.forwardRef(I);M.Z=T},21874:function(fe,M,e){"use strict";var h=e(13062),P=e(71230),u=e(11849),i=e(39428),E=e(3182),p=e(2824),I=e(952),T=e(5966),t=e(19054),c=e(63434),v=e(67294),d=e(85893),A=null;M.Z=(0,v.forwardRef)(function(r,a){var Z=r.userLabel,D=r.userNames,F=r.userPlaceholder,U=r.setUserNameId,y=r.width,R=y===void 0?"md":y,W=r.setDepartId,n=W===void 0?function(){}:W,H=r.setFalgUser,K=H===void 0?function(){}:H,Y=r.flag,z=Y===void 0?!1:Y,L=r.enable,Q=L===void 0?!0:L,X=r.filter,re=X===void 0?function(g){return g}:X,x=r.userName,ae=r.formRefs,ne=r.userNameChange,pe=ne===void 0?!1:ne,k=r.newMedia,ve=k===void 0?!1:k,q=r.recruit,$=q===void 0?!0:q,se=r.disabled,he=se===void 0?!1:se,oe=(0,v.useState)(JSON.parse(localStorage.getItem("Department"))),le=(0,p.Z)(oe,2),ue=le[0],Pe=le[1],G=(0,v.useState)(""),ie=(0,p.Z)(G,2),b=ie[0],m=ie[1],C=(0,v.useState)(void 0),w=(0,p.Z)(C,2),V=w[0],de=w[1],Ce=(0,v.useState)(!1),_e=(0,p.Z)(Ce,2),J=_e[0],je=_e[1],O=(0,v.useState)(""),j=(0,p.Z)(O,2),_=j[0],N=j[1],Ee=(0,v.useState)(""),De=(0,p.Z)(Ee,2),Te=De[0],Me=De[1];(0,v.useEffect)(function(){},[]),(0,v.useImperativeHandle)(a,function(){return{setDepartment:function(){var g=(0,E.Z)((0,i.Z)().mark(function s(me){return(0,i.Z)().wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:me.id=="-1",de(me.name),m(me.departmentId);case 3:case"end":return Re.stop()}},s)}));function o(s){return g.apply(this,arguments)}return o}()}});var Fe=function(){var g=(0,E.Z)((0,i.Z)().mark(function o(){var s,me,be;return(0,i.Z)().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return s=function Se(ge){var B=[];return ge.forEach(function(S,Be){var ce=[];S.children&&(ce=Se(S.children));var f="",te=!1,Ie={};S.departmentName?(f=S.departmentName,Ie.id=S.id,te=!0):(S.enable||!Q)&&(f=S.name,Ie.userId=S.userId,te=!0),te&&(ce.length>0?B.push((0,u.Z)((0,u.Z)({},Ie),{},{title:f,parentId:S.parentId,children:ce})):B.push((0,u.Z)((0,u.Z)({},Ie),{},{title:f,parentId:S.parentId})))}),B},me=function Se(ge,B){ge.forEach(function(S,Be){S.value=B+"-"+Be,S.children&&Se(S.children,S.value)})},be=s(ue),me(be,0),Ze.abrupt("return",be.reverse());case 5:case"end":return Ze.stop()}},o)}));return function(){return g.apply(this,arguments)}}(),xe=function(o){if(console.log(o),!o.userId){N("error"),K(!0);return}K(!1),N(""),U({name:o.title,id:o.userId,departmentId:o.parentId}),de(o.value),!!$&&(m(o.value.slice(0,o.value.length-2)),n(o.parentId))},ee=function(o){if(!o.id){Me("error"),K(!0);return}K(!1),m(o.value),n(o.id),!!$&&(Me(""),de(""))},Ae=function(o){U({name:o,id:-1})};return(0,d.jsx)(P.Z,{children:ue.length>0&&(0,d.jsxs)(I.ZP.Group,{children:[(0,d.jsx)(T.Z,{name:D,label:Z,placeholder:F,width:R,hidden:!J,fieldProps:{onChange:function(o){Ae(o.target.value)},defaultValue:V,disabled:he},rules:[{required:J}]}),(0,d.jsx)(t.Z,{name:D,label:Z,placeholder:F,allowClear:!0,width:R,secondary:!0,hidden:J,request:(0,E.Z)((0,i.Z)().mark(function g(){return(0,i.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.t0=re,s.next=3,Fe();case 3:return s.t1=s.sent,s.abrupt("return",(0,s.t0)(s.t1));case 5:case"end":return s.stop()}},g)})),required:!0,fieldProps:{disabled:!1,status:_,onSelect:function(o,s){xe(s)},value:[V],treeDefaultExpandAll:!0,filterTreeNode:!0,showSearch:!0,dropdownMatchSelectWidth:!1,labelInValue:!0,treeNodeFilterProp:"title",fieldNames:{label:"title"}}}),(0,d.jsx)(t.Z,{name:"departmentId",hidden:z,label:"\u90E8\u95E8",placeholder:"\u8BF7\u9009\u62E9\u90E8\u95E8",allowClear:!0,width:R,secondary:!0,request:(0,E.Z)((0,i.Z)().mark(function g(){return(0,i.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.t0=re,s.next=3,Fe();case 3:return s.t1=s.sent,s.abrupt("return",(0,s.t0)(s.t1));case 5:case"end":return s.stop()}},g)})),rules:[{required:J||!$}],fieldProps:{disabled:!J&&$,status:Te,onSelect:function(o,s){ee(s)},value:[b],treeDefaultExpandAll:!0,filterTreeNode:!0,showSearch:!0,dropdownMatchSelectWidth:!1,labelInValue:!0,treeNodeFilterProp:"title",fieldNames:{label:"title"}}}),(0,d.jsx)(c.Z,{hidden:z||!$,label:"\u662F\u5426\u662F\u79BB\u804C\u8001\u5E08\uFF08\u4E0D\u5728\u7CFB\u7EDF\u91CC\u7684\u8001\u5E08\uFF09",fieldProps:{onChange:function(o){je(o.target.checked)},defaultChecked:J}})]})})})},22:function(fe,M,e){"use strict";var h=e(39428),P=e(11849),u=e(3182),i=e(2824),E=e(66801),p=e(63863),I=e(67294),T=e(85893);M.Z=function(t){var c=t.columns,v=t.actionRef,d=t.formRef,A=t.cardBordered,r=A===void 0?!0:A,a=t.scroll,Z=a===void 0?!1:a,D=t.request,F=t.beforeSearchSubmit,U=t.toolbar,y=U===void 0?void 0:U,R=t.pagesizes,W=R===void 0?10:R,n=t.rowKey,H=n===void 0?"id":n,K=t.toolBarRender,Y=K===void 0?[]:K,z=t.dateFormatter,L=z===void 0?"string":z,Q=t.rowSelection,X=Q===void 0?!1:Q,re=t.expandable,x=re===void 0?void 0:re,ae=t.tableAlertOptionRender,ne=ae===void 0?void 0:ae,pe=t.onRow,k=t.params,ve=k===void 0?"":k,q=t.dataSource,$=q===void 0?void 0:q,se=t.tableStyle,he=se===void 0?void 0:se,oe=t.footer,le=oe===void 0?void 0:oe,ue=t.onReset,Pe=ue===void 0?void 0:ue,G=t.onSubmit,ie=G===void 0?void 0:G,b=t.onFn,m=b===void 0?void 0:b,C=t.getTotalElements,w=C===void 0?void 0:C,V=t.getData,de=V===void 0?void 0:V,Ce=t.loding,_e=Ce===void 0?void 0:Ce,J=t.search,je=J===void 0?void 0:J,O=t.searchData,j=O===void 0?{}:O,_=t.headerTitle,N=t.editable,Ee=N===void 0?void 0:N,De=t.className,Te=De===void 0?"tables":De,Me=t.rowClassName,Fe=Me===void 0?void 0:Me,xe=!1;D&&(xe=D.sortList);var ee={_orderBy:"",_direction:""},Ae=(0,I.useState)(W),g=(0,i.Z)(Ae,2),o=g[0],s=g[1],me=(0,I.useState)({}),be=(0,i.Z)(me,2),Re=be[0],Ze=be[1];return(0,T.jsx)(E.ZP,{columns:c,className:Te,actionRef:v,formRef:d,cardBordered:r,scroll:Z,headerTitle:_,tableStyle:he,dataSource:$,rowClassName:Fe,request:function(){var Se=(0,u.Z)((0,h.Z)().mark(function ge(B,S,Be){var ce,f,te;return(0,h.Z)().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:return Object.keys(B).forEach(function(l){(B[l]=="null"||B[l]==null)&&(B["".concat(l,"-isNull")]=!0,delete B[l])}),Object.keys(S).length>0?Object.keys(S).forEach(function(l){var Ue;ee._orderBy=l,((Ue=S[l])===null||Ue===void 0?void 0:Ue.indexOf("desc"))==0?ee._direction="desc":ee._direction="asc"}):xe?Object.keys(D.sortList).forEach(function(l){ee._orderBy=l,ee._direction=D.sortList[l]}):ee={_orderBy:"",_direction:""},ce=B,Object.keys(ce).forEach(function(l){ce[l]===""&&delete ce[l]}),f=(0,P.Z)((0,P.Z)((0,P.Z)((0,P.Z)({},Be),D.params),ce),j),Object.keys(f).forEach(function(l){(f[l]==""||f[l]==[""]||f[l]=="-isNull")&&f[l]!==0&&f[l]!==!1&&(f["".concat(l)+"-isNull"]=!0,delete f[l]),f[l]===null&&delete f[l],f[l]=="All"&&delete f[l]}),ee._orderBy!==""&&Object.assign(f,ee),Ze(f),Oe.next=10,p.Z.get(D.url,(0,P.Z)({},f));case 10:return te=Oe.sent,m&&m(te.data.content),de&&de(f),_e&&_e(!1),w&&w(te.data.totalElements),Oe.abrupt("return",{data:te.data.content,success:te.success,total:te.data.totalElements});case 16:case"end":return Oe.stop()}},ge)}));return function(ge,B,S){return Se.apply(this,arguments)}}(),rowKey:H,pagination:{pageSize:o,showSizeChanger:!0,onChange:function(ge,B){s(B)}},toolBarRender:function(){return Y},rowSelection:X,params:ve,expandable:x,dateFormatter:L,tableAlertOptionRender:ne,toolbar:y,onRow:pe,beforeSearchSubmit:F,onReset:Pe,onSubmit:ie,search:je,editable:Ee,footer:le,columnsState:{persistenceKey:Te,persistenceType:"localStorage"}})}},48683:function(fe,M,e){"use strict";e.r(M),e.d(M,{default:function(){return z}});var h=e(71906),P=e(32059),u=e(62350),i=e(24565),E=e(34792),p=e(48086),I=e(57663),T=e(71577),t=e(11849),c=e(2824),v=e(22),d=e(37490),A=e(63863),r=e(67294),a=e(39428),Z=e(3182),D=e(952),F=e(37476),U=e(64317),y=e(31199),R=e(21874),W=e(54493),n=e(85893),H=function(L){var Q=L.setModalVisible,X=L.modalVisible,re=L.callbackRef,x=L.renderData,ae=(0,r.useRef)(null),ne=(0,r.useState)(),pe=(0,c.Z)(ne,2),k=pe[0],ve=pe[1],q=(0,r.useState)(),$=(0,c.Z)(q,2),se=$[0],he=$[1],oe=(0,r.useState)(!1),le=(0,c.Z)(oe,2),ue=le[0],Pe=le[1],G=(0,r.useRef)();(0,r.useEffect)(function(){var b;x.type=="eidt"&&ae.current.setDepartment({id:x.userId,name:x.userName}),ve({id:x.userId,name:x.userName}),(b=G.current)===null||b===void 0||b.setFieldsValue((0,t.Z)((0,t.Z)({},x),{},{percent:x.percent*100}))},[]);var ie=function(m){return new Promise(function(C){A.Z.post("/sms/business/bizIntroductionProject",m).then(function(w){console.log("res",w),w.status=="success"&&(p.default.success("\u64CD\u4F5C\u6210\u529F!"),Q(),re(),C(!0))}).catch(function(w){C(!0)})})};return(0,n.jsxs)(F.Y,{width:550,formRef:G,onFinish:function(){var b=(0,Z.Z)((0,a.Z)().mark(function m(C){return(0,a.Z)().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return delete C.userName,C.userId=k.id,x.type=="eidt"&&(C.id=x.id),C.percent=C.percent/100,V.next=6,ie(C);case 6:case"end":return V.stop()}},m)}));return function(m){return b.apply(this,arguments)}}(),modalProps:{destroyOnClose:!0,onCancel:function(){Q()},maskClosable:!1},visible:X,children:[(0,n.jsx)(R.Z,{ref:ae,userLabel:"\u88AB\u63A8\u8350\u4EBA",userNames:"userName",userPlaceholder:"\u8BF7\u8F93\u5165\u62DB\u751F\u8001\u5E08\u7684\u540D\u5B57",setUserNameId:function(m){return ve(m)},setDepartId:function(m){return he(m)},flag:!0,setFalgUser:function(m){return Pe(m)}}),(0,n.jsxs)(D.ZP.Group,{children:[(0,n.jsx)(U.Z,{width:"md",name:"project",placeholder:"\u9009\u62E9\u62A5\u8003\u5C97\u4F4D",disabled:x.type=="eidt",label:"\u62A5\u8003\u5C97\u4F4D",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62A5\u8003\u5C97\u4F4D"}],fieldProps:{options:d.Z.getList("dict_reg_job"),showSearch:{filter:W.Z},onSearch:function(m){return console.log(m)}}}),(0,n.jsx)(y.Z,{name:"percent",label:"\u62BD\u6210\uFF08\u767E\u5206\u6BD4\uFF09",width:100,fieldProps:{addonAfter:"%"},rules:[{required:!0}]})]})]})},K=e(51042),Y=function(L){var Q=L.type,X=Q===void 0?"":Q,re=L.setCompanyId,x=L.onCancel,ae=L.admin,ne=ae===void 0?!0:ae,pe=(0,r.useState)(null),k=(0,c.Z)(pe,2),ve=k[0],q=k[1],$=(0,r.useState)("/sms/business/bizIntroductionProject"),se=(0,c.Z)($,2),he=se[0],oe=se[1],le=(0,r.useState)(!1),ue=(0,c.Z)(le,2),Pe=ue[0],G=ue[1],ie=(0,r.useRef)(),b=function(){ie.current.reload()};(0,r.useEffect)(function(){d.Z.getDepartmentName()},[]);var m=[{title:"\u63A8\u8350\u9879\u76EE",dataIndex:"parentProjects",key:"parentProjects",valueType:"cascader",fieldProps:{options:d.Z.getList("dict_reg_job"),showSearch:{filter:W.Z}},render:function(j,_){return(0,n.jsx)("span",{children:d.Z.getCascaderAllName("dict_reg_job",_.project)},"parentProjects")}},{title:"\u63A5\u53D7\u63A8\u8350\u9879\u76EE\u8D1F\u8D23\u4EBA",dataIndex:"userName"},{title:"\u63A8\u8350\u4EBA\u6240\u5360\u4E1A\u7EE9\u6BD4\u4F8B(%)",dataIndex:"percent",render:function(j,_){return(0,n.jsxs)("span",{children:[_.percent*100,"%"]},"parentProjects")}},{title:"\u64CD\u4F5C",dataIndex:"options",search:!1,hideInTable:!ne,render:function(j,_){return[(0,n.jsx)(T.Z,{type:"primary",size:"small",hidden:X==="contract",style:{marginRight:"15px"},onClick:function(){q((0,t.Z)((0,t.Z)({},_),{},{type:"eidt",renderDataNumber:0})),G(!0)},children:"\u7F16\u8F91"},"eidt"),(0,n.jsx)(i.Z,{title:"\u662F\u5426\u5220\u9664",okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",onConfirm:function(){A.Z.delete("/sms/contract/conCompany",{id:_.id}).then(function(Ee){Ee.status=="success"&&(p.default.success("\u64CD\u4F5C\u6210\u529F!"),b())})},children:(0,n.jsx)(T.Z,{hidden:X==="contract",type:"primary",size:"small",danger:!0,children:"\u5220\u9664"},"delete")},"deletes"),(0,n.jsx)(T.Z,{hidden:X==="",type:"primary",onClick:function(){re(_),x()},children:"\u9009\u62E9"},"xuanze")]}}],C=function(j,_){if(j===void 0)return"";console.log("1");var N=JSON.parse(j);if(console.log("value",N),_=="project")return d.Z.getCascaderAllName("dict_reg_job",N.project);if(_=="oldData"||_=="newData"){var Ee=N.percent*100+"%",De=d.Z.getDepartmentUserName(N.userId);return"\u9879\u76EE\u63A5\u6536\u4EBA".concat(De,"\u63A8\u8350\u4EBA\u6240\u5360\u4E1A\u7EE9\u6BD4\u4F8B").concat(Ee)}else return""},w=[{title:"\u63A8\u8350\u9879\u76EE",dataIndex:"parentProjects",key:"parentProjects",search:!1,valueType:"cascader",fieldProps:{options:d.Z.getList("dict_reg_job"),showSearch:{filter:W.Z}},render:function(j,_){return(0,n.jsx)("span",{children:C(_.oldData,"project")},"parentProjects")}},{title:"\u66F4\u6539\u524D\u4FE1\u606F",render:function(j,_){return(0,n.jsx)("span",{children:C(_.oldData,"oldData")})},search:!1},{title:"\u66F4\u6539\u540E\u4FE1\u606F",render:function(j,_){return(0,n.jsx)("span",{children:C(_.newData,"newData")})},search:!1},{title:"\u64CD\u4F5C\u4EBA",sorter:!0,dataIndex:"userName"},{title:"\u66F4\u65B0\u65F6\u95F4",key:"updateTime",sorter:!0,dataIndex:"updateTime",valueType:"dateRange",render:function(j,_){return(0,n.jsx)("span",{children:_.updateTime})}}],V=(0,r.useState)(m),de=(0,c.Z)(V,2),Ce=de[0],_e=de[1],J={menu:{type:"tab",items:[{key:"recommendTable",label:"\u4FE1\u606F\u914D\u7F6E"},{key:"optionTable",label:"\u64CD\u4F5C\u8BB0\u5F55"}],onChange:function(j){j=="recommendTable"?(_e(m),oe("/sms/business/bizIntroductionProject")):j=="optionTable"&&(_e(w),oe("/sms/business/bizOperationLog")),b()}}},je=(0,P.Z)({},"updateTime","desc");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{actionRef:ie,columns:Ce,className:"Contract",request:{url:he,sortList:je},toolbar:J,search:{defaultCollapsed:!1,labelWidth:150},toolBarRender:[(0,n.jsx)(T.Z,{icon:(0,n.jsx)(K.Z,{}),type:"primary",hidden:!ne,onClick:function(){q({type:"add",renderDataNumber:0}),G(!0)},children:"\u65B0\u5EFA"},"button")]}),Pe&&(0,n.jsx)(H,{setModalVisible:function(){return G(!1)},modalVisible:Pe,renderData:ve,callbackRef:function(){return b()}})]})},z=function(){return(0,n.jsx)(h.ZP,{children:(0,n.jsx)(Y,{})})}},54493:function(fe,M){"use strict";var e=function(P,u){return u.some(function(i){return i.label.toLowerCase().indexOf(P.toLowerCase())>-1})};M.Z=e}}]);
